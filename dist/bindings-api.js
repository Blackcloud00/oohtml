(()=>{var ut=Object.defineProperty;var Ne=(r,e)=>{for(var n in e)ut(r,n,{get:e[n],enumerable:!0})};var De={};Ne(De,{apply:()=>Me,batch:()=>Se,construct:()=>qe,deep:()=>Ot,defineProperties:()=>Tt,defineProperty:()=>Ie,deleteProperties:()=>Ct,deleteProperty:()=>me,get:()=>k,getOwnPropertyDescriptor:()=>Pe,getOwnPropertyDescriptors:()=>Pt,getPrototypeOf:()=>Te,has:()=>ae,intercept:()=>Et,isExtensible:()=>Ce,observe:()=>At,ownKeys:()=>le,preventExtensions:()=>He,set:()=>Q,setPrototypeOf:()=>je});function w(r){return!Array.isArray(r)&&typeof r=="object"&&r}function W(r){return typeof r}function _(r){return Array.isArray(r)}function ge(r,e,n=null){return _(e)?r.filter(t=>n?e.filter(i=>n(t,i)).length:e.indexOf(t)!==-1):[]}function D(r,...e){if(globalThis.webqit||(globalThis.webqit={}),globalThis.webqit.refs||Object.defineProperty(globalThis.webqit,"refs",{value:new Y}),!arguments.length)return globalThis.webqit.refs;let n=globalThis.webqit.refs.get(r);n||(n=new Y,globalThis.webqit.refs.set(r,n));let t,i;for(;t=e.shift();)(i=n)&&!(n=n.get(t))&&(n=new Y,i.set(t,n));return n}var Y=class extends Map{constructor(...e){super(...e),this.observers=new Set}set(e,n){let t=super.set(e,n);return this.fire("set",e,n,e),t}delete(e){let n=super.delete(e);return this.fire("delete",e),n}has(e){return this.fire("has",e),super.has(e)}get(e){return this.fire("get",e),super.get(e)}keyNames(){return Array.from(super.keys())}observe(e,n,t){let i={type:e,key:n,callback:t};return this.observers.add(i),()=>this.observers.delete(i)}unobserve(e,n,t){if(Array.isArray(e)||Array.isArray(n))throw new Error('The "type" and "key" arguments can only be strings.');for(let i of this.observers)!(fe([e,"*"],i.type)&&fe([n,"*"],i.key)&&i.callback===t)||this.observers.delete(i)}fire(e,n,...t){for(let i of this.observers)!(fe([e,"*"],i.type)&&fe([n,"*"],i.key))||i.callback(...t)}},fe=(r,e)=>Array.isArray(e)?ge(r,e).length:r.includes(e);function V(r){return typeof r=="function"}function ye(r){return V(r)&&/^class\s?/.test(Function.prototype.toString.call(r))}function Z(r){return r===null||r===""}function M(r){return arguments.length&&(r===void 0||typeof r>"u")}function v(r){return Array.isArray(r)||typeof r=="object"&&r||V(r)}function _e(r){return Z(r)||M(r)||r===!1||r===0||v(r)&&!Object.keys(r).length}function b(r){return V(r)||r&&{}.toString.call(r)==="[object function]"}function K(r){return r instanceof Number||typeof r=="number"}function S(r){return K(r)||r!==!0&&r!==!1&&r!==null&&r!==""&&!isNaN(r*1)}function U(r){return r instanceof String||typeof r=="string"&&r!==null}function xe(r){return!U(r)&&!M(r.length)}function ue(r,...e){return e.forEach(n=>{r.indexOf(n)<0&&r.push(n)}),r}function we(t,e){e=e||Object.prototype,e=e&&!_(e)?[e]:e;for(var n=[],t=t;t&&(!e||e.indexOf(t)<0)&&t.name!=="default";)n.push(t),t=t?Object.getPrototypeOf(t):null;return n}function be(r,e){var n=[];return we(r,e).forEach(t=>{ue(n,...Object.getOwnPropertyNames(t))}),n}function I(r,e,n=!1,t=!1,i=!1){var o=0,s=r.shift();if((S(s)||s===!0||s===!1)&&(o=s,s=r.shift()),!r.length)throw new Error("_merge() requires two or more array/objects.");return r.forEach((u,f)=>{!v(u)&&!b(u)||(n?be(u):Object.keys(u)).forEach(l=>{if(!!e(l,s,u,f)){var c=s[l],a=u[l];if((_(c)&&_(a)||w(c)&&w(a))&&(o===!0||o>0))s[l]=_(c)&&_(a)?[]:{},I([S(o)?o-1:o,s[l],c,a],e,n,t,i);else if(_(s)&&_(u))t?s[l]=a:s.push(a);else try{i?Object.defineProperty(s,l,Object.getOwnPropertyDescriptor(u,l)):s[l]=u[l]}catch{}}})}),s}function ee(...r){return I(r,(e,n,t)=>!0,!1,!1,!1)}function O(r,e=!0){return _(r)?r:!e&&w(r)?[r]:r!==!1&&r!==0&&_e(r)?[]:xe(r)?Array.prototype.slice.call(r):w(r)?Object.values(r):[r]}var N=class{constructor(e,n){this.registry=e,Object.assign(this,{...n,target:e.target}),this.params.signal&&this.params.signal.addEventListener("abort",()=>this.remove())}remove(){return this.removed=!0,this.registry.removeRegistration(this)}};var P=(...r)=>D("observer-api",...r),J=(r,e)=>r instanceof Promise?r.then(e):e(r);var te=class extends N{constructor(){super(...arguments),Object.defineProperty(this,"abortController",{value:new AbortController}),Object.defineProperty(this,"signal",{value:this.abortController.signal})}remove(){this.abortController.abort(),super.remove()}fire(e){if(this.handler.recursionTarget&&!["inject","force-async","force-sync"].includes(this.params.recursions))return;let n=e,t=this.filter;if(t!==1/0&&(t=O(t,!1))&&(n=e.filter(i=>t.includes(i.key))),this.params.diff&&(n=n.filter(i=>i.type!=="set"||i.value!==i.oldValue)),n.length){if(this.handler.recursionTarget&&this.params.recursions!=="force-sync"){this.handler.recursionTarget.push(...n);return}this.handler.recursionTarget=this.params.recursions==="inject"?n:[];let i=this.filter===1/0||Array.isArray(this.filter)?this.handler(n,this):this.handler(n[0],this);return J(i,o=>{let s=this.handler.recursionTarget;return delete this.handler.recursionTarget,this.params.recursions==="force-async"&&s.length?this.fire(s):o})}}};var z=class{constructor(e){this.target=e,this.entries=[]}addRegistration(e){return this.entries.push(e),e}removeRegistration(e){this.entries=this.entries.filter(n=>n!==e)}static _getInstance(e,n,t=!0,i=this.__namespace){if(!v(n))throw new Error(`Subject must be of type object; "${W(n)}" given!`);let o=this;return i&&P("namespaces").has(e+"-"+i)&&(o=P("namespaces").get(e+"-"+i),e+="-"+i),!P(n,"registry").has(e)&&t&&P(n,"registry").set(e,new o(n)),P(n,"registry").get(e)}static _namespace(e,n,t=null){if(e+="-"+n,arguments.length===2)return P("namespaces").get(e);if(!(t.prototype instanceof this))throw new Error(`The implementation of the namespace ${this.name}.${n} must be a subclass of ${this.name}.`);P("namespaces").set(e,t),t.__namespace=n}};var F=class extends z{static getInstance(e,n=!0,t=null){return super._getInstance("listeners",...arguments)}static namespace(e,n=null){return super._namespace("listeners",...arguments)}constructor(e){super(e),this.batches=[]}addRegistration(e,n,t){return super.addRegistration(new te(this,{filter:e,handler:n,params:t}))}emit(e){if(this.batches.length){this.batches[0].events.push(...e);return}this.entries.forEach(n=>n.fire(e))}batch(e){this.batches.unshift({entries:[...this.entries],events:[]});let n=e();return J(n,t=>{let i=this.batches.shift();return i.events.length&&i.entries.forEach(o=>o.fire(i.events)),t})}};var re=class extends N{exec(e,n,t){return this.running||!this.traps[e.type]?n(...Array.prototype.slice.call(arguments,2)):(this.running=!0,this.traps[e.type](e,t,(...i)=>(this.running=!1,n(...i))))}};var j=class extends z{static getInstance(e,n=!0,t=null){return super._getInstance("traps",...arguments)}static namespace(e,n=null){return super._namespace("traps",...arguments)}addRegistration(e){return super.addRegistration(new re(this,e))}emit(e,n=null){let t=this;return function i(o,...s){let u=t.entries[o];return u?u.exec(e,(...f)=>i(o+1,...f),...s):n?n(e,...s):s[0]}(0)}};var C=class{constructor(e,n){if(this.target=e,!n.type)throw new Error("Descriptor type must be given in definition!");Object.assign(this,n)}};var Ee={};Ne(Ee,{accessorize:()=>wt,proxy:()=>vt,unaccessorize:()=>bt,unproxy:()=>ce});function wt(r,e,n={}){r=Ae(r);let t=P(r,"accessorizedProps");function i(f){let l,c=r;do l=Object.getOwnPropertyDescriptor(c,f);while(!l&&(c=Object.getPrototypeOf(c)));return l?{proto:c,descriptor:l}:{descriptor:{value:void 0,configurable:!0,enumerable:!0,writable:!0}}}function o(f){if(t.has(f+""))return!0;let l=i(f);l.getValue=function(){return this.descriptor.get?this.descriptor.get():this.descriptor.value},l.setValue=function(d){return this.dirty=!0,this.descriptor.set?this.descriptor.set(d)!==!1:(this.descriptor.value=d,!0)},l.intact=function(){let d=Object.getOwnPropertyDescriptor(r,f);return d?.get===a.get&&d?.set===a.set&&t.get(f+"")===this},l.restore=function(){return this.intact()?(this.proto&&this.proto!==r||!this.proto&&!this.dirty?delete r[f]:Object.defineProperty(r,f,this.descriptor),t.delete(f+""),!0):!1},t.set(f+"",l);let{enumerable:c=!0}=l.descriptor,a={enumerable:c,configurable:!0};("value"in l.descriptor||l.descriptor.set)&&(a.set=function(d){return Q(this,f,d,n)}),("value"in l.descriptor||l.descriptor.get)&&(a.get=function(){return k(this,f,n)});try{return Object.defineProperty(r,f,a),!0}catch{return t.delete(f+""),!1}}let u=(Array.isArray(e)?e:e===void 0?Object.keys(r):[e]).map(o);return e===void 0||Array.isArray(e)?u:u[0]}function bt(r,e,n={}){r=Ae(r);let t=P(r,"accessorizedProps");function i(u){return t.has(u+"")?t.get(u+"").restore():!0}let s=(Array.isArray(e)?e:e===void 0?Object.keys(r):[e]).map(i);return e===void 0||Array.isArray(e)?s:s[0]}function vt(r,e={}){r=Ae(r);let n=new Proxy(r,{apply:(t,i,o)=>Me(t,i,o,e),construct:(t,i,o=null)=>qe(t,i,o,e),defineProperty:(t,i,o)=>Ie(t,i,o,e),deleteProperty:(t,i)=>me(t,i,e),get:(t,i,o=null)=>{let s=k(t,i,{...e,receiver:o});return e.proxyAutoBinding!==!1&&b(s)&&!ye(s)?function(...u){let f=this||n;return Se(f,()=>s.call(f,...u))}:s},getOwnPropertyDescriptor:(t,i)=>Pe(t,i,e),getPrototypeOf:t=>Te(t,e),has:(t,i)=>ae(t,i,e),isExtensible:t=>Ce(t,e),ownKeys:t=>le(t,e),preventExtensions:t=>He(t,e),set:(t,i,o,s=null)=>Q(t,i,o,{...e,receiver:s}),setPrototypeOf:(t,i)=>je(t,i,e)});return P(n).set(n,r),n}function ce(r){return P(r).get(r)||r}function Ae(r){if(!r||!v(r))throw new Error("Target must be of type object!");return ce(r)}function Ot(r,e,n,t=o=>o,i={}){if(!!e.length)return function o(s,u,f){let l=u[f.level],c=f.level===u.length-1;return s instanceof C&&s.type!=="get"?f={...f,probe:"always"}:f.probe!=="always"&&(f={...f,probe:!c}),n(s,l,(a,...d)=>{let g=m=>{m instanceof C&&(m.path=[m.key],s instanceof C&&(m.path=s.path.concat(m.key),Object.defineProperty(m,"context",{get:()=>s,configurable:!0})))},x=m=>{let y=L(m,!1);return J(y,p=>{m instanceof C?m.value=p:m=p;let h=d[0]||{};return o(m,u,{...f,...h,level:f.level+1})})};return de(l)&&Array.isArray(a)?(a.forEach(g),c?t(a,...d):a.map(x)):(g(a),c?t(a,...d):x(a))},f)}(r,e.slice(0),{...i,level:0})}function At(r,e,n,t={}){if(r=L(r,!t.level),b(arguments[1])&&([,n,t={}]=arguments,e=1/0),!b(n))throw new Error(`Handler must be a function; "${W(n)}" given!`);if(t={...t,descripted:!0},delete t.live,!v(r))return t.probe&&k(r,e,n,t);let i=Qe(r,e,n,t);return t.probe?k(r,e,i,t):i()}function Et(r,e,n={}){return r=L(r),w(e)||([,,,n={}]=arguments,e={[arguments[1]]:arguments[2]}),j.getInstance(r,!0,n.namespace).addRegistration({traps:e,params:n})}function Pe(r,e,n=i=>i,t={}){return q(r,"getOwnPropertyDescriptor",{key:e},n,t)}function Pt(r,e,n=i=>i,t={}){return q(r,"getOwnPropertyDescriptors",{key:e},n,t)}function Te(r,e=t=>t,n={}){return q(r,"getPrototypeOf",{},e,n)}function Ce(r,e=t=>t,n={}){return q(r,"isExtensible",{},e,n)}function le(r,e=t=>t,n={}){return q(r,"ownKeys",{},e,n)}function ae(r,e,n=i=>i,t={}){return q(r,"has",{key:e},n,t)}function k(r,e,n=i=>i,t={}){let i;return r=L(r,!t.level),w(n)?[t,n]=[n,o=>o]:t.live&&(i=!0),St(r,e,o=>{let s=[...o];return function u(f,l,c){if(!l.length)return c(f);let a=l.shift();function d(m,y=void 0){let p=E=>(m.value=E,u([...f,t.live||t.descripted?m:E],l,c));if(arguments.length>1)return p(y);let h=P(r,"accessorizedProps",!1),A=h&&h.get(m.key+"");return A&&A.intact()?p(A.getValue()):p(Reflect.get(r,m.key,...t.receiver?[t.receiver]:[]))}let g=new C(r,{type:"get",key:a,value:void 0,related:s});if(!v(r))return u([...f,t.live||t.descripted?g:void 0],l,c);let x=j.getInstance(r,!1,t.namespace);return x?x.emit(g,d):d(g)}([],o.slice(0),u=>{let f=de(e)?u:u[0];return i&&v(r)?Qe(r,e,n,t)(f):n(f)})},t)}function Se(r,e,n={}){return r=L(r),F.getInstance(r,!0,n.namespace).batch(e)}function Q(r,e,n,t=s=>s,i={},o=!1){r=L(r);let s=[[e,n]];w(e)&&([,,t=f=>f,i={},o=!1]=arguments,s=Object.entries(e)),w(t)&&([o,i,t]=[typeof i=="boolean"?i:!1,t,f=>f]);let u=s.map(([f])=>f);return function f(l,c,a){if(!c.length)return a(l);let[d,g]=c.shift();function x(y,p=void 0){let h=T=>(y.status=T,f(l.concat(y),c,a));if(arguments.length>1)return h(y,p);let A=P(r,"accessorizedProps",!1),E=A&&A.get(y.key+"");return y.type==="defineProperty"?(E&&!E.restore()&&h(!1),Object.defineProperty(r,y.key,y.value),h(!0)):E&&E.intact()?h(E.setValue(y.value)):h(Reflect.set(r,y.key,y.value))}function m(y,p){if(i.diff&&g===p)return f(l,c,a);let h=new C(r,{type:o?"defineProperty":"set",key:d,value:g,isUpdate:y,oldValue:p,related:[...u],detail:i.detail}),A=j.getInstance(r,!1,i.namespace);return A?A.emit(h,x):x(h)}return ae(r,d,y=>y?k(r,d,p=>m(y,p),i):m(y),i)}([],s.slice(0),f=>{let l=F.getInstance(r,!1,i.namespace);return l&&l.emit(f),t(de(e)?f.map(c=>c.status):f[0]?.status)})}function Ie(r,e,n,t=o=>o,i={}){return Q(r,e,n,t,i,!0)}function Tt(r,e,n=i=>i,t={}){return Q(r,e,n,t,!0)}function me(r,e,n=i=>i,t={}){r=L(r),w(n)&&([t,n]=[n,s=>s]);let i=O(e,!1),o=[...i];return function s(u,f,l){if(!f.length)return l(u);let c=f.shift();function a(g,x=void 0){let m=h=>(g.status=h,s(u.concat(g),f,l));if(arguments.length>1)return m(g,x);let y=P(r,"accessorizedProps",!1),p=y&&y.get(g.key+"");return p&&!p.restore()&&m(!1),m(Reflect.deleteProperty(r,g.key))}function d(g){let x=new C(r,{type:"deleteProperty",key:c,oldValue:g,related:[...o],detail:t.detail}),m=j.getInstance(r,!1,t.namespace);return m?m.emit(x,a):a(x)}return k(r,c,d,t)}([],i.slice(0),s=>{let u=F.getInstance(r,!1,t.namespace);return u&&u.emit(s),n(de(e)?s.map(f=>f.status):s[0].status)})}function Ct(r,e,n=i=>i,t={}){return me(...arguments)}function qe(r,e,n=null,t=o=>o,i={}){return q(r,"construct",arguments.length>2?{argumentsList:e,newTarget:n}:{argumentsList:e},t,i)}function Me(r,e,n,t=o=>o,i={}){return q(r,"apply",{thisArgument:e,argumentsList:n},t,i)}function je(r,e,n=i=>i,t={}){return q(r,"setPrototypeOf",{proto:e},n,t)}function He(r,e=t=>t,n={}){return q(r,"preventExtensions",{},e,n)}function Qe(r,e,n,t={}){let i;t.signal||(i=new AbortController,t={...t,signal:i.signal});let o=F.getInstance(r,!0,t.namespace);return function s(u,f=null){f?.remove();let c={signal:o.addRegistration(e,s,t).signal};if(arguments.length){let a=n(u,c);if(arguments.length>1)return a}return i}}function q(r,e,n={},t=o=>o,i={}){r=L(r),w(t)&&([i,t]=[t,f=>f]);function o(f,l){return arguments.length>1?t(l):t(Reflect[e](r,...Object.values(n)))}let s=new C(r,{type:e,...n}),u=j.getInstance(r,!1,i.namespace);return u?u.emit(s,o):o(s)}function de(r){return r===1/0||Array.isArray(r)}function L(r,e=!0){if((!r||!v(r))&&e)throw new Error(`Object must be of type object or array! "${W(r)}" given.`);return r instanceof C&&(r=r.value),r&&ce(r)}function St(r,e,n,t={}){return e===1/0?t.level&&!v(r)?n([]):le(r,n,t):n(O(e,!1))}var It={...De,...Ee},H=It;function ne(r,e,n={},t={}){e=O(e).slice();for(var i=r;!M(i)&&!Z(i)&&e.length;){var o=e.shift();if(!(n.get?n.get(i,o):v(i)?o in i:i[o])){t.exists=!1;return}i=n.get?n.get(i,o):i[o]}return t.exists=!0,i}function Fe(r,e,n,t={},i={}){let o=(c,a,d)=>i.set?i.set(c,a,d):(S(e[u])&&_(c)?c.push(d):c[a]=d,!0);e=O(e);for(var s=r,u=0;u<e.length;u++)if(u<e.length-1){if(!s||!v(s)&&!b(s))return!1;var f=ne(s,e[u],i);if(!v(f)){if(i.buildTree===!1)return!1;f=b(i.buildTree)?i.buildTree(u):S(e[u+1])?[]:{};var l=o(s,e[u],f);if(!l)return!1}s=f}else return o(s,e[u],n)}var ie=class{constructor(e,n=!0){Object.defineProperty(this,"window",{value:e}),Object.defineProperty(this,"readCallbacks",{value:new Set}),Object.defineProperty(this,"writeCallbacks",{value:new Set}),this.async=n,this.window.requestAnimationFrame?this._run():this.async=!1}_run(){this.window.requestAnimationFrame(()=>{for(let e of this.readCallbacks)e(),this.readCallbacks.delete(e);for(let e of this.writeCallbacks)e(),this.writeCallbacks.delete(e);this._run()})}onread(e,n=!1){if(n)return new Promise(t=>{this.async===!1?t(e()):this.readCallbacks.add(()=>{t(e())})});this.async===!1?e():this.readCallbacks.add(e)}onwrite(e,n=!1){if(n)return new Promise(t=>{this.async===!1?t(e()):this.writeCallbacks.add(()=>{t(e())})});this.async===!1?e():this.writeCallbacks.add(e)}cycle(e,n,t){this.onread(()=>{let i=e(t),o=s=>{s!==void 0&&this.onwrite(()=>{let u=n(s,t),f=l=>{l!==void 0&&this.cycle(e,n,l)};u instanceof Promise?u.then(f):f(u)})};i instanceof Promise?i.then(o):o(i)})}};var G=class{constructor(e,n,t){this.context=e,this.namespace=n,this.window=e.defaultView||e.ownerDocument?.defaultView||t,this.document=this.window.document,this.webqit=this.window.webqit,Object.defineProperty(this,"#",{value:{}})}resolveArgs(e){return b(e[0])?e=[[],...e]:w(e[0])&&e.length===1?e=[[],void 0,e[0]]:w(e[1])&&e.length===2?e=[O(e[0],!1),void 0,e[1]]:e[0]=O(e[0],!1),e}registry(...e){return D("realdom.realtime",this.window,this.namespace,...e)}createSignalGenerator(){return{generate(){return this.lastController?.abort(),this.lastController=new AbortController,{signal:this.lastController.signal}},disconnect(){this.lastController?.abort()}}}forEachMatchingContext(e,n,t){let{window:i}=this,o=Array.isArray(n)?n:[n],s=new Set;for(let[u,f]of this.registry(e))for(let[l,c]of f){let a=o.filter(d=>l.contains(d.target)?u==="subtree"||d.target===l:!1);if(!!a.length){Array.isArray(n)||(a=a[0]);for(let d of c)s.add([d,a,l])}}for(let[u,f,l]of s)t.call(this,u,f,l)}disconnectables(e,...n){let t={disconnect(){n.forEach(i=>i&&b(i.disconnect)&&i.disconnect()||b(i)&&i()||w(i)&&(i.disconnected=!0))}};return e&&e.addEventListener("abort",()=>t.disconnect()),t}};var R=class extends G{constructor(e,...n){super(e,"attr",...n)}get(e,n=void 0,t={}){let i=typeof e=="string";[e=[],n=void 0,t={}]=this.resolveArgs(arguments);let{context:o}=this,s=Ke(o,e),u=i?s[0]:s;if(!n)return u;let f=n&&t.lifecycleSignals&&this.createSignalGenerator(),l=f?.generate()||{};if(n(u,l,o),t.live){f&&(t={...t,signalGenerator:f});let c=this.observe(i?e[0]:e,n,{newValue:!0,...t});return this.disconnectables(t.signal,c)}}observe(e,n,t={}){let i=typeof e=="string";if([e=[],n,t={}]=this.resolveArgs(arguments),["sync","intercept"].includes(t.timing))return this.observeSync(i?e[0]:e,n,t);if(t.timing&&t.timing!=="async")throw new Error(`Timing option "${t.timing}" invalid.`);let{context:o,window:s,webqit:u}=this;t.eventDetails&&!u.realdom.attrInterceptionHooks?.intercepting&&Ye.call(s,"intercept",()=>{});let f=new s.MutationObserver(d=>{d=Ze(d).map(g=>et.call(s,g)),Xe.call(s,a,d,o)}),l={attributes:!0,attributeOldValue:t.oldValue,subtree:t.subtree};e.length&&(l.attributeFilter=e),f.observe(o,l);let c=t.signalGenerator||t.lifecycleSignals&&this.createSignalGenerator(),a={context:o,filter:e,callback:n,params:t,atomics:new Map,originalFilterIsString:i,signalGenerator:c,disconnectable:f};return this.disconnectables(t.signal,f,c)}observeSync(e,n,t={}){let i=typeof e=="string";[e,n,t={}]=this.resolveArgs(arguments);let{context:o,window:s}=this;if(t.timing&&!["sync","intercept"].includes(t.timing))throw new Error(`Timing option "${t.timing}" invalid.`);let u=t.timing==="intercept"?"intercept":"sync",f=t.subtree?"subtree":"children";this.registry(u).size||Ye.call(s,u,x=>{this.forEachMatchingContext(u,x,Xe)});let l={disconnect(){g.delete(a),g.size||d.delete(o)}},c=t.signalGenerator||t.lifecycleSignals&&this.createSignalGenerator(),a={context:o,filter:e,callback:n,params:t,atomics:new Map,originalFilterIsString:i,signalGenerator:c,disconnectable:l},d=this.registry(u,f);d.has(o)||d.set(o,new Set);let g=d.get(o);return g.add(a),this.disconnectables(t.signal,l,c)}};function Ze(r){return r.reduce((e,n,t)=>e[t-1]?.attributeName===n.attributeName?e:e.concat(n),[])}function Xe(r,e){let{context:n,filter:t,callback:i,params:o,atomics:s,originalFilterIsString:u,signalGenerator:f}=r;o.atomic&&!s.size&&(e=Ke(n,t,e)),o.newValue===null&&o.oldValue===null&&o.eventDetails||(e=e.map(a=>{let d;return o.eventDetails||({event:d,...a}=a),!o.oldValue&&"oldValue"in a&&({oldValue:d,...a}=a),!o.newValue&&"value"in a?{value:d,...a}=a:o.newValue&&typeof a.value>"u"&&(a={...a,value:a.target.getAttribute(a.name)}),a})),o.atomic&&(e.forEach(a=>s.set(a.name,a)),e=Array.from(s.entries()).map(([,a])=>a));let l=u?e[0]:e,c=f?.generate()||{};i(l,c,n)}function Ke(r,e,n=[]){let t={event:null,type:"attribute"};return e.length?e.map(o=>n.find(s=>s.name===o)||{target:r,name:o,value:r.getAttribute(o),...t}):Array.from(r.attributes).map(o=>n.find(s=>s.name===o.nodeName)||{target:r,name:o.nodeName,value:o.nodeValue,...t})}function et({target:r,attributeName:e,value:n,oldValue:t}){let s=(this.webqit.realdom.attrInterceptionRecords?.get(r)||{})[e]||"mutation";return{target:r,name:e,value:n,oldValue:t,type:"observation",event:s}}function Ye(r,e){let n=this,{webqit:t,document:i,Element:o}=n;t.realdom.attrInterceptionHooks||Object.defineProperty(t.realdom,"attrInterceptionHooks",{value:new Map}),t.realdom.attrInterceptionHooks.has(r)||t.realdom.attrInterceptionHooks.set(r,new Set),t.realdom.attrInterceptionHooks.get(r).add(e);let s=()=>t.realdom.attrInterceptionHooks.get(r).delete(e);if(t.realdom.attrInterceptionHooks?.intercepting)return s;console.warn("Attr mutation APIs are now being intercepted."),t.realdom.attrInterceptionHooks.intercepting=!0,Object.defineProperty(t.realdom,"attrInterceptionRecords",{value:new Map});let u=(c,a)=>{t.realdom.attrInterceptionRecords.has(c.target)||t.realdom.attrInterceptionRecords.set(c.target,{});let d=t.realdom.attrInterceptionRecords.get(c.target);clearTimeout(d[c.name]?.timeout),d[c.name]=c.event;let g=setTimeout(()=>{delete d[c.name]},0);Object.defineProperty(c.event,"timeout",{value:g,configurable:!0}),t.realdom.attrInterceptionHooks.get("intercept")?.forEach(m=>m([c]));let x=a();return t.realdom.attrInterceptionHooks.get("sync")?.forEach(m=>m([c])),x};new n.MutationObserver(c=>{c=Ze(c).map(a=>et.call(n,a)).filter((a,d)=>!Array.isArray(a.event)),c.length&&(t.realdom.attrInterceptionHooks.get("intercept")?.forEach(a=>a(c)),t.realdom.attrInterceptionHooks.get("sync")?.forEach(a=>a(c)))}).observe(i,{attributes:!0,subtree:!0,attributeOldValue:!0});let l=Object.create(null);return["setAttribute","removeAttribute","toggleAttribute"].forEach(c=>{l[c]=o.prototype[c],o.prototype[c]=function(...a){let d,g=this.getAttribute(a[0]);["setAttribute","toggleAttribute"].includes(c)&&(d=a[1]),c==="toggleAttribute"&&d===void 0&&(d=g===null);let x={target:this,name:a[0],value:d,oldValue:g,type:"interception",event:[this,c]};return u(x,()=>l[c].call(this,...a))}}),s}var oe=class extends G{constructor(e,...n){super(e,"tree",...n)}attr(e,n=void 0,t={}){let{context:i,window:o}=this;return new R(i,o).get(...arguments)}query(e,n=void 0,t={}){[e,n=void 0,t={}]=this.resolveArgs(arguments);let{context:i}=this,o=new Map,s=l=>(o.has(l)||o.set(l,{target:l,entrants:[],exits:[],type:"query",event:null}),o.get(l));if((!t.generation||t.generation==="entrants")&&(e.length?e.every(l=>typeof l=="string")&&(e=e.join(","))&&(t.subtree?i.querySelectorAll(e):[...i.children].filter(c=>c.matches(e))).forEach(c=>s(c.parentNode||i).entrants.push(c)):[...i.children].forEach(l=>s(i).entrants.push(l))),!n)return o;let u={disconnected:!1},f=n&&t.lifecycleSignals&&this.createSignalGenerator();for(let[,l]of o){if(u.disconnected)break;let c=f?.generate()||{};n(l,c,i)}if(t.live){f&&(t={...t,signalGenerator:f});let l=this.observe(e,n,t);return this.disconnectables(t.signal,u,l)}return this.disconnectables(t.signal,u,f)}children(e,n=void 0,t={}){return[e,n=void 0,t={}]=this.resolveArgs(arguments),this.query(e,n,{...t,subtree:!1})}subtree(e,n=void 0,t={}){return[e,n=void 0,t={}]=this.resolveArgs(arguments),this.query(e,n,{...t,subtree:!0})}observe(e,n,t={}){if([e,n,t={}]=this.resolveArgs(arguments),["sync","intercept"].includes(t.timing))return this.observeSync(e,n,t);if(t.timing&&t.timing!=="async")throw new Error(`Timing option "${t.timing}" invalid.`);let{context:i,window:o,webqit:s,document:u}=this;t.eventDetails&&(s.realdom.domInterceptionRecordsAlwaysOn=!0),(u.readyState==="loading"||s.realdom.domInterceptionRecordsAlwaysOn)&&!s.realdom.domInterceptionHooks?.intercepting&&nt.call(o,"sync",()=>{});let f=new o.MutationObserver(a=>a.forEach(d=>{ke.call(o,c,rt.call(o,d),i)}));f.observe(i,{childList:!0,subtree:t.subtree});let l=t.signalGenerator||t.lifecycleSignals&&this.createSignalGenerator(),c={context:i,selectors:e,callback:n,params:t,signalGenerator:l,disconnectable:f};if(t.staticSensitivity){let a=tt.call(o,c);return this.disconnectables(t.signal,f,l,a)}return this.disconnectables(t.signal,f,l)}observeSync(e,n,t={}){[e,n,t={}]=this.resolveArgs(arguments);let{context:i,window:o}=this;if(t.timing&&!["sync","intercept"].includes(t.timing))throw new Error(`Timing option "${t.timing}" invalid.`);let s=t.timing==="intercept"?"intercept":"sync",u=t.subtree?"subtree":"children";this.registry(s).size||nt.call(o,s,x=>{this.forEachMatchingContext(s,x,ke)});let f=new o.MutationObserver(x=>x.forEach(m=>{Array.isArray((m=rt.call(o,m)).event)||ke.call(o,a,m,i)}));f.observe(i,{childList:!0,subtree:t.subtree});let l={disconnect(){f.disconnect(),g.delete(a),g.size||d.delete(i)}},c=t.signalGenerator||t.lifecycleSignals&&this.createSignalGenerator(),a={context:i,selectors:e,callback:n,params:t,signalGenerator:c,disconnectable:l},d=this.registry(s,u);d.has(i)||d.set(i,new Set);let g=d.get(i);if(g.add(a),t.staticSensitivity){let x=tt.call(o,a);return this.disconnectables(t.signal,l,c,x)}return this.disconnectables(t.signal,l,c)}};function tt(r){let e=this,{context:n,selectors:t,callback:i,params:o,signalGenerator:s}=r,u=d=>d.match(/\.([\w-]+)/g)?.length?["class"]:[],f=d=>d.match(/#([\w-]+)/g)?.length?["id"]:[],l=d=>[...d.matchAll(/\[([^\=\]]+)(\=[^\]]+)?\]/g)].map(g=>g[1]).concat(u(d)).concat(f(d));if(!(r.$attrs=Array.from(new Set(t.filter(d=>typeof d=="string"&&d.includes("[")).reduce((d,g)=>d.concat(l(g)),[])))).length)return;let c=new Set,a=new Set;return c.push=d=>(a.delete(d),c.add(d)),a.push=d=>(c.delete(d),a.add(d)),r.$deliveryCache={entrants:c,exits:a},new R(n,e).observe(r.$attrs,d=>{let g=new Map,x=p=>(g.has(p)||g.set(p,{target:p,entrants:[],exits:[],type:"static",event:null}),g.get(p)),m=new WeakMap,y=p=>(m.has(p)||m.set(p,t.some(h=>p.matches(h))),m.get(p));for(let p of d)["entrants","exits"].forEach(h=>{o.generation&&h!==o.generation||r.$deliveryCache[h].has(p.target)||(h==="entrants"?!y(p.target):y(p.target))||(r.$deliveryCache[h].push(p.target),x(p.target)[h].push(p.target),x(p.target).event=p.event)});for(let[,p]of g){let h=s?.generate()||{};i(p,h,n)}},{subtree:o.subtree,timing:o.timing,eventDetails:o.eventDetails})}function ke(r,e){let{context:n,selectors:t,callback:i,params:o,signalGenerator:s,$deliveryCache:u}=r,f={...e,entrants:[],exits:[]};if(o.eventDetails||delete f.event,["entrants","exits"].forEach(c=>{if(!(o.generation&&c!==o.generation)&&(t.length?f[c]=Ht(t,e[c],e.event!=="parse"):f[c]=[...e[c]],!!u))for(let a of f[c])u[c].push(a)}),!f.entrants.length&&!f.exits.length)return;let l=s?.generate()||{};i(f,l,n)}function Ht(r,e,n){e=Array.isArray(e)?e:[...e];let t=(i,o)=>{if(i=i.filter(s=>s.matches),typeof o=="string"){let s=i.filter(u=>u.matches(o));if(n&&(s=i.reduce((u,f)=>[...u,...f.querySelectorAll(o)],s)),s.length)return s}else if(i.includes(o)||n&&i.some(s=>s.contains(o)))return[o]};return e.$$searchCache||(e.$$searchCache=new Map),r.reduce((i,o)=>{let s;return e.$$searchCache.has(o)?s=e.$$searchCache.get(o):(s=t(e,o)||[],w(o)&&e.$$searchCache.set(o,s)),i.concat(s)},[])}function rt({target:r,addedNodes:e,removedNodes:n}){let t=this,i;return i=O(e).reduce((o,s)=>o||t.webqit.realdom.domInterceptionRecords?.get(s),null),i=O(n).reduce((o,s)=>o||t.webqit.realdom.domInterceptionRecords?.get(s),i),i=i||t.document.readyState==="loading"&&"parse"||"mutation",{target:r,entrants:e,exits:n,type:"observation",event:i}}function nt(r,e){let n=this,{webqit:t,document:i,Node:o,CharacterData:s,Element:u,HTMLElement:f,HTMLTemplateElement:l,DocumentFragment:c}=n;t.realdom.domInterceptionHooks||Object.defineProperty(t.realdom,"domInterceptionHooks",{value:new Map}),t.realdom.domInterceptionHooks.has(r)||t.realdom.domInterceptionHooks.set(r,new Set),t.realdom.domInterceptionHooks.get(r).add(e);let a=()=>t.realdom.domInterceptionHooks.get(r).delete(e);if(t.realdom.domInterceptionHooks?.intercepting)return a;console.warn("DOM mutation APIs are now being intercepted."),t.realdom.domInterceptionHooks.intercepting=!0,Object.defineProperty(t.realdom,"domInterceptionRecords",{value:new Map});let d=(m,y)=>{m.entrants.concat(m.exits).forEach(h=>{clearTimeout(t.realdom.domInterceptionRecords.get(h)?.timeout),t.realdom.domInterceptionRecords.set(h,m.event);let A=setTimeout(()=>{t.realdom.domInterceptionRecords.delete(h)},0);Object.defineProperty(m.event,"timeout",{value:A,configurable:!0})}),t.realdom.domInterceptionHooks.get("intercept")?.forEach(h=>h(m));let p=y();return t.realdom.domInterceptionHooks.get("sync")?.forEach(h=>h(m)),p},g={characterData:Object.create(null),other:Object.create(null)};["insertBefore","insertAdjacentElement","insertAdjacentHTML","setHTML","replaceChildren","replaceWith","remove","replaceChild","removeChild","before","after","append","prepend","appendChild"].forEach(m=>{function y(...p){let h=this instanceof s?g.characterData:g.other,A=()=>h[m].call(this,...p);if(!(this instanceof s||this instanceof u||this instanceof c))return A();let E=[],T=[],X=this;["insertBefore"].includes(m)?T=[p[0]]:["insertAdjacentElement","insertAdjacentHTML"].includes(m)?(T=[p[1]],["beforebegin","afterend"].includes(p[0])&&(X=this.parentNode)):["setHTML","replaceChildren"].includes(m)?(E=[...this.childNodes],T=m==="replaceChildren"?[...p]:[p[0]]):["replaceWith","remove"].includes(m)?(E=[this],T=m==="replaceWith"?[...p]:[],X=this.parentNode):["replaceChild"].includes(m)?(E=[p[1]],T=[p[0]]):["removeChild"].includes(m)?E=[...p]:(T=[...p],["before","after"].includes(m)&&(X=this.parentNode));let $=m;if(["insertAdjacentHTML","setHTML"].includes(m)){let Ve=this.nodeName;if(m==="insertAdjacentHTML"&&["beforebegin","afterend"].includes(p[0])){if(!this.parentNode)return h[m].call(this,...p);Ve=this.parentNode.nodeName}let se=i.createElement(Ve);h.setHTML.call(se,T[0],m==="setHTML"?p[1]:{}),T=[...se.childNodes],m==="insertAdjacentHTML"?($="insertAdjacentElement",p[1]=new c,p[1].______isTemp=!0,p[1].append(...se.childNodes)):($="replaceChildren",p=[...se.childNodes])}return d({target:X,entrants:T,exits:E,type:"interception",event:[this,m]},()=>h[$].call(this,...p))}["insertBefore","replaceChild","removeChild","appendChild"].includes(m)?(g.other[m]=o.prototype[m],o.prototype[m]=y):(["after","before","remove","replaceWith"].includes(m)&&(g.characterData[m]=s.prototype[m],s.prototype[m]=y),u.prototype[m]&&(g.other[m]=u.prototype[m],u.prototype[m]=y))});let x=Object.create(null);return["outerHTML","outerText","innerHTML","innerText","textContent","nodeValue"].forEach(m=>{let y=["textContent","nodeValue"].includes(m)?o:["outerText","innerText"].includes(m)?f:u;x[m]=Object.getOwnPropertyDescriptor(y.prototype,m),Object.defineProperty(y.prototype,m,{...x[m],set:function(p){let h=()=>x[m].set.call(this,p);if(!(this instanceof u))return h();let A=[],E=[],T=this;if(["outerHTML","outerText"].includes(m)?(A=[this],T=this.parentNode):A=[...this.childNodes],["outerHTML","innerHTML"].includes(m)){let $=this.nodeName;if(m==="outerHTML"){if(!this.parentNode)return h();$=this.parentNode.nodeName}let B=i.createElement($==="TEMPLATE"?"div":$);x[m].set.call(B,p),E=this instanceof l?[]:[...B.childNodes],m==="outerHTML"?(p=new c,p.______isTemp=!0,p.append(...B.childNodes),h=()=>u.prototype.replaceWith.call(this,p)):this instanceof l?h=()=>this.content.replaceChildren(...B.childNodes):h=()=>u.prototype.replaceChildren.call(this,...B.childNodes)}return d({target:T,entrants:E,exits:A,type:"interception",event:[this,m]},h)}})}),["append","prepend","replaceChildren"].forEach(m=>{[i,c.prototype].forEach(y=>{let p=y[m];y[m]=function(...h){if(this.______isTemp)return p.call(this,...h);let A=m==="replaceChildren"?[...this.childNodes]:[];return d({target:this,entrants:h,exits:A,type:"interception",event:[this,m]},()=>p.call(this,...h))}})}),a}function it(){Dt.call(this),Ft.call(this),kt.call(this)}function Dt(){let r=this;r.CSS||(r.CSS={}),r.CSS.escape||(r.CSS.escape=e=>e.replace(/([\:@\~\$\&])/g,"\\$1"))}function Ft(){let r=this;"isConnected"in r.Node.prototype||Object.defineProperty(r.Node.prototype,"isConnected",{get:function(){return!this.ownerDocument||!(this.ownerDocument.compareDocumentPosition(this)&this.DOCUMENT_POSITION_DISCONNECTED)}})}function kt(){let r=this;r.Element.prototype.matches||(r.Element.prototype.matches=r.Element.prototype.matchesSelector||r.Element.prototype.mozMatchesSelector||r.Element.prototype.msMatchesSelector||r.Element.prototype.oMatchesSelector||r.Element.prototype.webkitMatchesSelector||function(e){for(var n=(this.document||this.ownerDocument).querySelectorAll(e),t=n.length;--t>=0&&n.item(t)!==this;);return t>-1})}function ot(){let r=this;if(r.webqit||(r.webqit={}),r.webqit.realdom)return r.webqit.realdom;r.webqit.realdom={},it.call(r),r.webqit.realdom.meta=(...n)=>Lt.call(r,...n),r.webqit.realdom.ready=(...n)=>Le.call(r,...n),r.webqit.realdom.realtime=(n,t="dom")=>{if(t==="dom")return new oe(n,r);if(t==="attr")return new R(n,r)};let e=new ie(r);return r.webqit.realdom.schedule=(n,...t)=>e[`on${n}`](...t),r.webqit.realdom}function Le(...r){let e="interactive",n;U(r[0])?(e=r[0],b(r[1])&&(n=r[1])):b(r[0])&&(n=r[0]);let t={interactive:["interactive","complete"],complete:["complete"]};if(!t[e])throw new Error(`Invalid ready-state timing: ${e}.`);let i=this;if(!n)return i.webqit.realdom.readyStatePromises||(i.webqit.realdom.readyStatePromises={interactive:new Promise(o=>Le.call(this,"interactive",o)),complete:new Promise(o=>Le.call(this,"complete",o))}),i.webqit.realdom.readyStatePromises[e];if(t[e].includes(i.document.readyState))return n(i);i.webqit.realdom.readyStateCallbacks||(i.webqit.realdom.readyStateCallbacks={interactive:[],complete:[]},i.document.addEventListener("readystatechange",()=>{let o=i.document.readyState;for(let s of i.webqit.realdom.readyStateCallbacks[o].splice(0))s(i)},!1)),i.webqit.realdom.readyStateCallbacks[e].push(n)}function Lt(r){let e=this,n={},t;return(t=e.document.querySelector(`meta[name="${r}"]`))&&(n=(t.content||"").split(";").filter(i=>i).reduce((i,o)=>{let s=o.split("=").map(u=>u.trim());return Fe(i,s[0].split("."),s[1]==="true"?!0:s[1]==="false"?!1:S(s[1])?parseInt(s[1]):s[1]),i},{})),{get name(){return r},get content(){return t.content},json(){return JSON.parse(JSON.stringify(n))}}}var he=(...r)=>D("oohtml",...r);function st(r,e,n){let t=r.toUpperCase().replace("-","_"),i=this,o=ot.call(i);return i.webqit||(i.webqit={}),i.webqit.oohtml||(i.webqit.oohtml={}),i.webqit.oohtml.configs||(i.webqit.oohtml.configs={}),i.webqit.oohtml.configs[t]||(i.webqit.oohtml.configs[t]={}),ee(2,i.webqit.oohtml.configs[t],n,e,o.meta(r).json()),{config:i.webqit.oohtml.configs[t],realdom:o,window:i}}function $e(r={}){let{config:e,window:n}=st.call(this,"bindings-api",r,{api:{bind:"bind",bindings:"bindings"}});n.webqit.Observer=H,Rt.call(n,e)}function Re(r){if(!he(r).has("bindings")){let e=Object.create(null);he(r).set("bindings",e)}return he(r).get("bindings")}function Rt(r){let e=this;if(r.api.bind in e.document)throw new Error(`document already has a "${r.api.bind}" property!`);if(r.api.bindings in e.document)throw new Error(`document already has a "${r.api.bindings}" property!`);if(r.api.bind in e.Element.prototype)throw new Error(`The "Element" class already has a "${r.api.bind}" property!`);if(r.api.bindings in e.Element.prototype)throw new Error(`The "Element" class already has a "${r.api.bindings}" property!`);Object.defineProperty(e.document,r.api.bind,{value:function(n,t={}){return ft(e.document,n,t)}}),Object.defineProperty(e.document,r.api.bindings,{get:function(){return H.proxy(Re(e.document))}}),Object.defineProperty(e.Element.prototype,r.api.bind,{value:function(n,t={}){return ft(this,n,t)}}),Object.defineProperty(e.Element.prototype,r.api.bindings,{get:function(){return H.proxy(Re(this))}})}function ft(r,e,{merge:n,diff:t,namespace:i}={}){let o=Re(r),s={diff:t,namespace:i};if(n)return H.set(o,e,s);let u=H.ownKeys(o,s).filter(f=>!(f in e));return H.batch(o,()=>(u.length&&H.deleteProperty(o,u,s),H.set(o,e,s)),s)}$e.call(window);})();
//# sourceMappingURL=bindings-api.js.map
