(()=>{var Vt=Object.defineProperty;var Bt=(n,t,r)=>t in n?Vt(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r;var rt=(n,t,r)=>(Bt(n,typeof t!="symbol"?t+"":t,r),r);function O(n){return!Array.isArray(n)&&typeof n=="object"&&n}function x(n){return Array.isArray(n)}function lt(n,t,r=null){return x(t)?n.filter(e=>r?t.filter(i=>r(e,i)).length:t.indexOf(e)!==-1):[]}function F(n,...t){if(globalThis.webqit||(globalThis.webqit={}),globalThis.webqit.refs||Object.defineProperty(globalThis.webqit,"refs",{value:new X}),!arguments.length)return globalThis.webqit.refs;let r=globalThis.webqit.refs.get(n);r||(r=new X,globalThis.webqit.refs.set(n,r));let e,i;for(;e=t.shift();)(i=r)&&!(r=r.get(e))&&(r=new X,i.set(e,r));return r}var X=class extends Map{constructor(...t){super(...t),this.observers=new Set}set(t,r){let e=super.set(t,r);return this.fire("set",t,r,t),e}delete(t){let r=super.delete(t);return this.fire("delete",t),r}has(t){return this.fire("has",t),super.has(t)}get(t){return this.fire("get",t),super.get(t)}keyNames(){return Array.from(super.keys())}observe(t,r,e){let i={type:t,key:r,callback:e};return this.observers.add(i),()=>this.observers.delete(i)}unobserve(t,r,e){if(Array.isArray(t)||Array.isArray(r))throw new Error('The "type" and "key" arguments can only be strings.');for(let i of this.observers)!(nt([t,"*"],i.type)&&nt([r,"*"],i.key)&&i.callback===e)||this.observers.delete(i)}fire(t,r,...e){for(let i of this.observers)!(nt([t,"*"],i.type)&&nt([r,"*"],i.key))||i.callback(...e)}},nt=(n,t)=>Array.isArray(t)?lt(n,t).length:n.includes(t);function W(n){return typeof n=="function"}function G(n){return n===null||n===""}function L(n){return arguments.length&&(n===void 0||typeof n>"u")}function E(n){return Array.isArray(n)||typeof n=="object"&&n||W(n)}function ct(n){return G(n)||L(n)||n===!1||n===0||E(n)&&!Object.keys(n).length}function w(n){return W(n)||n&&{}.toString.call(n)==="[object function]"}function z(n){return n instanceof Number||typeof n=="number"}function I(n){return z(n)||n!==!0&&n!==!1&&n!==null&&n!==""&&!isNaN(n*1)}function V(n){return n instanceof String||typeof n=="string"&&n!==null}function ft(n){return!V(n)&&!L(n.length)}function it(n,...t){return t.forEach(r=>{n.indexOf(r)<0&&n.push(r)}),n}function at(e,t){t=t||Object.prototype,t=t&&!x(t)?[t]:t;for(var r=[],e=e;e&&(!t||t.indexOf(e)<0)&&e.name!=="default";)r.push(e),e=e?Object.getPrototypeOf(e):null;return r}function ut(n,t){var r=[];return at(n,t).forEach(e=>{it(r,...Object.getOwnPropertyNames(e))}),r}function q(n,t,r=!1,e=!1,i=!1){var o=0,s=n.shift();if((I(s)||s===!0||s===!1)&&(o=s,s=n.shift()),!n.length)throw new Error("_merge() requires two or more array/objects.");return n.forEach((c,f)=>{!E(c)&&!w(c)||(r?ut(c):Object.keys(c)).forEach(m=>{if(!!t(m,s,c,f)){var l=s[m],u=c[m];if((x(l)&&x(u)||O(l)&&O(u))&&(o===!0||o>0))s[m]=x(l)&&x(u)?[]:{},q([I(o)?o-1:o,s[m],l,u],t,r,e,i);else if(x(s)&&x(c))e?s[m]=u:s.push(u);else try{i?Object.defineProperty(s,m,Object.getOwnPropertyDescriptor(c,m)):s[m]=c[m]}catch{}}})}),s}function U(...n){return q(n,(t,r,e)=>!0,!1,!1,!1)}function T(n,t=!0){return x(n)?n:!t&&O(n)?[n]:n!==!1&&n!==0&&ct(n)?[]:ft(n)?Array.prototype.slice.call(n):O(n)?Object.values(n):[n]}function J(n,t,r={},e={}){t=T(t).slice();for(var i=n;!L(i)&&!G(i)&&t.length;){var o=t.shift();if(!(r.get?r.get(i,o):E(i)?o in i:i[o])){e.exists=!1;return}i=r.get?r.get(i,o):i[o]}return e.exists=!0,i}function dt(n,t,r,e={},i={}){let o=(l,u,a)=>i.set?i.set(l,u,a):(I(t[c])&&x(l)?l.push(a):l[u]=a,!0);t=T(t);for(var s=n,c=0;c<t.length;c++)if(c<t.length-1){if(!s||!E(s)&&!w(s))return!1;var f=J(s,t[c],i);if(!E(f)){if(i.buildTree===!1)return!1;f=w(i.buildTree)?i.buildTree(c):I(t[c+1])?[]:{};var m=o(s,t[c],f);if(!m)return!1}s=f}else return o(s,t[c],r)}var Y=class{constructor(t,r=!0){Object.defineProperty(this,"window",{value:t}),Object.defineProperty(this,"readCallbacks",{value:new Set}),Object.defineProperty(this,"writeCallbacks",{value:new Set}),this.async=r,this.window.requestAnimationFrame?this._run():this.async=!1}_run(){this.window.requestAnimationFrame(()=>{for(let t of this.readCallbacks)t(),this.readCallbacks.delete(t);for(let t of this.writeCallbacks)t(),this.writeCallbacks.delete(t);this._run()})}onread(t,r=!1){if(r)return new Promise(e=>{this.async===!1?e(t()):this.readCallbacks.add(()=>{e(t())})});this.async===!1?t():this.readCallbacks.add(t)}onwrite(t,r=!1){if(r)return new Promise(e=>{this.async===!1?e(t()):this.writeCallbacks.add(()=>{e(t())})});this.async===!1?t():this.writeCallbacks.add(t)}cycle(t,r,e){this.onread(()=>{let i=t(e),o=s=>{s!==void 0&&this.onwrite(()=>{let c=r(s,e),f=m=>{m!==void 0&&this.cycle(t,r,m)};c instanceof Promise?c.then(f):f(c)})};i instanceof Promise?i.then(o):o(i)})}};function Tt(n){return(n=n.trim())&&n.startsWith("(")&&n.endsWith(")")}function st(n,t,r,e=!0){r=(Array.isArray(r)?r:[r]).map(c=>(c+"").replace("(",e?"(.//":"(./")).join("|");let i=n.document.evaluate(r,t,null,XPathResult.ANY_TYPE),o=[],s;for(;s=i.iterateNext();)o.push(s);return o}function Ct(n,t,r){return r=(Array.isArray(r)?r:[r]).map(e=>(e+"").replace("(","(self::")).join("|"),n.document.evaluate(`${r}`,t,null,XPathResult.BOOLEAN_TYPE).booleanValue}function St(n,t="|"){return[...n].reduce(([r,e,i,o],s)=>!r&&e===0&&(Array.isArray(t)?t:[t]).includes(s)?[r,e,[""].concat(i)]:(!r&&["(","[","{"].includes(s)&&!i[0].endsWith("\\")&&e++,!r&&[")","]","}"].includes(s)&&!i[0].endsWith("\\")&&e--,['"',"'","`"].includes(s)&&!i[0].endsWith("\\")&&(r=r===s?null:r||s),i[0]+=s,[r,e,i]),[null,0,[""]])[2].reverse()}var M=class{constructor(t){this.content=t,this.type=typeof t=="string"?"selector":"instance",this.kind=this.type==="instance"?null:Tt(t)?"xpath":"css",this.kind==="xpath"&&(this.isXpathAttr=St(t.trim().slice(1,-1),"@").length>1)}toString(){return this.content}};var $=class{constructor(t,r,e){this.context=t,this.namespace=r,this.window=t.defaultView||t.ownerDocument?.defaultView||e,this.document=this.window.document,this.webqit=this.window.webqit,Object.defineProperty(this,"#",{value:{}})}resolveArgs(t){if(w(t[0])?t=[[],...t]:O(t[0])&&!(t[0]instanceof M)&&t.length===1?t=[[],void 0,t[0]]:O(t[1])&&t.length===2?t=[T(t[0],!1),void 0,t[1]]:t[0]=T(t[0],!1),t[0].filter(r=>typeof r!="string"&&!(r instanceof M)&&!(r instanceof this.window.Node)).length)throw new Error("Argument #2 must be either a string or a Node object, or a list of those.");return t[0]=t[0].map(r=>r instanceof M?r:new M(r)),t}registry(...t){return F("realdom.realtime",this.window,this.namespace,...t)}createSignalGenerator(){return{generate(){return this.lastController?.abort(),this.lastController=new AbortController,{signal:this.lastController.signal}},disconnect(){this.lastController?.abort()}}}forEachMatchingContext(t,r,e){let{window:i}=this,o=Array.isArray(r)?r:[r],s=new Set;for(let[c,f]of this.registry(t))for(let[m,l]of f){let u=o.filter(a=>m.contains(a.target)?c==="subtree"||a.target===m:!1);if(!!u.length){Array.isArray(r)||(u=u[0]);for(let a of l)s.add([a,u,m])}}for(let[c,f,m]of s)e.call(i,c,f,m)}disconnectables(t,...r){let e={disconnect(){r.forEach(i=>i&&w(i.disconnect)&&i.disconnect()||w(i)&&i()||O(i)&&(i.disconnected=!0))}};return t&&t.addEventListener("abort",()=>e.disconnect()),e}};var N=class extends ${constructor(t,...r){super(t,"attr",...r)}get(t,r=void 0,e={}){let i=typeof t=="string"||t instanceof M;[t=[],r=void 0,e={}]=this.resolveArgs(arguments);let{context:o}=this,s=Lt(o,t);if(!r)return s;let c=e.lifecycleSignals&&this.createSignalGenerator();if(i)for(let f of s){let m=c?.generate()||{};r(f,m,o)}else{let f=c?.generate()||{};r(s,f,o)}if(e.live){c&&(e={...e,signalGenerator:c});let f=this.observe(i?t[0]:t,r,{newValue:!0,...e});return this.disconnectables(e.signal,f)}}observe(t,r,e={}){let i=typeof t=="string"||t instanceof M;if([t=[],r,e={}]=this.resolveArgs(arguments),["sync","intercept"].includes(e.timing))return this.observeSync(i?t[0]:t,r,e);if(e.timing&&e.timing!=="async")throw new Error(`Timing option "${e.timing}" invalid.`);let{context:o,window:s,webqit:c}=this;e.eventDetails&&!c.realdom.attrInterceptionHooks?.intercepting&&qt.call(s,"intercept",()=>{});let f=new s.MutationObserver(a=>{a=Pt(a).map(p=>Rt.call(s,p)),Mt.call(s,u,a,o)}),m={attributes:!0,attributeOldValue:e.oldValue,subtree:e.subtree};t.length&&(m.attributeFilter=t.map(a=>a+"")),f.observe(o,m);let l=e.signalGenerator||e.lifecycleSignals&&this.createSignalGenerator(),u={context:o,spec:t,callback:r,params:e,atomics:new Map,originalFilterIsString:i,signalGenerator:l,disconnectable:f};return this.disconnectables(e.signal,f,l)}observeSync(t,r,e={}){let i=typeof t=="string"||t instanceof M;[t,r,e={}]=this.resolveArgs(arguments);let{context:o,window:s}=this;if(e.timing&&!["sync","intercept"].includes(e.timing))throw new Error(`Timing option "${e.timing}" invalid.`);let c=e.timing==="intercept"?"intercept":"sync",f=e.subtree?"subtree":"children";this.registry(c).size||qt.call(s,c,h=>{this.forEachMatchingContext(c,h,Mt)});let m={disconnect(){p.delete(u),p.size||a.delete(o)}},l=e.signalGenerator||e.lifecycleSignals&&this.createSignalGenerator(),u={context:o,spec:t,callback:r,params:e,atomics:new Map,originalFilterIsString:i,signalGenerator:l,disconnectable:m},a=this.registry(c,f);a.has(o)||a.set(o,new Set);let p=a.get(o);return p.add(u),this.disconnectables(e.signal,m,l)}};function Pt(n){return n.reduce((t,r,e)=>t[e-1]?.attributeName===r.attributeName?t:t.concat(r),[])}function Mt(n,t){let{context:r,spec:e,callback:i,params:o,atomics:s,originalFilterIsString:c,signalGenerator:f}=n,m=e.map(a=>a+"");if(o.atomic&&!s.size?t=Lt(r,e,t):o.timing!=="async"&&e.length&&(t=t.filter(a=>m.includes(a.name))),!t.length)return;o.newValue===null&&o.oldValue===null&&o.eventDetails||(t=t.map(a=>{let p;return o.eventDetails||({event:p,...a}=a),!o.oldValue&&"oldValue"in a&&({oldValue:p,...a}=a),!o.newValue&&"value"in a?{value:p,...a}=a:o.newValue&&typeof a.value>"u"&&(a={...a,value:a.target.getAttribute(a.name)}),a})),o.atomic&&(t.forEach(a=>s.set(a.name,a)),t=Array.from(s.entries()).map(([,a])=>a));let l=c?t[0]:t,u=f?.generate()||{};i(l,u,r)}function Lt(n,t,r=[]){let e={event:null,type:"attribute"};return t.length?t.map(o=>(o=o+"",r.find(s=>s.name===o)||{target:n,name:o,value:n.getAttribute(o),...e})):Array.from(n.attributes).map(o=>r.find(s=>s.name===o.nodeName)||{target:n,name:o.nodeName,value:o.nodeValue,...e})}function Rt({target:n,attributeName:t,value:r,oldValue:e}){let s=(this.webqit.realdom.attrInterceptionRecords?.get(n)||{})[t]?.[0]||"mutation";return{target:n,name:t,value:r,oldValue:e,type:"observation",event:s}}function qt(n,t){let r=this,{webqit:e,document:i,Element:o}=r;e.realdom.attrInterceptionHooks||Object.defineProperty(e.realdom,"attrInterceptionHooks",{value:new Map}),e.realdom.attrInterceptionHooks.has(n)||e.realdom.attrInterceptionHooks.set(n,new Set),e.realdom.attrInterceptionHooks.get(n).add(t);let s=()=>e.realdom.attrInterceptionHooks.get(n).delete(t);if(e.realdom.attrInterceptionHooks?.intercepting)return s;console.warn("Attr mutation APIs are now being intercepted."),e.realdom.attrInterceptionHooks.intercepting=!0,Object.defineProperty(e.realdom,"attrInterceptionRecords",{value:new Map});let c=(l,u)=>{e.realdom.attrInterceptionRecords.has(l.target)||e.realdom.attrInterceptionRecords.set(l.target,{});let a=e.realdom.attrInterceptionRecords.get(l.target);a[l.name]=a[l.name]||[],a[l.name].unshift(l.event),e.realdom.attrInterceptionHooks.get("intercept")?.forEach(h=>h([l]));let p=u();return e.realdom.attrInterceptionHooks.get("sync")?.forEach(h=>h([l])),p};new r.MutationObserver(l=>{l=l.filter(u=>!(r.webqit.realdom.attrInterceptionRecords?.get(u.target)||{})[u.attributeName]?.shift()),l=Pt(l).map(u=>Rt.call(r,u)),l.length&&(e.realdom.attrInterceptionHooks.get("intercept")?.forEach(u=>u(l)),e.realdom.attrInterceptionHooks.get("sync")?.forEach(u=>u(l)))}).observe(i,{attributes:!0,subtree:!0,attributeOldValue:!0});let m=Object.create(null);return["setAttribute","removeAttribute","toggleAttribute"].forEach(l=>{m[l]=o.prototype[l],o.prototype[l]=function(...u){let a,p=this.getAttribute(u[0]);["setAttribute","toggleAttribute"].includes(l)&&(a=u[1]),l==="toggleAttribute"&&a===void 0&&(a=p===null);let h={target:this,name:u[0],value:a,oldValue:p,type:"interception",event:[this,l]};return c(h,()=>m[l].call(this,...u))}}),s}var Q=class extends ${constructor(t,...r){super(t,"tree",...r)}attr(t,r=void 0,e={}){let{context:i,window:o}=this;return new N(i,o).get(...arguments)}query(t,r=void 0,e={}){[t,r=void 0,e={}]=this.resolveArgs(arguments);let{context:i}=this,o=new Map,s=m=>(o.has(m)||o.set(m,{target:m,entrants:[],exits:[],type:"query",event:null}),o.get(m));if(!e.generation||e.generation==="entrants"){if(!t.length)[...i.children].forEach(m=>s(i).entrants.push(m));else if(t.every(m=>m.type==="selector")){let[m,l]=t.reduce(([a,p],h)=>h.kind==="xpath"?[a,p.concat(h)]:[a.concat(h),p],[[],[]]),u=[];e.subtree?(m.length&&u.push(...i.querySelectorAll(m.join(","))),l.length&&u.push(...st(this.window,i,l))):(m.length&&u.push(...[...i.children].filter(a=>a.matches(m))),l.length&&u.push(...st(this.window,i,l,!1))),u.forEach(a=>s(a.parentNode||i).entrants.push(a))}}if(!r)return o;let c={disconnected:!1},f=r&&e.lifecycleSignals&&this.createSignalGenerator();for(let[,m]of o){if(c.disconnected)break;let l=f?.generate()||{};r(m,l,i)}if(e.live){f&&(e={...e,signalGenerator:f});let m=this.observe(t,r,e);return this.disconnectables(e.signal,c,m)}return this.disconnectables(e.signal,c,f)}children(t,r=void 0,e={}){return[t,r=void 0,e={}]=this.resolveArgs(arguments),this.query(t,r,{...e,subtree:!1})}subtree(t,r=void 0,e={}){return[t,r=void 0,e={}]=this.resolveArgs(arguments),this.query(t,r,{...e,subtree:!0})}observe(t,r,e={}){if([t,r,e={}]=this.resolveArgs(arguments),["sync","intercept"].includes(e.timing))return this.observeSync(t,r,e);if(e.timing&&e.timing!=="async")throw new Error(`Timing option "${e.timing}" invalid.`);let{context:i,window:o,webqit:s,document:c}=this;e.eventDetails&&(s.realdom.domInterceptionRecordsAlwaysOn=!0),(c.readyState==="loading"||s.realdom.domInterceptionRecordsAlwaysOn)&&!s.realdom.domInterceptionHooks?.intercepting&&kt.call(o,"sync",()=>{});let f=new o.MutationObserver(u=>u.forEach(a=>{ht.call(o,l,Nt.call(o,a),i)}));f.observe(i,{childList:!0,subtree:e.subtree});let m=e.signalGenerator||e.lifecycleSignals&&this.createSignalGenerator(),l={context:i,spec:t,callback:r,params:e,signalGenerator:m,disconnectable:f};if(e.staticSensitivity){let u=Ht.call(o,l);return this.disconnectables(e.signal,f,m,u)}return this.disconnectables(e.signal,f,m)}observeSync(t,r,e={}){[t,r,e={}]=this.resolveArgs(arguments);let{context:i,window:o}=this;if(e.timing&&!["sync","intercept"].includes(e.timing))throw new Error(`Timing option "${e.timing}" invalid.`);let s=e.timing==="intercept"?"intercept":"sync",c=e.subtree?"subtree":"children";this.registry(s).size||kt.call(o,s,h=>{this.forEachMatchingContext(s,h,ht)});let f=new o.MutationObserver(h=>h.forEach(d=>{Array.isArray((d=Nt.call(o,d)).event)||ht.call(o,u,d,i)}));f.observe(i,{childList:!0,subtree:e.subtree});let m={disconnect(){f.disconnect(),p.delete(u),p.size||a.delete(i)}},l=e.signalGenerator||e.lifecycleSignals&&this.createSignalGenerator(),u={context:i,spec:t,callback:r,params:e,signalGenerator:l,disconnectable:m},a=this.registry(s,c);a.has(i)||a.set(i,new Set);let p=a.get(i);if(p.add(u),e.staticSensitivity){let h=Ht.call(o,u);return this.disconnectables(e.signal,m,l,h)}return this.disconnectables(e.signal,m,l)}};function Ht(n){let t=this,{context:r,spec:e,callback:i,params:o,signalGenerator:s}=n,c=e.filter(p=>p.kind==="css"),f=p=>p.match(/\.([\w-]+)/g)?.length?["class"]:[],m=p=>p.match(/#([\w-]+)/g)?.length?["id"]:[],l=p=>[...p.matchAll(/\[([^\=\]]+)(\=[^\]]+)?\]/g)].map(h=>h[1]).concat(f(p)).concat(m(p));if(!(n.$attrs=Array.from(new Set(c.filter(p=>(p+"").includes("[")).reduce((p,h)=>p.concat(l(h+"")),[])))).length)return;let u=new Set,a=new Set;return u.push=p=>(a.delete(p),u.add(p)),a.push=p=>(u.delete(p),a.add(p)),n.$deliveryCache={entrants:u,exits:a},new N(r,t).observe(n.$attrs,p=>{let h=new Map,d=g=>(h.has(g)||h.set(g,{target:g,entrants:[],exits:[],type:"static",event:null}),h.get(g)),_=new WeakMap,y=g=>(_.has(g)||_.set(g,c.some(v=>g.matches(v+""))),_.get(g));for(let g of p)["entrants","exits"].forEach(v=>{o.generation&&v!==o.generation||n.$deliveryCache[v].has(g.target)||(v==="entrants"?!y(g.target):y(g.target))||(n.$deliveryCache[v].push(g.target),d(g.target)[v].push(g.target),d(g.target).event=g.event)});for(let[,g]of h){let v=s?.generate()||{};i(g,v,r)}},{subtree:o.subtree,timing:o.timing,eventDetails:o.eventDetails})}function ht(n,t){let{context:r,spec:e,callback:i,params:o,signalGenerator:s,$deliveryCache:c}=n,f={...t,entrants:[],exits:[]};if(o.eventDetails||delete f.event,["entrants","exits"].forEach(l=>{if(!(o.generation&&l!==o.generation)&&(e.length?f[l]=oe.call(this,e,t[l],t.event!=="parse"):f[l]=[...t[l]],!!c))for(let u of f[l])c[l].push(u)}),!f.entrants.length&&!f.exits.length)return;let m=s?.generate()||{};i(f,m,r)}function oe(n,t,r){t=Array.isArray(t)?t:[...t];let e=(i,o)=>{if(o.type==="selector"){let s=o.isXpathAttr?[]:i.filter(c=>o.kind==="xpath"?Ct(this,c,o+""):c.matches&&c.matches(o+""));if((r||o.isXpathAttr)&&(s=i.reduce((c,f)=>o.kind==="xpath"?[...c,...st(this,f,o,r)]:f.querySelectorAll?[...c,...f.querySelectorAll(o+"")]:c,s)),s.length)return s}else if(i.includes(o.content)||r&&i.some(s=>s.contains(o.content)))return[o.content]};return t.$$searchCache||(t.$$searchCache=new Map),n.reduce((i,o)=>{let s;return t.$$searchCache.has(o.content)?s=t.$$searchCache.get(o.content):(s=e(t,o)||[],o.type==="instance"&&t.$$searchCache.set(o.content,s)),i.concat(s)},[])}function Nt({target:n,addedNodes:t,removedNodes:r}){let e=this,i;return i=T(t).reduce((o,s)=>o||e.webqit.realdom.domInterceptionRecords?.get(s),null),i=T(r).reduce((o,s)=>o||e.webqit.realdom.domInterceptionRecords?.get(s),i),i=i||e.document.readyState==="loading"&&"parse"||"mutation",{target:n,entrants:t,exits:r,type:"observation",event:i}}function kt(n,t){let r=this,{webqit:e,document:i,Node:o,CharacterData:s,Element:c,HTMLElement:f,HTMLTemplateElement:m,DocumentFragment:l}=r;e.realdom.domInterceptionHooks||Object.defineProperty(e.realdom,"domInterceptionHooks",{value:new Map}),e.realdom.domInterceptionHooks.has(n)||e.realdom.domInterceptionHooks.set(n,new Set),e.realdom.domInterceptionHooks.get(n).add(t);let u=()=>e.realdom.domInterceptionHooks.get(n).delete(t);if(e.realdom.domInterceptionHooks?.intercepting)return u;console.warn("DOM mutation APIs are now being intercepted."),e.realdom.domInterceptionHooks.intercepting=!0,Object.defineProperty(e.realdom,"domInterceptionRecords",{value:new Map});let a=(d,_)=>{d.entrants.concat(d.exits).forEach(g=>{clearTimeout(e.realdom.domInterceptionRecords.get(g)?.timeout),e.realdom.domInterceptionRecords.set(g,d.event);let v=setTimeout(()=>{e.realdom.domInterceptionRecords.delete(g)},0);Object.defineProperty(d.event,"timeout",{value:v,configurable:!0})}),e.realdom.domInterceptionHooks.get("intercept")?.forEach(g=>g(d));let y=_();return e.realdom.domInterceptionHooks.get("sync")?.forEach(g=>g(d)),y},p={characterData:Object.create(null),other:Object.create(null)};["insertBefore","insertAdjacentElement","insertAdjacentHTML","setHTML","replaceChildren","replaceWith","remove","replaceChild","removeChild","before","after","append","prepend","appendChild"].forEach(d=>{function _(...y){let g=this instanceof s?p.characterData:p.other,v=()=>g[d].call(this,...y);if(!(this instanceof s||this instanceof c||this instanceof l))return v();let C=[],S=[],B=this;["insertBefore"].includes(d)?S=[y[0]]:["insertAdjacentElement","insertAdjacentHTML"].includes(d)?(S=[y[1]],["beforebegin","afterend"].includes(y[0])&&(B=this.parentNode)):["setHTML","replaceChildren"].includes(d)?(C=[...this.childNodes],S=d==="replaceChildren"?[...y]:[y[0]]):["replaceWith","remove"].includes(d)?(C=[this],S=d==="replaceWith"?[...y]:[],B=this.parentNode):["replaceChild"].includes(d)?(C=[y[1]],S=[y[0]]):["removeChild"].includes(d)?C=[...y]:(S=[...y],["before","after"].includes(d)&&(B=this.parentNode));let j=d;if(["insertAdjacentHTML","setHTML"].includes(d)){let _t=this.nodeName;if(d==="insertAdjacentHTML"&&["beforebegin","afterend"].includes(y[0])){if(!this.parentNode)return g[d].call(this,...y);_t=this.parentNode.nodeName}let et=i.createElement(_t);g.setHTML.call(et,S[0],d==="setHTML"?y[1]:{}),S=[...et.childNodes],d==="insertAdjacentHTML"?(j="insertAdjacentElement",y[1]=new l,y[1].______isTemp=!0,y[1].append(...et.childNodes)):(j="replaceChildren",y=[...et.childNodes])}return a({target:B,entrants:S,exits:C,type:"interception",event:[this,d]},()=>g[j].call(this,...y))}["insertBefore","replaceChild","removeChild","appendChild"].includes(d)?(p.other[d]=o.prototype[d],o.prototype[d]=_):(["after","before","remove","replaceWith"].includes(d)&&(p.characterData[d]=s.prototype[d],s.prototype[d]=_),c.prototype[d]&&(p.other[d]=c.prototype[d],c.prototype[d]=_))});let h=Object.create(null);return["outerHTML","outerText","innerHTML","innerText","textContent","nodeValue"].forEach(d=>{let _=["textContent","nodeValue"].includes(d)?o:["outerText","innerText"].includes(d)?f:c;h[d]=Object.getOwnPropertyDescriptor(_.prototype,d),Object.defineProperty(_.prototype,d,{...h[d],set:function(y){let g=()=>h[d].set.call(this,y);if(!(this instanceof c))return g();let v=[],C=[],S=this;if(["outerHTML","outerText"].includes(d)?(v=[this],S=this.parentNode):v=[...this.childNodes],["outerHTML","innerHTML"].includes(d)){let j=this.nodeName;if(d==="outerHTML"){if(!this.parentNode)return g();j=this.parentNode.nodeName}let D=i.createElement(j==="TEMPLATE"?"div":j);h[d].set.call(D,y),C=this instanceof m?[]:[...D.childNodes],d==="outerHTML"?(y=new l,y.______isTemp=!0,y.append(...D.childNodes),g=()=>c.prototype.replaceWith.call(this,y)):this instanceof m?g=()=>this.content.replaceChildren(...D.childNodes):g=()=>c.prototype.replaceChildren.call(this,...D.childNodes)}return a({target:S,entrants:C,exits:v,type:"interception",event:[this,d]},g)}})}),["append","prepend","replaceChildren"].forEach(d=>{[i,l.prototype].forEach(_=>{let y=_[d];_[d]=function(...g){if(this.______isTemp)return y.call(this,...g);let v=d==="replaceChildren"?[...this.childNodes]:[];return a({target:this,entrants:g,exits:v,type:"interception",event:[this,d]},()=>y.call(this,...g))}})}),u}function jt(){se.call(this),le.call(this),ce.call(this)}function se(){let n=this;n.CSS||(n.CSS={}),n.CSS.escape||(n.CSS.escape=t=>t.replace(/([\:@\~\$\&])/g,"\\$1"))}function le(){let n=this;"isConnected"in n.Node.prototype||Object.defineProperty(n.Node.prototype,"isConnected",{get:function(){return!this.ownerDocument||!(this.ownerDocument.compareDocumentPosition(this)&this.DOCUMENT_POSITION_DISCONNECTED)}})}function ce(){let n=this;n.Element.prototype.matches||(n.Element.prototype.matches=n.Element.prototype.matchesSelector||n.Element.prototype.mozMatchesSelector||n.Element.prototype.msMatchesSelector||n.Element.prototype.oMatchesSelector||n.Element.prototype.webkitMatchesSelector||function(t){for(var r=(this.document||this.ownerDocument).querySelectorAll(t),e=r.length;--e>=0&&r.item(e)!==this;);return e>-1})}function $t(){let n=this;if(n.webqit||(n.webqit={}),n.webqit.realdom)return n.webqit.realdom;n.webqit.realdom={},jt.call(n),n.webqit.realdom.meta=(...r)=>fe.call(n,...r),n.webqit.realdom.ready=(...r)=>gt.call(n,...r),n.webqit.realdom.realtime=(r,e="dom")=>{if(e==="dom")return new Q(r,n);if(e==="attr")return new N(r,n)};let t=new Y(n);return n.webqit.realdom.schedule=(r,...e)=>t[`on${r}`](...e),n.webqit.realdom}function gt(...n){let t="interactive",r;V(n[0])?(t=n[0],w(n[1])&&(r=n[1])):w(n[0])&&(r=n[0]);let e={interactive:["interactive","complete"],complete:["complete"]};if(!e[t])throw new Error(`Invalid ready-state timing: ${t}.`);let i=this;if(!r)return i.webqit.realdom.readyStatePromises||(i.webqit.realdom.readyStatePromises={interactive:new Promise(o=>gt.call(this,"interactive",o)),complete:new Promise(o=>gt.call(this,"complete",o))}),i.webqit.realdom.readyStatePromises[t];if(e[t].includes(i.document.readyState))return r(i);i.webqit.realdom.readyStateCallbacks||(i.webqit.realdom.readyStateCallbacks={interactive:[],complete:[]},i.document.addEventListener("readystatechange",()=>{let o=i.document.readyState;for(let s of i.webqit.realdom.readyStateCallbacks[o].splice(0))s(i)},!1)),i.webqit.realdom.readyStateCallbacks[t].push(r)}function fe(n){let t=this,r={},e;return(e=t.document.querySelector(`meta[name="${n}"]`))&&(r=(e.content||"").split(";").filter(i=>i).reduce((i,o)=>{let s=o.split("=").map(c=>c.trim());return dt(i,s[0].split("."),s[1]==="true"?!0:s[1]==="false"?!1:I(s[1])?parseInt(s[1]):s[1]),i},{})),{get name(){return n},get content(){return e.content},json(){return JSON.parse(JSON.stringify(r))}}}var b=(...n)=>F("oohtml",...n),A={};function Dt(n,t,r){let e=this,i=$t.call(e);e.webqit||(e.webqit={}),e.webqit.oohtml||(e.webqit.oohtml={}),e.webqit.oohtml.configs||(e.webqit.oohtml.configs={});let o=n.toUpperCase().replace("-","_");return e.webqit.oohtml.configs[o]||(e.webqit.oohtml.configs[o]={}),A.window=e,U(2,e.webqit.oohtml.configs[o],r,t,i.meta(n).json()),{config:e.webqit.oohtml.configs[o],realdom:i,window:e}}var P=class{static instance(t){return b(t).get("exportsmanager::instance")||new this(t)}constructor(t,r=null,e=0){let{window:i}=A,{webqit:{realdom:o,oohtml:{configs:s}}}=i;b(t).get("exportsmanager::instance")?.dispose(),b(t).set("exportsmanager::instance",this),this.host=t,this.config=s.HTML_IMPORTS,this.parent=r,this.level=e,this.exports=R(this.host),this.defId=(this.host.getAttribute(this.config.template?.attr.moduledef)||"").trim(),this.validateDefId(this.defId),this.realtimeA=o.realtime(this.host.content).children(c=>{this.export(c.entrants,!0),this.export(c.exits,!1)},{live:!0,timing:"sync"}),this.realtimeB=o.realtime(this.host).attr(["src","loading"],(...c)=>this.evaluateLoading(...c),{live:!0,atomic:!0,timing:"sync",lifecycleSignals:!0}),this.realtimeC=this.evalInheritance()}validateDefId(t){if(["@","/","*","#"].some(r=>t.includes(r)))throw new Error(`The export ID "${t}" contains an invalid character.`)}export(t,r){let{window:e}=A,{webqit:{Observer:i}}=e,o,s=this.exports["#"]||[];i.batch(this.exports,()=>{t.forEach(c=>{if(c.nodeType!==1)return;let f=c.matches(this.config.templateSelector),m=(c.getAttribute(f?this.config.template.attr.moduledef:this.config.template.attr.fragmentdef)||"").trim();r?(f&&m?new P(c,this.host,this.level+1):(s.push(c),o=!0),m&&(this.validateDefId(m),i.set(this.exports,(!f&&"#"||"")+m,c))):(f&&m?P.instance(c).dispose():(s=s.filter(l=>l!==c),o=!0),m&&i.deleteProperty(this.exports,(!f&&"#"||"")+m))}),o&&i.set(this.exports,"#",s)})}evaluateLoading([t,r],{signal:e}){let{window:{webqit:{Observer:i}}}=A,o=(t.value||"").trim();if(!o)return;let s,c=l=>{if(!l)return s;s=l.then(()=>m.remove())},f=(r.value||"").trim(),m=i.intercept(this.exports,"get",async(l,u,a)=>(f==="lazy"&&c(this.load(o,!0)),await c(),a()),{signal:e});f!=="lazy"&&c(this.load(o))}load(t){let{window:r}=A;if(this.host.content.children.length)return Promise.resolve();if(this.fetchInFlight?.src===t)return this.fetchInFlight.request;this.fetchInFlight?.controller.abort();let e=new AbortController,i=(s,c)=>this.host.dispatchEvent(new r.CustomEvent(s,{detail:c})),o=r.fetch(t,{signal:e.signal,element:this.host}).then(s=>s.ok?s.text():Promise.reject(s.statusText)).then(s=>(this.host.innerHTML=s.trim(),i("load"),this.host)).catch(s=>(console.error(`Error fetching the bundle at "${t}": ${s.message}`),this.fetchInFlight=null,i("loaderror"),this.host));return this.fetchInFlight={src:t,request:o,controller:e},o}evalInheritance(){if(!this.parent)return[];let{window:{webqit:{Observer:t}}}=A,r=(this.host.getAttribute(this.config.template.attr.extends)||"").trim(),e=(this.host.getAttribute(this.config.template.attr.inherits)||"").trim(),i=c=>{c.forEach(f=>{t.get(this.exports,f.key)===f.oldValue&&(["get","set","def"].includes(f.type)?t[f.type.replace("get","set")](this.exports,f.key,f.value):f.type==="delete"&&t.deleteProperty(this.exports,f.key))})},o=[],s=R(this.parent);return r&&o.push(t.reduce(s,[r,this.config.template.api.exports,1/0],t.get,i,{live:!0})),(e=e.split(" ").map(c=>c.trim()).filter(c=>c)).length&&o.push(t.get(s,e,i,{live:!0})),o}dispose(){this.realtimeA.disconnect(),this.realtimeB.disconnect(),this.realtimeC.forEach(t=>t instanceof Promise?t.then(r=>r.abort()):t.abort()),Object.entries(this.exports).forEach(([t,r])=>{t.startsWith("#")||P.instance(r).dispose()})}};function Ft(){let{window:n}=A,{webqit:t}=n;if(t.DOMContextRequestEvent)return t.DOMContextRequestEvent;class r extends n.Event{constructor(...i){let o=i.pop();if(typeof o!="function")throw new Error("Callback must be provided.");let s=i.pop();if(!s?.kind)throw new Error('"options.kind" must be specified.');let c=["contextrequest","contextclaim"],f=i.pop()||c[0];if(!c.includes(f))throw new Error(`Invalid event type. Must be one of: ${c.join(",")}`);let{kind:m,detail:l,targetContext:u,live:a,signal:p,diff:h,...d}=s;super(f,{...d,bubbles:d.bubbles!==!1}),Object.defineProperty(this,"callback",{get:()=>o}),Object.defineProperty(this,"kind",{get:()=>m}),Object.defineProperty(this,"targetContext",{get:()=>u}),Object.defineProperty(this,"detail",{get:()=>l}),Object.defineProperty(this,"live",{get:()=>a}),Object.defineProperty(this,"signal",{get:()=>p}),Object.defineProperty(this,"diff",{get:()=>h}),Object.defineProperty(this,"options",{get:()=>d})}respondWith(i){if(this.diff){if("_prevValue"in this&&this._prevValue===i)return;Object.defineProperty(this,"_prevValue",{value:i,configurable:!0})}return this.callback(i)}}return t.DOMContextRequestEvent=r,r}var Z=class extends AbortController{constructor(t){super(),t(r=>{let{window:{webqit:{Observer:e}}}=A;e.defineProperty(this,"value",{value:r,configurable:!0,enumerable:!0})},this)}};var K=class extends Error{};var tt=class{static instance(t){return b(t).get("contexts::instance")||new this(t)}constructor(t){b(t).get("contexts::instance")?.dispose(),b(t).set("contexts::instance",this);let r={host:t,contexts:new Set};Object.defineProperty(this,"#",{get:()=>r})}get[Symbol.iterator](){return this["#"].contexts[Symbol.iterator]}get length(){return this["#"].contexts.size}find(...t){return[...this["#"].contexts].find(r=>typeof t[0]=="function"?t[0](r):r.constructor.kind===t[0]&&(t.length===1||r.detail===t[1]))}attach(t){if(!(t instanceof k))throw new TypeError("Context is not a valid DOMContext instance.");if(this.find(t.constructor.kind,t.detail))throw new K(`Context of same kind "${t.constructor.kind}"${t.detail?` and detail "${t.detail}"`:""} already exists.`);this["#"].contexts.add(t),t.initialize(this["#"].host)}detach(t){t.dispose(this["#"].host),this["#"].contexts.delete(t)}request(...t){return new Z((r,e)=>{typeof t[t.length-1]!="function"&&(t[t.length-1]?t.push(r):t[t.length-1]=r);let i;(i=t.find(s=>typeof s=="object"&&s))&&i.live&&(i.signal&&i.signal.addEventListener("abort",()=>e.abort()),t[t.indexOf(i)]={...i,signal:e.signal});let o=new(Ft())(...t);this["#"].host.dispatchEvent(o)})}};var yt=class{static createRequest(){return{kind:this.kind}}constructor(t=null){Object.defineProperty(this,"detail",{get:()=>t}),Object.defineProperty(this,"subscriptions",{value:new Set})}get configs(){let{window:{webqit:{oohtml:{configs:t}}}}=A;return t}get name(){return this.host===A.window.document?1/0:this.host.getAttribute(this.configs.CONTEXT_API.attr.contextname)}subscribed(t){}handle(t){}unsubscribed(t){}matchEvent(t){return t.kind===this.constructor.kind&&(!t.targetContext||t.targetContext===this.name)}handleEvent(t){if(!(this.disposed||typeof t.respondWith!="function")){if(t.type==="contextclaim"){if(t.target===this.host||!(t.detail instanceof yt))return;let r=new Set;return this.subscriptions.forEach(e=>{!t.target.contains(e.target)||!t.detail.matchEvent(e)||(t.stopPropagation(),this.subscriptions.delete(e),r.add(e))}),t.respondWith(r)}if(t.type==="contextrequest")return this.matchEvent(t)?(t.live&&(this.subscriptions.add(t),this.subscribed(t),t.signal?.addEventListener("abort",()=>{this.subscriptions.delete(t),this.unsubscribed(t)})),t.stopPropagation(),this.handle(t)):void 0}}initialize(t){this.host=t,this.disposed=!1,t.addEventListener("contextrequest",this),t.addEventListener("contextclaim",this);let{value:r}=tt.instance(t).request("contextclaim",{kind:this.constructor.kind,detail:this});return r.forEach(e=>{this.subscriptions.add(e),this.subscribed(e),this.handle(e)}),this}dispose(t){return this.disposed=!0,t.removeEventListener("contextrequest",this),t.removeEventListener("contextclaim",this),this.subscriptions.forEach(r=>{this.subscriptions.delete(r),this.unsubscribed(r);let{target:e}=r;e.dispatchEvent(r)}),this}},k=yt;rt(k,"kind");var H=class extends k{static createRequest(t=null){let r=super.createRequest();if(t?.startsWith("/"))r.detail=t,r.targetContext=1/0;else if(t?.startsWith("@")){let[e,...i]=i.slice(1).split(/(?<=\w)(?=\/|#)/).map(o=>o.trim());r.targetContext=e,r.detail=i.join("")}else r.detail=t;return r}get localModules(){return R(this.host)}handle(t){let{window:{webqit:{Observer:r}}}=A;if(t._controller?.abort(),(t.detail||"").trim()==="/")return t.respondWith(this.localModules);let e=this.configs.HTML_IMPORTS,i=(t.detail||"").split(/\/|(?<=\w)(?=#)/g).map(s=>s.trim()).filter(s=>s);if(i.length&&(i=i.join(`/${e.template.api.exports}/`)?.split("/")||[]),!i.length)return t.respondWith();let o={live:t.live,signal:t.signal,descripted:!0};t._controller=r.reduce(this.localModules,i,r.get,(s,{signal:c}={})=>{let f=Array.isArray(s)?s:s.value,m=Array.isArray(s)?s.length:s.value;if(!(!m&&this.host.isConnected===!1))return m||!this.contextModules?(t._isValidLocalResult=m,t.respondWith(f)):r.reduce(this.contextModules,i,r.get,l=>(t._currentSource="context",t.respondWith(Array.isArray(l)?l:l.value)),{...o,signal:c})},{lifecycleSignals:!0,...o})}unsubscribed(t){t._controller?.abort()}realtimeSources(t){this.host=t;let r=()=>{for(let o of this.subscriptions)o._isValidLocalResult||this.handle(o)},e=this.configs.HTML_IMPORTS;if(!this.host.matches||!e.context.attr.importscontext)return;this.refdSourceController?.disconnect();let i=this.host.ownerDocument.defaultView.webqit.realdom;this.refdSourceController=i.realtime(this.host).attr(e.context.attr.importscontext,(o,{signal:s})=>{if(!o.value)return this.contextModules=void 0,r();let c={...this.constructor.createRequest(o.value.trim()),live:!0,signal:s};this.host.parentNode[this.configs.CONTEXT_API.api.contexts].request(c,f=>{this.contextModules=f&&Object.getPrototypeOf(f)?R(f):f,r()})},{live:!0,timing:"sync",lifecycleSignals:!0})}initialize(t){return this.realtimeSources(t),super.initialize(t)}dispose(t){return this.refdSourceController?.disconnect(),super.dispose(t)}};rt(H,"kind","html-imports");function Wt(){let{window:n}=A,{webqit:t}=n,{Observer:r,realdom:e,oohtml:{configs:i}}=t;if(t.HTMLImportElement)return t.HTMLImportElement;let o=i.HTML_IMPORTS.import.tagName.includes("-")?n.HTMLElement:class{};class s extends o{static instance(f){return i.HTML_IMPORTS.import.tagName.includes("-")&&f instanceof this?f:b(f).get("import::instance")||new this(f)}constructor(...f){super();let m=f[0]||this;b(m).set("import::instance",this),Object.defineProperty(this,"el",{get:()=>m,configurable:!1});let l={};Object.defineProperty(this,"#",{get:()=>l,configurable:!1}),l.slottedElements=new Set,l.setAnchorNode=u=>(l.anchorNode=u,u),l.importRequest=(u,a=null)=>{let p={...H.createRequest(l.moduleRef?.includes("#")?l.moduleRef:`${l.moduleRef}#`),live:a&&!0,signal:a};(this.el.isConnected?this.el.parentNode:l.anchorNode.parentNode)[i.CONTEXT_API.api.contexts].request(p,h=>{u((h instanceof n.HTMLTemplateElement?[...h.content.children]:Array.isArray(h)?h:h&&[h])||[])})},l.hydrate=(u,a)=>{l.moduleRef=(this.el.getAttribute(i.HTML_IMPORTS.import.attr.moduleref)||"").trim(),u.replaceWith(l.setAnchorNode(this.createAnchorNode())),l.autoRestore(()=>{a.forEach(p=>{l.slottedElements.add(p),b(p).set("slot@imports",this.el)})}),l.hydrationImportRequest=new AbortController,l.importRequest(p=>{if(l.originalsRemapped)return this.fill(p);let h=p.map((_,y)=>({el:_,fragmentDef:_.getAttribute(i.HTML_IMPORTS.template.attr.fragmentdef)||"",tagName:_.tagName,i:y})),d=-1;a.forEach(_=>{let y=_.tagName,g=_.getAttribute(i.HTML_IMPORTS.template.attr.fragmentdef)||"",v=(d++,h.find(C=>C.tagName===y&&C.fragmentDef===g&&C.i===d));!v||b(_).set("original@imports",v.el)}),l.originalsRemapped=!0},l.hydrationImportRequest.signal)},l.autoRestore=(u=null)=>{l.autoRestoreRealtime?.disconnect(),u&&u();let a=()=>{l.anchorNode?.replaceWith(this.el),l.anchorNode=null,this.el.setAttribute("data-nodecount",0)};if(!l.slottedElements.size)return a();let p=e.realtime(n.document).observe([...l.slottedElements],h=>{if(h.exits.forEach(d=>{b(d).delete("slot@imports"),l.slottedElements.delete(d)}),!l.slottedElements.size){if(p.disconnect(),!h.target.isConnected)return;a()}},{subtree:!0,timing:"sync",generation:"exits"});l.autoRestoreRealtime=p},l.connectedCallback=()=>{if(l.slottedElements.size)throw new Error("Illegal reinsertion into the DOM; import slot is not empty!");l.moduleRefRealtime||(l.moduleRefRealtime=e.realtime(this.el).attr(i.HTML_IMPORTS.import.attr.moduleref,(u,{signal:a})=>{l.moduleRef=u.value,l.importRequest(p=>!l.hydrationImportRequest&&this.fill(p),a)},{live:!0,timing:"sync",lifecycleSignals:!0}),l.hydrationImportRequest?.abort(),l.hydrationImportRequest=null)},l.disconnectedCallback=()=>{l.hydrationImportRequest?.abort(),l.hydrationImportRequest=null,!l.anchorNode.isConnected&&(l.moduleRefRealtime?.disconnect(),l.moduleRefRealtime=null)}}createAnchorNode(){if(n.webqit.env!=="server")return n.document.createTextNode("");let f=n.document.createElement("div");f.textContent=this.el.outerHTML;let m=n.document.createComment(f.innerHTML);return b(m).set("isAnchorNode",!0),m}fill(f){Array.isArray(f)&&(f=new Set(f)),this.el.setAttribute("data-nodecount",f.size),this["#"].autoRestore(()=>{if(this["#"].slottedElements.forEach(m=>{let l=b(m).get("original@imports");f.has(l)?f.delete(l):(this["#"].slottedElements.delete(m),m.remove())}),f.size){let m=this["#"].anchorNode,l=this["#"].setAnchorNode(this.createAnchorNode());(this.el.isConnected?this.el:m).replaceWith(l)}f.forEach(m=>{let l=m.cloneNode(!0);l.hasAttribute(i.HTML_IMPORTS.template.attr.fragmentdef)||l.toggleAttribute(i.HTML_IMPORTS.template.attr.fragmentdef,!0),b(l).set("original@imports",m),b(l).set("slot@imports",this.el),this["#"].slottedElements.add(l),this["#"].anchorNode.before(l)})})}empty(){this["#"].slottedElements.forEach(f=>f.remove())}get anchorNode(){return this["#"].anchorNode}get moduleRef(){return this["#"].moduleRef}get slottedElements(){return this["#"].slottedElements}}return i.HTML_IMPORTS.import.tagName.includes("-")&&customElements.define(i.HTML_IMPORTS.import.tagName,s),t.HTMLImportElement=s,s}function xt(n={}){let{config:t,realdom:r,window:e}=Dt.call(this,"html-imports",n,{template:{attr:{moduledef:"def",fragmentdef:"def",extends:"extends",inherits:"inherits"},api:{exports:"exports",moduledef:"def"}},context:{attr:{importscontext:"importscontext"},api:{import:"import"}},import:{tagName:"import",attr:{moduleref:"ref"}},staticsensitivity:!0,isomorphic:!0});t.templateSelector=`template[${e.CSS.escape(t.template.attr.moduledef)}]`,t.importsContextSelector=`[${e.CSS.escape(t.context.attr.importscontext)}]`,t.slottedElementsSelector=`[${e.CSS.escape(t.template.attr.fragmentdef)}]:not(template)`;let i=(o,s)=>{let c=`starts-with(., "${o}")`,f=`substring(., string-length(.) - string-length("${s}") + 1) = "${s}"`;return`${c} and ${f}`};t.anchorNodeSelector=`comment()[${i(`&lt;${t.import.tagName}`,`&lt;/${t.import.tagName}&gt;`)}]`,e.webqit.HTMLImportsContext=H,e.webqit.HTMLImportElement=Wt(),ae.call(e,t),ue.call(e,t)}function R(n,t=!0){if(!b(n).has("exports")&&t){let r=Object.create(null);b(n).set("exports",r)}return b(n).get("exports")}function ae(n){let t=this,{webqit:{oohtml:{configs:r}}}=t;if(n.template.api.exports in t.HTMLTemplateElement.prototype)throw new Error(`The "HTMLTemplateElement" class already has a "${n.template.api.exports}" property!`);if(n.template.api.moduledef in t.HTMLTemplateElement.prototype)throw new Error(`The "HTMLTemplateElement" class already has a "${n.template.api.moduledef}" property!`);if(n.context.api.import in t.document)throw new Error(`document already has a "${n.context.api.import}" property!`);if(n.context.api.import in t.HTMLElement.prototype)throw new Error(`The "HTMLElement" class already has a "${n.context.api.import}" property!`);Object.defineProperty(t.HTMLTemplateElement.prototype,n.template.api.exports,{get:function(){return R(this)}}),Object.defineProperty(t.HTMLTemplateElement.prototype,n.template.api.moduledef,{get:function(){return this.getAttribute(n.template.attr.moduledef)}}),Object.defineProperty(t.document,n.context.api.import,{value:function(i,o=!1,s=null){return e(t.document,...arguments)}}),Object.defineProperty(t.HTMLElement.prototype,n.context.api.import,{value:function(i,o=!1,s=null){return e(this,...arguments)}});function e(i,o,s=!1,c=null){let f={};typeof s=="function"?(c=s,s=!1):typeof s=="object"&&s?f={...s,...f}:f={live:s};let m={...H.createRequest(o),...f};return i[r.CONTEXT_API.api.contexts].request(m,c)}}function ue(n){let t=this,{webqit:{Observer:r,realdom:e,oohtml:{configs:i},HTMLImportElement:o,HTMLImportsContext:s}}=t,c=l=>{let u=l[i.CONTEXT_API.api.contexts];u.find(s.kind)||u.attach(new s)},f=l=>{let u=l[i.CONTEXT_API.api.contexts],a=u.find(s.kind);a&&(!l.isConnected||!l.matches?.(n.importsContextSelector)&&!Object.keys(a.localModules).length)&&u.detach(a)};e.realtime(t.document).subtree([n.templateSelector,n.importsContextSelector],l=>{l.entrants.forEach(u=>{if(u.matches(n.templateSelector)){Object.defineProperty(u,"scoped",{value:u.hasAttribute("scoped")});let a=P.instance(u);a.ownerContext=u.scoped?l.target:t.document;let p=R(a.ownerContext);a.defId&&r.set(p,a.defId,u),c(a.ownerContext)}else c(u)}),l.exits.forEach(u=>{if(u.matches(n.templateSelector)){let a=P.instance(u),p=R(a.ownerContext);a.defId&&r.deleteProperty(p,a.defId),f(a.ownerContext)}else f(u)})},{live:!0,timing:"sync",staticSensitivity:n.staticsensitivity}),e.realtime(t.document).subtree(n.import.tagName,l=>{l.entrants.forEach(u=>m(u,!0,l)),l.exits.forEach(u=>m(u,!1,l))},{live:!0,timing:"sync"});function m(l,u){let a=o.instance(l);u?a["#"].connectedCallback():a["#"].disconnectedCallback()}t.webqit.env!=="server"&&e.realtime(t.document).subtree(`(${n.anchorNodeSelector})`,l=>{l.entrants.forEach(u=>{if(b(u).get("isAnchorNode"))return;let a=t.document.createElement("div");a.innerHTML=u.nodeValue,a.innerHTML=a.firstChild.textContent;let p=a.firstChild,h=parseInt(p.getAttribute("data-nodecount")),d=new Set,_=u;for(;(_=_.previousElementSibling)&&_.matches(n.slottedElementsSelector)&&h--;)d.add(_);o.instance(p)["#"].hydrate(u,d)})},{live:!0})}xt.call(window);})();
//# sourceMappingURL=html-imports.js.map
