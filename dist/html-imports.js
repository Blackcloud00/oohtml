(()=>{function x(e){return!Array.isArray(e)&&typeof e=="object"&&e}function I(e,...i){globalThis.WebQitInternalsRegistry||(globalThis.WebQitInternalsRegistry=new Map);var f=globalThis.WebQitInternalsRegistry.get(e);if(!f){if(f=new Map,i[0]===!1)return f;globalThis.WebQitInternalsRegistry.set(e,f)}for(var o,t;o=i.shift();)if((t=f)&&!(f=f.get(o))){if(f=new Map,i[0]===!1)return f;t.set(o,f)}return f}function _(e){return Array.isArray(e)}function T(e){return typeof e=="function"}function P(e){return e===null||e===""}function C(e){return arguments.length&&(e===void 0||typeof e>"u")}function b(e){return Array.isArray(e)||typeof e=="object"&&e||T(e)}function W(e){return P(e)||C(e)||e===!1||e===0||b(e)&&!Object.keys(e).length}function y(e){return T(e)||e&&{}.toString.call(e)==="[object function]"}function q(e){return e instanceof Number||typeof e=="number"}function O(e){return q(e)||e!==!0&&e!==!1&&e!==null&&e!==""&&!isNaN(e*1)}function E(e){return e instanceof String||typeof e=="string"&&e!==null}function D(e){return!E(e)&&!C(e.length)}function $(e,...i){return i.forEach(f=>{e.indexOf(f)<0&&e.push(f)}),e}function U(o,i){i=i||Object.prototype,i=i&&!_(i)?[i]:i;for(var f=[],o=o;o&&(!i||i.indexOf(o)<0)&&o.name!=="default";)f.push(o),o=o?Object.getPrototypeOf(o):null;return f}function k(e,i){var f=[];return U(e,i).forEach(o=>{$(f,...Object.getOwnPropertyNames(o))}),f}function v(e,i,f=!1,o=!1,t=!1){var n=0,r=e.shift();if((O(r)||r===!0||r===!1)&&(n=r,r=e.shift()),!e.length)throw new Error("_merge() requires two or more array/objects.");return e.forEach((u,d)=>{!b(u)&&!y(u)||(f?k(u):Object.getOwnPropertyNames(u)).forEach(s=>{if(!!i(s,r,u,d)){var c=r[s],p=u[s];if((_(c)&&_(p)||x(c)&&x(p))&&(n===!0||n>0))r[s]=_(c)&&_(p)?[]:{},v([O(n)?n-1:n,r[s],c,p],i,f,o,t);else if(_(r)&&_(u))o?r[s]=p:r.push(p);else try{t?Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(u,s)):r[s]=u[s]}catch{}}})}),r}function F(...e){return v(e,(i,f,o)=>!0,!1,!1,!1)}function z(e,i){return e.reduce((f,o,t)=>f||i(o,t),!1)}function w(e,i=!0){return _(e)?e:!i&&x(e)?[e]:e!==!1&&e!==0&&W(e)?[]:D(e)?Array.prototype.slice.call(e):x(e)?Object.values(e):[e]}function A(e,i,f={},o={}){i=w(i).slice();for(var t=e;!C(t)&&!P(t)&&i.length;){var n=i.shift();if(!(f.get?f.get(t,n):b(t)?n in t:t[n])){o.exists=!1;return}t=f.get?f.get(t,n):t[n]}return o.exists=!0,t}function V(e,i,f,o={},t={}){let n=(c,p,m)=>t.set?t.set(c,p,m):(O(i[u])&&_(c)?c.push(m):c[p]=m,!0);i=w(i);for(var r=e,u=0;u<i.length;u++)if(u<i.length-1){if(!r||!b(r)&&!y(r))return!1;var d=A(r,i[u],t);if(!b(d)){if(t.buildTree===!1)return!1;d=y(t.buildTree)?t.buildTree(u):O(i[u+1])?[]:{};var s=n(r,i[u],d);if(!s)return!1}r=d}else return n(r,i[u],f)}var B=(e,i=Array)=>class extends i{constructor(...o){super(...o),Object.defineProperty(this,"window",{value:e})}get(o,t={}){let n=this[o];return Ne.call(e,n,t.context,!1)}each(o,t={}){this.forEach((n,r)=>{(n=this.get(r,t))&&o(n)})}attributes(o=[]){let t=this.get(0);return t?o.length?o.reduce((n,r)=>n.concat(t.getAttribute(r)),[]):Array.from(t.attributes).reduce((n,r)=>n.concat({name:r.name,value:r.value}),[]):[]}children(o={}){let t=this.get(0,o);return t?this.constructor.from(t instanceof this.window.HTMLTemplateElement?t.content.children:t.children):this.constructor.from([])}querySelectorAll(o,t={}){let n=this.get(0,t)||t.context||e.document.documentElement;return this.constructor.from(K.call(e,o,n,!0))}};function Ne(e,i=null,f=!0){let o=this;if(E(e)){let n;if(e.trim().startsWith("<")){var t=o.document.createElement("div");t.innerHTML=e,n=f?t.children:t.firstChild}else n=K.call(o,e,i,f);return n}return e instanceof o.Element?f?[e]:e:f?w(e,!1):e}function K(e,i=null,f=!0){i=i||this.document;var t,n=f?"querySelectorAll":"querySelector";try{t=i[n](e)}catch{try{t=i[n](e.replace(/\:is\(/g,":matches("))}catch{try{t=i[n](e.replace(/\:is\(/g,":-webkit-any("))}catch{try{t=i[n](e.replace(/\:is\(/g,":-moz-any("))}catch(s){throw s}}}}return t}function ee(e){let i=this;i.document.readyState==="complete"?e(i):(i.document.domReadyCallbacks||(i.document.domReadyCallbacks=[],i.document.addEventListener("DOMContentLoaded",()=>{i.document.domReadyCallbacks.splice(0).forEach(f=>f(i))},!1)),i.document.domReadyCallbacks.push(e))}function te(e,i=!1){let f=this,o={content:{}};return!(o.el=f.document.querySelector('meta[name="oohtml"]'))&&i&&(o.el=f.document.createElement("meta"),o.el.setAttribute("name",e),f.document.head.append(o.el)),o.el&&(o.content=(o.el.getAttribute("content")||"").split(";").filter(t=>t).reduce((t,n)=>{let r=n.split("=").map(u=>u.trim());return V(t,r[0].split("."),r[1]==="true"?!0:r[1]==="false"?!1:O(r[1])?parseInt(r[1]):r[1]),t},{})),o.get=function(t){return JSON.stringify(A(this.content,t.split(".")))},o.copy=function(){return JSON.stringify(this.content)},o.copyWithDefaults=function(...t){return t.length?F(!0,{},...t.reverse().concat(this.content)):this.copy()},o}var re=e=>class{constructor(f=!0){Object.defineProperty(this,"window",{value:e}),Object.defineProperty(this,"readCallbacks",{value:new Set}),Object.defineProperty(this,"writeCallbacks",{value:new Set}),this.async=f,this.window.requestAnimationFrame?this._run():this.async=!1}_run(){this.window.requestAnimationFrame(()=>{this.readCallbacks.forEach(f=>{f()||this.readCallbacks.delete(f)}),this.writeCallbacks.forEach(f=>{f()||this.writeCallbacks.delete(f)}),this._run()})}onread(f,o=!1){if(o)return new Promise((t,n)=>{this.async===!1?f(t,n):this.readCallbacks.add(()=>{f(t,n)})});this.async===!1?f():this.readCallbacks.add(f)}onwrite(f,o=!1){if(o)return new Promise((t,n)=>{this.async===!1?f(t,n):this.writeCallbacks.add(()=>{f(t,n)})});this.async===!1?f():this.writeCallbacks.add(f)}cycle(f,o,t){this.onread(()=>{var n=f(t);if(n){var r=u=>{this.onwrite(()=>{var d=o(u,t);if(d){var s=c=>{this.cycle(f,o,c)};d instanceof Promise?d.then(s):s()}})};n instanceof Promise?n.then(r):r()}})}};var oe=(e,i=Array)=>class extends B(e,i){attributes(o,t,n={}){y(arguments[0],n)&&(n=t||{},t=o,o=[]);let r=super.attributes(o);return r.length&&t(...r),this.attributeChangeCallback(o,t,n)}attributeChangeCallback(o,t,n={}){y(arguments[0])&&(n=t||{},t=o,o=[]);let r=new e.MutationObserver(s=>{if(!o.length){t(...Array.from(s).reduce((c,p)=>c.concat({name:p.attributeName,value:u.getAttribute(p.attributeName),oldValue:p.oldValue}),[]));return}t(...o.reduce((c,p)=>c.concat(u.getAttribute(p)),[]))});n={attributes:!0,attributeOldValue:!o.length,subtree:n.subtree},o.length&&(n.attributeFilter=o);let u=this.get(0,n);r.observe(u,n);let d=this;return{disconnect(){return r.disconnect(),{reconnect(){return d.attributeChangeCallback(o,t,n)}}}}}children(o,t={}){S(super.children(t),o,t,1);let n=new e.MutationObserver(s=>{let[c,p,m,a]=ie(s);S(c,o,t,0,1),S(p,o,t,1,0),S(m,o,t,0),S(a,o,t,1)}),r=this.get(0,t),u=r instanceof e.HTMLTemplateElement?r.content:r;n.observe(u,{childList:!0});let d=this;return{disconnect(){return n.disconnect(),{reconnect(){return d.children(o)}}}}}querySelectorAll(o,t,n={}){let r=super.querySelectorAll(o,n);S(r,t,n,1);let u=this.get(0,n);return this.constructor.from([o]).presenceChangeCallback(t,{...n,context:u||n.context})}querySelectorNone(o,t,n={}){super.querySelectorAll(o,n).length===0&&(n.each?t(null,0):t([],0));let r=this.get(0,n);return this.constructor.from([o]).presenceChangeCallback(t,{...n,context:r||n.context})}connectedCallback(o,t={}){let n=[];return this.each(r=>{!r.isConnected||(t.each?o(r,1):n.push(r))},t),n.length&&o(n,1),this.presenceChangeCallback(o,{...t,on:"added"})}disconnectedCallback(o,t={}){let n=[];return this.each(r=>{r.isConnected||(t.each?o(r,0):n.push(r))},t),n.length&&o(n,0),this.presenceChangeCallback(o,{...t,on:"removed"})}presenceChangeCallback(o,t={}){let n=(m,[...a])=>{if(a=a.filter(h=>h.matches),E(m)){let h=a.filter(g=>g.matches(m));if(t.observeIndirectMutation!==!1&&(h=a.reduce((g,N)=>g.concat(w(N.querySelectorAll(m))),h),h.length))return h}else{if(a.includes(m))return[m];if(t.observeIndirectMutation!==!1&&a.length){let h=m;for(;h=h.parentNode;)if(a.includes(h))return[m]}}},r=(m,a)=>(a.$$searchCache||(a.$$searchCache=new Map),m.reduce((h,g)=>{let N;return a.$$searchCache.has(g)?N=a.$$searchCache.get(g):(N=n(g,a,E(g))||[],a.$$searchCache.set(g,N)),h.concat(N)},[])),u=this,d=new Set,s=new Set,c=(m,a,h)=>{a&&t.on==="removed"||!a&&t.on==="added"||(m=r(u,m)).length&&(m.forEach(g=>{a?(d.add(g),s.delete(g)):(d.delete(g),s.add(g))}),t.maintainCallState?S(m,o,t,a,h,d,s):S(m,o,t,a,h))},p=t.context||e.document.documentElement;return ne.call(e,p,(m,a,h,g)=>{c(m,0,1),c(a,1,0),c(h,0,0),c(g,1,1)})}};function S(e,i,f,...o){f.each?e.forEach(t=>i(t,...o)):e instanceof Set&&e.size?i([...e],...o):Array.isArray(e)&&e.length&&i(e,...o)}var M=new Map;function ne(e,i){let f=this;if(!M.has(e)){let t=new Set,n=new f.MutationObserver(u=>{if(!t.size)return;let[d,s,c,p]=ie(u);t.forEach(m=>m(d,s,c,p))}),r=e instanceof f.HTMLTemplateElement?e.content:e;n.observe(r,{childList:!0,subtree:!0}),M.set(e,{callbacks:t,observer:n})}M.get(e).callbacks.add(i);let o={disconnect(){let t=M.get(e);return t.callbacks.delete(i),t.callbacks.size||(t.observer.disconnect(),M.delete(e)),{reconnect(){let n=M.get(e);return n?(n.callbacks.add(i),o):ne.call(f,e,i)}}}};return o}function ie(e){let i=new Set,f=new Set,o=new Set,t=new Set;return e.forEach(n=>{n.addedNodes.forEach(r=>{r.isConnected?i.add(r):t.add(r)}),n.removedNodes.forEach(r=>{r.isConnected&&i.has(r)?(i.delete(r),f.add(r)):o.add(r)}),t.forEach(r=>{o.has(r)||(t.delete(r),i.add(r))})}),[f,t,o,i]}function fe(){Se.call(this),Ae.call(this),Te.call(this)}function Se(){let e=this;e.CSS||(e.CSS={}),e.CSS.escape||(e.CSS.escape=i=>i.replace(/([\:@\~\$\&])/g,"\\$1"))}function Ae(){let e=this;"isConnected"in e.Node.prototype||Object.defineProperty(e.Node.prototype,"isConnected",{get:function(){return!this.ownerDocument||!(this.ownerDocument.compareDocumentPosition(this)&this.DOCUMENT_POSITION_DISCONNECTED)}})}function Te(){let e=this;e.Element.prototype.matches||(e.Element.prototype.matches=e.Element.prototype.matchesSelector||e.Element.prototype.mozMatchesSelector||e.Element.prototype.msMatchesSelector||e.Element.prototype.oMatchesSelector||e.Element.prototype.webkitMatchesSelector||function(i){for(var f=(this.document||this.ownerDocument).querySelectorAll(i),o=f.length;--o>=0&&f.item(o)!==this;);return o>-1})}function ue(){let e=this;if(e.wq||(e.wq={}),e.wq.dom)return e.wq.dom;let i=B(e),f=re(e),o=oe(e);return i.prototype.realtime=function(...t){return t.length?new o(...t):new o(...this)},e.wq.dom=new i,e.wq.dom.reflow=new f,e.wq.dom.ready=ee.bind(e),e.wq.dom.meta=te.bind(e),e.wq.dom.extend=(t,n,{supportsRealtime:r=!1}={})=>{r!=="only"&&(i.prototype[t]=n),r&&(o.prototype[t]=n)},fe.call(e),e.wq.dom}function le(e,i,f=!1){e=e.trim();let o=["()","{}","[]"];if(i.length===1&&o.includes(i[0])){let[n,r]=e.split(i[0][0],2);return r&&r.endsWith(i[0][1])&&(r=r.substr(0,r.length-1)),[n,r]}let[t]=e.split("").reduce(([n,r],u)=>(i.includes(u)&&!r?n.unshift(f?u:""):(["(","{","["].includes(u)?r++:[")","}","]"].includes(u)&&r--,n[0]+=u),[n,r]),[[""],0]);return t.reverse()}var ce=new Map;function me(e,i=[]){let f=ce.get(e);if(!f){let o=e,t;i.includes(o.substr(0,1))&&(t=o.substr(0,1),o=o.substr(1).trim());let[n,...r]=le(o.trim(),[":"]),u=r.reduce((d,s)=>{let[c,p]=le(s.trim(),["()"]);return d[c]=p||!0,d},{});f=[t,n,u],ce.set(e,f)}return f.slice(0)}var l=(e,...i)=>I(e,"oohtml",...i);function $e(e){let i=this,{dom:f}=i.wq,o=e.element.import.includes("-")?i.HTMLElement:class{};class t extends o{constructor(...r){super();let u=r[0]||this;Object.defineProperty(this,"el",{get:()=>u}),l(this.el).set("instance",this),l(this.el).set("slottedElements",new Set),l(this.el).set("specialMutationEventStack",[])}get moduleRef(){return l(this.el).get("moduleref")}get importId(){return l(this.el).get("importId")}get importModifiers(){return l(this.el).get("importModifiers")}get anchorNode(){return l(this.el).get("anchorNode")}get compositionBlock(){return l(this.el).get("compositionBlock")}get slottedElements(){return l(this.el).get("slottedElements")}createAnchorNode(){return e.isomorphic?i.document.createComment(this.el.outerHTML):i.document.createTextNode("")}doConnectedCallback(){if(l(this.el).get("anchorNode"))return;let r=this.createAnchorNode();this.bindAnchorElement(r)}bindAnchorElement(r){l(this.el).set("anchorNode",r),l(r).set("anchoredNode",this.el)}resolve(r,u=null,d={}){r=r.slice(0),u=u||l(this.el).get("importId"),d=d||l(this.el).get("importModifiers");let s=p=>{let m=p.reduce((a,h)=>(h.forEach(g=>a.add(g)),a),new Set);this.fill(m)},c=(p,m)=>{let a=l(p).get("exports"),h=()=>a.get(`#${u}`);a.ready(()=>m(h()))};(function p(m=[]){let a=r.shift();if(!a)return s(m);c(a.value,h=>p(m.concat(h||[])))})()}fill(r){if(z(e.importInertContexts||[],s=>this.el.closest(s)))return;Array.isArray(r)&&(r=new Set(r));let u=l(this.el).get("slottedElements");u.forEach(s=>{let c=l(s).get("original");r.has(c)?r.delete(c):(u.delete(s),s.remove())});let d=l(this.el).get("anchorNode");this.el.isConnected&&r.size&&(l(this.el).get("specialMutationEventStack").push(1),this.el.replaceWith(d)),r.forEach(s=>{let c=s.cloneNode(!0);l(c).set("original",s),u.add(c),d.before(c)}),this.bindSlottedElements(new Set(u))}empty(){l(this.el).get("slottedElements").forEach(r=>r.remove())}bindSlottedElements(r){r.size&&this.unbindSlottedElements(),Array.isArray(r)&&(r=new Set(r));let u=l(this.el).get("slottedElements");r.forEach(s=>{u.add(s),l(s).set("slot",this.el)});let d=f.realtime(...r).disconnectedCallback((s,c,p,m,a)=>{if(a&&a.size===r.size&&d.disconnect(),s.isConnected||u.delete(s),l(s).get("slot")===this.el&&l(s).delete("slot"),!u.size){let h=l(this.el).get("anchorNode");h.isConnected&&(l(this.el).get("specialMutationEventStack").push(1),h.replaceWith(this.el))}},{each:!0,maintainCallState:!0});l(this.el).set("slottedElementsObserver",d)}unbindSlottedElements(){let r=l(this.el).get("slottedElementsObserver");r&&r.disconnect(),l(this.el).get("slottedElements").clear()}doDisconnectedCallback(){this.unbindSlottedElements()}}return e.element.import.includes("-")?(t.node=n=>{if(!(n instanceof t))throw new Error("Unable to resolve import element class.");return n},i.customElements.define(e.element.import,t)):t.node=n=>l(n).get("instance")||new t(n),i.wq.HTMLImportElement=t,{HTMLImportElement:t}}function Le(e){let i=this,{HTMLImportElement:f}=i.wq;function o(t){let n=new Set;t.childNodes.forEach(r=>{if(r.nodeType===1){if(!r.matches(e.exportgroupSelector))return;n.add(r)}else if(r.nodeType===8){let u=r.nodeValue.trim();if(!u.startsWith("<"+e.element.import)||!u.endsWith("</"+e.element.import+">"))return;let d=i.document.createElement("div");d.innerHTML=u;let s=d.firstChild;if(!s.matches(e.element.import))return;let c=f.node(s);c.bindAnchorElement(r),c.bindSlottedElements([...n]),n.clear()}})}w(i.document.querySelectorAll(e.exportgroupSelector)).forEach(t=>{l(t).get("slot")||l(t.parentNode).get("hydrationVisit")||(o(t.parentNode),l(t.parentNode).set("hydrationVisit",!0))})}function Be(e){let i=this,{dom:f,HTMLImportElement:o}=i.wq;f.realtime().querySelectorAll(e.modulerefSelector,(t,n)=>{let r=t.matches(e.element.import);if(r&&(l(t).get("specialMutationEventStack")||[]).length)return l(t).get("specialMutationEventStack").pop();let u=l(t).get("attributesRealtimeConn");if(u&&u.disconnect(),n)r&&o.node(t).doConnectedCallback();else{let s=l(t).get("moduleQueryRealtimeConn");s&&s.unsubscribe(),r&&o.node(t).doDisconnectedCallback();return}let d=[e.attr.moduleref];r&&d.push(e.attr.importid),u=f.realtime(t).attributes(d,(s,c=null)=>{let p=l(t).get("moduleQueryRealtimeConn");p&&p.unsubscribe(),l(t).set("moduleref",s);let m,a;if(r&&([,m,a]=me(c||"default"),l(t).set("importId",m),l(t).set("importModifiers",a)),!s){if(!r)return;let g=(t.parentNode||l(t).get("anchorNode").parentNode).closest(e.modulerefSelector);if(!g)return;l(t).set("compositionBlock",g),l(g,"imports").set(m,t);let N=l(g).get("moduleQueryResult");o.node(t).resolve(N);return}if(r){let h=l(t).get("compositionBlock");h&&(l(t).delete("compositionBlock"),l(h,"imports").delete(m))}p=l(i.document).get("exports").query(s,h=>{l(t).set("moduleQueryResult",h),r?o.node(t).resolve(h,m,a):l(t,"imports").forEach(g=>{o.node(g).resolve(h)})},{realtime:!0,await:"atomic"}),l(t).set("moduleQueryRealtimeConn",p)}),l(t).set("attributesRealtimeConn",u)},{each:!0})}function R(e={}){let i=this,f=ue.call(i),o=f.meta("oohtml").copyWithDefaults(e,{element:{import:"import"},attr:{importid:"name",exportsearch:"exportsearch",moduleref:"template",exportgroup:"exportgroup"}});o.exportgroupSelector=`[${i.CSS.escape(o.attr.exportgroup)}]`,o.modulerefSelector=`[${i.CSS.escape(o.attr.moduleref)}]`;let{HTMLImportElement:t}=$e.call(this,o);return f.ready(()=>{Le.call(this,o)}),Be.call(this,o),{HTMLImportElement:t}}R.call(window);})();
//# sourceMappingURL=html-imports.js.map
