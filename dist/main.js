(()=>{function b(r){return!Array.isArray(r)&&typeof r=="object"&&r}function F(r){return typeof r}function O(r,...e){globalThis.WebQitInternalsRegistry||(globalThis.WebQitInternalsRegistry=new Map);var t=globalThis.WebQitInternalsRegistry.get(r);if(!t){if(t=new Map,e[0]===!1)return t;globalThis.WebQitInternalsRegistry.set(r,t)}for(var i,n;i=e.shift();)if((n=t)&&!(t=t.get(i))){if(t=new Map,e[0]===!1)return t;n.set(i,t)}return t}function h(r){return Array.isArray(r)}function Z(r){return typeof r=="function"}function qe(r){return Z(r)&&/^class\s?/.test(Function.prototype.toString.call(r))}function ue(r){return r===null||r===""}function q(r){return arguments.length&&(r===void 0||typeof r>"u")}function g(r){return Array.isArray(r)||typeof r=="object"&&r||Z(r)}function Ne(r){return ue(r)||q(r)||r===!1||r===0||g(r)&&!Object.keys(r).length}function _(r){return Z(r)||r&&{}.toString.call(r)==="[object function]"}function X(r){return r instanceof Number||typeof r=="number"}function A(r){return X(r)||r!==!0&&r!==!1&&r!==null&&r!==""&&!isNaN(r*1)}function $(r){return r instanceof String||typeof r=="string"&&r!==null}function De(r){return!$(r)&&!q(r.length)}function le(r,e=1){var t=0;r.forEach(n=>{t++});var i=r.slice(r.length-t,e);return arguments.length>1?i:i[0]}function ce(r,e=1){return arguments.length>1?le(r.slice().reverse(),e).reverse():le(r.slice().reverse())}function ge(r,...e){return e.forEach(t=>{r.indexOf(t)<0&&r.push(t)}),r}function Le(i,e){e=e||Object.prototype,e=e&&!h(e)?[e]:e;for(var t=[],i=i;i&&(!e||e.indexOf(i)<0)&&i.name!=="default";)t.push(i),i=i?Object.getPrototypeOf(i):null;return t}function Re(r,e){var t=[];return Le(r,e).forEach(i=>{ge(t,...Object.getOwnPropertyNames(i))}),t}function D(r,e,t=!1,i=!1,n=!1){var s=0,o=r.shift();if((A(o)||o===!0||o===!1)&&(s=o,o=r.shift()),!r.length)throw new Error("_merge() requires two or more array/objects.");return r.forEach((u,l)=>{!g(u)&&!_(u)||(t?Re(u):Object.getOwnPropertyNames(u)).forEach(f=>{if(!!e(f,o,u,l)){var p=o[f],c=u[f];if((h(p)&&h(c)||b(p)&&b(c))&&(s===!0||s>0))o[f]=h(p)&&h(c)?[]:{},D([A(s)?s-1:s,o[f],p,c],e,t,i,n);else if(h(o)&&h(u))i?o[f]=c:o.push(c);else try{n?Object.defineProperty(o,f,Object.getOwnPropertyDescriptor(u,f)):o[f]=u[f]}catch{}}})}),o}function R(r,e){var t=void 0;return g(r)&&Object.keys(r).forEach((i,n)=>{t!==!1&&(t=e(A(i)?parseFloat(i):i,r[i],n))}),t}function W(...r){return D(r,(e,t,i)=>!0,!1,!1,!1)}function re(r,e,t=null,i=!1){return e.length>r.length?-1:(typeof t=="number"?i?r.slice(0,t+1+(t<0?r.length:0)):r.slice(t):r).reduce((n,s,o)=>{var[u,l,f]=n;if(!i&&u>-1)return[u,l,f];var p=f+1,c=s===e[p]?p===0?[o,0]:[l,p]:[-1,-1];return c[1]===e.length-1&&(c[1]=-1,c[0]>-1)?[c[0]].concat(c):[u].concat(c)},[-1,-1,-1])[0]+(i||typeof t!="number"?0:t>-1?t:r.length-t)}function ie(r,e,t=null,i=!1){var n=re(r,e,t,i);return n===-1?[]:r.slice(n+e.length)}function $e(r,e){return r.reduce((t,i,n)=>t||e(i,n),!1)}function w(r,e=!0){return h(r)?r:!e&&b(r)?[r]:r!==!1&&r!==0&&Ne(r)?[]:De(r)?Array.prototype.slice.call(r):b(r)?Object.values(r):[r]}function H(r,e,t=null){return t||t!==!1&&r.dotSafe&&e.dotSafe?r.join(".")===e.join("."):r.length===e.length&&r.reduce((i,n,s)=>i&&n===e[s],!0)}function ae(r,e,t=null){return h(e)?r.filter(i=>t?e.filter(n=>t(i,n)).length:e.indexOf(i)!==-1):[]}function pe(r,e,t=null){return t||t!==!1&&r.dotSafe&&e.dotSafe?(r.join(".")+".").startsWith(e.join(".")+"."):e.reduce((i,n,s)=>i&&n===r[s],!0)}function We(r){let e=(t,i,n)=>n.indexOf(t)===i;return r.filter(e)}function Y(r){return(Be(r)?r:w(r).length?[r]:[]).reduce((e,t)=>e.concat([w(t)]),[]).map(e=>V.resolve(e))}var V=class extends Array{static resolve(e){return e.every(t=>!(t+"").includes("."))?new V().concat(e):e}get dotSafe(){return!0}};function Be(r){return w(r).reduce((e,t)=>e||h(t),!1)}function He(r){return r.filter(e=>e||e===0).length!==r.length}function et(r){return r.filter(e=>He(w(e))).length>0}var k=class{constructor(e){this.target=e,this.fireables=[],this.currentlyFiring=[]}add(e){return this.fireables.push(e),e}remove(e){this.fireables=this.fireables.filter(t=>t!==e)}removeMatches(e){this.match(e).forEach(t=>{this.fireables=this.fireables.filter(i=>i!==t)})}match(e){return this.fireables.filter(t=>{var i=Y(t.filter),n=w((t.params||{}).tags),s=Y(e.filter),o=w((e.params||{}).tags);return(!e.originalHandler||t.handler===e.originalHandler)&&(!s.length||H(s,i))&&(!o.length||o.length===n.length&&ae(n,o).length===o.length)})}static _getFirebase(e,t,i=!0,n=this.__namespace){if(!g(t))throw new Error('Subject must be of type object; "'+F(t)+'" given!');var s=this;return n&&globalThis.WebQitObserverNamespaceRegistry.has(e+"-"+n)&&(s=globalThis.WebQitObserverNamespaceRegistry.get(e+"-"+n),e+="-"+n),!O(t,"firebases").has(e)&&i&&O(t,"firebases").set(e,new s(t)),O(t,"firebases").get(e)}static _namespace(e,t,i=null){if(e+="-"+t,arguments.length===2)return globalThis.WebQitObserverNamespaceRegistry.get(e);if(!(i.prototype instanceof this))throw new Error(`The implementation of the namespace ${this.name}.${t} must be a subclass of ${this.name}.`);globalThis.WebQitObserverNamespaceRegistry.set(e,i),i.__namespace=t}};globalThis.WebQitObserverNamespaceRegistry||(globalThis.WebQitObserverNamespaceRegistry=new Map);var ee=class{constructor(e,t){this.target=e,this.handler=t.handler,this.filter=t.filter,this.params=t.params}disconnect(){this.disconnected=!0}};var me=class extends ee{fire(e,t,i){return this.disconnected||this.filter&&!ae(w(this.filter),[e.type]).length?t(...Array.prototype.slice.call(arguments,2)):this.handler(e,i,t)}};function _e(r,e=[],t=!0){var i=0;return A(arguments[0])&&g(arguments[1])&&(i=arguments[0],r=arguments[1],e=arguments[2]||[]),D([i,{},r],(n,s,o)=>_(e)?e(n):h(e)&&e.length?e.indexOf(n)>-1:!0,!1,!1,t)}function te(r,e,t={},i={}){e=w(e).slice();for(var n=r;!q(n)&&!ue(n)&&e.length;){var s=e.shift();if(!(t.get?t.get(n,s):g(n)?s in n:n[s])){i.exists=!1;return}n=t.get?t.get(n,s):n[s]}return i.exists=!0,n}function Ve(r,e,t,i={},n={}){let s=(p,c,a)=>n.set?n.set(p,c,a):(A(e[u])&&h(p)?p.push(a):p[c]=a,!0);e=w(e);for(var o=r,u=0;u<e.length;u++)if(u<e.length-1){if(!o||!g(o)&&!_(o))return!1;var l=te(o,e[u],n);if(!g(l)){if(n.buildTree===!1)return!1;l=_(n.buildTree)?n.buildTree(u):A(e[u+1])?[]:{};var f=s(o,e[u],l);if(!f)return!1}o=l}else return s(o,e[u],t)}var ne=class{constructor(e,t){if(this.target=e,!t.type)throw new Error("Action type must be given in definition!");R(t,(i,n)=>{Object.defineProperty(this,i,{value:n,enumerable:!0})}),Object.seal(this)}};var S=class extends k{add(e){return super.add(new me(this.target,e))}fire(e,t=null){if(e instanceof ne||(e=new ne(this.target,e)),this.currentlyFiring.filter(s=>s.type===e.type&&s.name===e.name).length)return t?t():void 0;this.currentlyFiring.push(e);let i=(s,...o)=>{var u=this.fireables[s];return u?u.fire(e,(...l)=>i(s+1,...l),...o):t?t(...o):o[0]};var n=i(0);return this.currentlyFiring.pop(),n}static getFirebase(e,t=!0,i=null){return super._getFirebase("interceptor",...arguments)}static namespace(e,t=null){return super._namespace("interceptor",...arguments)}};function P(r){return O(r,!1).get(r)||r}function T(r,e,t={},i={}){if(!e||!g(e))throw new Error("Target must be of type object!");e=P(e);var n,s=function(o){return arguments.length?o:Reflect[r](e,...Object.values(t))};return(n=S.getFirebase(e,!1,i.namespace))?n.fire({type:r,...t},s):s()}function be(r,e,t,i={}){return T("apply",r,{thisArgument:e,argumentsList:t},i)}function we(r,e,t=null,i={}){return T("construct",r,arguments.length>2?{argumentsList:e,newTarget:t}:{argumentsList:e},i)}var L=class{constructor(e,t=!1){this._={},this._.target=e,this._.cancellable=t,this._.propagationStopped=!1,this._.defaultPrevented=!1,this._.promisesInstance=null,this._.promises=[]}get target(){return this._.target}get cancellable(){return this._.cancellable}stopPropagation(){this._.propagationStopped=!0}get propagationStopped(){return this._.propagationStopped}preventDefault(){this._.defaultPrevented=!0}get defaultPrevented(){return this._.defaultPrevented}waitUntil(e){e instanceof Promise&&(this._.promises.push(e),this._.promisesInstance=null)}get promises(){return!this._.promisesInstance&&this._.promises.length&&(this._.promisesInstance=Promise.all(this._.promises)),this._.promisesInstance}respondWith(e){var t,i=b(e)&&!q(e.propagationStopped)&&!q(e.defaultPrevented);e===!1||i&&e.propagationStopped?this.stopPropagation():e===!1||i&&e.defaultPrevented?this.preventDefault():(e instanceof Promise&&(t=e)||i&&(t=e.promises))&&this.waitUntil(t)}};var de=class extends ee{constructor(e,t){if(super(e,t),this.filters2D=Y(this.filter),this.filtersIsOriginally2D=Be(this.filter),this.filtersIsDynamic=et(this.filters2D),this.filtersIsDynamic&&this.filters2D.length>1)throw new Error('Only one "Dynamic Filter" must be observed at a time! "'+this.filters2D.map(i=>"["+i.join(", ")+"]").join(", ")+'" have been bound together.')}fire(e){if(this.disconnected||this.params.type&&!$e(e,o=>this.params.type===o.type))return;let t=o=>!["set","def"].includes(o.type)||!this.params.diff||(_(this.params.diff)?this.params.diff(o.value,o.oldValue):o.value!==o.oldValue);var i=new L(this.target);if(this.filters2D.length){var n=e.filter(o=>this.filters2D.filter((u,l)=>{var f=u.slice();return this.filtersIsDynamic&&o.path.forEach((p,c)=>{f[c]=f[c]||f[c]===0?f[c]:p}),(!this.filtersIsDynamic||!He(f))&&t(o)&&(!this.params.subtree&&H(f,o.path)||this.params.suptree&&pe(f,o.path)&&(!A(this.params.suptree)||ie(f,o.path).length<=this.params.suptree)||this.params.subtree&&o.path.length>=f.length&&pe(o.path,f)&&(!A(this.params.subtree)||ie(o.path,f).length<=this.params.subtree))}).length);if(n.length)if(this.filtersIsOriginally2D||this.params.subtree){var s=n;b(this.filter)&&(s={...this.filter},n.forEach((o,u)=>{s[o.name]=o})),i.respondWith(this.handler(s,i))}else n.forEach((o,u)=>{i.respondWith(this.handler(o,i))})}else(this.params.subtree||e.filter(o=>H(o.path,[o.name])).length===e.length)&&e.filter(o=>t(o)).length&&i.respondWith(this.handler(e,i));return i}};var z=class{constructor(e,t){if(this.target=e,t.originalSubject||(this.originalSubject=e),!("type"in t))throw new Error("Mutation type must be given in definition!");if(!("name"in t))throw new Error("Property name must be given in definition!");R(t,(i,n)=>{i==="path"&&(n=V.resolve(n)),Object.defineProperty(this,i,{value:n,enumerable:!0})}),this.path||Object.defineProperty(this,"path",{value:V.resolve([t.name]),enumerable:!0}),Object.seal(this)}};var C=class extends k{constructor(e){super(e),this.buffers=[]}add(e){return super.add(new de(this.target,e))}fire(e,t){var i=new L(this.target,t);return e=w(e,!1).map(n=>n instanceof z?n:new z(this.target,n)),this.buffers.length?(ce(this.buffers)(e),i):(this.currentlyFiring.filter(n=>e.filter(s=>n.type===s.type&&n.name===s.name).length).length,this.fireables.forEach(n=>{if(i.propagationStopped&&t)return i;i.respondWith(n.fire(e))}),i)}static getFirebase(e,t=!0,i=null){return super._getFirebase("observer",...arguments)}static namespace(e,t=null){return super._namespace("observer",...arguments)}};function N(r,e,t=null,i={}){if(r=t||r,!r||!g(r))throw new Error("Target must be of type object!");r=P(r);var n=w(e),s=n.map(o=>{var u,l=function(f){return arguments.length?f:O(r,"accessorizedProps").has(o)&&O(r,"accessorizedProps").get(o).touch(!0)?O(r,"accessorizedProps").get(o).get():t?Reflect.get(r,o,t):Reflect.get(r,o)};return(u=S.getFirebase(r,!0,i.namespace))?u.fire({type:"get",name:o,related:n,receiver:t},l):l()});return h(e)?s:s[0]}function ve(r,e,t=null,i={}){if(r=P(r),!r||!g(r))throw new Error('Observable subjects must be of type object; "'+F(r)+'" given!');if(_(e)&&(i=arguments.length>2?t:{},t=e,e=null),!_(t))throw new Error('Handler must be a function; "'+F(t)+'" given!');var n,s=C.getFirebase(r,!0,i.namespace),o={filter:e,handler:t,params:i};if((o.filter||o.params.subtree==="*"||o.params.subtree&&oe(r))&&U(r,o.filter,o.params.subtree,i.namespace),o.params.unique&&(n=s.match({filter:e,params:i})).length){if(o.params.unique!=="replace")return n[0];s.remove(n[0])}return s.add(o)}function Q(r,e,t,i=null,n={}){if(r!==t){var s;if(ve(t,(u,l)=>{if(s=C.getFirebase(r,!1,n.namespace)){var f=u.map(p=>{var c=p;do if(c.target===r)return;while(c=c.src);var a={};return R(p,(m,d)=>{m!=="target"&&m!=="name"&&m!=="path"&&m!=="src"&&(a[m]=d)}),a.name=e,a.path=[e].concat(p.path),a.originalSubject=p.originalSubject,a.src=p,new z(r,a)}).filter(p=>p);if(f.length)return s.fire(f,l.cancellable)}},{subtree:!0,...n,unique:!0,tags:[ze,e,r]}),b(i)&&(s=C.getFirebase(r,!1,n.namespace))){var o=W({name:e,type:"set",value:t,related:[e]},i);let u=s.fire(o,n.cancellable);if(n.eventTypeReturn)return u}}}var ze={};function U(r,e=null,t=!1,i=null){if(!r||!g(r))throw new Error("Target must be of type object!");var n=C.getFirebase(r,!0,i);if(!(!n||n.build)){n.build=t;var s=Y(e),o=!s.length||s.filter(l=>!l[0]&&l[0]!==0).length?Object.keys(r):s.map(l=>l[0]),u=s.length?s.map(l=>l.slice(1)).filter(l=>l.length):null;n.subBuild=u&&u.length?u:null,o.forEach(l=>{var f=N(r,l,null,{namespace:i});try{g(f)&&(Q(r,l,f,null,params),(n.subBuild&&oe(f)||(_isFunction(t)?t(f):t&&oe(f)))&&U(f,n.subBuild,t,i))}catch{}})}}var oe=r=>(r instanceof Object||r instanceof Array||r instanceof Function)&&(typeof window>"u"||r!==window);function xe(r,e,t=null,i={}){if(r=P(r),!r||!g(r))throw new Error('Observable subjects must be of type object; "'+F(r)+'" given!');if(_(e)&&(i=arguments.length>2?t:{},t=e,e=null),t&&!_(t))throw new Error('Handler must be a function; "'+F(t)+'" given!');var n;if(n=C.getFirebase(r,!1,i.namespace))return n.removeMatches({filter:e,originalHandler:t,params:i})}function G(r,e,t,i=null,n={}){xe(t,null,null,{...n,tags:[ze,e,r]});var s;if(b(i)&&(s=C.getFirebase(r,!1,n.namespace))){var o=W({name:e,type:"del",oldValue:t,related:[e]},i);s.fire(o,n.cancellable)}}function J(r,e,t={}){return T("has",r,{name:e},t)}function Oe(r,e,t,i={}){e=t.receiver||e;var n=t.keysOrPayload,s=t.value;if(!e||!g(e))throw new Error("Target must be of type object!");b(n)&&(i=s||{},s=null),e=P(e);var o=S.getFirebase(e,!1,i.namespace),u=C.getFirebase(e,!1,i.namespace);let l=(m,d,y,E)=>{var x="set",v;r&&(x="defineProperty",v=d||{},d=v.value);var M=!1,K;J(e,m,i)&&(M=!0,K=N(e,m,t.receiver,i));var I={name:m,type:x,value:d,receiver:t.receiver,related:y,detail:E,isUpdate:M,oldValue:K},Je=function(Ke){return arguments.length&&(v?v=Ke:d=Ke),v?O(e,"accessorizedProps",!1).has(m)&&!O(e,"accessorizedProps").get(m).restore()?!1:(Object.defineProperty(e,m,v),!0):O(e,"accessorizedProps",!1).has(m)?O(e,"accessorizedProps").get(m).set(d):(e[m]=d,!0)};if(o){var wt=v?{type:"defineProperty",name:m,descriptor:v,receiver:t.receiver,related:y,detail:E,isUpdate:M,oldValue:K}:{type:"set",name:m,value:d,receiver:t.receiver,related:y,detail:E,isUpdate:M,oldValue:K};I.success=o.fire(wt,Je)}else I.success=Je();return I.success&&I.value!==I.oldValue&&(g(I.oldValue)&&G(e,m,I.oldValue,null,i),g(I.value)&&(Q(e,m,I.value,null,i),u&&(u.subBuild||u.build&&oe(I.value))&&U(I.value,u.subBuild,u.build,i.namespace))),I};var f,p=[];h(n)||($(n)||X(n))&&(f=w(n))?p=f.map(m=>l(m,s,f,i.detail)):b(n)&&(f=Object.keys(n))&&(p=f.map(m=>l(m,n[m],f,i.detail)));var c=p.filter(m=>m.success!==!1),a;return u?(a=u.fire(c,i.cancellable),a.successCount=c.length):i.eventTypeReturn&&(a=new L(e)),i.eventTypeReturn?a:c.length>0}function Ee(r,e,t=null,i={}){return Oe(!0,r,{keysOrPayload:e,value:t},i)}function Ce(r,e,t={}){if(!r||!g(r))throw new Error("Target must be of type object!");r=P(r);var i=w(e),n=i.map(l=>{var f;J(r,l,t)&&(f=N(r,l,null,t));var p={name:l,type:"deleteProperty",related:i,detail:t.detail,oldValue:f},c,a=function(m){return arguments.length?m:O(r,"accessorizedProps",!1).has(l)&&!O(r,"accessorizedProps").get(l).restore()?!1:(delete r[l],!0)};return(c=S.getFirebase(r,!1,t.namespace))?p.success=c.fire({type:"deleteProperty",name:l,oldValue:f,related:i},a):p.success=a(),p.success&&g(p.oldValue)&&G(r,l,p.oldValue,null,t),p}),s=n.filter(l=>l.success!==!1),o,u;return(o=C.getFirebase(r,!1,t.namespace))?(u=o.fire(s,t.cancellable),u.successCount=s.length):t.eventTypeReturn&&(u=new L(r)),t.eventTypeReturn?u:s.length>0}function Pe(r,e,t={}){return T("getOwnPropertyDescriptor",r,{name:e},t)}function Se(r,e={}){return T("getPrototypeOf",r,{},e)}function Te(r,e={}){return T("isExtensible",r,{},e)}function Fe(r,e={}){return T("ownKeys",r,{},e)}function Ae(r,e={}){return T("preventExtensions",r,{},e)}function se(r,e,t=null,i=null,n={}){return Oe(!1,r,arguments.length>3?{keysOrPayload:e,value:t,receiver:i}:{keysOrPayload:e,value:t},n)}function je(r,e,t={}){return T("setPrototypeOf",r,{prototype:e},t)}function rt(r,e=[],t={}){t=b(e)?e:t;var i=(arguments.length===1?Object.keys(r):w(e)).map(n=>{if(O(r,"accessorizedProps").has(n)&&O(r,"accessorizedProps").get(n).touch(!0))return!1;let s=()=>{for(var a,m=r;!a&&(m=Object.getPrototypeOf(m));)a=Object.getOwnPropertyDescriptor(m,n);return a};var o=Object.getOwnPropertyDescriptor(r,n),u,l;o||(u={writable:!0,enumerable:!(n in r),configurable:t.configurable!==!1});var f={...o||u};"value"in f&&delete f.value,"writable"in f&&delete f.writable,f.get=()=>{if(c.ongoingGets.length)return c.get();c.ongoingGets.push(1);var a=N(r,n,null,t);return c.ongoingGets.pop(),a};var p;f.set=a=>{if(c.ongoingSets.length)return c.set(a);c.ongoingSets.push(1);var m=se(r,n,a,null,t);return c.ongoingSets.pop(),m};var c={ongoingGets:[],ongoingSets:[],get:function(){var a=o;return a||(l?a=u:a=s()||u),a.get?a.get.call(r):a.value},set:function(a){var m=o;return m||(l?m=u:(m=s())?"value"in m&&(m=u,l=!0):(m=u,l=!0)),m.set||m.get?m.set?m.set.call(r,a):!1:(m.value=a,!0)},restore:function(){try{return this.intact()&&(o||l?Object.defineProperty(r,n,o||u):delete r[n],O(r,"accessorizedProps").delete(n)),!0}catch{}return!1},intact:function(){return(Object.getOwnPropertyDescriptor(r,n)||{}).get===f.get},touch:function(a=!1){return this.intact()||(a?!this.restore():!1)}};try{return Object.defineProperty(r,n,f),O(r,"accessorizedProps").set(n,c),!0}catch{}return!1});return h(e)?i:i[0]}function it(r,e=[],t={}){t=b(e)?e:t;var i=(arguments.length===1?Object.keys(r):w(e)).map(n=>O(r,"accessorizedProps",!1).has(n)?O(r,"accessorizedProps").get(n).restore():!0);return h(e)?i:i[0]}function nt(r,e={}){if(!g(r))throw new Error('Object must be of type target; "'+F(r)+'" given!');var t=new Proxy(r,{apply:(i,n,s)=>be(i,n,s,e),construct:(i,n,s=null)=>we(i,n,s,e),defineProperty:(i,n,s)=>Ee(i,n,s,e),deleteProperty:(i,n)=>Ce(i,n,e),get:(i,n,s=null)=>{var o=N(i,n,s,e);return e.proxyAutoBinding!==!1&&_(o)&&!qe(o)?o.bind(t):o},getOwnPropertyDescriptor:(i,n)=>Pe(i,n,e),getPrototypeOf:i=>Se(i,e),has:(i,n)=>J(i,n,e),isExtensible:i=>Te(i,e),ownKeys:i=>Fe(i,e),preventExtensions:i=>Ae(i,e),set:(i,n,s,o=null)=>se(i,n,s,o,e),setPrototypeOf:(i,n)=>je(i,n,e)});return O(t).set(t,r),t}function ot(r,e,t={}){if(r=P(r),!g(r))throw new Error('Object must be of type target; "'+F(handler)+'" given!');var i={},n=!0;b(e)||(_(e)?e={"":e}:_(t)&&(e={[e]:t},t=arguments.length>3?arguments[3]:{}),n=!1);var s=S.getFirebase(r,!0,t.namespace);return Object.keys(e).forEach(o=>{if(!_(e[o]))throw new Error("Callback"+(o===null?"":" for "+o)+' must be a function; "'+F(e[o])+'" given!');var u={filter:o,handler:e[o],params:t},l;if(u.params.unique&&(l=s.match(u)).length){if(u.params.unique!=="replace")return l[0];s.remove(l[0])}n?i[o]=s.add(u):i=s.add(u)}),i}function st(r,e=null,t={}){if(r=P(r),!r||!g(r))throw new Error('Object must be of type target; "'+F(r)+'" given!');var i=S.getFirebase(r,!1,t.namespace);_isObject(e)||(_(e)?e={[null]:e}:_(t)&&(e={[e]:t},t=arguments.length>3?arguments[3]:{}),isOriginallyObj=!1),(i=S.getFirebase(r,!1,t.namespace))&&Object.keys(e).forEach(n=>{if(!_(e[n]))throw new Error("Callback"+(n===null?"":" for "+n)+' must be a function; "'+F(e[n])+'" given!');var s={filter:n,originalHandler:e[n],params:t};return i.removeMatches(s)})}function ft(r,...e){var t=e.map(s=>{if(s=P(s),!g(s))throw new Error("Target must be of type object!");return{target:s,subjectCopy:h(s)?s.slice(0):_e(s)}}),i=r(...e);let n=()=>{t.map(s=>{var o=Object.keys(s.subjectCopy),u=Object.keys(s.target),l=[],f=We(o.concat(u)).map(c=>{if(s.subjectCopy[c]!==s.target[c]){l.push(c);var a={name:c,related:l,buffered:!0};return u.includes(c)?(a.type="set",a.value=s.target[c],o.includes(c)&&(a.isUpdate=!0)):a.type="del",o.includes(c)&&(a.oldValue=s.subjectCopy[c]),g(s.subjectCopy[c])&&G(s.target,c,s.subjectCopy[c]),g(s.target[c])&&Q(s.target,c,s.target[c]),a}}).filter(c=>c),p;if(f.length&&(p=C.getFirebase(s.target,!1)))return p.fire(f)})};return i instanceof Promise?i.then(n):n(),i}var ut={apply:be,construct:we,defineProperty:Ee,deleteProperty:Ce,get:N,getOwnPropertyDescriptor:Pe,getPrototypeOf:Se,has:J,isExtensible:Te,ownKeys:Fe,preventExtensions:Ae,set:se,setPrototypeOf:je,accessorize:rt,unaccessorize:it,proxy:nt,unproxy:P,observe:ve,unobserve:xe,intercept:ot,unintercept:st,closure:ft,build:U,link:Q,unlink:G,Observers:C,Interceptors:S};var at=r=>{let e=r.wq;return e.apiMutationsBindings=[new Map,new Map],e.apiMutationsBindings.hasListeners=()=>e.apiMutationsBindings.some(t=>t.size),e.apiMutationsHooks=new Set,class{attr(i,n,s){[i,n,s]=Me(arguments);let o=new r.MutationObserver(l=>{l.forEach(f=>s({target:f.target,name:f.attributeName,oldValue:f.oldValue,type:"attribute-record"},i))}),u={attributes:!0,attributeOldValue:!0};return n.length&&(u.attributeFilter=n),o.observe(i,u),o}match(i,n,s,o={}){[i,n,s,o={}]=Me(arguments);let u=new Set,l=f=>(u.has(f)||u.set(f,{target:f,connectedNodes:[],disconnectedNodes:[],type:"query-record"}),u.get(f));return n.every(f=>$(f))&&(n=n.join(","))?(!o.on||o.on==="connected")&&(o.subtree?i.querySelectorAll(n):i.children||[]).forEach(f=>{l(f.parentNode).connectedNodes.push(f)}):n.every(f=>b(f))&&(i!==document||o.subtree)&&n.forEach(f=>{let p=i===document?f.isConnected:f.parentNode===i||o.subtree&&i.contains(f);((!o.on||o.on==="connected")&&p||o.on==="disconnected"&&!p)&&l(f.parentNode)[p?"connectedNodes":"disconnectedNodes"].push(f)}),u.forEach(f=>s(f,i)),this.observe(...arguments)}observe(i,n,s,o={}){let{document:u}=r;u.readyState==="loading"&&!e.parsetimeApiMutations&&(e.parsetimeApiMutations=new Set,ct(r,c=>{!e.parsetimeApiMutations||c.incomingNodes.concat(c.outgoingNodes).forEach(a=>{e.parsetimeApiMutations.add(a)})}),u.addEventListener("readystatechange",()=>{e.parsetimeApiMutations?.clear(),e.parsetimeApiMutations=null})),[i,n,s,o={}]=Me(arguments);let l=new r.MutationObserver(c=>{c.forEach(({target:a,addedNodes:m,removedNodes:d})=>{lt.call(this,i,{target:a,addedNodes:m,removedNodes:d,type:"mutation-record"},{selectors:n,callback:s,params:{deepIntersect:y=>u.readyState!=="loading"||e.parsetimeApiMutations?.has(y),...o}})})}),f=()=>l.observe(i,{childList:!0,subtree:o.subtree});f();let p={disconnect(){return l.disconnect(),{reconnect(){return f(),p}}}};return p}intercept(i,n,s,o={}){if([i,n,s,o={}]=Me(arguments),!e.apiMutationsBindings.intercepting){let{document:c}=r;e.apiMutationsBindings.intercepting=!0;let a=m=>{e.apiMutationsBindings.forEach((d,y)=>{d.forEach((E,x)=>{!(m.target===x||y&&(x===c&&m.target.isConnected||x.contains(m.target)))||E.forEach(v=>{m.type==="mutation-record"?v={...v,params:{...v.params,deepIntersect:!1}}:v={...v,params:{deepIntersect:!0,...v.params}},lt.call(this,x,m,v)})})})};if(ct(r,a),c.readyState==="loading"){let m=this.observe(c,d=>{d={target:d.target,incomingNodes:d.addedNodes.filter(y=>!e.parsetimeApiMutations?.has(y)),outgoingNodes:d.removedNodes.filter(y=>!e.parsetimeApiMutations?.has(y)),type:d.type},!(!d.incomingNodes.length&&!d.outgoingNodes.length)&&a(d)},{subtree:!0});c.addEventListener("readystatechange",()=>m.disconnect())}}let u=e.apiMutationsBindings[o.subtree?1:0];u.has(i)||u.set(i,new Set);let l=u.get(i),f={selectors:n,callback:s,params:o};l.add(f);let p={disconnect(){return l.delete(f),l.size||u.delete(i),{reconnect(){return l.size?(l.add(f),p):this.intercept(i,n,s,o)}}}};return p}}};function Me(r){return _(r[1])?r=[r[0],[],...[...r].slice(1)]:r[1]=w(r[1],!1),r}function lt(r,e,t){let i,n={...e};["addedNodes","incomingNodes","removedNodes","outgoingNodes"].forEach(s=>{if(!(s in n))return;let o=["removedNodes","outgoingNodes"].includes(s);o&&t.params.on==="connected"||!o&&t.params.on==="disconnected"?n[s]=[]:t.selectors.length?(n[s]=Nt.call(this,t.selectors,n[s],t.params.deepIntersect)).length&&(i=!0):(n[s]=[...n[s]],i=!0)}),i&&t.callback(n,r)}function Nt(r,e,t){e=Array.isArray(e)?e:[...e];let i=(n,s)=>{if(n=n.filter(o=>o.matches),$(s)){let o=n.filter(u=>u.matches(s));if((t===!0||_(t))&&(o=n.reduce((u,l)=>{let f=_(t)&&!t(l)?[]:l.querySelectorAll(s);return[...u,...f]},o)),o.length)return o}else if(n.includes(s)||(t===!0||_(t))&&n.some(o=>_(t)&&!t(o)?!1:o.contains(s)))return[s]};return e.$$searchCache||(e.$$searchCache=new Map),r.reduce((n,s)=>{let o;return e.$$searchCache.has(s)?o=e.$$searchCache.get(s):(o=i(e,s)||[],b(s)&&e.$$searchCache.set(s,o)),n.concat(o)},[])}function ct(r,e){let t=r.wq;if(t.apiMutationsHooks.add(e),t.apiMutationsHooks.intercepting)return;t.apiMutationsHooks.intercepting=!0,console.warn("DOM mutation APIs are now being intercepted.");let{document:i,Node:n,Element:s,HTMLElement:o}=r,u=f=>{t.apiMutationsHooks.forEach(p=>p(f))},l=Object.create(null);["insertBefore","insertAdjacentElement","insertAdjacentHTML","setHTML","replaceChildren","replaceWith","remove","replaceChild","removeChild","before","after","append","prepend","appendChild"].forEach(f=>{let p=["insertBefore","replaceChild","removeChild","appendChild"].includes(f)?n:s;l[f]=p.prototype[f],l[f]&&(p.prototype[f]=function(...c){let a=()=>l[f].call(this,...c);if(!(this instanceof s))return a();let m=[],d=[],y=this;["insertBefore"].includes(f)?d=[c[0]]:["insertAdjacentElement","insertAdjacentHTML"].includes(f)?(d=[c[1]],["beforebegin","afterend"].includes(c[0])&&(y=this.parentNode)):["setHTML","replaceChildren"].includes(f)?(m=[...this.childNodes],d=f==="replaceChildren"?[...c]:[c[0]]):["replaceWith","remove"].includes(f)?(m=[this],d=f==="replaceWith"?[...c]:[],y=this.parentNode):["replaceChild"].includes(f)?(m=[c[1]],d=[c[0]]):["removeChild"].includes(f)?m=[...c]:(d=[...c],["before","after"].includes(f)&&(y=this.parentNode));let E=f;if(["insertAdjacentHTML","setHTML"].includes(f)){let x=this.nodeName;if(f==="insertAdjacentHTML"&&["beforebegin","afterend"].includes(c[0])){if(!this.parentNode)return l[f].call(this,...c);x=this.parentNode.nodeName}let v=i.createElement(x);l.setHTML.call(v,d[0],f==="setHTML"?c[1]:{}),d=[...v.childNodes],f==="insertAdjacentHTML"?(E="insertAdjacentElement",c[1]=new DocumentFragment,c[1].append(...v.childNodes)):(E="replaceChildren",c=[...v.childNodes])}return u({target:y,incomingNodes:d,outgoingNodes:m,type:"interception-record",event:[this,f]}),l[E].call(this,...c)})}),["outerHTML","outerText","innerHTML","innerText","textContent","nodeValue"].forEach(f=>{let p=["textContent","nodeValue"].includes(f)?n:["outerText","innerText"].includes(f)?o:s;l[f]=Object.getOwnPropertyDescriptor(p.prototype,f),Object.defineProperty(p.prototype,f,{...l[f],set:function(c){let a=()=>l[f].set.call(this,c);if(!(this instanceof s))return a();let m=[],d=[],y=this;if(["outerHTML","outerText"].includes(f)?(m=[this],y=this.parentNode):m=[...this.childNodes],["outerHTML","innerHTML"].includes(f)){let E=this.nodeName;if(f==="outerHTML"){if(!this.parentNode)return a();E=this.parentNode.nodeName}let x=i.createElement(E);l[f].set.call(x,c),d=[...x.childNodes],f==="outerHTML"?(c=new DocumentFragment,c.append(...x.childNodes),a=()=>l.replaceWith.call(this,c)):a=()=>l.replaceChildren.call(this,...x.childNodes)}return u({target:y,incomingNodes:d,outgoingNodes:m,type:"interception-record",event:[this,f]}),a()}})}),["append","prepend"].forEach(f=>{let p=i[f];i[f]=function(...c){return u({target:i,incomingNodes:c,outgoingNodes:[],type:"interception-record",event:[i,f]}),p.call(this||i,...c)}})}var pt=r=>class{constructor(t=!0){Object.defineProperty(this,"window",{value:r}),Object.defineProperty(this,"readCallbacks",{value:new Set}),Object.defineProperty(this,"writeCallbacks",{value:new Set}),this.async=t,this.window.requestAnimationFrame?this._run():this.async=!1}_run(){this.window.requestAnimationFrame(()=>{this.readCallbacks.forEach(t=>{t()||this.readCallbacks.delete(t)}),this.writeCallbacks.forEach(t=>{t()||this.writeCallbacks.delete(t)}),this._run()})}onread(t,i=!1){if(i)return new Promise((n,s)=>{this.async===!1?t(n,s):this.readCallbacks.add(()=>{t(n,s)})});this.async===!1?t():this.readCallbacks.add(t)}onwrite(t,i=!1){if(i)return new Promise((n,s)=>{this.async===!1?t(n,s):this.writeCallbacks.add(()=>{t(n,s)})});this.async===!1?t():this.writeCallbacks.add(t)}cycle(t,i,n){this.onread(()=>{let s=t(n),o=u=>{u!==void 0&&this.onwrite(()=>{let l=i(u,n),f=p=>{p!==void 0&&this.cycle(t,i,p)};l instanceof Promise?l.then(f):f(l)})};s instanceof Promise?s.then(o):o(s)})}};function mt(){Dt.call(this),Lt.call(this),Rt.call(this)}function Dt(){let r=this;r.CSS||(r.CSS={}),r.CSS.escape||(r.CSS.escape=e=>e.replace(/([\:@\~\$\&])/g,"\\$1"))}function Lt(){let r=this;"isConnected"in r.Node.prototype||Object.defineProperty(r.Node.prototype,"isConnected",{get:function(){return!this.ownerDocument||!(this.ownerDocument.compareDocumentPosition(this)&this.DOCUMENT_POSITION_DISCONNECTED)}})}function Rt(){let r=this;r.Element.prototype.matches||(r.Element.prototype.matches=r.Element.prototype.matchesSelector||r.Element.prototype.mozMatchesSelector||r.Element.prototype.msMatchesSelector||r.Element.prototype.oMatchesSelector||r.Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),i=t.length;--i>=0&&t.item(i)!==this;);return i>-1})}function dt(){let r=this;if(r.wq||(r.wq={}),r.wq.dom)return r.wq.dom;r.wq.dom={},mt.call(r);let e=pt(r);r.wq.dom.Reflow=new e;let t=at(r);return r.wq.dom.Realtime=new t,r.wq.dom.ready=$t.bind(r),r.wq.dom.meta=Wt.bind(r),r.wq.dom}function $t(r){let e=this;e.document.readyState==="complete"?r(e):(e.document.domReadyCallbacks||(e.document.domReadyCallbacks=[],e.document.addEventListener("DOMContentLoaded",()=>{e.document.domReadyCallbacks.splice(0).forEach(t=>t(e))},!1)),e.document.domReadyCallbacks.push(r))}function Wt(r,e=!1){let t=this,i={content:{}};return!(i.el=t.document.querySelector(`meta[name="${r}"]`))&&e&&(i.el=t.document.createElement("meta"),i.el.setAttribute("name",r),t.document.head.append(i.el)),i.el&&(i.content=(i.el.getAttribute("content")||"").split(";").filter(n=>n).reduce((n,s)=>{let o=s.split("=").map(u=>u.trim());return Ve(n,o[0].split("."),o[1]==="true"?!0:o[1]==="false"?!1:A(o[1])?parseInt(o[1]):o[1]),n},{})),i.get=function(n){return JSON.parse(JSON.stringify(te(this.content,n.split("."))))},i.copy=function(){return JSON.parse(JSON.stringify(this.content))},i.copyWithDefaults=function(...n){return n.length?W(!0,{},...n.reverse().concat(this.content)):this.copy()},i}function ht(r={}){return{runtimeParams:{...Vt,...r.runtimeParams||{}},compilerParams:{...Ht,...r.compilerParams||{}},parserParams:{...Bt,...r.parserParams||{}}}}var Bt={ecmaVersion:"2020",allowReturnOutsideFunction:!0,allowAwaitOutsideFunction:!0,allowSuperOutsideMethod:!0,preserveParens:!1,locations:!1},Ht={globalsNoObserve:["globalThis","arguments","console"],originalSource:!0,globalsOnlyPaths:!1,locations:!0,compact:2},Vt={apiVersion:1};function gt(r,e=!1){let t=r.split(/\n/g);if(t.length>1){for(;!t[0].trim().length;)t.shift();let i=t[e?1:0].split(/[^\s]/)[0].length;if(i)return t.map((n,s)=>{let o=n.substring(0,i);return o.trim().length?o.trim()==="}"&&s===t.length-1?"}":n:n.substring(i)}).join(`
`)}return r}var j=(r,e)=>r instanceof Promise?r.then(e):e(r);var _t=new Map;function fe(r,e,t=void 0){let i=_t.get(r);if(arguments.length>2){i||(i=new Map,_t.set(r,i)),i.set(e,t);return}return i&&i.get(e)}var B=class{constructor(e,t,i,n={},s=null,o=null){this.ownerContract=e,this.graph=t,this.callee=i,this.params=e?n:{...n,isSubscriptFunction:!0},this.exits=o||new Map,this.$thread=s||{entries:new Map,sequence:[],ownerContract:this},this.subContracts=new Map,this.observers=[],this.contract=function(u,l,f=null,p=null){if(!this.graph.subContracts[u])throw new Error(`[${this.graph.type}:${this.graph.lineage}]: Graph not found for child contract ${u}.`);let c=this.graph.subContracts[u],a={...this.params,isIterationContract:arguments.length===3,iterationId:arguments.length===3&&l,isFunctionContract:arguments.length===4,functionType:arguments.length===4&&l,isSubscriptFunction:arguments.length===4&&f,functionScope:this.params.isFunctionContract&&this.graph.lineage||this.params.functionScope};if(a.isIterationContract){let E=f,x=new B(this,c,E,a,this.$thread,this.exits),v=this.subContracts.get(u);return v||(v=new Map,this.subContracts.set(u,v)),v.has(a.iterationId)&&v.get(a.iterationId).dispose(),v.set(a.iterationId,x),x.call()}let m,d,y;if(this.subContracts.has(u)&&this.subContracts.get(u).dispose(),a.isFunctionContract){m=p;let E=()=>new B(this,c,m,a);if(a.functionType!=="FunctionDeclaration")y=this.createFunction(E);else{let x=E();a.apiVersion>1?(y=function(...v){let M=x.call(this,...v);return M=j(M,K=>[M,x.thread.bind(x),x]),x=E(),M},y.target=x):y=x}}else m=l,d=new B(this,c,m,a,this.$thread,this.exits),this.subContracts.set(u,d),y=d.call();return y}.bind(this),this.contract.memo=Object.create(null),this.ownerContract&&!["FunctionDeclaration","FunctionExpression"].includes(this.graph.type)&&(this.contract.args=this.ownerContract.contract.args),this.contract.exiting=function(u,l){if(!arguments.length)return this.exits.size;let f=this.exits.get(u)===l;return f&&this.exits.clear(),f}.bind(this),this.contract.exit=function(u,l){this.exits.set(u,l)}.bind(this),this.contract.functions=new Map,this.contract.functions.declaration=(u,l)=>{this.contract.functions.set(u,l),this.applyReflection(u,typeof l=="function"?l.target:l)}}fire(e,t,i){if(!this.ownerContract)return;let n=this.ownerContract.fire(e,t,i);return this.observers.forEach(s=>{s.contractUrl===e&&s.callback(t,i)}),n}observe(e,t){!this.params.isFunctionContract||this.observers.push({contractUrl:e,callback:t})}call(e,...t){if(this.disposed)throw new Error(`[${this.graph.type}:${this.graph.lineage}]: Instance not runable after having been disposed.`);this.ownerContract||(this.contract.args=t,Object.defineProperty(this.contract.args,Symbol.toStringTag,{value:"Arguments"}));let i=this.callee.call(e,this.contract,...t);if(this.graph.$sideEffects)for(let n in this.graph.effects)for(let s of this.graph.effects[n].refs)this.buildThread([],s,[],0,!0);return j(i,()=>{if(!this.ownerContract||this.params.isFunctionContract){let n=this.exits.get("return");if(this.exits.clear(),n!==void 0)return n}return i})}iterate(e=[]){if(this.disposed)return!1;if(!["ForOfStatement","ForInStatement"].includes(this.graph.type)||this.subContracts.size!==1)throw new Error(`Contract ${this.graph.lineage} is not an iterator.`);let[[,t]]=this.subContracts,i;if(!e.length||e.includes("length")&&this.graph.type==="ForOfStatement")for(let[,n]of t)i=j(i,()=>n.call());else for(let n of e){let s=t.get(n)||t.get(parseInt(n));!s||(i=j(i,()=>s.call()))}return i}thread(...e){if(this.disposed)return!1;this.$thread.active=!0;for(let t in this.graph.effects)for(let i of this.graph.effects[t].refs)for(let n of e){let[s,o,u]=this.matchRefs(n,i);!s||this.buildThread(n,i,u,o)}return this.runThread()}runThread(){let e=(s,o)=>{if(["ForOfStatement","ForInStatement"].includes(s.graph.type)&&o.every(u=>u.executionPlan.isIterationContractTarget)){let u=o.map(l=>l.executionPlan.iterationTarget);return this.fire(s.graph.lineage,"iterating",o),s.iterate(u)}return this.fire(s.graph.lineage,"executing",o),s.call()},t,i,n;for(;(i=this.$thread.sequence.shift())&&(n=[...this.$thread.entries.get(i)])&&this.$thread.entries.delete(i);)t=j(t,()=>{if(i.disposed||!i.filterRefs(n).length)return;this.$thread.current=i;let s=e(i,n);return j(s,()=>{for(let o of n)[].concat(o.executionPlan.assigneeRef||o.executionPlan.assigneeRefs||[]).forEach(u=>{i.buildThread([],u,[],0)})}),s});return j(t,()=>{let s=this.exits.get("return");return this.exits.clear(),this.$thread.current=null,this.$thread.active=!1,s})}buildThread(e,t,i,n=0,s=!1){let o=n>0;if(this.ownerContract){if(!this.compute(i)||t.condition!==void 0&&!this.assert(t.condition))return}else o||(o=i.length||t.condition!==void 0);let u=s?t.$subscriptions:t.subscriptions;Object.keys(u).forEach(l=>{let[f,p]=l.split(":"),c=m=>{!m||m.selectRefs(p,u[l],o?e:null)},a=this.locate(f);Array.isArray(a)?a.forEach(c):c(a)})}selectRefs(e,t,i=null){let n=this.$thread,s=this.graph.signals[e],o=(l,f)=>l.graph.lineage.localeCompare(f.graph.lineage,void 0,{numeric:!0}),u=(l,f=[],p={})=>{if(!n.active||n.current&&o(this,n.current)<0)return;let c=n.entries.get(this);if(c||(c=new Set,n.entries.set(this,c),n.sequence.push(this),n.sequence.sort(o)),c.add({...l,computes:f,executionPlan:p}),!p.assigneeRef&&["VariableDeclaration","AssignmentExpression"].includes(this.graph.type)){p.assigneeRefs=[];for(let a in this.graph.effects)p.assigneeRefs.push(...this.graph.effects[a].refs)}};for(let l of t){let f=s.refs[l];if(!i){u(f);continue}let[p,c,a]=this.matchRefs(i,f);if(!p)continue;if(c<=0){u(f,a);continue}let m=i.slice(-c),d="assignee"in s?this.graph.effects[s.assignee]:null;if(d){d.refs.forEach(y=>{if(y.depth.length){let[E,x,v]=this.matchRefs(m,y.depth),M=a.concat(v);if(E&&x>0){let K=y.path.concat(m.slice(-x));this.buildThread(K,y,M,x)}else E&&u(f,M,{assigneeRef:y})}else{let E=y.path.concat(m);this.buildThread(E,y,a,c)}});continue}if(c===1&&this.graph.type==="ForOfStatement"){u(f,a,{isIterationContractTarget:!0,iterationTarget:m[0]});continue}if(c===1&&this.graph.type==="ForInStatement"){u(f,a,{isIterationContractTarget:!0,iterationTarget:m[0]});continue}}}filterRefs(e){return e.filter(t=>{if(!!this.compute(t.computes)&&!(t.condition!==void 0&&!this.assert(t.condition)))return!0})}matchRefs(e,t){let i,n,s,o;Array.isArray(e)?(i=e,n=e.dotSafe?e.join("."):void 0):(i=e.path,n=e.$path),Array.isArray(t)?(s=t,o=t.dotSafe?t.join("."):void 0):(s=t.path,o=t.$path);let u=i.length-s.length;if(u>0&&([i,s,n,o]=[s,i,o,n]),n&&o)return[`${o}.`.startsWith(`${n}.`),u,[]];let l=[],f=c=>typeof c=="object"?c.name:c,p=(c,a)=>{if(!c||!a)return!1;let m=typeof c=="object"&&"memoId"in c,d=typeof a=="object"&&"memoId"in a;return m||d?(l.push(y=>(m?y[c.memoId]:f(c))===(d?y[a.memoId]:f(a))),!0):f(c)===f(a)};return[i.reduce((c,a,m)=>c&&p(a,s[m]),!0),u,l]}locate(e){let t=this.graph.lineage+"/",i=e+"/";if(i===t)return this;if(i.startsWith(t)){let n=e.slice(t.length).split("/"),s=this.subContracts.get(parseInt(n.shift()));if(n.length){if(s instanceof Map)return Array.from(s).reduce((o,[u,l])=>o.concat(l.locate(e)),[]);if(s)return s.locate(e)}return s}if(this.ownerContract)return this.ownerContract.locate(e)}compute(e){return!e.some(t=>t(this.contract.memo)===!1)}assert(e){if(typeof e=="string"&&e.includes(":")){let[n,s]=e.split(":");return this.locate(n).assert(s)}let t=this.graph.conditions[e],i=this.contract.memo;return typeof t.parent<"u"&&!this.assert(t.parent)?!1:typeof t.switch<"u"?t.cases.some(n=>i[n]===i[t.switch]):typeof t.whenNot<"u"?!i[t.whenNot]:typeof t.when<"u"?i[t.when]:!0}dispose(){this.params.isFunctionContract||(this.subContracts.forEach((e,t)=>{e instanceof Map?(e.forEach(i=>i.dispose()),e.clear()):e.dispose()}),this.subContracts.clear(),delete this.ownerContract,delete this.callee,delete this.params,delete this.contract.memo,this.disposed=!0)}createFunction(e,t=void 0){let i=e(),n=function(o,...u){let l=o.call(this===void 0?t:this,...u);return o.params.isSubscriptFunction&&o.params.apiVersion>1&&(l=j(l,f=>[f,o.thread.bind(o),o]),i=e(i)),l},s=i instanceof Promise||i.callee instanceof async function(){}.constructor?async function(){return j(i,o=>n.call(this,o,...arguments))}:function(){return n.call(this,i,...arguments)};return j(i,o=>{this.applyReflection(s,o)}),fe(s,"properties",j(i,o=>{let u={type:o.params.functionType||"Program",isSubscriptFunction:o.params.isSubscriptFunction,sideEffects:o.graph.sideEffects||!1};if(o.params.isSubscriptFunction){u.dependencies=[];for(let[l,f]of Object.entries(o.graph.effects))u.dependencies.push(...f.refs.map(p=>p.path.map(c=>c.name)))}return u})),s}applyReflection(e,t){Object.defineProperty(t.callee,"length",{configurable:!0,value:t.callee.length-1});let i=t.callee.toString();Object.defineProperty(t.callee,"toString",{configurable:!0,value:(s=!1)=>!s&&t.graph.originalSource?t.graph.originalSource:i});let n={name:t.callee.name,length:t.callee.length,toString:t.callee.toString};t.params.isSubscriptFunction&&(t.params.apiVersion>1||(n={...n,thread:t.thread.bind(t),dispose:t.dispose.bind(t),runtime:t})),Object.keys(n).forEach(s=>{Object.defineProperty(e,s,{configurable:!0,value:n[s]})})}};var he=class extends B{static create(e,t=[],i={}){let s=i.async||e.graph.hoistedAwaitKeyword?Object.getPrototypeOf(async function(){}).constructor:Function,o=i.compileFunction?i.compileFunction(e.source,[e.identifier+""].concat(t)):new s(e.identifier+"",...t,e.source);return new this(null,e.graph,o,i)}static createFunction(e,t,i=[],n={},s,o=null){n={...n,functionType:"Constructor"},t instanceof Promise&&(n={...n,async:!0});let u=p=>p?new this(null,p.graph,p.callee,n):j(t,c=>l(this.create(c,i,n))),l=p=>{if(p.graph.originalSource&&!p.graph.originalSourceModified){let c=`${n.async||p.graph.hoistedAwaitKeyword?"async ":""}function ${e||"anonymous"}`,a=p.graph.originalSource.split(/\n/g).map(m=>`    ${m}`).join(`
`);p.graph.originalSource=`${c}(${i.join(", ")}) {
${a}
}`,p.graph.originalSourceModified=!0}return e&&Object.defineProperty(p.callee,"name",{configurable:!0,value:e}),p},f=this.prototype.createFunction(u,s);return fe(f,"locations",j(t,p=>({locations:p.locations}))),f}};function Ie(...r){if(typeof window!="object")throw new Error("No window in context.");let e=ht(typeof r[r.length-1]=="object"?r.pop():{}),t=gt(r.pop()||""),i=r,n=s=>he.createFunction(void 0,s,i,e.runtimeParams,this,t);if(window.wq?.SubscriptCompiler&&!e.runtimeParams.async){let{parse:s,compile:o}=window.wq.SubscriptCompiler,u=s(t,e.parserParams);return n(o(u,e.compilerParams))}if(!window.wq?.SubscriptCompilerWorker){let u=`
        importScripts( '${document.querySelector('meta[name="subscript-compiler-url"]')?.content||"https://unpkg.com/@webqit/subscript/dist/compiler.js"}' );
        const { parse, compile } = self.wq.SubscriptCompiler;
        self.onmessage = e => {
            const { source, params } = e.data;
            const ast = parse( source, params.parserParams );
            const compilation = compile( ast, params.compilerParams );
            compilation.identifier = compilation.identifier.toString();
            e.ports[ 0 ]?.postMessage( compilation );
        };`;window.wq=window.wq||{},window.wq.SubscriptCompilerWorker=new Worker(`data:text/javascript;base64,${btoa(u)}`)}return n(new Promise(s=>{let o=new MessageChannel;wq.SubscriptCompilerWorker.postMessage({source:t,params:e},[o.port2]),o.port1.onmessage=u=>s(u.data)}))}Object.defineProperty(Ie,"inspect",{value:fe});function Qe(r={}){let e=this,i=dt.call(e).meta("oohtml").copyWithDefaults(r,{selectors:{script:'script[type="subscript"]'},retention:"retain"});zt.call(this,i)}function zt(r){let e=this,{dom:t}=e.wq;e.wq.transformCache=new Map,e.wq.compileCache=[new Map,new Map];let i=()=>{};t.Realtime.intercept(e.document,"script[scoped],script[contract]",n=>{n.incomingNodes.forEach(s=>{if("contract"in s||(Object.defineProperty(s,"contract",{value:s.hasAttribute("contract")}),"scoped"in s))return i(s);Object.defineProperty(s,"scoped",{value:s.hasAttribute("scoped")});let o=s.scoped?n.target:s.type==="module"?void 0:e;Qt.call(this,s,o,r)})},{subtree:!0,on:"connected"}),e.wq.exec=n=>{let s=Yt(n);if(!s)throw new Error("Argument must be a valid exec hash.");let{script:o,compiledScript:u,thisContext:l}=s;switch(l instanceof e.Element&&o.scoped&&(l.scripts||Object.defineProperty(l,"scripts",{value:new Set}),l.scripts.add(o)),r.retention){case"dispose":o.remove();break;case"hidden":o.textContent='"hidden"';break;default:o.textContent=u.function.originalSource}return Ut.call(this,u,l,o)}}function Ut(r,e,t){if(!r.function)throw new Error("Input script must already be compiled!");let i=r.function.call(e);r.contract&&Object.defineProperty(t,"sync",{value:(...u)=>Xt(i,([,l])=>l(...u))});let n=this,{dom:s}=n.wq;if(!(e instanceof n.EventTarget))return i;let o;return t.contract&&(o=u=>{t.sync()},e.addEventListener("namespacechange",o),e.addEventListener("statechange",o)),s.Realtime.intercept(n.document,e,()=>{t.contract&&(e.removeEventListener("namespacechange",o),e.removeEventListener("statechange",o)),e.dispatchEvent(new n.CustomEvent("beforeremove")),e.scripts.delete(t)},{subtree:!0,on:"disconnected"}),t}function Qt(r,e,t={}){let i=this.wq,n=i.compileCache[r.contract?0:1],s=yt(r.textContent),o=r.textContent,u;if(!(u=n.get(s))){let f=[],p={},c=[];r.type==="module"&&c.push("import "),r.type==="module"&&!r.contract&&c.push("await "),c.length&&new RegExp(c.join("|")).test(o)&&([f,o,p]=Gt(o),f.length&&(o=`
	${Jt(f).join(`
	`)}
	${o}
`));let a;if(r.contract){let m={...t.parserParams||{},allowReturnOutsideFunction:!1,allowAwaitOutsideFunction:r.type==="module",allowSuperOutsideMethod:!1},d={...t.runtimeParams||{},async:r.type==="module",apiVersion:2};a=Ie(o,{...t,parserParams:m,runtimeParams:d})}else{let d=r.type==="module"?Object.getPrototypeOf(async function(){}).constructor:Function;a=t.runtimeParams?.compileFunction?t.runtimeParams.compileFunction(o):new d(o),Object.defineProperty(a,"originalSource",{configurable:!0,value:r.textContent})}u=Object.defineProperty(r.cloneNode(),"function",{value:a}),r.scoped&&Object.defineProperty(u,"scoped",Object.getOwnPropertyDescriptor(r,"scoped")),r.contract&&Object.defineProperty(u,"contract",Object.getOwnPropertyDescriptor(r,"contract")),n.set(s,u)}let l=yt({script:r,compiledScript:u,thisContext:e});r.textContent=`wq.exec('${l}');`}function Gt(r){let[e,t]=bt(r,(o,u,l,f,p,c)=>{if(u==="start-enclosure"&&l==="{"&&!f.openAsync?.type&&f.openEnclosures.length===f.openAsync?.scopeId)f.openAsync.type="block";else if(u==="end-enclosure"&&l==="}"&&f.openAsync?.type==="block"&&f.openEnclosures.length===f.openAsync.scopeId)f.openAsync=null;else if(u==="start-quote"&&!f.openEnclosures.length&&["starting","from"].includes(f.openImport))f.openImport="url";else if(u==="end-quote"&&f.openImport==="url")f.openImport="closing";else if(u==="char"){if(f.openImport==="closing"&&(l===";"||![" ",`
`].includes(l)||c))return l===";"||c?(o[0]+=l,o.unshift("")):o.unshift(l),f.openImport=null,!1;let a=r.substring(p-1);if(!f.openImport&&/^[\W]?import[ ]*[^\(]/.test(a))return f.openImport="starting",o.unshift(""),6;if(f.openImport==="starting"&&/^[\W]?from /.test(a))return f.openImport="from",4;if(!f.openAsync){if(/^[\W]?async /.test(a))return f.openAsync={scopeId:f.openEnclosures.length},5;if(/^[\W]?await /.test(a))return f.topLevelAwait=!0,5}f.openAsync&&(!f.openAsync.type&&/.?\=\>[ ]*?\{/.test(a)?f.openAsync.type="inline-arrow":f.openAsync.type==="inline-arrow"&&[`
`,";"].includes(l)&&f.openEnclosures.length===f.openAsync.scopeId&&(f.openAsync=null))}}),i=[],n="",s;for(let o of e.reverse())(s=o.trim()).startsWith("import ")?i.push(o):s&&(n+=o);return[i,n,t]}function Jt(r){let e=[],t=[];return r.forEach((i,n)=>{i=Kt(i);let[s,o]=i.items.reduce(([u,l],f)=>f.id==="*"?[f.alias,l]:[u,l.concat(f)],[null,[]]);if(s&&e.push(`const ${s} = __$imports$__[${n}];`),o.length){let u=o.map(l=>`${l.id}${l.id!==l.alias?`: ${l.alias}`:""}`).join(", ");e.push(`const { ${u} } = __$imports$__[${n}];`)}t.push(`import("${i.url}")`)}),[`
	const __$imports$__ = await Promise.all([
		${t.join(`,
		`)}
	]);`,e.join(`
	`)]}function Kt(r){let e=n=>{let s=/^[`'"]/.exec(n);return s&&n.substring(1,n.lastIndexOf(s[0]))},t={items:[{id:""}]},i=r.replace("import","").trim();return(t.url=e(i))||bt(i,(n,s,o,u,l,f)=>{if(["start-quote","ongoing-quote","end-quote","char"].includes(s)){if(t.url)return;if(!u.openQuote){let p=i.substring(l);if(o===","){t.items.unshift({id:""});return}if(p.startsWith(" as "))return t.items[0].alias="",3;if(p.startsWith(" from "))return t.url=e(p.replace("from","").trim()),p.length}"alias"in t.items[0]?t.items[0].alias+=o:(t.items[0].id+=o,u.openEnclosures.length&&(t.items[0].enclosed=!0))}}),t.items=t.items.map(n=>({id:n.id&&!n.alias&&!n.enclosed?"default":n.id.trim(),alias:n.alias?n.alias.trim():n.id.trim()})).filter(n=>n.id).reverse(),t}function bt(r,e){let t=r.length-1;return[...r].reduce(([i,n,s],o,u)=>{if(s)return i[0]+=o,[i,n,--s];let l;if(n.openQuote||n.openComment)return o===n.openQuote?(n.openQuote=null,l=e(i,"end-quote",o,n,u,u===t)):n.openQuote?l=e(i,"ongoing-quote",o,n,u,u===t):n.openComment&&(n.openComment==="//"&&o===`
`||n.openComment==="/*"&&i[0].substr(-1)==="*"&&o==="/")&&(n.openComment=null,l=e(i,"end-comment",o,n,u,u===t)),l!==!1&&(i[0]+=o),[i,n,typeof l=="number"?l:s];let f;return(f=["()","{}","[]"].filter(p=>o===p[0])[0])?(l=e(i,"start-enclosure",o,n,u,u===t),n.openEnclosures.unshift(f)):n.openEnclosures.length&&o===n.openEnclosures[0][1]?(n.openEnclosures.shift(),l=e(i,"end-enclosure",o,n,u,u===t)):['"',"'","`"].includes(o)?(l=e(i,"start-quote",o,n,u,u===t),n.openQuote=o):!n.openComment&&["/*","//"].includes(r.substr(u,2))?(l=e(i,"start-comment",o,n,u,u===t),n.openComment=r.substr(u,2)):l=e(i,"char",o,n,u,u===t),l!==!1&&(i[0]+=o),[i,n,typeof l=="number"?l:s]},[[""],{openEnclosures:[]},0])}var Ue=new Map,Zt=()=>(0|Math.random()*9e6).toString(36),Xt=(r,e)=>r instanceof Promise?r.then(e):e(r);function yt(r){let e;return(e=Ue.get(r))||(e=Zt(),Ue.set(r,e)),e}function Yt(r){let e;return Ue.forEach((t,i)=>{t===r&&(e=i)}),e}function Ge(r={}){this.wq||(this.wq={}),!this.wq.oohtml&&(this.wq.Observer=ut,Qe.call(this,r.ScopedJS||{}),this.wq.oohtml={})}Ge.call(window);})();
//# sourceMappingURL=main.js.map
