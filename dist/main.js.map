{
  "version": 3,
  "sources": ["../node_modules/@webqit/util/js/isObject.js", "../node_modules/@webqit/util/js/getType.js", "../node_modules/@webqit/util/js/internals.js", "../node_modules/@webqit/util/js/isArray.js", "../node_modules/@webqit/util/js/isTypeFunction.js", "../node_modules/@webqit/util/js/isClass.js", "../node_modules/@webqit/util/js/isNull.js", "../node_modules/@webqit/util/js/isUndefined.js", "../node_modules/@webqit/util/js/isTypeObject.js", "../node_modules/@webqit/util/js/isEmpty.js", "../node_modules/@webqit/util/js/isFunction.js", "../node_modules/@webqit/util/js/isNumber.js", "../node_modules/@webqit/util/js/isNumeric.js", "../node_modules/@webqit/util/js/isString.js", "../node_modules/@webqit/util/js/isTypeArray.js", "../node_modules/@webqit/util/arr/first.js", "../node_modules/@webqit/util/arr/last.js", "../node_modules/@webqit/util/arr/pushUnique.js", "../node_modules/@webqit/util/obj/getPrototypeChain.js", "../node_modules/@webqit/util/obj/getAllPropertyNames.js", "../node_modules/@webqit/util/obj/mergeCallback.js", "../node_modules/@webqit/util/obj/each.js", "../node_modules/@webqit/util/obj/merge.js", "../node_modules/@webqit/util/arr/indexOfSet.js", "../node_modules/@webqit/util/arr/after.js", "../node_modules/@webqit/util/arr/any.js", "../node_modules/@webqit/util/arr/from.js", "../node_modules/@webqit/util/arr/equals.js", "../node_modules/@webqit/util/arr/intersect.js", "../node_modules/@webqit/util/arr/startsWith.js", "../node_modules/@webqit/util/arr/unique.js", "../node_modules/@webqit/observer/src/core/utils.js", "../node_modules/@webqit/observer/src/core/Firebase.js", "../node_modules/@webqit/observer/src/core/Fireable.js", "../node_modules/@webqit/observer/src/core/Interceptor.js", "../node_modules/@webqit/util/obj/copy.js", "../node_modules/@webqit/util/obj/get.js", "../node_modules/@webqit/util/obj/set.js", "../node_modules/@webqit/observer/src/core/Action.js", "../node_modules/@webqit/observer/src/core/Interceptors.js", "../node_modules/@webqit/observer/src/actors/unproxy.js", "../node_modules/@webqit/observer/src/actions/_exec.js", "../node_modules/@webqit/observer/src/actions/apply.js", "../node_modules/@webqit/observer/src/actions/construct.js", "../node_modules/@webqit/observer/src/core/Event.js", "../node_modules/@webqit/observer/src/core/Observer.js", "../node_modules/@webqit/observer/src/core/Mutation.js", "../node_modules/@webqit/observer/src/core/Observers.js", "../node_modules/@webqit/observer/src/actions/get.js", "../node_modules/@webqit/observer/src/reactions/observe.js", "../node_modules/@webqit/observer/src/connectors/link.js", "../node_modules/@webqit/observer/src/connectors/build.js", "../node_modules/@webqit/observer/src/reactions/unobserve.js", "../node_modules/@webqit/observer/src/connectors/unlink.js", "../node_modules/@webqit/observer/src/actions/has.js", "../node_modules/@webqit/observer/src/actions/_setOrDefine.js", "../node_modules/@webqit/observer/src/actions/defineProperty.js", "../node_modules/@webqit/observer/src/actions/deleteProperty.js", "../node_modules/@webqit/observer/src/actions/getOwnPropertyDescriptor.js", "../node_modules/@webqit/observer/src/actions/getPrototypeOf.js", "../node_modules/@webqit/observer/src/actions/isExtensible.js", "../node_modules/@webqit/observer/src/actions/ownKeys.js", "../node_modules/@webqit/observer/src/actions/preventExtensions.js", "../node_modules/@webqit/observer/src/actions/set.js", "../node_modules/@webqit/observer/src/actions/setPrototypeOf.js", "../node_modules/@webqit/observer/src/actors/accessorize.js", "../node_modules/@webqit/observer/src/actors/unaccessorize.js", "../node_modules/@webqit/observer/src/actors/proxy.js", "../node_modules/@webqit/observer/src/reactions/intercept.js", "../node_modules/@webqit/observer/src/reactions/unintercept.js", "../node_modules/@webqit/observer/src/reactions/closure.js", "../node_modules/@webqit/observer/src/index.js", "../node_modules/@webqit/dom/src/Realtime.js", "../node_modules/@webqit/dom/src/Reflow.js", "../node_modules/@webqit/dom/src/polyfills.js", "../node_modules/@webqit/dom/src/index.js", "../../subscript/src/params.js", "../../subscript/src/util.js", "../../subscript/src/runtime/inspect.js", "../../subscript/src/runtime/Contract.js", "../../subscript/src/runtime/Runtime.js", "../../subscript/src/SubscriptFunctionLite.js", "../src/scoped-js/index.js", "../src/index.js", "../src/targets.browser.js"],
  "sourcesContent": ["\n/**\n * Tells if val is pure object.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn !Array.isArray(val) && typeof val === 'object' && val;\n};\n", "\n/**\n * Returns the val's type.\n *\n * @param string \tval\n *\n * @return string\n */\nexport default function(val) {\n\treturn typeof val;\n};\n", "\n/**\n * Creates and/or returns an \"internals\" object for the given object.\n * \n * @param Any obj\n * @param String namespace\n * \n * @return Object\n */\nexport default function internals(obj, ...namespaces) {\n    if (!globalThis.WebQitInternalsRegistry) {\n        globalThis.WebQitInternalsRegistry = new Map;\n    }\n    var itnls = globalThis.WebQitInternalsRegistry.get(obj);\n    if (!itnls) {\n        itnls = new Map;\n        if (namespaces[0] === false) {\n            // FALSE means: Return orphan Map if not exists\n            return itnls;\n        }\n        globalThis.WebQitInternalsRegistry.set(obj, itnls);\n    }\n    var _ns, _itnls;\n    while ((_ns = namespaces.shift())) {\n        if ((_itnls = itnls) && !(itnls = itnls.get(_ns))) {\n            itnls = new Map;\n            if (namespaces[0] === false) {\n                // FALSE means: Return orphan Map if not exists\n                return itnls;\n            }\n            _itnls.set(_ns, itnls);\n        }\n    }\n    return itnls;\n}", "\n/**\n * Tells if val is of type \"array\".\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn Array.isArray(val);\n};\n", "\n/**\n * Tells if val is of type \"function\".\n * This holds true for both regular functions and classes.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn typeof val === 'function';\n};\n", "\n/**\n * @imports\n */\nimport _isTypeFunction from './isTypeFunction.js';\n\n/**\n * Tells if val is of type \"class\".\n *\n * @param object \t\tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isTypeFunction(val) && /^class\\s?/.test(Function.prototype.toString.call(val));\n};\n", "\n/**\n * Tells if val is undefined or is null.\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn val === null || val === '';\n};\n", "\n/**\n * Tells if val is undefined or is of type \"undefined\".\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn arguments.length && (val === undefined || typeof val === 'undefined');\n};\n", "\n/**\n * @imports\n */\nimport _isTypeFunction from './isTypeFunction.js';\n\n/**\n * Tells if val is of type \"object\".\n * This holds true for anything object, including built-ins.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn Array.isArray(val) || (typeof val === 'object' && val) || _isTypeFunction(val);\n};\n", "\n/**\n * @imports\n */\nimport _isNull from './isNull.js';\nimport _isUndefined from './isUndefined.js';\nimport _isTypeObject from './isTypeObject.js';\n\n/**\n * Tells if val is empty in its own type.\n * This holds true for NULLs, UNDEFINED, FALSE, 0,\n * objects without keys, empty arrays.\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isNull(val) || _isUndefined(val) || val === false || val === 0 \n\t\t|| (_isTypeObject(val) && !Object.keys(val).length);\n};\n", "\n/**\n * @imports\n */\nimport _isTypeFunction from './isTypeFunction.js';\n\n/**\n * Tells if val is of type \"function\".\n *\n * @param object \t\tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isTypeFunction(val) || (val && {}.toString.call(val) === '[object function]');\n};\n", "\n/**\n * Tells if val is of type \"number\".\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn val instanceof Number || (typeof val === 'number');\n};\n", "\n/**\n * @imports\n */\nimport _isNumber from './isNumber.js';\n/**\n * Tells if val is of type \"string\" or a numeric string.\n * This holds true for both numbers and numeric strings.\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isNumber(val) || (val !== true && val !== false && val !== null && val !== '' && !isNaN(val * 1));\n};\n", "\n/**\n * Tells if val is of type \"string\".\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn val instanceof String || (typeof val === 'string' && val !== null);\n};\n", "\n/**\n * @imports\n */\nimport _isString from './isString.js';\nimport _isUndefined from './isUndefined.js';\n\n/**\n * Tells if val is \"array-like\".\n * This holds true for anything that has a length property.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn !_isString(val) && !_isUndefined(val.length);\n};\n", "\n/**\n * Returns THE FIRST ENTRY OR A NUMBER OF ENTRIES counting forward from the begining.\n *\n * @param array \tarr\n * @param int\t \tamount\n *\n * @return mixed|array\n */\nexport default function(arr, amount = 1) {\n\tvar count = 0;\n\tarr.forEach(itm => {\n\t\tcount ++;\n\t});\n\tvar firsts = arr.slice(arr.length - count, amount);\n\treturn arguments.length > 1 ? firsts : firsts[0];\n};\n", "\n/**\n * @imports\n */\nimport _first from './first.js';\n\n/**\n * Returns THE LAST ENTRY OR A NUMBER OF ENTRIES counting forward to the end.\n *\n * @param array \tarr\n * @param int\t \tamount\n *\n * @return mixed|array\n */\nexport default function(arr, amount = 1) {\n\treturn arguments.length > 1\n\t\t? _first(arr.slice().reverse(), amount).reverse()\n\t\t: _first(arr.slice().reverse());\n};\n", "\n/**\n * Adds an item if not already exist.\n *\n * @param array \tarr\n * @param array\t \t...itms\n *\n * @return array\n */\nexport default function(arr, ...items) {\n\titems.forEach(itm => {\n\t\tif (arr.indexOf(itm) < 0) {\n\t\t\tarr.push(itm);\n\t\t}\n\t});\n\treturn arr;\n};\n", "\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\n\n/**\n * Returns the prototype chain.\n *\n * @param object \t\tobj\n * @param object\t \tuntil\n *\n * @return bool\n */\nexport default function(obj, until) {\n\tuntil = until || Object.prototype;\n\tuntil = until && !_isArray(until) ? [until] : until;\n\t// We get the chain of inheritance\n\tvar prototypalChain = [];\n\tvar obj = obj;\n\twhile((obj && (!until || until.indexOf(obj) < 0) && obj.name !== 'default')) {\n\t\tprototypalChain.push(obj);\n\t\tobj = obj ? Object.getPrototypeOf(obj) : null;\n\t}\n\treturn prototypalChain;\n};\n", "\n/**\n * @imports\n */\nimport _pushUnique from '../arr/pushUnique.js';\nimport _getPrototypeChain from './getPrototypeChain.js';\n\n/**\n * Eagerly retrieves object members all down the prototype chain.\n *\n * @param object\t \tobj\n * @param object\t \tuntil\n *\n * @return array\n */\nexport default function(obj, until) {\n\tvar keysAll = [];\n\t_getPrototypeChain(obj, until).forEach(obj => {\n\t\t_pushUnique(keysAll, ...Object.getOwnPropertyNames(obj));\n\t});\n\treturn keysAll;\n};\n", "\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\nimport _isFunction from '../js/isFunction.js';\nimport _isObject from '../js/isObject.js';\nimport _isTypeObject from '../js/isTypeObject.js';\nimport _isNumeric from '../js/isNumeric.js';\nimport _getAllPropertyNames from './getAllPropertyNames.js';\n\n/**\n  * Merges values from subsequent arrays/objects first array/object;\n  * optionally recursive\n  *\n  * @param array ...objs\n  *\n  * @return void\n  */\nexport default function mergeCallback(objs, callback, deepProps = false, isReplace = false, withSymbols = false) {\n\tvar depth = 0;\n\tvar obj1 = objs.shift();\n\tif (_isNumeric(obj1) || obj1 === true || obj1 === false) {\n\t\tdepth = obj1;\n\t\tobj1 = objs.shift();\n\t}\n\tif (!objs.length) {\n\t\tthrow new Error('_merge() requires two or more array/objects.');\n\t}\n\tobjs.forEach((obj2, i) => {\n\t\tif (!_isTypeObject(obj2) && !_isFunction(obj2)) {\n\t\t\treturn;\n\t\t}\n\t\t(deepProps ? _getAllPropertyNames(obj2) : Object.getOwnPropertyNames(obj2)).forEach(key => {\n\t\t\tif (!callback(key, obj1, obj2, i)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar valAtObj1 = obj1[key];\n\t\t\tvar valAtObj2 = obj2[key];\n\t\t\tif (((_isArray(valAtObj1) && _isArray(valAtObj2)) || (_isObject(valAtObj1) && _isObject(valAtObj2))) \n\t\t\t&& (depth === true || depth > 0)) {\n\t\t\t\t// RECURSE...\n\t\t\t\tobj1[key] = _isArray(valAtObj1) && _isArray(valAtObj2) ? [] : {};\n\t\t\t\tmergeCallback([_isNumeric(depth) ? depth - 1 : depth, obj1[key], valAtObj1, valAtObj2], callback, deepProps, isReplace, withSymbols);\n\t\t\t} else {\n\t\t\t\tif (_isArray(obj1) && _isArray(obj2)) {\n\t\t\t\t\tif (isReplace) {\n\t\t\t\t\t\tobj1[key] = valAtObj2;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tobj1.push(valAtObj2);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// In case we're setting a read-only property\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (withSymbols) {\n\t\t\t\t\t\t\tObject.defineProperty(obj1, key, Object.getOwnPropertyDescriptor(obj2, key));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tobj1[key] = obj2[key];\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\treturn obj1;\n};\n", "\n/**\n * @imports\n */\nimport _isTypeObject from '../js/isTypeObject.js';\nimport _isNumeric from '../js/isNumeric.js';\n\n/**\n * Loops thru obj flatly with a callback function.\n * Stops when callback returns a non-undefined value.\n *\n * @param array|object \t\t\tobj \t\t\tThe array or object to iterate.\n * @param function \t\t\t\tcallback \t\tThe callback function.\n *\n * @return mixed|null\t\t\tAny non-null return from callback\n */\nexport default function(obj, callback) {\n\tvar returnValue = undefined;\n\tif (_isTypeObject(obj)) {\n\t\tObject.keys(obj).forEach((k, i) => {\n\t\t\tif (returnValue !== false) {\n\t\t\t\treturnValue = callback(_isNumeric(k) ? parseFloat(k) : k, obj[k], i);\n\t\t\t}\n\t\t});\n\t}\n\treturn returnValue;\n};\n", "\n/**\n * @imports\n */\nimport _mergeCallback from './mergeCallback.js';\n\n/**\n  * Merges values from subsequent arrays/objects first array/object;\n  * optionally recursive\n  *\n  * @param array ...objs\n  *\n  * @return void\n  */\nexport default function(...objs) {\n\treturn _mergeCallback(objs, (k, obj1, obj2) => {\n\t\treturn true;\n\t}, false/*deepProps*/, false/*isReplace*/, false/*withSymbols*/);\n};\n", "\n/**\n * Returns the index of subset array \"b\" in array \"a\".\n * \n * @param {Array} a \n * @param {Array} b \n * @param {Int} fromInex \n * @param {Bool} last\n * \n * @returns Int\n */\nexport default function indexOfSet(a, b, fromInex = null, last = false) {\n    if (b.length > a.length) return -1;\n\treturn (typeof fromInex === 'number' ? (last ? a.slice(0, (fromInex + 1) + (fromInex < 0 ? a.length : 0)) : a.slice(fromInex)) : a).reduce((cursors, value, i) => {\n        var [ index, cursorA, cursorB ] = cursors;\n        if (!last && index > -1) {\n            return [index, cursorA, cursorB];\n        }\n        var _cursorB = cursorB + 1;\n        var _cursors = value === b[_cursorB] ? (_cursorB === 0 ? [i, 0] : [cursorA, _cursorB]) : [-1, -1];\n        if (_cursors[1] === b.length - 1) {\n            // Reset B cursor\n            _cursors[1] = -1;\n            if (_cursors[0] > -1) {\n                return [_cursors[0]].concat(_cursors);\n            }\n        }\n        return [index].concat(_cursors);\n    }, [-1, -1, -1])[0] + (last || typeof fromInex !== 'number' ? 0 : (fromInex > -1 ? fromInex : a.length - fromInex));\n}", "\n/**\n * @imports\n */\nimport _after from '../str/after.js';\nimport _indexOfSet from './indexOfSet.js';\n\n/**\n * Returns members of array \"a\" after the array \"b\" subset.\n *\n * @param {Array} a \n * @param {Array} b \n * @param {Int} fromInex \n * @param {Bool} last \n * \n * @returns Bool\n */\nexport default function after(a, b, fromInex = null, last = false) {\n\tvar subsetIndex = _indexOfSet(a, b, fromInex, last);\n\treturn subsetIndex === -1 ? [] : a.slice(subsetIndex + b.length);\n}", "\n/**\n * Tells if ANY items pass the test.\n *\n * @param array \tarr\n * @param function \tcallback\n *\n * @return bool\n */\nexport default function(arr, callback) {\n\treturn arr.reduce((prevTest, itm, i) => prevTest || callback(itm, i), false);\n};\n", "\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\nimport _isTypeArray from '../js/isTypeArray.js';\nimport _isEmpty from '../js/isEmpty.js';\nimport _isObject from '../js/isObject.js';\n\n/**\n * Casts an array-like object to an array.\n *\n * @param mixed \tval\n * @param bool\t \tcastObject\n *\n * @return array\n */\nexport default function(val, castObject = true) {\n\tif (_isArray(val)) {\n\t\treturn val;\n\t};\n\tif (!castObject && _isObject(val)) {\n\t\treturn [val];\n\t};\n\tif (val !== false && val !== 0 && _isEmpty(val)) {\n\t\treturn [];\n\t};\n\tif (_isTypeArray(val)) {\n\t\treturn Array.prototype.slice.call(val);\n\t};\n\tif (_isObject(val)) {\n\t\treturn Object.values(val);\n\t};\n\treturn [val];\n};\n", "\n/**\n * Tells if two arrays are shallow equals.\n * \n * @param {Array} a \n * @param {Array} b \n * @param {Bool} dotSafe\n * \n * @returns Bool\n */\nexport default function equals(a, b, dotSafe = null) {\n\treturn dotSafe || (dotSafe !== false && a.dotSafe && b.dotSafe) \n\t\t? a.join('.') === b.join('.') \n\t\t: a.length === b.length && a.reduce((prev, value, i) => prev && value === b[i], true);\n}", "\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\n\n/**\n * Returns the intersection of two arrays;\n * optionally using a custom matching function.\n *\n * @param array \tarr\n * @param array\t \tarr2\n * @param function \tcallback\n *\n * @return array\n */\nexport default function(arr, arr2, callback = null) {\n\treturn !_isArray(arr2) ? [] : arr.filter(val1 => callback \n\t\t? arr2.filter(val2 => callback(val1, val2)).length \n\t\t: arr2.indexOf(val1) !== -1\n\t);\n};\n", "\n/**\n * Tells if the array \"a\" starts with array \"b\".\n *\n * @param {Array} a \n * @param {Array} b \n * @param {Bool} dotSafe \n * \n * @returns Bool\n */\nexport default function startsWith(a, b, dotSafe = null) {\n\treturn dotSafe || (dotSafe !== false && a.dotSafe && b.dotSafe) \n\t\t? (a.join('.') + '.').startsWith(b.join('.') + '.') \n\t\t: b.reduce((prev, value, i) => prev && value === a[i], true);\n}", "\n/**\n * Returns a list of unique items.\n *\n * @param array\t \t\t\t\tarr\n *\t *\n * @return array\n */\nexport default function(arr) {\n\tconst distinct = (value, index, self) => {\n\t\treturn self.indexOf(value) === index;\n\t};\n\treturn arr.filter(distinct);\n};\n", "\n/**\n * @imports\n */\nimport { _isArray } from '@webqit/util/js/index.js';\nimport { _from as _arrFrom, _all } from '@webqit/util/arr/index.js';\n\n\n/**\n *  Returns paths in 2-dimensional form.\n * \n * - key                    => [ [key] ]\n * - [key]                  => [ [key] ]\n * - [key, key2]            => [ [key, key2] ]\n * - [ [key] ]              => [ [key] ]\n * - [ [key1, key2] ]       => [ [key1, key2] ]\n * \n * @param Array|String paths\n * \n * @return Array\n */\nexport function paths2D(paths) {\n\treturn (pathsIs2D(paths) ? paths : (_arrFrom(paths).length ? [paths] : []))\n\t\t.reduce((multiple, path) => multiple.concat([_arrFrom(path)]), [])\n\t\t.map(path => DotSafePath.resolve(path));\n}\nexport class DotSafePath extends Array {\n\tstatic resolve(path) {\n\t\t// Note the concat() below...\n\t\t// the spread operator: new DotSafePath(...path) doesn't work when path is [0].\n\t\treturn path.every(v => !(v + '').includes('.')) ? (new DotSafePath).concat(path) : path;\n\t}\n\tget dotSafe() { return true }\n}\n\n/**\n * OTHER HELPERS\n */\n\nexport function pathsIs2D(paths) {\n\treturn _arrFrom(paths).reduce((yes, path) => yes || _isArray(path), false);\n}\nexport function pathsIsDynamic(pathArray) {\n\t// Note that trying to simply match empty slots, as in: pathArray.filter(seg => !seg && seg !== 0).length\n\t// doesn't work when the empty slots are really empty slote, as in: [ 'key', <1 empty item> ]\n\treturn pathArray.filter(seg => seg || seg === 0).length !== pathArray.length;\n}\nexport function paths2DIsDynamic(paths) {\n\treturn paths.filter(pathArray => pathsIsDynamic(_arrFrom(pathArray))).length > 0;\n}\n\n", "\n/**\n * @imports\n */\nimport { _isTypeObject, _isFunction, _getType, _internals } from '@webqit/util/js/index.js';\nimport { _from as _arrFrom, _intersect, _equals as _arrEquals } from '@webqit/util/arr/index.js';\nimport { paths2D } from './utils.js'\n\n/**\n * ---------------------------\n * The Firebase class\n * ---------------------------\n */\n\nexport default class Firebase {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param object\ttarget\n\t * \n\t * @return void\n\t */\n\tconstructor(target) {\n\t\tthis.target = target;\n\t\tthis.fireables = [];\n\t\tthis.currentlyFiring = [];\n\t}\n\t\n\t/**\n\t * Adds an Fireable instance\n\t * with optional tags.\n\t *\n\t * @param Fireable\t\t\tfireable\n\t *\n\t * @return Fireable\n\t */\n\tadd(fireable) {\n\t\tthis.fireables.push(fireable);\n\t\treturn fireable;\n\t}\n\t\n\t/**\n\t * Removes fireables by instance.\n\t *\n\t * @param Fireable\t\t\tfireable\n\t *\n\t * @return void\n\t */\n\tremove(fireable) {\n\t\tthis.fireables = this.fireables.filter(_fireable => _fireable !== fireable);\n\t}\n\t\n\t/**\n\t * Removes fireables by definition.\n\t *\n\t * @param object\t\t\tdfn\n\t *\n\t * @return void\n\t */\n\tremoveMatches(dfn) {\n\t\tthis.match(dfn).forEach(fireable => {\n\t\t\tthis.fireables = this.fireables.filter(_fireable => _fireable !== fireable);\n\t\t});\n\t}\n\t\n\t/**\n\t * Finds fireables by definition.\n\t *\n\t * @param object\t\t\tdfn\n\t *\n\t * @return array\n\t */\n\tmatch(dfn) {\n\t\treturn this.fireables.filter(fireable => {\n\t\t\tvar fireableFilter = paths2D(fireable.filter);\n\t\t\tvar fireableTags = _arrFrom((fireable.params || {}).tags);\n\t\t\t// -----------------------\n\t\t\tvar dfnFilter = paths2D(dfn.filter);\n\t\t\tvar dfnTags = _arrFrom((dfn.params || {}).tags);\n\t\t\t// -----------------------\n\t\t\treturn (!dfn.originalHandler || fireable.handler === dfn.originalHandler)\n\t\t\t\t&& (!dfnFilter.length || _arrEquals(dfnFilter, fireableFilter))\n\t\t\t\t&& (!dfnTags.length || (dfnTags.length === fireableTags.length && _intersect(fireableTags, dfnTags).length === dfnTags.length));\n\t\t});\n\t}\n\t\t\n\t/**\n\t * Returns a observer-specific object embedded on an element.\n\t *\n\t * @param string\t\ttype\n\t * @param array|object\ttarget\n\t * @param bool      \tcreateIfNotExists\n\t * @param string      \tnamespace\n\t *\n\t * @return Firebase\n\t */\n\tstatic _getFirebase(type, target, createIfNotExists = true, namespace = this.__namespace) {\n\t\tif (!_isTypeObject(target)) {\n\t\t\tthrow new Error('Subject must be of type object; \"' + _getType(target) + '\" given!');\n\t\t}\n\t\tvar ImplementationClass = this;\n\t\tif (namespace && globalThis.WebQitObserverNamespaceRegistry.has(type + '-' + namespace)) {\n\t\t\tImplementationClass = globalThis.WebQitObserverNamespaceRegistry.get(type + '-' + namespace);\n\t\t\ttype += '-' + namespace\n\t\t}\n\t\tif (!_internals(target, 'firebases').has(type) && createIfNotExists) {\n\t\t\t_internals(target, 'firebases').set(type, new ImplementationClass(target));\n\t\t}\n\t\treturn _internals(target, 'firebases').get(type);\n\t}\n\n\t/**\n\t * Extend a Fireable Class with a namespace.\n\t *\n\t * @param string\t\tnamespace\n\t * @param class      \tImplementationClass\n\t *\n\t * @return void|class\n\t */\n\tstatic _namespace(type, namespace, ImplementationClass = null) {\n\t\ttype += '-' + namespace;\n\t\tif (arguments.length === 2) {\n\t\t\treturn globalThis.WebQitObserverNamespaceRegistry.get(type);\n\t\t}\n\t\tif (!(ImplementationClass.prototype instanceof this)) {\n\t\t\tthrow new Error(`The implementation of the namespace ${this.name}.${namespace} must be a subclass of ${this.name}.`);\n\t\t}\n\t\tglobalThis.WebQitObserverNamespaceRegistry.set(type, ImplementationClass);\n\t\tImplementationClass.__namespace = namespace;\n\t}\n}\n\nif (!globalThis.WebQitObserverNamespaceRegistry) {\n\tglobalThis.WebQitObserverNamespaceRegistry = new Map();\n}\n", "\n/**\n * ---------------------------\n * The Fireable class\n * ---------------------------\n */\n\nexport default class Fireable {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param object|array\t\ttarget\n\t * @param object\t\t\tdfn\n\t *\n\t * @return void\n\t */\n\tconstructor(target, dfn) {\n\t\tthis.target = target;\n\t\tthis.handler = dfn.handler;\n\t\tthis.filter = dfn.filter;\n\t\tthis.params = dfn.params;\n\n\t}\n\n\t/**\n\t * Sets a \"disconnected\" flag on the Fireable.\n\t *\n\t * @return void\n\t */\n\tdisconnect() {\n\t\tthis.disconnected = true;\n\t}\n}", "\n/**\n * @imports\n */\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport { _intersect } from '@webqit/util/arr/index.js';\nimport Fireable from './Fireable.js';\n\n/**\n * ---------------------------\n * The Trap class\n * ---------------------------\n */\n\nexport default class Interceptor extends Fireable {\n\t\n\t/**\n\t * Calls the observer's handler function\n\t * on matching with the event's fields.\n\t *\n\t * @param Event\t\t\t \t\t\tevent\n\t * @param function\t\t\t\t\tnext\n\t * @param mixed\t\t\t\t\t \trecieved\n\t *\n\t * @return void\n\t */\n\tfire(event, next, recieved) {\n\t\tif (this.disconnected || (this.filter && !_intersect(_arrFrom(this.filter), [event.type]).length)) {\n\t\t\treturn next(...Array.prototype.slice.call(arguments, 2));\n\t\t}\n\t\treturn this.handler(event, recieved, next);\n\t}\n}", "\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\nimport _isFunction from '../js/isFunction.js';\nimport _isNumeric from '../js/isNumeric.js';\nimport _isTypeObject from '../js/isTypeObject.js';\nimport _mergeCallback from './mergeCallback.js';\n\n/**\n * Copies an object.\n *\n * @param object\t \tobj\n * @param array\t\t \tfilter\n *\n * @return object\n */\nexport default function(obj, filter = [], withSymbols = true) {\n\tvar depth = 0;\n\tif (_isNumeric(arguments[0]) && _isTypeObject(arguments[1])) {\n\t\tdepth = arguments[0];\n\t\tobj = arguments[1];\n\t\tfilter = arguments[2] || [];\n\t}\n\treturn _mergeCallback([depth, {}, obj], (key, obj1, obj2) => {\n\t\treturn _isFunction(filter) ? filter(key) \n\t\t\t: (_isArray(filter) && filter.length ? filter.indexOf(key) > -1 : true);\n\t}, false/*deepProps*/, false/*isReplace*/, withSymbols);\n};\n", "\n/**\n * @imports\n */\nimport _isTypeObject from '../js/isTypeObject.js';\nimport _isUndefined from '../js/isUndefined.js';\nimport _isNull from '../js/isNull.js';\nimport _arrFrom from '../arr/from.js';\n\n/**\n * Retrieves the value at the given path.\n *\n * A return value of undefined is ambiguous, and can mean either that the\n * path does not exist, or that the path actually exists but with a value of undefined. If it is required to\n * know whether the path actually exists, pass an object as a third argument.\n * This object will have an \"exists\" key set to true/false.\n *\n * @param object \t\t\t\tctxt\n * @param array \t\t\t\tpath\n * @param object \t\t\t\ttrap\n * @param object \t\t\t\treciever\n *\n * @return mixed\n */\nexport default function(ctxt, path, trap = {}, reciever = {}) {\n\tpath = _arrFrom(path).slice();\n\tvar _ctxt = ctxt;\n\twhile(!_isUndefined(_ctxt) && !_isNull(_ctxt) && path.length) {\n\t\tvar _key = path.shift();\n\t\tif (!(trap.get ? trap.get(_ctxt, _key) : (_isTypeObject(_ctxt) ? _key in _ctxt : _ctxt[_key]))) {\n\t\t\treciever.exists = false;\n\t\t\treturn;\n\t\t}\n\t\t_ctxt = trap.get ? trap.get(_ctxt, _key) : _ctxt[_key];\n\t}\n\treciever.exists = true;\n\treturn _ctxt;\n};\n", "\n/**\n * @imports\n */\nimport _isTypeObject from '../js/isTypeObject.js';\nimport _isFunction from '../js/isFunction.js';\nimport _isNumeric from '../js/isNumeric.js';\nimport _isArray from '../js/isArray.js';\nimport _arrFrom from '../arr/from.js';\nimport _get from './get.js';\n\n/**\n * Sets a value to the given path.\n *\n * @param object \t\t\t\tobj\n * @param array \t\t\t\tpath\n * @param mixed \t\t\t\tval\n * @param object|function \t\tbuildTree\n * @param object \t\t\t\ttrap\n *\n * @return bool\n */\nexport default function(obj, path, val, buildTree = {}, trap = {}) {\n\tconst _set = (target, key, val) => {\n\t\tif (trap.set) {\n\t\t\treturn trap.set(target, key, val);\n\t\t} else {\n\t\t\tif (_isNumeric(path[i]) && _isArray(target)) {\n\t\t\t\ttarget.push(val);\n\t\t\t} else {\n\t\t\t\ttarget[key] = val;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t};\n\tpath = _arrFrom(path);\n\tvar target = obj;\n\tfor(var i = 0; i < path.length; i ++) {\n\t\tif (i < path.length - 1) {\n\t\t\tif (!target || (!_isTypeObject(target) && !_isFunction(target))) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar branch = _get(target, path[i], trap);\n\t\t\tif (!_isTypeObject(branch)) {\n\t\t\t\tif (trap.buildTree === false) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tbranch = _isFunction(trap.buildTree) ? trap.buildTree(i) : (_isNumeric(path[i + 1]) ? [] : {});\n\t\t\t\tvar branchSuccess = _set(target, path[i], branch);\n\t\t\t\tif (!branchSuccess) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttarget = branch;\n\t\t} else {\n\t\t\treturn _set(target, path[i], val);\n\t\t}\n\t}\n};\n", "\n/**\n * @imports\n */\nimport { _each } from '@webqit/util/obj/index.js';\n\n/**\n * ---------------------------\n * The QueryEvent class\n * ---------------------------\n */\n\nexport default class Action {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param array|object\ttarget\n\t * @param object\t\tdfn\n\t *\n\t * @return void\n\t */\n\tconstructor(target, dfn) {\n\t\tthis.target = target;\n\t\tif (!dfn.type) {\n\t\t\tthrow new Error('Action type must be given in definition!');\n\t\t}\n\t\t_each(dfn, (key, value) => {\n\t\t\tObject.defineProperty(this, key, {value, enumerable:true});\n\t\t});\n\t\tObject.seal(this);\n\t}\n}", "\n/**\n * @imports\n */\nimport Firebase from './Firebase.js';\nimport Interceptor from './Interceptor.js';\nimport Action from './Action.js';\n\n/**\n * ---------------------------\n * The Reactive class\n * ---------------------------\n */\n\nexport default class Interceptors extends Firebase {\n\t\n\t/**\n\t * @inheritdoc\n\t */\n\tadd(dfn) {\n\t\treturn super.add(new Interceptor(this.target, dfn));\n\t}\n\n\t/**\n\t * Fires all interceptors with the given action.\n\t *\n\t * @param Action\t\t\taction\n\t * @param function\t\t\tdefaultHandler\n\t *\n\t * @return mixed\n\t */\n\tfire(action, defaultHandler = null) {\n\t\tif (!(action instanceof Action)) {\n\t\t\taction = new Action(this.target, action);\n\t\t}\n\t\tif (this.currentlyFiring.filter(a => a.type === action.type && a.name === action.name).length) {\n\t\t\treturn defaultHandler ? defaultHandler() : undefined;\n\t\t}\n\t\tthis.currentlyFiring.push(action);\n\t\tconst next = (index, ..._args) => {\n\t\t\tvar interceptor = this.fireables[index];\n\t\t\tif (interceptor) {\n\t\t\t\treturn interceptor.fire(action, (...args) => {\n\t\t\t\t\treturn next(index + 1, ...args);\n\t\t\t\t}/*next*/, ..._args);\n\t\t\t}\n\t\t\treturn defaultHandler ? defaultHandler(..._args) : _args[0];\n\t\t};\n\t\tvar value = next(0);\n\t\tthis.currentlyFiring.pop();\n\t\treturn value;\n\t}\n\n\tstatic getFirebase(target, createIfNotExists = true, namespace = null) {\n\t\treturn super._getFirebase('interceptor', ...arguments);\n\t}\n\n\tstatic namespace(namespace, ImplementationClass = null) {\n\t\treturn super._namespace('interceptor', ...arguments);\n\t}\n}", "\n/**\n * @imports\n */\nimport { _internals } from '@webqit/util/js/index.js';\n\n/**\n * Returns the original object earlier proxied by proxy().\n *\n * @param Proxy|Any\t\ttarget\n *\n * @return Any\n */\nexport default function(target) {\n    // Proxy targets are mapped to their own instances internally\n    return _internals(target, false).get(target) || target;\n}\n", "\n/**\n * @imports\n */\nimport { _isTypeObject } from '@webqit/util/js/index.js';\nimport Interceptors from '../core/Interceptors.js';\nimport _unproxy from '../actors/unproxy.js';\n\n/**\n * Runs a Reflect operation of the specified type.\n *\n * @param string\t\ttype\n * @param array|object\ttarget\n * @param object\t\tpayload\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(type, target, payload = {}, params = {}) {\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Target must be of type object!');\n\t}\n\ttarget = _unproxy(target);\n\t// ---------------------------------\n\t// Execute any \"keys\" traps, otherwise \"test\" the default way\n\tvar interceptors, defaultHandler = function(_val) {\n\t\treturn arguments.length ? _val : Reflect[type](target, ...Object.values(payload));\n\t};\n\tif (interceptors = Interceptors.getFirebase(target, false, params.namespace)) {\n\t\treturn interceptors.fire({ type, ...payload }, defaultHandler);\n\t}\n\treturn defaultHandler();\n}\n", "\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs an \"apply\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tthisArgument\n * @param array\t\t\targumentsList\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, thisArgument, argumentsList, params = {}) {\n\treturn _exec('apply', target, { thisArgument, argumentsList }, params);\n}\n", "\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"construct\" operation on a target.\n *\n * @param array|object\ttarget\n * @param array\t\t\targumentsList\n * @param object\t\tnewTarget\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, argumentsList, newTarget = null, params = {}) {\n\treturn _exec('construct', target, arguments.length > 2 ? { argumentsList, newTarget } : { argumentsList }, params);\n}\n", "\n/**\n * @imports\n */\nimport { _isUndefined, _isObject } from '@webqit/util/js/index.js';\nimport { _each } from '@webqit/util/obj/index.js';\n\n/**\n * ---------------------------\n * The Event class\n * ---------------------------\n */\n\nexport default class Event {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param array|object\t\ttarget\n\t * @param bool\t\t\t\tcancellable\n\t *\n\t * @return void\n\t */\n\tconstructor(target, cancellable = false) {\n\t\tthis._ = {};\n\t\tthis._.target = target;\n\t\tthis._.cancellable = cancellable;\n\t\tthis._.propagationStopped = false;\n\t\tthis._.defaultPrevented = false;\n\t\tthis._.promisesInstance = null;\n\t\tthis._.promises = [];\n\t}\n\n\t/**\n\t * Gets the \"target\" object.\n\t *\n\t * @return array|object\n\t */\n\tget target() {\n\t\treturn this._.target;\n\t}\n\n\t/**\n\t * Gets the \"cancellable\" flag.\n\t *\n\t * @return bool\n\t */\n\tget cancellable() {\n\t\treturn this._.cancellable;\n\t}\n\n\t/**\n\t * -----------------------\n\t * RESPONSE HANDLERS\n\t * -----------------------\n\t */\n\n\t/**\n\t * Stops the evnt from reaching other listeners.\n\t *\n\t * @return bool\n\t */\n\tstopPropagation() {\n\t\tthis._.propagationStopped = true;\n\t}\n\t\t\n\t/**\n\t * (Readonly) tells if stopPropagation() has been called.\n\t *\n\t * @return bool\n\t */\n\tget propagationStopped() {\n\t\treturn this._.propagationStopped;\n\t}\n\t\t\n\t/**\n\t * Sets a disposition that asks event initiator not to\n\t * proceed with default action.\n\t *\n\t * @return void\n\t */\n\tpreventDefault() {\n\t\tthis._.defaultPrevented = true;\n\t}\n\t\t\n\t/**\n\t * (Readonly) tells if preventDefault() has been called.\n\t *\n\t * @return bool\n\t */\n\tget defaultPrevented() {\n\t\treturn this._.defaultPrevented;\n\t}\n\t\t\n\t/**\n\t * Sets a Promise disposition.\n\t *\n\t * @param Promise\tpromise\n\t *\n\t * @return void\n\t */\n\twaitUntil(promise) {\n\t\tif (promise instanceof Promise) {\n\t\t\tthis._.promises.push(promise);\n\t\t\tthis._.promisesInstance = null;\n\t\t}\n\t}\n\t\t\n\t/**\n\t * (Readonly) returns all promises.\n\t *\n\t * @return Promise|null\n\t */\n\tget promises() {\n\t\tif (!this._.promisesInstance && this._.promises.length) {\n\t\t\tthis._.promisesInstance = Promise.all(this._.promises);\n\t\t}\n\t\treturn this._.promisesInstance;\n\t}\n\t\t\n\t/**\n\t * Evaluates the given disposition value and\n\t * calls an appropriate disposition method.\n\t *\n\t * @params mixed \trspns\n\t *\n\t * @return void\n\t */\n\trespondWith(rspns) {\n\t\tvar proms;\n\t\tvar isEvent = _isObject(rspns) && !_isUndefined(rspns.propagationStopped) && !_isUndefined(rspns.defaultPrevented)\n\t\tif ((rspns === false) || (isEvent && rspns.propagationStopped)) {\n\t\t\tthis.stopPropagation();\n\t\t} else if ((rspns === false) || (isEvent && rspns.defaultPrevented)) {\n\t\t\tthis.preventDefault();\n\t\t} else if ((rspns instanceof Promise && (proms = rspns))\n\t\t|| (isEvent && (proms = rspns.promises))) {\n\t\t\tthis.waitUntil(proms);\n\t\t}\n\t}\n}", "\n/**\n * @imports\n */\nimport {\n\t_after as _arrAfter, _startsWith as _arrStartsWith,\n\t_any, _equals as _arrEquals,\n} from '@webqit/util/arr/index.js';\nimport { _isNumeric, _isFunction, _isObject } from '@webqit/util/js/index.js';\nimport { paths2D, pathsIs2D, pathsIsDynamic, paths2DIsDynamic } from './utils.js'\nimport Fireable from './Fireable.js';\nimport Event from './Event.js';\n\n/**\n * ---------------------------\n * The Observer class\n * ---------------------------\n */\n\nexport default class Observer extends Fireable {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param array|object\t\ttarget\n\t * @param object\t\t\tdfn\n\t *\n\t * @return void\n\t */\n\tconstructor(target, dfn) {\n\t\tsuper(target, dfn);\n\t\t// The rest of this code is designed for a 2-dimensional array.\n\t\tthis.filters2D = paths2D(this.filter);\n\t\tthis.filtersIsOriginally2D = pathsIs2D(this.filter);\n\t\tthis.filtersIsDynamic = paths2DIsDynamic(this.filters2D);\n\t\tif (this.filtersIsDynamic && this.filters2D.length > 1) {\n\t\t\tthrow new Error('Only one \"Dynamic Filter\" must be observed at a time! \"' + this.filters2D.map(pathArray => '[' + pathArray.join(', ') + ']').join(', ') + '\" have been bound together.');\n\t\t}\n\t}\n\t\n\t/**\n\t * Calls the observer's handler function\n\t * on matching with the event's filter.\n\t *\n\t * @param array\t\t\t \tchanges\n\t *\n\t * @return void\n\t */\n\tfire(changes) {\n\t\tif (this.disconnected || (this.params.type && !_any(changes, delta => this.params.type === delta.type))) {\n\t\t\treturn;\n\t\t}\n\t\tconst diff = delta => !['set', 'def'].includes(delta.type) || (\n\t\t\t!this.params.diff || (_isFunction(this.params.diff) ? this.params.diff(delta.value, delta.oldValue) : delta.value !== delta.oldValue)\n\t\t);\n\t\tvar evt = new Event(this.target);\n\t\tif (this.filters2D.length) {\n\t\t\tvar matches = changes.filter(delta => {\n\t\t\t\t// one observerPathArray can turn out to be two if dynamic\n\t\t\t\t// OR evt.originatingFields is multiple and this.params.subtree\n\t\t\t\treturn this.filters2D.filter((observerPathArray, i) => {\n\t\t\t\t\tvar observerPathArray_Resolved = observerPathArray.slice();\n\t\t\t\t\tif (this.filtersIsDynamic) {\n\t\t\t\t\t\t// Note that if we had tried to loop thru observerPathArray_Resolved,\n\t\t\t\t\t\t// we wouldn't be able tp access slots that are truly empty, as in: [ 'key', <1 empty item> ]\n\t\t\t\t\t\tdelta.path.forEach((_seg, i) => {\n\t\t\t\t\t\t\tobserverPathArray_Resolved[i] = observerPathArray_Resolved[i] || observerPathArray_Resolved[i] === 0 \n\t\t\t\t\t\t\t\t? observerPathArray_Resolved[i]\n\t\t\t\t\t\t\t\t: _seg;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn (!this.filtersIsDynamic || !pathsIsDynamic(observerPathArray_Resolved)) && diff(delta) && ((!this.params.subtree && _arrEquals(observerPathArray_Resolved, delta.path))\n\t\t\t\t\t\t|| (this.params.suptree && _arrStartsWith(observerPathArray_Resolved, delta.path) && (!_isNumeric(this.params.suptree) || _arrAfter(observerPathArray_Resolved, delta.path).length <= this.params.suptree))\n\t\t\t\t\t\t|| (this.params.subtree && delta.path.length >= observerPathArray_Resolved.length && _arrStartsWith(delta.path, observerPathArray_Resolved) && (!_isNumeric(this.params.subtree) || _arrAfter(delta.path, observerPathArray_Resolved).length <= this.params.subtree))\n\t\t\t\t\t);\n\t\t\t\t}).length;\n\t\t\t});\n\t\t\tif (matches.length) {\n\t\t\t\tif (this.filtersIsOriginally2D || this.params.subtree) {\n\t\t\t\t\tvar changesObject = matches;\n\t\t\t\t\tif (_isObject(this.filter)) {\n\t\t\t\t\t\tchangesObject = {...this.filter};\n\t\t\t\t\t\tmatches.forEach((e, i) => {\n\t\t\t\t\t\t\tchangesObject[e.name] = e;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tevt.respondWith(this.handler(changesObject, evt));\n\t\t\t\t} else {\n\t\t\t\t\tmatches.forEach((e, i) => {\n\t\t\t\t\t\tevt.respondWith(this.handler(e, evt));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t} else if ((this.params.subtree || changes.filter(delta => _arrEquals(delta.path, [delta.name])).length === changes.length) && changes.filter(delta => diff(delta)).length) {\n\t\t\tevt.respondWith(this.handler(changes, evt));\n\t\t}\n\t\treturn evt;\n\t}\n}\n", "\n/**\n * @imports\n */\nimport { _each } from '@webqit/util/obj/index.js';\nimport { DotSafePath } from './utils.js';\n\n/**\n * ---------------------------\n * The QueryEvent class\n * ---------------------------\n */\n\nexport default class Mutation {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param array|object\ttarget\n\t * @param object\t\tdfn\n\t *\n\t * @return void\n\t */\n\tconstructor(target, dfn) {\n\t\tthis.target = target;\n\t\tif (!dfn.originalSubject) {\n\t\t\tthis.originalSubject = target;\n\t\t}\n\t\tif (!('type' in dfn)) {\n\t\t\tthrow new Error('Mutation type must be given in definition!');\n\t\t}\n\t\tif (!('name' in dfn)) {\n\t\t\tthrow new Error('Property name must be given in definition!');\n\t\t}\n\t\t_each(dfn, (key, value) => {\n\t\t\tif (key === 'path') {\n\t\t\t\tvalue = DotSafePath.resolve(value);\n\t\t\t}\n\t\t\tObject.defineProperty(this, key, {value, enumerable:true});\n\t\t});\n\t\tif (!this.path) {\n\t\t\tObject.defineProperty(this, 'path', {value: DotSafePath.resolve([dfn.name]), enumerable:true});\n\t\t}\n\t\tObject.seal(this);\n\t}\n}", "\n/**\n * @imports\n */\nimport { _from as _arrFrom, _remove, _last } from '@webqit/util/arr/index.js';\nimport Firebase from './Firebase.js';\nimport Observer from './Observer.js';\nimport Mutation from './Mutation.js';\nimport Event from './Event.js';\n\n/**\n * ---------------------------\n * The Reactive class\n * ---------------------------\n */\n\nexport default class Observers extends Firebase {\n\t\n\t/**\n\t * Initializes the instance.\n\t *\n\t * @param object\ttarget\n\t * \n\t * @return void\n\t */\n\tconstructor(target) {\n\t\tsuper(target);\n\t\tthis.buffers = [];\n\t}\n\t\n\t/**\n\t * @inheritdoc\n\t */\n\tadd(dfn) {\n\t\treturn super.add(new Observer(this.target, dfn));\n\t}\n\t\n\t/**\n\t * Fires all observers with the given evt (change).\n\t *\n\t * @param array|Mutation\t\tchanges\n\t * @param bool\t\t\t\tcancellable\n\t *\n\t * @return Event\n\t */\n\tfire(changes, cancellable) {\n\t\tvar evt = new Event(this.target, cancellable);\n\t\t// We accept multiple changes\n\t\tchanges = _arrFrom(changes, false).map(delta => !(delta instanceof Mutation) ? new Mutation(this.target, delta) : delta);\n\t\tif (this.buffers.length) {\n\t\t\t_last(this.buffers)(changes);\n\t\t\treturn evt;\n\t\t}\n\t\tif (this.currentlyFiring.filter(d => changes.filter(delta => d.type === delta.type && d.name === delta.name).length).length) {\n\t\t\t//return false;\n\t\t}\n\t\t//this.currentlyFiring.push(...changes);\n\t\tthis.fireables.forEach(observer => {\n\t\t\tif (evt.propagationStopped && cancellable) {\n\t\t\t\treturn evt;\n\t\t\t}\n\t\t\tevt.respondWith(observer.fire(changes));\n\t\t});\n\t\t//changes.forEach(delta => _remove(this.currentlyFiring, delta));\n\t\treturn evt;\n\t}\n\n\tstatic getFirebase(target, createIfNotExists = true, namespace = null) {\n\t\treturn super._getFirebase('observer', ...arguments);\n\t}\n\n\tstatic namespace(namespace, ImplementationClass = null) {\n\t\treturn super._namespace('observer', ...arguments);\n\t}\n}", "\n/**\n * @imports\n */\nimport {\n\t_isArray, _isNumeric, _isClass,\n\t_isFunction, _isTypeObject, _internals\n} from '@webqit/util/js/index.js';\nimport { _from as _objFrom } from '@webqit/util/obj/index.js';\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport Interceptors from '../core/Interceptors.js';\nimport _unproxy from '../actors/unproxy.js';\n\n/**\n * Runs a \"get\" operation on a target.\n * Fires any such query observers that may be bound to target.\n *\n * @param array|object\ttarget\n * @param string|array\tkeys\n * @param object\t\treceiver\n * @param object\t\tparams\n *\n * @return mixed\n */\nexport default function(target, keys, receiver = null, params = {}) {\n\ttarget = receiver || target;\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Target must be of type object!');\n\t}\n\ttarget = _unproxy(target);\n\t// ---------------------------------\n\tvar _keys = _arrFrom(keys);\n\tvar values = _keys.map(key => {\n\t\t// Execute any \"get\" traps, otherwise \"get\" the default way\n\t\tvar interceptors, defaultGet = function(_value) {\n\t\t\tif (arguments.length) {\n\t\t\t\treturn _value;\n\t\t\t}\n\t\t\tif (_internals(target, 'accessorizedProps').has(key) && _internals(target, 'accessorizedProps').get(key).touch(true)) {\n\t\t\t\treturn _internals(target, 'accessorizedProps').get(key).get();\n\t\t\t}\n\t\t\treturn receiver \n\t\t\t\t? Reflect.get(target, key, receiver) \n\t\t\t\t: Reflect.get(target, key);\n\t\t};\n\t\tif (interceptors = Interceptors.getFirebase(target, true, params.namespace)) {\n\t\t\treturn interceptors.fire({type:'get', name: key, related: _keys, receiver}, defaultGet);\n\t\t}\n\t\treturn defaultGet();\n\t});\n\t// ---------------------------------\n\treturn _isArray(keys) ? values : values[0];\n}\n", "\n/**\n * @imports\n */\nimport { _isFunction, _isTypeObject, _getType } from '@webqit/util/js/index.js';\nimport build, { isUserObject } from '../connectors/build.js';\nimport _unproxy from '../actors/unproxy.js';\nimport Observers from '../core/Observers.js';\n\n/**\n * Adds an observer to an target's firebase.\n *\n * @param array|object\t\t\t\ttarget\n * @param string|array|function\t\tfilter\n * @param function\t\t\t\t\thandler\n * @param object\t\t\t\t\tparams\n *\n * @return Observer\n */\nexport default function(target, filter, handler = null, params = {}) {\n\ttarget = _unproxy(target);\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Observable subjects must be of type object; \"' + _getType(target) + '\" given!');\n\t}\n\tif (_isFunction(filter)) {\n\t\tparams = arguments.length > 2 ? handler : {};\n\t\thandler = filter;\n\t\tfilter = null;\n\t}\n\tif (!_isFunction(handler)) {\n\t\tthrow new Error('Handler must be a function; \"' + _getType(handler) + '\" given!');\n\t}\n\tvar existing, observers = Observers.getFirebase(target, true, params.namespace);\n\tvar dfn = {filter, handler, params,};\n\tif (dfn.filter || dfn.params.subtree === '*' || (dfn.params.subtree && isUserObject(target))) {\n\t\tbuild(target, dfn.filter, dfn.params.subtree, params.namespace);\n\t}\n\tif (dfn.params.unique && (existing = observers.match({filter, params})).length) {\n\t\tif (dfn.params.unique !== 'replace') {\n\t\t\treturn existing[0];\n\t\t}\n\t\tobservers.remove(existing[0]);\n\t}\n\treturn observers.add(dfn);\n}\n", "\n/**\n * @imports\n */\nimport { _each, _merge } from '@webqit/util/obj/index.js';\nimport { _isObject } from '@webqit/util/js/index.js';\nimport Mutation from '../core/Mutation.js';\nimport Observers from '../core/Observers.js';\nimport observe from '../reactions/observe.js';\n\n/**\n * Bubble helper\n *\n * @param array|object\ttarget\n * @param string\t\tfield\n * @param array|object\tvalue\n * @param object\t\tevent\n * @param object\t\tparams\n *\n * @return void\n */\nexport default function(target, field, value, event = null, params = {}) {\n\tif (target === value) {\n\t\treturn;\n\t}\n\tvar observers;\n\tobserve(value, (changes, eventObject) => {\n\t\tif (observers = Observers.getFirebase(target, false, params.namespace)) {\n\t\t\tvar _changes = changes.map(delta => {\n\t\t\t\t// ------------\n\t\t\t\t// Recursive events must not propagate\n\t\t\t\t// ------------\n\t\t\t\tvar d = delta;\n\t\t\t\tdo {\n\t\t\t\t\tif (d.target === target) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} while(d = d.src);\n\t\t\t\t// ------------\n\t\t\t\t// Create propagation\n\t\t\t\t// ------------\n\t\t\t\tvar dfn = {}; _each(delta, (key, value) => {\n\t\t\t\t\tif (key !== 'target' && key !== 'name' && key !== 'path' && key !== 'src') {\n\t\t\t\t\t\tdfn[key] = value;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tdfn.name = field;\n\t\t\t\tdfn.path = [field].concat(delta.path);\n\t\t\t\tdfn.originalSubject = delta.originalSubject;\n\t\t\t\tdfn.src = delta;\n\t\t\t\treturn new Mutation(target, dfn);\n\t\t\t}).filter(c => c);\n\t\t\tif (_changes.length) {\n\t\t\t\treturn observers.fire(_changes, eventObject.cancellable);\n\t\t\t}\n\t\t}\n\t}, {subtree: true, ...params, unique: true, tags: [linkTag, field, target]});\n\tif (_isObject(event) && (observers = Observers.getFirebase(target, false, params.namespace))) {\n\t\t// The event object\n\t\tvar _event = _merge({\n\t\t\tname: field,\n\t\t\ttype: 'set',\n\t\t\tvalue,\n\t\t\trelated: [field],\n\t\t}, event);\n\t\tlet eventObject = observers.fire(_event, params.cancellable);\n\t\tif (params.eventTypeReturn) {\n\t\t\treturn eventObject;\n\t\t}\n\t}\n}\n\n/**\n * @var object\n */\nexport const linkTag = {};", "\n/**\n * @imports\n */\nimport { _isTypeObject } from '@webqit/util/js/index.js';\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport { _before, _after } from '@webqit/util/str/index.js';\nimport { paths2D } from '../core/utils.js';\nimport Observers from '../core/Observers.js';\nimport _get from '../actions/get.js';\nimport link from './link.js';\n\n/**\n * Recursively \"connects\" an object's members to the object\n * for observer actions.\n *\n * @param array|object\ttarget\n * @param string|array\tpaths\n * @param bool\t\t\tsubtree\n * @param String\t\tnamespace\n *\n * @return void\n */\nexport default function build(target, paths = null, subtree = false, namespace = null) {\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Target must be of type object!');\n\t}\n\tvar observers = Observers.getFirebase(target, true, namespace);\n\tif (!observers || observers.build) {\n\t\treturn;\n\t}\n\tobservers.build = subtree;\n\t// ---------------------------------\n\t// For paths2D, refer to the comments at class Observer.\n\tvar _paths2D = paths2D(paths);\n\t// If any path starts with a dot, (a wild card path), all keys at this level is implied\n\tvar rootLevelKeysToObserve = !_paths2D.length || _paths2D.filter(path => /*Starts with an empty segment*/!path[0] && path[0] !== 0).length\n\t\t? Object.keys(target)\n\t\t: _paths2D.map(path => path[0]);\n\tvar subLevelKeysToObserve = _paths2D.length ? _paths2D.map(path => path.slice(1)).filter(p => p.length) : null;\n\tobservers.subBuild = subLevelKeysToObserve && subLevelKeysToObserve.length ? subLevelKeysToObserve : null;\n\trootLevelKeysToObserve.forEach(key => {\n\t\tvar value = _get(target, key, null, { namespace });\n\t\ttry {\n\t\t\tif (_isTypeObject(value)) {\n\t\t\t\tlink(target, key, value, null, params);\n\t\t\t\tif ((observers.subBuild && isUserObject(value)) \n\t\t\t\t|| (_isFunction(subtree) ? subtree(value) : (subtree && isUserObject(value)))) {\n\t\t\t\t\tbuild(value, observers.subBuild, subtree, namespace);\n\t\t\t\t}\n\t\t\t}\n\t\t} catch(e) {/* instanceof-ing certain primitives may throw */}\n\t});\n}\n\n/**\n * Tells if an object if a User Object.\n * \n * @param Object value\n * \n * @return Bool\n */\nexport const isUserObject = value => ((value instanceof Object) || (value instanceof Array) || (value instanceof Function))\n\t&& (typeof window === 'undefined' || value !== window);\n", "\n/**\n * @imports\n */\nimport { _isFunction, _isTypeObject, _getType } from '@webqit/util/js/index.js';\nimport _unproxy from '../actors/unproxy.js';\nimport Observers from '../core/Observers.js';\n\n/**\n * Removes observers from an target's firebase.\n *\n * @param array|object\t\t\t\ttarget\n * @param string|array|function\t\tfilter\n * @param function\t\t\t\t\toriginalHandler\n * @param object\t\t\t\t\tparams\n *\n * @return void\n */\nexport default function(target, filter, originalHandler = null, params = {}) {\n\ttarget = _unproxy(target);\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Observable subjects must be of type object; \"' + _getType(target) + '\" given!');\n\t}\n\tif (_isFunction(filter)) {\n\t\tparams = arguments.length > 2 ? originalHandler : {};\n\t\toriginalHandler = filter;\n\t\tfilter = null;\n\t}\n\tif (originalHandler && !_isFunction(originalHandler)) {\n\t\tthrow new Error('Handler must be a function; \"' + _getType(originalHandler) + '\" given!');\n\t}\n\tvar observers;\n\tif (observers = Observers.getFirebase(target, false, params.namespace)) {\n\t\treturn observers.removeMatches({filter, originalHandler, params});\n\t}\n}\n", "\n/**\n * @imports\n */\nimport { _merge } from '@webqit/util/obj/index.js';\nimport { _isObject } from '@webqit/util/js/index.js';\nimport Observers from '../core/Observers.js';\nimport unobserve from '../reactions/unobserve.js';\nimport { linkTag } from './link.js';\n\n/**\n * Unbubble helper\n *\n * @param array|object\ttarget\n * @param string\t\tfield\n * @param array|object\tobject\n * @param object\t\tevent\n * @param object\t\tparams\n *\n * @return void\n */\nexport default function(target, field, value, event = null, params = {}) {\n\tunobserve(value, null, null, {...params, tags:[linkTag, field, target]});\n\tvar observers;\n\tif (_isObject(event) && (observers = Observers.getFirebase(target, false, params.namespace))) {\n\t\t// The event object\n\t\tvar _event = _merge({\n\t\t\tname: field,\n\t\t\ttype: 'del',\n\t\t\toldValue: value,\n\t\t\trelated: [field],\n\t\t}, event);\n\t\tobservers.fire(_event, params.cancellable);\n\t}\n}\n", "\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"has\" operation on a target.\n *\n * @param array|object\ttarget\n * @param string\t\tname\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, name, params = {}) {\n\treturn _exec('has', target, { name }, params);\n}\n", "\n/**\n * @imports\n */\nimport {\n\t_isObject, _isTypeObject, _internals,\n\t_isNumber, _isArray, _isString\n} from '@webqit/util/js/index.js';\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport build, { isUserObject } from '../connectors/build.js';\nimport Interceptors from '../core/Interceptors.js';\nimport Observers from '../core/Observers.js';\nimport Event from '../core/Event.js';\nimport unlink from '../connectors/unlink.js';\nimport link from '../connectors/link.js';\nimport _unproxy from '../actors/unproxy.js';\nimport _has from './has.js';\nimport _get from './get.js';\n\n/**\n * Executes a \"_setProp\" type of operation on a target.\n * Fires any observers for the specific type that may be bound to target.\n *\n * @param bool\t\t\tdefine\n * @param array|object\ttarget\n * @param object\t\tpayload\n * @param Object\t\tparams\n *\n * @return Event\n */\nexport default function(define, target, payload, params = {}) {\n\ttarget = payload.receiver || target;\n\tvar keysOrPayload = payload.keysOrPayload;\n\tvar value = payload.value;\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Target must be of type object!');\n\t}\n\tif (_isObject(keysOrPayload)) {\n\t\tparams = value || {};\n\t\tvalue = null;\n\t}\n\t// ----------\n\ttarget = _unproxy(target);\n\tvar interceptors = Interceptors.getFirebase(target, false, params.namespace),\n\t\tobservers = Observers.getFirebase(target, false, params.namespace);\n\t// ----------\n\tconst handleSet = (key, value, related, detail) => {\n\t\tvar type = 'set', descriptor;\n\t\tif (define) {\n\t\t\ttype = 'defineProperty';\n\t\t\tdescriptor = value || {};\n\t\t\tvalue = descriptor.value;\n\t\t}\n\t\t// ---------------------------------\n\t\t// The event object\n\t\tvar isUpdate = false, oldValue;\n\t\tif (_has(target, key, params)) {\n\t\t\tisUpdate = true;\n\t\t\toldValue = _get(target, key, payload.receiver, params);\n\t\t}\n\t\tvar e = {\n\t\t\tname: key,\n\t\t\ttype,\n\t\t\tvalue,\n\t\t\treceiver: payload.receiver,\n\t\t\trelated,\n\t\t\tdetail,\n\t\t\tisUpdate,\n\t\t\toldValue,\n\t\t};\n\t\t// ---------------------------------\n\t\t// The set operation\n\t\tvar defaultSet = function(_success) {\n\t\t\tif (arguments.length) {\n\t\t\t\tif (descriptor) {\n\t\t\t\t\tdescriptor = _success;\n\t\t\t\t} else {\n\t\t\t\t\tvalue = _success;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (descriptor) {\n\t\t\t\tif (_internals(target, 'accessorizedProps', false).has(key)\n\t\t\t\t&& !_internals(target, 'accessorizedProps').get(key).restore()) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tObject.defineProperty(target, key, descriptor);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (_internals(target, 'accessorizedProps', false).has(key)) {\n\t\t\t\treturn _internals(target, 'accessorizedProps').get(key).set(value);\n\t\t\t}\n\t\t\ttarget[key] = value;\n\t\t\treturn true;\n\t\t};\n\t\tif (interceptors) {\n\t\t\tvar eventObject = descriptor \n\t\t\t\t? {type: 'defineProperty', name: key, descriptor, receiver: payload.receiver, related, detail, isUpdate, oldValue} \n\t\t\t\t: {type: 'set', name: key, value, receiver: payload.receiver, related, detail, isUpdate, oldValue};\n\t\t\te.success = interceptors.fire(eventObject, defaultSet);\n\t\t} else {\n\t\t\te.success = defaultSet();\n\t\t}\n\t\t// ---------------------------------\n\t\tif (e.success && e.value !== e.oldValue) {\n\t\t\t// Unobserve outgoing value for bubbling\n\t\t\tif (_isTypeObject(e.oldValue)) {\n\t\t\t\tunlink(target, key, e.oldValue, null, params);\n\t\t\t}\n\t\t\t// Observe incoming value for bubbling\n\t\t\tif (_isTypeObject(e.value)) {\n\t\t\t\tlink(target, key, e.value, null, params);\n\t\t\t\tif (observers && (observers.subBuild || (observers.build && isUserObject(e.value)))) {\n\t\t\t\t\tbuild(e.value, observers.subBuild, observers.build, params.namespace);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn e;\n\t};\n\t// ---------------------------------\n\tvar keys, events = [];\n\tif (_isArray(keysOrPayload) || ((_isString(keysOrPayload) || _isNumber(keysOrPayload)) && (keys = _arrFrom(keysOrPayload)))) {\n\t\tevents = keys.map(key => handleSet(key, value, keys, params.detail));\n\t} else if (_isObject(keysOrPayload) && (keys = Object.keys(keysOrPayload))) {\n\t\tevents = keys.map(key => handleSet(key, keysOrPayload[key], keys, params.detail));\n\t}\n\tvar successfulEvents = events.filter(e => e.success !== false);\n\t// ---------------------------------\n\tvar evt;\n\tif (observers) {\n\t\tevt = observers.fire(successfulEvents, params.cancellable);\n\t\tevt.successCount = successfulEvents.length;\n\t} else if (params.eventTypeReturn) {\n\t\tevt = new Event(target);\n\t}\n\treturn params.eventTypeReturn ? evt : successfulEvents.length > 0;\n}\n", "\n/**\n * @imports\n */\nimport _setOrDefine from './_setOrDefine.js';\n\n/**\n * Executes a \"defineProperty\" operation on a target.\n * Fires any observers that may be bound to target.\n *\n * @param array|object\ttarget\n * @param string|array\tkeysOrPayload\n * @param mixed\t\t\tvalue\n * @param object\t\tparams\n *\n * @return bool\n */\nexport default function(target, keysOrPayload, value = null, params = {}) {\n\treturn _setOrDefine(true/*define*/, target, { keysOrPayload, value }, params);\n}\n", "\n/**\n * @imports\n */\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport { _isTypeObject, _internals } from '@webqit/util/js/index.js';\nimport Interceptors from '../core/Interceptors.js';\nimport Observers from '../core/Observers.js';\nimport Event from '../core/Event.js';\nimport unlink from '../connectors/unlink.js';\nimport _unproxy from '../actors/unproxy.js';\nimport _has from './has.js';\nimport _get from './get.js';\n\n/**\n * Executes a \"deleteProperty\" operation on a target.\n * Fires any observers that may be bound to target.\n *\n * @param array|object\ttarget\n * @param string|array\tkeys\n * @param object\t\tparams\n *\n * @return Event\n */\nexport default function(target, keys, params = {}) {\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Target must be of type object!');\n\t}\n\ttarget = _unproxy(target);\n\tvar _keys = _arrFrom(keys);\n\tvar events = _keys.map(key => {\n\t\t// ---------------------------------\n\t\t// The event object\n\t\tvar oldValue;\n\t\tif (_has(target, key, params)) {\n\t\t\toldValue = _get(target, key, null, params);\n\t\t}\n\t\tvar e = {\n\t\t\tname: key,\n\t\t\ttype: 'deleteProperty',\n\t\t\trelated: _keys,\n\t\t\tdetail: params.detail,\n\t\t\toldValue,\n\t\t};\n\t\t// ---------------------------------\n\t\t// Execute any \"del\" traps, otherwise \"del\" the default way\n\t\tvar interceptors, defaultDel = function(_success) {\n\t\t\tif (arguments.length) {\n\t\t\t\treturn _success;\n\t\t\t}\n\t\t\tif (_internals(target, 'accessorizedProps', false).has(key)\n\t\t\t&& !_internals(target, 'accessorizedProps').get(key).restore()) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tdelete target[key];\n\t\t\treturn true;\n\t\t};\n\t\tif (interceptors = Interceptors.getFirebase(target, false, params.namespace)) {\n\t\t\te.success = interceptors.fire({type: 'deleteProperty', name:key, oldValue, related: _keys}, defaultDel);\n\t\t} else {\n\t\t\te.success = defaultDel();\n\t\t}\n\t\t// ---------------------------------\n\t\t// Unobserve outgoing value for bubbling\n\t\tif (e.success && _isTypeObject(e.oldValue)) {\n\t\t\tunlink(target, key, e.oldValue, null, params);\n\t\t}\n\t\treturn e;\n\t});\n\tvar successfulEvents = events.filter(e => e.success !== false);\n\t// ---------------------------------\n\tvar observers, evt;\n\tif (observers = Observers.getFirebase(target, false, params.namespace)) {\n\t\tevt = observers.fire(successfulEvents, params.cancellable);\n\t\tevt.successCount = successfulEvents.length;\n\t} else if (params.eventTypeReturn) {\n\t\tevt = new Event(target);\n\t}\n\treturn params.eventTypeReturn ? evt : successfulEvents.length > 0;\n}\n", "\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"getOwnPropertyDescriptor\" operation on a target.\n *\n * @param array|object\ttarget\n * @param string|number name\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, name, params = {}) {\n\treturn _exec('getOwnPropertyDescriptor', target, { name }, params);\n}\n", "\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"getPrototypeOf\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, params = {}) {\n\treturn _exec('getPrototypeOf', target, {}, params);\n}\n", "\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"isExtensible\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, params = {}) {\n\treturn _exec('isExtensible', target, {}, params);\n}\n", "\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"ownKeys\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, params = {}) {\n\treturn _exec('ownKeys', target, {}, params);\n}\n", "\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"preventExtensions\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, params = {}) {\n\treturn _exec('preventExtensions', target, {}, params);\n}\n", "\n/**\n * @imports\n */\nimport _setOrDefine from './_setOrDefine.js';\n\n/**\n * Executes a \"set\" operation on a target.\n * Fires any observers that may be bound to target.\n *\n * @param array|object\ttarget\n * @param string|array\tkeysOrPayload\n * @param mixed\t\t\tvalue\n * @param object\t\treceiver\n * @param object\t\tparams\n *\n * @return bool\n */\nexport default function(target, keysOrPayload, value = null, receiver = null, params = {}) {\n\treturn _setOrDefine(false/*define*/, target, arguments.length > 3 ? { keysOrPayload, value, receiver } : { keysOrPayload, value }, params);\n}\n", "\n/**\n * @imports\n */\nimport _exec from './_exec.js';\n\n/**\n * Runs a \"setPrototypeOf\" operation on a target.\n *\n * @param array|object\ttarget\n * @param object\t\tprototype\n * @param object\t\tparams\n *\n * @return array\n */\nexport default function(target, prototype, params = {}) {\n\treturn _exec('setPrototypeOf', target, { prototype }, params);\n}\n", "\n/**\n * @imports\n */\nimport { _isArray, _internals } from '@webqit/util/js/index.js';\nimport { _isObject } from '@webqit/util/js/index.js';\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport _get from '../actions/get.js';\nimport _set from '../actions/set.js';\n\n/**\n * Initializes \"Reflxive getter/setter\" traps on the target.\n *\n * @param array|object\ttarget\n * @param string|array\tkeys\n * @param object\t\tparams\n *\n * @return bool|array\n */\nexport default function(target, keys = [], params = {}) {\n\tparams = _isObject(keys) ? keys : params;\n\tvar successFlags = (arguments.length === 1 ? Object.keys(target) : _arrFrom(keys)).map(key => {\n\t\tif (_internals(target, 'accessorizedProps').has(key) && _internals(target, 'accessorizedProps').get(key).touch(true)) {\n\t\t\treturn false;\n\t\t}\n\t\t// ----------\n\t\tconst getDescriptorDeep = () => {\n\t\t\tvar descriptor, proto = target;\n\t\t\twhile (!descriptor && (proto = Object.getPrototypeOf(proto))) {\n\t\t\t\tdescriptor = Object.getOwnPropertyDescriptor(proto, key);\n\t\t\t}\n\t\t\treturn descriptor;\n\t\t};\n\t\t// ----------\n\t\tvar originalOwnDescriptor = Object.getOwnPropertyDescriptor(target, key),\n\t\t\taltOriginalOwnDescriptor,\n\t\t\tactiveIsAltOriginalOwnDescriptor;\n\t\tif (!originalOwnDescriptor) {\n\t\t\t// Not an own property\n\t\t\t// and maybe not even defined at all in the prototype chain\n\t\t\taltOriginalOwnDescriptor = {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: key in target ? false/* existing but inherited*/ : true,\n\t\t\t\tconfigurable: params.configurable !== false,\n\t\t\t};\n\t\t}\n\t\t// ----------\n\t\tvar reactiveOwnDescriptor = { ...(originalOwnDescriptor || altOriginalOwnDescriptor) };\n\t\tif ('value' in reactiveOwnDescriptor) {\n\t\t\tdelete reactiveOwnDescriptor.value;\n\t\t}\n\t\tif ('writable' in reactiveOwnDescriptor) {\n\t\t\tdelete reactiveOwnDescriptor.writable;\n\t\t}\n\t\t// ----------\n\t\treactiveOwnDescriptor.get = () => {\n\t\t\tif (controlObject.ongoingGets.length) {\n\t\t\t\t// .touch(true)\n\t\t\t\treturn controlObject.get();\n\t\t\t}\n\t\t\t// _get() will return here\n\t\t\t// but to call controlObject.get();\n\t\t\tcontrolObject.ongoingGets.push(1);\n\t\t\tvar value = _get(target, key, null, params);\n\t\t\tcontrolObject.ongoingGets.pop();\n\t\t\treturn value;\n\t\t};\n\t\tvar setting;\n\t\treactiveOwnDescriptor.set = newValue => {\n\t\t\tif (controlObject.ongoingSets.length) {\n\t\t\t\treturn controlObject.set(newValue);\n\t\t\t}\n\t\t\t// _set() will return here\n\t\t\t// but to call controlObject.set();\n\t\t\tcontrolObject.ongoingSets.push(1);\n\t\t\tvar operation = _set(target, key, newValue, null, params);\n\t\t\tcontrolObject.ongoingSets.pop();\n\t\t\treturn operation;\n\t\t};\n\t\t// ----------\n\t\tvar controlObject = {\n\t\t\tongoingGets: [],\n\t\t\tongoingSets: [],\n\t\t\tget: function() {\n\t\t\t\t// ---------------------\n\t\t\t\tvar descriptor = originalOwnDescriptor;\n\t\t\t\tif (!descriptor) {\n\t\t\t\t\tif (activeIsAltOriginalOwnDescriptor) {\n\t\t\t\t\t\t// Already switched to altOriginalOwnDescriptor\n\t\t\t\t\t\tdescriptor = altOriginalOwnDescriptor;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// getDescriptorDeep() or altOriginalOwnDescriptor\n\t\t\t\t\t\tdescriptor = getDescriptorDeep() || altOriginalOwnDescriptor;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// ---------------------\n\t\t\t\treturn descriptor.get ? descriptor.get.call(target) : descriptor.value;\n\t\t\t},\n\t\t\tset: function(value) {\n\t\t\t\t// ---------------------\n\t\t\t\tvar descriptor = originalOwnDescriptor;\n\t\t\t\tif (!descriptor) {\n\t\t\t\t\tif (activeIsAltOriginalOwnDescriptor) {\n\t\t\t\t\t\t// Already switched to altOriginalOwnDescriptor\n\t\t\t\t\t\tdescriptor = altOriginalOwnDescriptor;\n\t\t\t\t\t} else if (descriptor = getDescriptorDeep()) {\n\t\t\t\t\t\tif (('value' in descriptor)) {\n\t\t\t\t\t\t\t// Deep is data property.\n\t\t\t\t\t\t\t// We should rather switch to altOriginalOwnDescriptor\n\t\t\t\t\t\t\tdescriptor = altOriginalOwnDescriptor;\n\t\t\t\t\t\t\tactiveIsAltOriginalOwnDescriptor = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Not yet switched to altOriginalOwnDescriptor\n\t\t\t\t\t\t// and no getDescriptorDeep()\n\t\t\t\t\t\tdescriptor = altOriginalOwnDescriptor;\n\t\t\t\t\t\tactiveIsAltOriginalOwnDescriptor = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// ---------------------\n\t\t\t\tif (descriptor.set || descriptor.get) {\n\t\t\t\t\tif (!descriptor.set) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\t// Can sometimes return undefined\n\t\t\t\t\treturn descriptor.set.call(target, value);\n\t\t\t\t}\n\t\t\t\tdescriptor.value = value;\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\trestore: function() {\n\t\t\t\ttry {\n\t\t\t\t\tif (this.intact()) {\n\t\t\t\t\t\tif (originalOwnDescriptor || activeIsAltOriginalOwnDescriptor /* switched */) {\n\t\t\t\t\t\t\tObject.defineProperty(target, key, originalOwnDescriptor || altOriginalOwnDescriptor /* switch target */);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdelete target[key];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_internals(target, 'accessorizedProps').delete(key);\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t} catch(e) {}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tintact: function() {\n\t\t\t\treturn (Object.getOwnPropertyDescriptor(target, key) || {}).get === reactiveOwnDescriptor.get;\n\t\t\t},\n\t\t\ttouch: function(attemptRestore = false) {\n\t\t\t\t// If intact, or not intact but not restorable, return true - \"valid\"\n\t\t\t\treturn this.intact() || (attemptRestore ? !this.restore() : false);\n\t\t\t},\n\t\t}\n\t\t// ----------\n\t\ttry {\n\t\t\tObject.defineProperty(target, key, reactiveOwnDescriptor);\n\t\t\t_internals(target, 'accessorizedProps').set(key, controlObject);\n\t\t\treturn true;\n\t\t} catch(e) {}\n\t\treturn false;\n\t});\n\treturn _isArray(keys) ? successFlags : successFlags[0];\n}\n", "\n/**\n * @imports\n */\nimport { _isArray, _isObject, _internals } from '@webqit/util/js/index.js';\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\n\n/**\n * Removes previously initialized \"Reflxive getter/setter\" traps from the target.\n *\n * @param array|object\ttarget\n * @param string|array\tkeys\n * @param object\t\tparams\n *\n * @return bool|array\n */\nexport default function(target, keys = [], params = {}) {\n\tparams = _isObject(keys) ? keys : params;\n\tvar successFlags = (arguments.length === 1 ? Object.keys(target) : _arrFrom(keys)).map(key => {\n\t\tif (_internals(target, 'accessorizedProps', false).has(key)) {\n\t\t\treturn _internals(target, 'accessorizedProps').get(key).restore();\n\t\t}\n\t\treturn true;\n\t});\n\treturn _isArray(keys) ? successFlags : successFlags[0];\n}\n", "\n/**\n * @imports\n */\nimport {\n    _isClass, _isFunction, _isTypeObject,\n    _getType, _internals,\n} from '@webqit/util/js/index.js';\nimport apply from '../actions/apply.js';\nimport construct from '../actions/construct.js';\nimport defineProperty from '../actions/defineProperty.js';\nimport deleteProperty from '../actions/deleteProperty.js';\nimport get from '../actions/get.js';\nimport getOwnPropertyDescriptor from '../actions/getOwnPropertyDescriptor.js';\nimport getPrototypeOf from '../actions/getPrototypeOf.js';\nimport has from '../actions/has.js';\nimport isExtensible from '../actions/isExtensible.js';\nimport ownKeys from '../actions/ownKeys.js';\nimport preventExtensions from '../actions/preventExtensions.js';\nimport set from '../actions/set.js';\nimport setPrototypeOf from '../actions/setPrototypeOf.js';\n\n/**\n * Returns an object as a proxy and binds all instance methods\n * to the proxy instead of the object itself.\n *\n * @param Object|Array\t\ttarget\n * @param Object\t\t    params\n *\n * @return Proxy\n */\nexport default function(target, params = {}) {\n\tif (!_isTypeObject(target)) {\n\t\tthrow new Error('Object must be of type target; \"' + _getType(target) + '\" given!');\n    }\n    var proxy = new Proxy(target, {\n        apply:  (target, thisArgument, argumentsList) => apply(target, thisArgument, argumentsList, params),\n        construct:  (target, argumentsList, newTarget = null) => construct(target, argumentsList, newTarget, params),\n        defineProperty:  (target, propertyKey, attributes) => defineProperty(target, propertyKey, attributes, params),\n        deleteProperty: (target, propertyKey) => deleteProperty(target, propertyKey, params),\n        get: (target, propertyKey, receiver = null) => {\n            var val = get(target, propertyKey, receiver, params);\n            if (params.proxyAutoBinding !== false && _isFunction(val) && !_isClass(val)) {\n                return val.bind(proxy);\n            }\n            return val;\n        },\n        getOwnPropertyDescriptor: (target, propertyKey) => getOwnPropertyDescriptor(target, propertyKey, params),\n        getPrototypeOf: target => getPrototypeOf(target, params),\n        has: (target, propertyKey) => has(target, propertyKey, params),\n        isExtensible: target => isExtensible(target, params),\n        ownKeys: target => ownKeys(target, params),\n        preventExtensions: target => preventExtensions(target, params),\n        set: (target, propertyKey, value, receiver = null) => set(target, propertyKey, value, receiver, params),\n        setPrototypeOf: (target, prototype) => setPrototypeOf(target, prototype, params),\n    });\n    _internals(proxy).set(proxy, target);\n\treturn proxy;\n}\n", "\n/**\n * @imports\n */\nimport { _isFunction, _isTypeObject, _isObject, _getType } from '@webqit/util/js/index.js';\nimport _unproxy from '../actors/unproxy.js';\nimport Interceptors from '../core/Interceptors.js';\n\n/**\n * Adds a trap to an target's firebase.\n *\n * @param array|object\t\t\t\ttarget\n * @param object\t\t\t\t\ttrap\n * @param object\t\t\t\t\tparams\n *\n * @return Interceptor\n */\nexport default function(target, trap, params = {}) {\n\ttarget = _unproxy(target);\n\tif (!_isTypeObject(target)) {\n\t\tthrow new Error('Object must be of type target; \"' + _getType(handler) + '\" given!');\n\t}\n\tvar returnObj = {}, isOriginallyObj = true;\n\tif (!_isObject(trap)) {\n\t\t// Backwards compatibility\n\t\tif (_isFunction(trap)) {\n\t\t\ttrap = { '': trap };\n\t\t} else if (_isFunction(params)) {\n\t\t\ttrap = { [trap]: params };\n\t\t\tparams = arguments.length > 3 ? arguments[3] : {};\n\t\t}\n\t\tisOriginallyObj = false;\n\t}\n\tvar interceptors = Interceptors.getFirebase(target, true, params.namespace);\n\tObject.keys(trap).forEach(filter => {\n\t\tif (!_isFunction(trap[filter])) {\n\t\t\tthrow new Error('Callback' + (filter === null ? '' : ' for ' + filter) + ' must be a function; \"' + _getType(trap[filter]) + '\" given!');\n\t\t}\n\t\tvar dfn = { filter, handler: trap[filter], params }, existing;\n\t\tif (dfn.params.unique && (existing = interceptors.match(dfn)).length) {\n\t\t\tif (dfn.params.unique !== 'replace') {\n\t\t\t\treturn existing[0];\n\t\t\t}\n\t\t\tinterceptors.remove(existing[0]);\n\t\t}\n\t\tif (isOriginallyObj) {\n\t\t\treturnObj[filter] = interceptors.add(dfn);\n\t\t} else {\n\t\t\treturnObj = interceptors.add(dfn);\n\t\t}\n\t});\n\treturn returnObj;\n}\n", "\n/**\n * @imports\n */\nimport { _isFunction, _isTypeObject, _getType } from '@webqit/util/js/index.js';\nimport _unproxy from '../actors/unproxy.js';\nimport Interceptors from '../core/Interceptors.js';\n\n/**\n * Removes traps from an target's firebase.\n *\n * @param array|object\t\t\t\ttarget\n * @param object\t\t\t\t\ttrap\n * @param object\t\t\t\t\tparams\n *\n * @return void\n */\nexport default function(target, trap = null, params = {}) {\n\ttarget = _unproxy(target);\n\tif (!target || !_isTypeObject(target)) {\n\t\tthrow new Error('Object must be of type target; \"' + _getType(target) + '\" given!');\n\t}\n\tvar interceptors = Interceptors.getFirebase(target, false, params.namespace);\n\tif (!_isObject(trap)) {\n\t\t// Backwards compatibility\n\t\tif (_isFunction(trap)) {\n\t\t\ttrap = { [null]: trap };\n\t\t} else if (_isFunction(params)) {\n\t\t\ttrap = { [trap]: params };\n\t\t\tparams = arguments.length > 3 ? arguments[3] : {};\n\t\t}\n\t\tisOriginallyObj = false;\n\t}\n\tif (interceptors = Interceptors.getFirebase(target, false, params.namespace)) {\n\t\tObject.keys(trap).forEach(filter => {\n\t\t\tif (!_isFunction(trap[filter])) {\n\t\t\t\tthrow new Error('Callback' + (filter === null ? '' : ' for ' + filter) + ' must be a function; \"' + _getType(trap[filter]) + '\" given!');\n\t\t\t}\n\t\t\tvar dfn = { filter, originalHandler: trap[filter], params };\n\t\t\treturn interceptors.removeMatches(dfn);\n\t\t});\n\t}\n}\n", "\n/**\n * @imports\n */\nimport { _copy } from '@webqit/util/obj/index.js';\nimport { _unique } from '@webqit/util/arr/index.js';\nimport { _isArray, _isTypeObject } from '@webqit/util/js/index.js';\nimport _unproxy from '../actors/unproxy.js';\nimport Observers from '../core/Observers.js';\nimport unlink from '../connectors/unlink.js';\nimport link from '../connectors/link.js';\n\n/**\n * Executes a callback function on a target in \"closure\" mode.\n * Fires any observers that may be bound to target on recorded changes.\n *\n * @param function\t\tcallback\n * @param array\t\t\t...subjects\n *\n * @return array|Event\n */\nexport default function(callback, ...subjects) {\n\tvar context = subjects.map(target => {\n\t\ttarget = _unproxy(target);\n\t\tif (!_isTypeObject(target)) {\n\t\t\tthrow new Error('Target must be of type object!');\n\t\t}\n\t\treturn {\n\t\t\ttarget,\n\t\t\tsubjectCopy: _isArray(target) ? target.slice(0) : _copy(target),\n\t\t};\n\t});\n\t// ---------------------------------\n\tvar result = callback(...subjects);\n\t// ---------------------------------\n\tconst fireDiffs = () => {\n\t\tcontext.map(cntxt => {\n\t\t\tvar initialKeys = Object.keys(cntxt.subjectCopy);\n\t\t\tvar currentKeys = Object.keys(cntxt.target);\n\t\t\tvar related = [];\n\t\t\tvar changes = _unique(initialKeys.concat(currentKeys)).map(key => {\n\t\t\t\tif (cntxt.subjectCopy[key] !== cntxt.target[key]) {\n\t\t\t\t\trelated.push(key);\n\t\t\t\t\t// ---------------------------------\n\t\t\t\t\t// The event object\n\t\t\t\t\tvar e = {\n\t\t\t\t\t\tname:key,\n\t\t\t\t\t\trelated,\n\t\t\t\t\t\tbuffered: true,\n\t\t\t\t\t};\n\t\t\t\t\tif (currentKeys.includes(key)) {\n\t\t\t\t\t\te.type = 'set';\n\t\t\t\t\t\te.value = cntxt.target[key];\n\t\t\t\t\t\tif (initialKeys.includes(key)) {\n\t\t\t\t\t\t\te.isUpdate = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\te.type = 'del';\n\t\t\t\t\t}\n\t\t\t\t\tif (initialKeys.includes(key)) {\n\t\t\t\t\t\te.oldValue = cntxt.subjectCopy[key];\n\t\t\t\t\t}\n\t\t\t\t\t// ---------------------------------\n\t\t\t\t\t// Unobserve outgoing value for bubbling\n\t\t\t\t\tif (_isTypeObject(cntxt.subjectCopy[key])) {\n\t\t\t\t\t\tunlink(cntxt.target, key, cntxt.subjectCopy[key]);\n\t\t\t\t\t}\n\t\t\t\t\t// Observe incoming value for bubbling\n\t\t\t\t\tif (_isTypeObject(cntxt.target[key])) {\n\t\t\t\t\t\tlink(cntxt.target, key, cntxt.target[key]);\n\t\t\t\t\t}\n\t\t\t\t\treturn e;\n\t\t\t\t}\n\t\t\t}).filter(c => c);\n\t\t\t// ---------------------------------\n\t\t\tvar observers;\n\t\t\tif (changes.length && (observers = Observers.getFirebase(cntxt.target, false))) {\n\t\t\t\treturn observers.fire(changes);\n\t\t\t}\n\t\t});\n\t};\n\tif (result instanceof Promise) {\n\t\tresult.then(fireDiffs);\n\t} else {\n\t\tfireDiffs();\n\t}\n\treturn result;\n}\n", "\n/**\n * @imports\n */\n// Actions\nimport apply from './actions/apply.js';\nimport construct from './actions/construct.js';\nimport defineProperty from './actions/defineProperty.js';\nimport deleteProperty from './actions/deleteProperty.js';\nimport get from './actions/get.js';\nimport getOwnPropertyDescriptor from './actions/getOwnPropertyDescriptor.js';\nimport getPrototypeOf from './actions/getPrototypeOf.js';\nimport has from './actions/has.js';\nimport isExtensible from './actions/isExtensible.js';\nimport ownKeys from './actions/ownKeys.js';\nimport preventExtensions from './actions/preventExtensions.js';\nimport set from './actions/set.js';\nimport setPrototypeOf from './actions/setPrototypeOf.js';\n// Actors\nimport accessorize from './actors/accessorize.js';\nimport unaccessorize from './actors/unaccessorize.js';\nimport proxy from './actors/proxy.js';\nimport unproxy from './actors/unproxy.js';\n// Reactions\nimport observe from './reactions/observe.js';\nimport unobserve from './reactions/unobserve.js';\nimport intercept from './reactions/intercept.js';\nimport unintercept from './reactions/unintercept.js';\nimport closure from './reactions/closure.js';\n// Connectors\nimport build from './connectors/build.js';\nimport link from './connectors/link.js';\nimport unlink from './connectors/unlink.js';\n// Core\nimport Observers from './core/Observers.js';\nimport Interceptors from './core/Interceptors.js';\n\n/**\n * @exports\n */\nexport default {\n\t// Actions\n\tapply,\n\tconstruct,\n\tdefineProperty,\n\tdeleteProperty,\n\tget,\n\tgetOwnPropertyDescriptor,\n\tgetPrototypeOf,\n\thas,\n\tisExtensible,\n\townKeys,\n\tpreventExtensions,\n\tset,\n\tsetPrototypeOf,\n\t// Actors\n\taccessorize,\n\tunaccessorize,\n\tproxy,\n\tunproxy,\n\t// Reactions\n\tobserve,\n\tunobserve,\n\tintercept,\n\tunintercept,\n\tclosure,\n\t// Connectors\n\tbuild,\n\tlink,\n\tunlink,\n\t// Core\n\tObservers,\n\tInterceptors,\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport { _isFunction, _isString, _isObject } from '@webqit/util/js/index.js';\r\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\r\n\r\n/**\r\n * ---------------------\r\n * Ctxt Mutations Utilities\r\n * ---------------------\r\n */\r\n\r\n/**\r\n *\r\n * @var Map\r\n */\r\nexport default window => {\r\n\tconst wq = window.wq;\r\n\twq.apiMutationsBindings = [ new Map, new Map, ];\r\n\twq.apiMutationsBindings.hasListeners = () => wq.apiMutationsBindings.some( x => x.size );\r\n\twq.apiMutationsHooks = new Set;\r\n\treturn class Realtime {\r\n\r\n\t\t/**\r\n\t\t * Observes changes in attributes of the given element.\r\n\t\t *\r\n\t\t * @param Element\t\t\t\t\tcontext\r\n\t\t * @param array\t\t\t\t\t\tfilter\r\n\t\t * @param function\t\t\t\t\tcallback\r\n\t\t *\r\n\t\t * @return Realtime\r\n\t\t */\r\n\t\tattr( context, filter, callback ) {\r\n\t\t\t[ context, filter, callback ] = resolveArgs( arguments );\r\n\t\t\tconst mo = new window.MutationObserver( records => {\r\n\t\t\t\trecords.forEach( record => callback( {\r\n\t\t\t\t\ttarget: record.target,\r\n\t\t\t\t\tname: record.attributeName,\r\n\t\t\t\t\toldValue: record.oldValue,\r\n\t\t\t\t\ttype: 'attribute-record',\r\n\t\t\t\t}, context ) );\r\n\t\t\t} );\r\n\t\t\tconst params = { attributes: true, attributeOldValue: true };\r\n\t\t\tif ( filter.length ) { params.attributeFilter = filter; }\r\n\t\t\tmo.observe( context, params );\r\n\t\t\treturn mo;\r\n\t\t}\r\n\t\t\r\n\t\t/**\r\n\t\t * Mutation matching\r\n\t\t *\r\n\t\t * @param document|Element\t\t\tcallback\r\n\t\t * @param array|Element|string\t\tselectors\r\n\t\t * @param function\t\t\t\t\tcallback\r\n\t\t * @param object\t\t\t\t\tparams\r\n\t\t *\r\n\t\t * @return void\r\n\t\t */\r\n\t\tmatch( context, selectors, callback, params = {} ) {\r\n\t\t\t[ context, selectors, callback, params = {} ] = resolveArgs( arguments );\r\n\t\t\t// ------------------\r\n\t\t\tconst records = new Set, getRecord = target => {\r\n\t\t\t\tif ( !records.has( target ) ) {\r\n\t\t\t\t\trecords.set( target, {\r\n\t\t\t\t\t\ttarget, \r\n\t\t\t\t\t\tconnectedNodes: [], \r\n\t\t\t\t\t\tdisconnectedNodes: [],\r\n\t\t\t\t\t\ttype: 'query-record',\r\n\t\t\t\t\t} );\r\n\t\t\t\t}\r\n\t\t\t\treturn records.get( target );\r\n\t\t\t};\r\n\t\t\t// ------------------\r\n\t\t\tif ( selectors.every( selector => _isString( selector ) ) && ( selectors = selectors.join( ',' ) ) ) {\r\n\t\t\t\tif ( !params.on || params.on === 'connected' ) {\r\n\t\t\t\t\t( params.subtree ? context.querySelectorAll( selectors ) : context.children || [] ).forEach( node => {\r\n\t\t\t\t\t\tgetRecord( node.parentNode ).connectedNodes.push( node );\r\n\t\t\t\t\t} );\r\n\t\t\t\t}\r\n\t\t\t} else if ( selectors.every( selector => _isObject( selector ) ) ) {\r\n\t\t\t\tif ( context !== document || params.subtree ) {\r\n\t\t\t\t\tselectors.forEach( node => {\r\n\t\t\t\t\t\tconst isConnected = context === document ? node.isConnected : (\r\n\t\t\t\t\t\t\tnode.parentNode === context || ( params.subtree && context.contains( node ) )\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tif ( ( ( !params.on || params.on === 'connected' ) && isConnected ) || ( params.on === 'disconnected' && !isConnected ) ) {\r\n\t\t\t\t\t\t\tgetRecord( node.parentNode )[ isConnected ? 'connectedNodes' : 'disconnectedNodes' ].push( node );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// ------------------\r\n\t\t\trecords.forEach( record => callback( record, context ) );\r\n\t\t\t// ------------------\r\n\t\t\treturn this.observe( ...arguments );\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Mutation Observer\r\n\t\t * \r\n\t\t * @param document|Element\t\t\tcallback\r\n\t\t * @param array|Element|string\t\tselectors\r\n\t\t * @param function\t\t\t\t\tcallback\r\n\t\t * @param object\t\t\t\t\tparams\r\n\t\t * \r\n\t\t * @returns Object\r\n\t\t */\r\n\t\tobserve( context,  selectors, callback, params = {} ) {\r\n\t\t\t// ------------------------\r\n\t\t\t// If the document is still parsing, we need to detect\r\n\t\t\t// API-based DOM mutations so as for them to be treated differently\r\n\t\t\tconst { document } = window;\r\n\t\t\tif ( document.readyState === 'loading' && !wq.parsetimeApiMutations ) {\r\n\t\t\t\twq.parsetimeApiMutations = new Set;\r\n\t\t\t\tbindToApiMutations( window, record => {\r\n\t\t\t\t\tif ( !wq.parsetimeApiMutations ) return;\r\n\t\t\t\t\trecord.incomingNodes.concat( record.outgoingNodes ).forEach( node => {\r\n\t\t\t\t\t\twq.parsetimeApiMutations.add( node );\r\n\t\t\t\t\t} );\r\n\t\t\t\t} );\r\n\t\t\t\tdocument.addEventListener( 'readystatechange', () => {\r\n\t\t\t\t\twq.parsetimeApiMutations?.clear();\r\n\t\t\t\t\twq.parsetimeApiMutations = null;\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\t\t\t// ------------------------\r\n\t\t\t[ context, selectors, callback, params = {} ] = resolveArgs( arguments );\r\n\t\t\tconst mo = new window.MutationObserver( records => {\r\n\t\t\t\trecords.forEach( ( { target, addedNodes, removedNodes } ) => {\r\n\t\t\t\t\temit.call( this, context, {\r\n\t\t\t\t\t\ttarget,\r\n\t\t\t\t\t\taddedNodes,\r\n\t\t\t\t\t\tremovedNodes,\r\n\t\t\t\t\t\ttype: 'mutation-record',\r\n\t\t\t\t\t}/*!important*/, {\r\n\t\t\t\t\t\tselectors,\r\n\t\t\t\t\t\tcallback,\r\n\t\t\t\t\t\tparams: {\r\n\t\t\t\t\t\t\t// deepIntersect after document is done parsing OR for mutations done while still parsing\r\n\t\t\t\t\t\t\tdeepIntersect: node => document.readyState !== 'loading' || wq.parsetimeApiMutations?.has( node ),\r\n\t\t\t\t\t\t\t// deepIntersect may be overridden below\r\n\t\t\t\t\t\t\t...params,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t} );\r\n\t\t\t\t} );\r\n\t\t\t} );\r\n\t\t\tconst connect = () => mo.observe( context, { childList: true, subtree: params.subtree, } );\r\n\t\t\tconnect();\r\n\t\t\tconst controller = {\r\n\t\t\t\tdisconnect() {\r\n\t\t\t\t\tmo.disconnect();\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\treconnect() {\r\n\t\t\t\t\t\t\tconnect();\r\n\t\t\t\t\t\t\treturn controller;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t};\r\n\t\t\t\t},\r\n\t\t\t};\r\n\t\t\t// ------------------------\r\n\t\t\treturn controller;\r\n\t\t}\r\n\t\t\r\n\t\t/**\r\n\t\t * Mutation Interceptor\r\n\t\t * \r\n\t\t * @param document|Element\t\t\tcallback\r\n\t\t * @param array|Element|string\t\tselectors\r\n\t\t * @param function\t\t\t\t\tcallback\r\n\t\t * @param object\t\t\t\t\tparams\r\n\t\t * \r\n\t\t * @returns Object\r\n\t\t */\r\n\t\tintercept( context, selectors, callback, params = {} ) {\r\n\t\t\t[ context, selectors, callback, params = {} ] = resolveArgs( arguments );\r\n\t\t\t// -------------\r\n\t\t\tif ( !wq.apiMutationsBindings.intercepting ) {\r\n\t\t\t\tconst { document } = window;\r\n\t\t\t\twq.apiMutationsBindings.intercepting = true;\r\n\t\t\t\t// -----------\r\n\t\t\t\t// Interception handler\r\n\t\t\t\t// -----------\r\n\t\t\t\tconst intercept = record => {\r\n\t\t\t\t\twq.apiMutationsBindings.forEach( ( contexts, index ) => {\r\n\t\t\t\t\t\tcontexts.forEach( ( traps, context ) => {\r\n\t\t\t\t\t\t\tif ( !( record.target === context || ( index && ( context === document && record.target.isConnected || context.contains( record.target ) ) ) ) ) return;\r\n\t\t\t\t\t\t\ttraps.forEach( trap => {\r\n\t\t\t\t\t\t\t\tif ( record.type === 'mutation-record' ) {\r\n\t\t\t\t\t\t\t\t\t// Parse-based events are finegrained and should not be deep-intersected\r\n\t\t\t\t\t\t\t\t\ttrap = { ...trap, params: { ...trap.params, deepIntersect: false/* non-overridable */ } };\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t// API-based events aren't finegrained and should be deep-intersected\r\n\t\t\t\t\t\t\t\t\ttrap = { ...trap, params: { deepIntersect: true/* overridable */, ...trap.params } };\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\temit.call( this, context, record, trap );\r\n\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t} );\r\n\t\t\t\t};\r\n\t\t\t\tbindToApiMutations( window, intercept );\r\n\t\t\t\t// -----------\r\n\t\t\t\t// If the document is still loading, catch parser-based events\r\n\t\t\t\t// -----------\r\n\t\t\t\tif ( document.readyState === 'loading' ) {\r\n\t\t\t\t\tconst controller = this.observe( document, record => {\r\n\t\t\t\t\t\trecord = {\r\n\t\t\t\t\t\t\ttarget: record.target,\r\n\t\t\t\t\t\t\tincomingNodes: record.addedNodes.filter( node => !wq.parsetimeApiMutations?.has( node ) ),\r\n\t\t\t\t\t\t\toutgoingNodes: record.removedNodes.filter( node => !wq.parsetimeApiMutations?.has( node ) ),\r\n\t\t\t\t\t\t\ttype: record.type,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif ( !record.incomingNodes.length && !record.outgoingNodes.length ) return;\r\n\t\t\t\t\t\tintercept( record );\r\n\t\t\t\t\t}, { subtree: true } );\r\n\t\t\t\t\tdocument.addEventListener( 'readystatechange', () => controller.disconnect() );\r\n\t\t\t\t}\r\n\t\t\t\t// -----------\r\n\t\t\t}\r\n\t\t\t// -------------\r\n\t\t\tconst contexts = wq.apiMutationsBindings[ params.subtree ? 1 : 0 ];\r\n\t\t\tif ( !contexts.has( context ) ) { contexts.set( context, new Set ); }\r\n\t\t\t// -------------\r\n\t\t\tconst traps = contexts.get( context );\r\n\t\t\tconst trap = { selectors, callback, params };\r\n\t\t\ttraps.add( trap );\r\n\t\t\t// -------------\r\n\t\t\tconst controller = {\r\n\t\t\t\tdisconnect() {\r\n\t\t\t\t\ttraps.delete( trap );\r\n\t\t\t\t\tif ( !traps.size ) { contexts.delete( context ); }\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\treconnect() {\r\n\t\t\t\t\t\t\tif ( !traps.size ) {\r\n\t\t\t\t\t\t\t\treturn this.intercept( context, selectors, callback, params );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttraps.add( trap );\r\n\t\t\t\t\t\t\treturn controller;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t};\r\n\t\t\t\t},\r\n\t\t\t};\r\n\t\t\t// -------------\r\n\t\t\treturn controller;\r\n\t\t}\r\n\r\n\t};\r\n};\r\n\r\n\r\n/**\r\n * Resolves arguments\r\n * \r\n * @param Array \t\t\targs \r\n * \r\n * @returns Array\r\n */\r\nfunction resolveArgs( args ) {\r\n\tif ( _isFunction( args[ 1 ] ) ) {\r\n\t\targs = [ args[ 0 ], [], ...[ ...args ].slice( 1 ) ];\r\n\t} else {\r\n\t\targs[ 1 ] = _arrFrom( args[ 1 ], false/*castObject*/ );\r\n\t}\r\n\treturn args;\r\n}\r\n\r\n/**\r\n * Resolves arguments\r\n * \r\n * @param Document|Element \tcontext \r\n * @param Object \t\t\trecord \r\n * @param Object \t\t\ttrap \r\n * \r\n * @returns Array\r\n */\r\nfunction emit( context, record, trap ) {\r\n\tlet matches, _record = { ...record };\r\n\t[ 'addedNodes', 'incomingNodes', 'removedNodes', 'outgoingNodes' ].forEach( prop => {\r\n\t\tif ( !( prop in _record ) ) return;\r\n\t\tconst isExit = [ 'removedNodes', 'outgoingNodes' ].includes( prop );\r\n\t\tif ( ( isExit && trap.params.on === 'connected' ) || ( !isExit && trap.params.on === 'disconnected' ) ) {\r\n\t\t\t_record[ prop ] = [];\r\n\t\t} else if ( !trap.selectors.length ) {\r\n\t\t\t_record[ prop ] = [ ..._record[ prop ] ];\r\n\t\t\tmatches = true;\r\n\t\t} else if ( ( _record[ prop ] = intersectNodes.call(\r\n\t\t\tthis,\r\n\t\t\ttrap.selectors,\r\n\t\t\t_record[ prop ],\r\n\t\t\ttrap.params.deepIntersect,\r\n\t\t) ).length ) {\r\n\t\t\tmatches = true;\r\n\t\t}\r\n\t} );\r\n\tif ( matches ) {\r\n\t\ttrap.callback( _record, context );\r\n\t}\r\n}\r\n\r\n/**\r\n * Aggregates instances of els in sources\r\n * \r\n * @param Array \t\t\ttargets \r\n * @param Array \t\t\tsources \r\n * @param Bool|Function \tdeepIntersect \r\n * \r\n * @returns \r\n */\r\nfunction intersectNodes( targets, sources, deepIntersect ) {\r\n\tsources = Array.isArray( sources ) ? sources : [ ...sources ];\r\n\tconst match = ( sources, target ) => {\r\n\t\t// Filter out text nodes\r\n\t\tsources = sources.filter( source => source.matches );\r\n\t\tif ( _isString( target ) ) {\r\n\t\t\t// Is directly mutated...\r\n\t\t\tlet matches = sources.filter( source => source.matches( target ) );\r\n\t\t\t// Is contextly mutated...\r\n\t\t\tif ( deepIntersect === true || _isFunction( deepIntersect ) ) {\r\n\t\t\t\tmatches = sources\r\n\t\t\t\t\t.reduce( ( collection, source ) => {\r\n\t\t\t\t\t\tlet result = _isFunction( deepIntersect ) && !deepIntersect( source ) ? [] : source.querySelectorAll( target );\r\n\t\t\t\t\t\treturn [ ...collection, ...result ];\r\n\t\t\t\t\t}, matches );\r\n\t\t\t}\r\n\t\t\tif ( matches.length ) {\r\n\t\t\t\treturn matches;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// Is directly mutated...\r\n\t\t\tif ( sources.includes( target ) || (\r\n\t\t\t\t( deepIntersect === true || _isFunction( deepIntersect ) ) && sources.some( source => _isFunction( deepIntersect ) && !deepIntersect( source ) ? false : source.contains( target ) )\r\n\t\t\t) ) {\r\n\t\t\t\treturn [ target ];\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t// -------------------------------\r\n\t// Search can be expensive...\r\n\t// Multiple listeners searching the same thing in the same list?\r\n\tif ( !sources.$$searchCache ) { sources.$$searchCache = new Map; }\r\n\treturn targets.reduce( ( matches, target ) => {\r\n\t\tlet _matches;\r\n\t\tif ( sources.$$searchCache.has( target ) ) {\r\n\t\t\t_matches = sources.$$searchCache.get( target );\r\n\t\t} else {\r\n\t\t\t_matches = match( sources, target ) || [];\r\n\t\t\tif ( _isObject( target ) ) {\r\n\t\t\t\tsources.$$searchCache.set( target, _matches );\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn matches.concat( _matches );\r\n\t}, [] );\r\n}\r\n\r\n/**\r\n * Aggregates instances of els in sources\r\n * \r\n * @param window \t\t\twindow \r\n * @param Function \t\t\tcallback \r\n * \r\n * @returns \r\n */\r\nfunction bindToApiMutations( window, callback ) {\r\n\tconst wq = window.wq;\r\n\twq.apiMutationsHooks.add( callback );\r\n\tif ( wq.apiMutationsHooks.intercepting ) return;\r\n\twq.apiMutationsHooks.intercepting = true;\r\n\tconsole.warn( `DOM mutation APIs are now being intercepted.` )\r\n\tconst { document, Node, Element, HTMLElement } = window;\r\n\t// -----------\r\n\t// Interception handlers\r\n\t// -----------\r\n\tconst intercept = record => {\r\n\t\twq.apiMutationsHooks.forEach( callback => callback( record ) );\r\n\t};\r\n\t// -----------\r\n\t// Intercept DOM mutation methods\r\n\t// -----------\r\n\tconst originalApis = Object.create( null );\r\n\t// -----------\r\n\t[\r\n\t\t'insertBefore'/*Node*/, 'insertAdjacentElement', 'insertAdjacentHTML', 'setHTML',\r\n\t\t'replaceChildren', 'replaceWith', 'remove', 'replaceChild'/*Node*/, 'removeChild'/*Node*/, \r\n\t\t'before', 'after', 'append', 'prepend', 'appendChild'/*Node*/, \r\n\t].forEach( apiName => {\r\n\t\t// We'll be sure to monkey the correct interface\r\n\t\tconst Interface = [ 'insertBefore', 'replaceChild', 'removeChild', 'appendChild' ].includes( apiName ) ? Node : Element;\r\n\t\toriginalApis[ apiName ] = Interface.prototype[ apiName ];\r\n\t\t// In case newer methods like setHTML() are not supported\r\n\t\tif ( !originalApis[ apiName ] ) return;\r\n\t\t// Monkey now...\r\n\t\tInterface.prototype[ apiName ] = function( ...args ) {\r\n\t\t\t// Instance of Node interface? Abort!\r\n\t\t\tconst exec = () => originalApis[ apiName ].call( this, ...args );\r\n\t\t\tif ( !( this instanceof Element ) ) return exec();\r\n\t\t\t// Bail out early\r\n\t\t\t//if ( !wq.apiMutationsBindings.hasListeners() ) return exec();\r\n\t\t\t// --------------\r\n\t\t\t// Obtain outgoingNodes and incomingNodes\r\n\t\t\tlet outgoingNodes = [], incomingNodes = [], target = this;\r\n\t\t\tif ( [ 'insertBefore' ].includes( apiName ) ) {\r\n\t\t\t\tincomingNodes = [ args[ 0 ] ];\r\n\t\t\t} else if ( [ 'insertAdjacentElement', 'insertAdjacentHTML' ].includes( apiName ) ) {\r\n\t\t\t\tincomingNodes = [ args[ 1 ] ];\r\n\t\t\t\tif ( [ 'beforebegin', 'afterend' ].includes( args[ 0 ] ) ) {\r\n\t\t\t\t\ttarget = this.parentNode;\r\n\t\t\t\t}\r\n\t\t\t} else if ( [ 'setHTML', 'replaceChildren' ].includes( apiName ) ) {\r\n\t\t\t\toutgoingNodes = [ ...this.childNodes ];\r\n\t\t\t\tincomingNodes = apiName === 'replaceChildren' ? [ ...args ] : [ args[ 0 ] ];\r\n\t\t\t} else if ( [ 'replaceWith', 'remove' ].includes( apiName ) ) {\r\n\t\t\t\toutgoingNodes = [ this ];\r\n\t\t\t\tincomingNodes = apiName === 'replaceWith' ? [ ...args ] : [];\r\n\t\t\t\ttarget = this.parentNode;\r\n\t\t\t} else if ( ['replaceChild' ].includes( apiName ) ) {\r\n\t\t\t\toutgoingNodes = [ args[ 1 ] ];\r\n\t\t\t\tincomingNodes = [ args[ 0 ] ];\r\n\t\t\t} else if ( ['removeChild' ].includes( apiName ) ) {\r\n\t\t\t\toutgoingNodes = [ ...args ];\r\n\t\t\t} else {\r\n\t\t\t\t// 'before', 'after', 'append', 'prepend', 'appendChild'\r\n\t\t\t\tincomingNodes = [ ...args ];\r\n\t\t\t\tif ( [ 'before', 'after' ].includes( apiName ) ) {\r\n\t\t\t\t\ttarget = this.parentNode;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// --------------\r\n\t\t\t// Parse HTML to incomingNodes\r\n\t\t\tlet apiNameFinal = apiName;\r\n\t\t\tif ( [ 'insertAdjacentHTML', 'setHTML' ].includes( apiName ) ) {\r\n\t\t\t\tlet tempNodeName = this.nodeName;\r\n\t\t\t\tif ( apiName === 'insertAdjacentHTML' && [ 'beforebegin', 'afterend' ].includes( args[ 0 ] ) ) {\r\n\t\t\t\t\t// We can't handle this... and this is going to throw afterall\r\n\t\t\t\t\tif ( !this.parentNode ) return originalApis[ apiName ].call( this, ...args );\r\n\t\t\t\t\ttempNodeName = this.parentNode.nodeName;\r\n\t\t\t\t}\r\n\t\t\t\tconst temp = document.createElement( tempNodeName );\r\n\t\t\t\toriginalApis.setHTML.call( temp, incomingNodes[ 0 ], apiName === 'setHTML' ? args[ 1 ] : {} );\r\n\t\t\t\tincomingNodes = [ ...temp.childNodes ];\r\n\t\t\t\t// --------------  \r\n\t\t\t\tif ( apiName === 'insertAdjacentHTML' ) {\r\n\t\t\t\t\tapiNameFinal = 'insertAdjacentElement';\r\n\t\t\t\t\targs[ 1 ] = new DocumentFragment;\r\n\t\t\t\t\targs[ 1 ].append( ...temp.childNodes );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tapiNameFinal = 'replaceChildren';\r\n\t\t\t\t\targs = [ ...temp.childNodes ];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// --------------\r\n\t\t\tintercept( { target, incomingNodes, outgoingNodes, type: 'interception-record', event: [ this, apiName ] } );\r\n\t\t\t// --------------\r\n\t\t\treturn originalApis[ apiNameFinal ].call( this, ...args );\r\n\t\t}\r\n\t} );\r\n\t// -----------\r\n\t// Intercept DOM mutation properties\r\n\t// -----------\r\n\t[\r\n\t\t'outerHTML', 'outerText'/*HTMLElement*/, 'innerHTML', \r\n\t\t'innerText'/*HTMLElement*/,'textContent'/*Node*/, 'nodeValue'/*Node*/\r\n\t].forEach( apiName => {\r\n\t\t// We'll be sure to monkey the correct interface\r\n\t\tconst Interface = [ 'textContent', 'nodeValue' ].includes( apiName ) ? Node : (\r\n\t\t\t[ 'outerText', 'innerText' ].includes( apiName ) ? HTMLElement : Element\r\n\t\t);\r\n\t\toriginalApis[ apiName ] = Object.getOwnPropertyDescriptor( Interface.prototype, apiName );\r\n\t\tObject.defineProperty( Interface.prototype, apiName, { ...originalApis[ apiName ], set: function( value ) {\r\n\t\t\tlet exec = () => originalApis[ apiName ].set.call( this, value );\r\n\t\t\t// Instance of Node interface? Abort!\r\n\t\t\tif ( !( this instanceof Element ) ) return exec();\r\n\t\t\t// Bail out early\r\n\t\t\t//if ( !wq.apiMutationsBindings.hasListeners() ) return exec();\r\n\t\t\t// --------------\r\n\t\t\t// Obtain outgoingNodes and incomingNodes\r\n\t\t\tlet outgoingNodes = [], incomingNodes = [], target = this;\r\n\t\t\tif ( [ 'outerHTML', 'outerText' ].includes( apiName ) ) {\r\n\t\t\t\toutgoingNodes = [ this ];\r\n\t\t\t\ttarget = this.parentNode;\r\n\t\t\t} else {\r\n\t\t\t\t// 'innerHTML', 'innerText', 'textContent', 'nodeValue'\r\n\t\t\t\toutgoingNodes = [ ...this.childNodes ];\r\n\t\t\t}\r\n\t\t\t// --------------\r\n\t\t\t// Parse HTML to nodes\r\n\t\t\tif ( [ 'outerHTML', 'innerHTML' ].includes( apiName ) ) {\r\n\t\t\t\tlet tempNodeName = this.nodeName;\r\n\t\t\t\tif ( apiName === 'outerHTML' ) {\r\n\t\t\t\t\t// We can't handle this... and this is going to throw afterall\r\n\t\t\t\t\tif ( !this.parentNode ) return exec();\r\n\t\t\t\t\ttempNodeName = this.parentNode.nodeName;\r\n\t\t\t\t}\r\n\t\t\t\tconst temp = document.createElement( tempNodeName );\r\n\t\t\t\toriginalApis[ apiName ].set.call( temp, value );\r\n\t\t\t\tincomingNodes = [ ...temp.childNodes ];\r\n\t\t\t\t// -------------- \r\n\t\t\t\tif ( apiName === 'outerHTML' ) {\r\n\t\t\t\t\tvalue = new DocumentFragment;\r\n\t\t\t\t\tvalue.append( ...temp.childNodes );\r\n\t\t\t\t\texec = () => originalApis.replaceWith.call( this, value );\r\n\t\t\t\t} else {\r\n\t\t\t\t\texec = () => originalApis.replaceChildren.call( this, ...temp.childNodes );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// -------------- \r\n\t\t\tintercept( { target, incomingNodes, outgoingNodes, type: 'interception-record', event: [ this, apiName ] } );\r\n\t\t\t// -------------- \r\n\t\t\treturn exec();\r\n\t\t} } );\r\n\t} );\r\n\t// -----------\r\n\t// Intercept document mutation methods\r\n\t// -----------\r\n\t[ 'append', 'prepend' ].forEach( apiName => {\r\n\t\tconst originalApi = document[ apiName ];\r\n\t\tdocument[ apiName ] = function( ...args ) {\r\n\t\t\tintercept( {\r\n\t\t\t\ttarget: document,\r\n\t\t\t\tincomingNodes: args,\r\n\t\t\t\toutgoingNodes: [],\r\n\t\t\t\ttype: 'interception-record', \r\n\t\t\t\tevent: [ document, apiName ]\r\n\t\t\t} );\r\n\t\t\treturn originalApi.call( this || document, ...args );\r\n\t\t}\r\n\t} );\r\n}\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport _each from '@webqit/util/obj/each.js';\r\n\r\n/**\r\n * ---------------------------\r\n * Binds callbacks to requestAnimationFrame()\r\n * to create a central \"read/write\" phases for Ctxt access.\r\n * ---------------------------\r\n */\r\n\t\t\t\r\nexport default window => class Reflow {\r\n\r\n\t/**\r\n\t * Starts the loop.\r\n\t *\r\n\t * @return this\r\n\t */\r\n\tconstructor( asyncDOM = true ) {\r\n\t\tObject.defineProperty( this, 'window', { value: window } );\r\n\t\tObject.defineProperty( this, 'readCallbacks', { value: new Set } );\r\n\t\tObject.defineProperty( this, 'writeCallbacks', { value: new Set } );\r\n\t\tthis.async = asyncDOM;\r\n\t\tif ( this.window.requestAnimationFrame ) {\r\n\t\t\tthis._run();\r\n\t\t} else {\r\n\t\t\tthis.async = false;\r\n\t\t}\r\n\t}\r\n\r\n\t_run() {\r\n\t\tthis.window.requestAnimationFrame( () => {\r\n\t\t\tthis.readCallbacks.forEach( callback => {\r\n\t\t\t\tif ( !callback() ) {\r\n\t\t\t\t\tthis.readCallbacks.delete( callback );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t\tthis.writeCallbacks.forEach( callback => {\r\n\t\t\t\tif ( !callback() ) {\r\n\t\t\t\t\tthis.writeCallbacks.delete( callback );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t\tthis._run();\r\n\t\t} );\r\n\t}\r\n\t\r\n\t/**\r\n\t * Binds a callback to the \"read\" phase.\r\n\t *\r\n\t * @param function \tcallback\r\n\t * @param bool\t\twithPromise\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tonread( callback, withPromise = false ) {\r\n\t\tif ( withPromise ) {\r\n\t\t\treturn new Promise( ( resolve, reject ) => {\r\n\t\t\t\tif ( this.async === false ) {\r\n\t\t\t\t\tcallback( resolve, reject );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.readCallbacks.add( () => {\r\n\t\t\t\t\t\tcallback( resolve, reject );\r\n\t\t\t\t\t} );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t}\r\n\t\tif ( this.async === false ) {\r\n\t\t\tcallback();\r\n\t\t} else {\r\n\t\t\tthis.readCallbacks.add( callback );\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Binds a callback to the \"write\" phase.\r\n\t *\r\n\t * @param function \tcallback\r\n\t * @param bool\t\twithPromise\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tonwrite( callback, withPromise = false ) {\r\n\t\tif ( withPromise ) {\r\n\t\t\treturn new Promise( ( resolve, reject ) => {\r\n\t\t\t\tif ( this.async === false ) {\r\n\t\t\t\t\tcallback( resolve, reject );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.writeCallbacks.add( () => {\r\n\t\t\t\t\t\tcallback( resolve, reject );\r\n\t\t\t\t\t} );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t}\r\n\t\tif ( this.async === false ) {\r\n\t\t\tcallback();\r\n\t\t} else {\r\n\t\t\tthis.writeCallbacks.add( callback );\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * A special construct for Ctxt manipulations that span\r\n\t * one or more read/write cycles.\r\n\t *\r\n\t * @param function \tread\r\n\t * @param function \twrite\r\n\t * @param mixed\t\tprevTransaction\r\n\t *\r\n\t * @return void|mixed\r\n\t */\r\n\tcycle( onread, onwrite, prevTransaction ) {\r\n\t\tthis.onread( () => {\r\n\t\t\t// Record initial values\r\n\t\t\tconst readReturn = onread( prevTransaction );\r\n\t\t\t// Call erite, the transation\r\n\t\t\tconst callWrite = ( readReturn ) => {\r\n\t\t\t\tif ( readReturn === undefined ) return;\r\n\t\t\t\tthis.onwrite( () => {\r\n\t\t\t\t\tconst writeReturn = onwrite( readReturn, prevTransaction );\r\n\t\t\t\t\t// Repeat transaction\r\n\t\t\t\t\tconst repeatTransaction = ( writeReturn ) => {\r\n\t\t\t\t\t\tif ( writeReturn === undefined ) return;\r\n\t\t\t\t\t\tthis.cycle( onread, onwrite, writeReturn );\r\n\t\t\t\t\t};\r\n\t\t\t\t\t// ---------------------------------------\r\n\t\t\t\t\t// If \"write\" returns a promise, we wait until it is resolved\r\n\t\t\t\t\t// ---------------------------------------\r\n\t\t\t\t\tif ( writeReturn instanceof Promise ) {\r\n\t\t\t\t\t\twriteReturn.then( repeatTransaction );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\trepeatTransaction( writeReturn );\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\t\t\t};\r\n\t\t\t// ---------------------------------------\r\n\t\t\t// If \"read\" returns a promise, we wait until it is resolved\r\n\t\t\t// ---------------------------------------\r\n\t\t\tif ( readReturn instanceof Promise ) {\r\n\t\t\t\treadReturn.then( callWrite );\r\n\t\t\t} else {\r\n\t\t\t\tcallWrite( readReturn );\r\n\t\t\t}\r\n\t\t} );\r\n\t}\r\n\r\n}", "\r\n/**\r\n * Applies all supported polyfills\r\n */\r\nexport default function() {\r\n    CSS_escape.call( this );\r\n    Node_isConnected.call( this );\r\n    Element_matches.call( this );\r\n}\r\n\r\n/**\r\n * Polyfills the window.CSS object.\r\n *  \r\n * @return void\r\n */\r\nexport function CSS_escape() {\r\n    const window = this;\r\n    if ( !window.CSS ) { window.CSS = {} }\r\n    if ( !window.CSS.escape ) {\r\n        /**\r\n         * Polyfills the window.CSS.escape() function.\r\n         *  \r\n         * @param string str \r\n         * \r\n         * @return string\r\n         */\r\n        window.CSS.escape = str => str.replace( /([\\:@\\~\\$\\&])/g, '\\\\$1' );\r\n    }\r\n}\r\n\r\n/**\r\n * Polyfills the Node.prototype.isConnected property\r\n * \r\n * @see MDN\r\n  *  \r\n * @return bool\r\n*/\r\nexport function Node_isConnected() {\r\n    const window = this;\r\n    if ( !( 'isConnected' in window.Node.prototype ) ) {\r\n        Object.defineProperty( window.Node.prototype, 'isConnected', { get: function() {\r\n            return !this.ownerDocument || !(\r\n                this.ownerDocument.compareDocumentPosition( this )\r\n                & this.DOCUMENT_POSITION_DISCONNECTED);\r\n        } } );\r\n    }\r\n}\r\n\r\n/**\r\n * Polyfills the Element.prototype.matches() method\r\n * \r\n * @see MDN\r\n  *  \r\n * @return void\r\n*/\r\nexport function Element_matches() {\r\n    const window = this;\r\n    if ( !window.Element.prototype.matches ) {\r\n        window.Element.prototype.matches = \r\n        window.Element.prototype.matchesSelector || \r\n        window.Element.prototype.mozMatchesSelector ||\r\n        window.Element.prototype.msMatchesSelector || \r\n        window.Element.prototype.oMatchesSelector || \r\n        window.Element.prototype.webkitMatchesSelector ||\r\n        function( s ) {\r\n            var matches = ( this.document || this.ownerDocument ).querySelectorAll( s ),\r\n                i = matches.length;\r\n            while ( --i >= 0 && matches.item( i ) !== this ) {}\r\n            return i > -1;            \r\n        }\r\n    }\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport { _isNumeric } from '@webqit/util/js/index.js';\r\nimport { _set, _get, _merge } from '@webqit/util/obj/index.js';\r\nimport createRealtimeClass from './Realtime.js';\r\nimport createReflowClass from './Reflow.js';\r\nimport polyfill from './polyfills.js';\r\n\r\nexport default function() {\r\n    const window = this;\r\n    if ( !window.wq ) window.wq = {};\r\n    if ( window.wq.dom ) return window.wq.dom;\r\n    window.wq.dom = {};\r\n    polyfill.call( window );\r\n    // ------\r\n    const Reflow = createReflowClass( window );\r\n    window.wq.dom.Reflow = new Reflow;\r\n    // ------\r\n    const Realtime = createRealtimeClass( window );\r\n    window.wq.dom.Realtime = new Realtime;\r\n    // ------\r\n    window.wq.dom.ready = ready.bind( window );\r\n    window.wq.dom.meta = meta.bind( window );\r\n    // ------\r\n    return window.wq.dom;\r\n}\r\n\r\n\r\n/**\r\n * DOM-ready listeners.\r\n * \r\n * @param Function\t    \t\tcallback\r\n * \r\n * @return void\r\n */\r\nfunction ready( callback ) {\r\n\tconst window = this;\r\n\tif ( window.document.readyState === 'complete' ) {\r\n\t\tcallback( window );\r\n\t} else {\r\n\t\tif ( !window.document.domReadyCallbacks ) {\r\n\t\t\twindow.document.domReadyCallbacks = [];\r\n\t\t\twindow.document.addEventListener( 'DOMContentLoaded', () => {\r\n\t\t\t\twindow.document.domReadyCallbacks.splice( 0 ).forEach( cb => cb( window ) );\r\n\t\t\t}, false );\r\n\t\t}\r\n\t\twindow.document.domReadyCallbacks.push( callback );\r\n\t}\r\n}\r\n\r\n/**\r\n * A wq's meta tag props reader.\r\n *  \r\n * @param String name\r\n * @param Bool\t readWrite\r\n * \r\n * @return Object\r\n */\r\nfunction meta( name, readWrite = false ) {\r\n    const window = this;\r\n    const metaInstance = { content: {} };\r\n    // Initialize reader\r\n    if ( !(metaInstance.el = window.document.querySelector( `meta[name=\"${ name }\"]` ) ) && readWrite ) {\r\n        metaInstance.el = window.document.createElement( 'meta' );\r\n        metaInstance.el.setAttribute( 'name', name );\r\n        window.document.head.append( metaInstance.el );\r\n    }\r\n    if ( metaInstance.el ) {\r\n        metaInstance.content = ( metaInstance.el.getAttribute( 'content' ) || '' ).split( ';' ).filter( v => v ).reduce( ( _metaVars, directive ) => {\r\n            const directiveSplit = directive.split( '=' ).map( d => d.trim() );\r\n            _set( _metaVars, directiveSplit[ 0 ].split( '.' ), directiveSplit[ 1 ] === 'true' \r\n                ? true : (directiveSplit[ 1 ] === 'false' ? false : (\r\n                    _isNumeric( directiveSplit[ 1 ] ) ? parseInt( directiveSplit[ 1 ] ) : directiveSplit[ 1 ]\r\n                ) )\r\n            );\r\n            return _metaVars;\r\n        }, {} );\r\n    }\r\n    // Read prop...\r\n    metaInstance.get = function( prop ) { return JSON.parse( JSON.stringify( _get( this.content, prop.split( '.' ) ) ) ); }\r\n    // Copy...\r\n    metaInstance.copy = function() {\r\n\t\treturn JSON.parse( JSON.stringify( this.content ) );\r\n    };\r\n\t// Copy with defaults...\r\n    metaInstance.copyWithDefaults = function( ...defaults ) {\r\n\t\tif ( defaults.length ) return _merge( true, {}, ...defaults.reverse().concat( this.content ) );\r\n\t\treturn this.copy();\r\n    };\r\n    return metaInstance;\r\n}", "\r\n/**\r\n * @exports\r\n */\r\nexport function resolveParams( extensions = {} ) {\r\n    return {\r\n        runtimeParams: { ...runtimeParams, ...( extensions.runtimeParams || {} ) },\r\n        compilerParams: { ...compilerParams, ...( extensions.compilerParams || {} ) },\r\n        parserParams: { ...parserParams, ...( extensions.parserParams || {} ) },\r\n    }\r\n}\r\nexport const parserParams = {\r\n    ecmaVersion: '2020',\r\n    allowReturnOutsideFunction: true,\r\n    allowAwaitOutsideFunction: true,\r\n    allowSuperOutsideMethod: true,\r\n    preserveParens: false,\r\n    locations: false,\r\n};\r\nexport const compilerParams = {\r\n    globalsNoObserve: [ 'globalThis', 'arguments', 'console', ],\r\n    originalSource: true,\r\n    globalsOnlyPaths: false,\r\n    locations: true,\r\n    compact: 2,\r\n};\r\nexport const runtimeParams = {\r\n    apiVersion: 1,\r\n};\r\n", "\r\n/**\r\n * @normalizeTabs\r\n */\r\nexport  function normalizeTabs( rawSource, isFunc = false ) {\r\n    let rawSourceSplit = rawSource.split(/\\n/g);\r\n    if ( rawSourceSplit.length > 1 ) {\r\n        while ( !rawSourceSplit[ 0 ].trim().length ) rawSourceSplit.shift();\r\n        let possibleBodyIndentLevel = rawSourceSplit[ isFunc ? 1 : 0 ].split(/[^\\s]/)[ 0 ].length;\r\n        if ( possibleBodyIndentLevel ) {\r\n            return rawSourceSplit.map( ( line, i ) => {\r\n                let possibleIndent = line.substring( 0, possibleBodyIndentLevel );\r\n                if ( !possibleIndent.trim().length ) {\r\n                    return line.substring( possibleBodyIndentLevel );\r\n                }\r\n                // Last line?\r\n                if ( possibleIndent.trim() === '}' && i === rawSourceSplit.length - 1 ) {\r\n                    return '}';\r\n                }\r\n                return line;\r\n            } ).join( \"\\n\" );\r\n        }\r\n    }\r\n    return rawSource;\r\n}\r\n\r\nexport const _await = ( maybePromise, callback ) => (\r\n    maybePromise instanceof Promise ? maybePromise.then( callback ) : callback( maybePromise )\r\n);\r\n\r\nexport  const _compare = ( a, b ) => {\r\n    if ( typeof a === 'object' && a && typeof b === 'object' && b ) return _deepEql( a, b );\r\n    if ( Array.isArray( a ) && Array.isArray( b ) && a.length === b.length ) return a.every( valueA => b.some( valueB => _compare( valueA, valueB ) ) );\r\n    return a === b;\r\n};\r\n\r\nexport  const _deepEql = function( a, b ) {\r\n    for ( let key in a ) {\r\n        if ( !_compare( a[ key ], b[ key ] ) ) return false;\r\n    }\r\n    return true;\r\n};", "\r\n/**\r\n * @exports\r\n */\r\nconst store = new Map;\r\nexport default function( _function, property, value = undefined ) {\r\n    let insp = store.get( _function );\r\n    if ( arguments.length > 2 ) {\r\n        if ( !insp ) {\r\n            insp = new Map;\r\n            store.set( _function, insp );\r\n        }\r\n        insp.set( property, value );\r\n        return;\r\n    }\r\n    return insp && insp.get( property );\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport { _await } from '../util.js';\r\nimport inspection from './inspect.js';\r\n\r\nexport default class Contract {\r\n\r\n    constructor( ownerContract, graph, callee, params = {}, $thread = null, exits = null ) {\r\n        this.ownerContract = ownerContract;\r\n        this.graph = graph;\r\n        this.callee = callee;\r\n        this.params = !ownerContract ? { ...params, isSubscriptFunction: true } : params;\r\n        this.exits = exits || new Map;\r\n        this.$thread = $thread || { entries: new Map, sequence: [], ownerContract: this };\r\n        this.subContracts = new Map;\r\n        this.observers = [];\r\n        this.contract = function( contractId, arg1, arg2 = null, arg3 = null ) {\r\n            if ( !this.graph.subContracts[ contractId ] ) {\r\n                throw new Error( `[${ this.graph.type }:${ this.graph.lineage }]: Graph not found for child contract ${ contractId }.` );\r\n            }\r\n\r\n            let subGraph = this.graph.subContracts[ contractId ];\r\n            let subParams = {\r\n                ...this.params,\r\n                isIterationContract: arguments.length === 3,\r\n                iterationId: arguments.length === 3 && arg1,\r\n                isFunctionContract: arguments.length === 4,\r\n                functionType: arguments.length === 4 && arg1,\r\n                isSubscriptFunction: arguments.length === 4 && arg2,\r\n                functionScope: ( this.params.isFunctionContract && this.graph.lineage ) || this.params.functionScope,\r\n            };\r\n\r\n            if ( subParams.isIterationContract ) {\r\n                // This is an iteration contract\r\n                let callee = arg2;\r\n                // Create iteration\r\n                let iterationInstanceContract = new Contract( this, subGraph, callee, subParams, this.$thread, this.exits );\r\n                // Add iteration\r\n                let iterations = this.subContracts.get( contractId );\r\n                if ( !iterations ) {\r\n                    iterations = new Map;\r\n                    this.subContracts.set( contractId, iterations );\r\n                }\r\n                // Dispose all existing\r\n                if ( iterations.has( subParams.iterationId ) ) {\r\n                    iterations.get( subParams.iterationId ).dispose();\r\n                }\r\n                iterations.set( subParams.iterationId, iterationInstanceContract );\r\n                return iterationInstanceContract.call();\r\n            }\r\n\r\n            let callee, subContract, returnValue;\r\n            // Dispose existing\r\n            if ( this.subContracts.has( contractId ) ) {\r\n                this.subContracts.get( contractId ).dispose();\r\n            }\r\n\r\n            if ( subParams.isFunctionContract ) {\r\n                // Function contracts\r\n                callee = arg3;\r\n                const createCallback = () => new Contract( this, subGraph, callee, subParams );\r\n                if ( subParams.functionType !== 'FunctionDeclaration' ) {\r\n                    returnValue = this.createFunction( createCallback );\r\n                } else {\r\n                    let subContract = createCallback();\r\n                    if ( subParams.apiVersion > 1 ) {\r\n                        returnValue = function( ...args ) {\r\n                            let _returnValue = subContract.call( this, ...args );\r\n                            _returnValue = _await( _returnValue, __returnValue => [ _returnValue, subContract.thread.bind( subContract ), subContract ] );\r\n                            subContract = createCallback();\r\n                            return _returnValue;\r\n                        }\r\n                        returnValue.target = subContract;\r\n                    } else {\r\n                        returnValue = subContract;\r\n                    }\r\n                }\r\n            } else {\r\n                // Regular contracts\r\n                callee = arg1, subContract = new Contract( this, subGraph, callee, subParams, this.$thread, this.exits );\r\n                this.subContracts.set( contractId, subContract );\r\n                returnValue = subContract.call();\r\n            }\r\n\r\n            return returnValue;\r\n        }.bind( this );\r\n        // ---------------------------\r\n        this.contract.memo = Object.create( null );\r\n        if ( this.ownerContract && ![ 'FunctionDeclaration', 'FunctionExpression' ].includes( this.graph.type ) ) {\r\n            this.contract.args = this.ownerContract.contract.args;\r\n        }\r\n        // ---------------------------\r\n        this.contract.exiting = function( keyword, arg ) {\r\n            if ( !arguments.length ) return this.exits.size;\r\n            let exitMatch = this.exits.get( keyword ) === arg;\r\n            if ( exitMatch ) this.exits.clear();\r\n            return exitMatch;\r\n        }.bind( this );\r\n        // ---------------------------\r\n        this.contract.exit = function( keyword, arg ) {\r\n            this.exits.set( keyword, arg );\r\n        }.bind( this );\r\n        // ---------------------------\r\n        this.contract.functions = new Map;\r\n        this.contract.functions.declaration = ( functionDeclaration, callTarget ) => {\r\n            this.contract.functions.set( functionDeclaration, callTarget );\r\n            this.applyReflection( functionDeclaration, typeof callTarget === 'function' ? callTarget.target : callTarget );\r\n        }\r\n    }\r\n\r\n    fire( contractUrl, event, refs ) {\r\n        if ( !this.ownerContract ) return;\r\n        const ret = this.ownerContract.fire( contractUrl, event, refs );\r\n        this.observers.forEach( observer => {\r\n            if ( observer.contractUrl !== contractUrl ) return;\r\n            observer.callback( event, refs );\r\n        } );\r\n        return ret;\r\n    }\r\n\r\n    observe( contractUrl, callback ) {\r\n        if ( !this.params.isFunctionContract ) return;\r\n        this.observers.push( { contractUrl, callback } );\r\n    }\r\n\r\n    call( $this, ...$arguments ) {\r\n        if ( this.disposed ) {\r\n            throw new Error( `[${ this.graph.type }:${ this.graph.lineage }]: Instance not runable after having been disposed.` );\r\n        }\r\n        if ( !this.ownerContract ) {\r\n            this.contract.args = $arguments;\r\n            Object.defineProperty( this.contract.args, Symbol.toStringTag, { value: 'Arguments' } );\r\n        }\r\n        let returnValue = this.callee.call( $this, this.contract, ...$arguments );\r\n        if ( this.graph.$sideEffects ) {\r\n            for ( let referenceId in this.graph.effects ) {\r\n                for ( let effectRef of this.graph.effects[ referenceId ].refs ) {\r\n                    // Build side effects\r\n                    this.buildThread( [], effectRef, [], 0, true );\r\n                }\r\n            }\r\n        }\r\n        return _await( returnValue, () => {\r\n            if ( !this.ownerContract || this.params.isFunctionContract ) {\r\n                let exitReturnValue = this.exits.get( 'return' );\r\n                this.exits.clear();\r\n                if ( exitReturnValue !== undefined ) return exitReturnValue;\r\n            }\r\n            return returnValue;\r\n        } );\r\n    }\r\n\r\n    iterate( keys = [] ) {\r\n        if ( this.disposed ) return false;\r\n        if ( ![ 'ForOfStatement', 'ForInStatement' ].includes( this.graph.type ) || this.subContracts.size !== 1 ) {\r\n            throw new Error( `Contract ${ this.graph.lineage } is not an iterator.` );\r\n        }\r\n        let [ [ /* iterationContractId */, iterationInstances ] ] = this.subContracts;\r\n        let prev\r\n        if ( !keys.length || ( keys.includes( 'length' ) && this.graph.type === 'ForOfStatement' ) ) {\r\n            for ( let [ /* iterationId */, iterationInstance ] of iterationInstances ) {\r\n                prev = _await( prev, () => iterationInstance.call() );\r\n            }\r\n        } else {\r\n            for ( let key of keys ) {\r\n                let instance = iterationInstances.get( key ) || iterationInstances.get( parseInt( key ) );\r\n                if ( !instance ) continue;\r\n                prev = _await( prev, () => instance.call() );\r\n            }\r\n        }\r\n        return prev;\r\n    }\r\n\r\n    thread( ...eventRefs ) {\r\n        if ( this.disposed ) return false;\r\n        this.$thread.active = true;\r\n        for ( let referenceId in this.graph.effects ) {\r\n            for ( let effectRef of this.graph.effects[ referenceId ].refs ) {\r\n                for ( let eventRef of eventRefs ) {\r\n                    let [ isMatch, remainder, computes ] = this.matchRefs( eventRef, effectRef );\r\n                    if ( !isMatch ) continue;\r\n                    this.buildThread( eventRef, effectRef, computes, remainder );\r\n                }\r\n            }\r\n        }\r\n        return this.runThread();\r\n    }\r\n\r\n    runThread() {\r\n        let execute = ( entry, refs ) => {\r\n            if ( [ 'ForOfStatement', 'ForInStatement' ].includes( entry.graph.type ) \r\n            && refs.every( ref => ref.executionPlan.isIterationContractTarget ) ) {\r\n                let targets = refs.map( ref => ref.executionPlan.iterationTarget );\r\n                this.fire( entry.graph.lineage, 'iterating', refs );\r\n                return entry.iterate( targets );\r\n            }\r\n            this.fire( entry.graph.lineage, 'executing', refs );\r\n            return entry.call();\r\n        };\r\n        let prev, entry, refs;\r\n        while ( \r\n            ( entry = this.$thread.sequence.shift() ) \r\n            && ( refs = [ ...this.$thread.entries.get( entry ) ] ) \r\n            && this.$thread.entries.delete( entry ) // Important: to allow re-entry on susequent threads\r\n        ) {\r\n            prev = _await( prev, () => {\r\n                if ( entry.disposed || !entry.filterRefs( refs ).length ) return;\r\n                this.$thread.current = entry;\r\n                let maybePromise = execute( entry, refs );\r\n                _await( maybePromise, () => {\r\n                    for ( let ref of refs ) {\r\n                        [].concat( ref.executionPlan.assigneeRef || ref.executionPlan.assigneeRefs || [] ).forEach( assigneeRef => {\r\n                            entry.buildThread( [], assigneeRef, [], 0 );\r\n                        } );\r\n                    }\r\n                } );\r\n                return maybePromise;\r\n            } );\r\n        }\r\n        return _await( prev, () => {\r\n            let _ret = this.exits.get( 'return' );\r\n            this.exits.clear();\r\n            this.$thread.current = null;\r\n            this.$thread.active = false;\r\n            return _ret;\r\n        } );\r\n    }\r\n\r\n    buildThread( eventRef, effectRef, computes, remainder = 0, isSideEffect = false ) {\r\n        let shouldMatchEventRef = remainder > 0;\r\n        if ( this.ownerContract ) {\r\n            // IMPORTANT: effectRef at global level are not supposed to be checked for computes and condition\r\n            if ( !this.compute( computes ) ) return;\r\n            if ( effectRef.condition !== undefined && !this.assert( effectRef.condition ) ) return;\r\n        } else if ( !shouldMatchEventRef ) {\r\n            shouldMatchEventRef = computes.length || effectRef.condition !== undefined;\r\n        }\r\n        let subscriptionsObject = isSideEffect ? effectRef.$subscriptions : effectRef.subscriptions;\r\n        // First we assert the conditions for the effectRef before moving on\r\n        Object.keys( subscriptionsObject ).forEach( fullReferenceUrl => {\r\n            let [ contractUrl, referenceId ] = fullReferenceUrl.split( ':' );\r\n            let selectRefs = _subscriberInstance => {\r\n                if ( !_subscriberInstance ) return;\r\n                _subscriberInstance.selectRefs( referenceId, subscriptionsObject[ fullReferenceUrl ], shouldMatchEventRef ? eventRef : null );\r\n            }\r\n            // We find the subscriber instance\r\n            let subscriberInstance = this.locate( contractUrl );\r\n            if ( Array.isArray( subscriberInstance ) ) {\r\n                subscriberInstance.forEach( selectRefs );\r\n            } else {\r\n                selectRefs( subscriberInstance );\r\n            }\r\n        } );\r\n    }\r\n\r\n    selectRefs( referenceId, refIds, eventRef = null ) {\r\n        // We'll select refs from within the following reference\r\n        let $thread = this.$thread;\r\n        let reference = this.graph.signals[ referenceId ];\r\n        // -----------------------------------------\r\n        let compare = ( a, b ) => a.graph.lineage.localeCompare( b.graph.lineage, undefined, { numeric: true } );\r\n        let selectRef = ( ref, computes = [], executionPlan = {} ) => {\r\n            // If this addition is by the side effect of a function, \"this\" can sometimes be higher in scope\r\n            if ( !$thread.active ) return;\r\n            if ( $thread.current && compare( this, $thread.current ) < 0 ) return;\r\n            let refs = $thread.entries.get( this );\r\n            if ( !refs ) {\r\n                refs = new Set;\r\n                $thread.entries.set( this, refs );\r\n                $thread.sequence.push( this );\r\n                $thread.sequence.sort( compare );\r\n            }\r\n            refs.add( { ...ref, computes, executionPlan } );\r\n            if ( !executionPlan.assigneeRef && [ 'VariableDeclaration', 'AssignmentExpression' ].includes( this.graph.type ) ) {\r\n                executionPlan.assigneeRefs = [];\r\n                for ( let referenceId in this.graph.effects ) {\r\n                    executionPlan.assigneeRefs.push( ...this.graph.effects[ referenceId ].refs )\r\n                }\r\n            }\r\n        };\r\n        // -----------------------------------------\r\n        for ( let refId of refIds ) {\r\n            // The ref within reference\r\n            let ref = reference.refs[ refId ];\r\n            // First we assert the conditions for the ref before moving on\r\n            if ( !eventRef ) {\r\n                // AffectedRef matched event ref... So we select ALL refs within reference\r\n                selectRef( ref );\r\n                continue;\r\n            }\r\n            // We match ref to decide whether or how to select it\r\n            let [ isMatch_b, remainder_b, computes_b ] = this.matchRefs( eventRef, ref );\r\n            if ( !isMatch_b ) continue;\r\n            if ( remainder_b <= 0 ) {\r\n                // SubscriberRef matches event ref\r\n                selectRef( ref, computes_b );\r\n                continue;\r\n            }\r\n            let eventRef_balance = eventRef.slice( -remainder_b );\r\n            let assigneeReference = 'assignee' in reference ? this.graph.effects[ reference.assignee ] : null;\r\n            if ( assigneeReference ) {\r\n                assigneeReference.refs.forEach( assigneeRef => {\r\n                    if ( assigneeRef.depth.length ) {\r\n                        let [ isMatch_c, remainder_c, computes_c ] = this.matchRefs( eventRef_balance, assigneeRef.depth );\r\n                        let computes_d = computes_b.concat( computes_c );\r\n                        if ( isMatch_c && remainder_c > 0 ) {\r\n                            // We move on passively to effects on the assignee\r\n                            let newEventRef = assigneeRef.path.concat( eventRef_balance.slice( -remainder_c ) );\r\n                            this.buildThread( newEventRef, assigneeRef, computes_d, remainder_c );\r\n                        } else if ( isMatch_c ) {\r\n                            // Match is successful on the destructuring side... so we select\r\n                            selectRef( ref, computes_d, { assigneeRef } );\r\n                        }\r\n                    } else {\r\n                        // We move on passively to effects on the assignee\r\n                        let newEventRef = assigneeRef.path.concat( eventRef_balance );\r\n                        this.buildThread( newEventRef, assigneeRef, computes_b, remainder_b );\r\n                    }\r\n                } );\r\n                continue;\r\n            }\r\n            if ( remainder_b === 1 && this.graph.type === 'ForOfStatement' ) {\r\n                // An iteration item was changed or the length property of the list was changed\r\n                selectRef( ref, computes_b, { isIterationContractTarget: true, iterationTarget: eventRef_balance[ 0 ] } );\r\n                continue;\r\n            }\r\n            if ( remainder_b === 1 && this.graph.type === 'ForInStatement' ) {\r\n                // An iteration property was changed\r\n                selectRef( ref, computes_b, { isIterationContractTarget: true, iterationTarget: eventRef_balance[ 0 ] } );\r\n                continue;\r\n            }\r\n        }\r\n    }\r\n\r\n    filterRefs( refs ) {\r\n        return refs.filter( ref => {\r\n            if ( !this.compute( ref.computes ) ) return;\r\n            if ( ref.condition !== undefined && !this.assert( ref.condition ) ) return;\r\n            return true;\r\n        } );\r\n    }\r\n\r\n    matchRefs( a, b ) {\r\n        let pathA, $pathA, pathB, $pathB;\r\n        if ( Array.isArray( a ) ) {\r\n            pathA = a, $pathA = a.dotSafe ? a.join( '.' ) : undefined;\r\n        } else {\r\n            pathA = a.path, $pathA = a.$path;\r\n        }\r\n        if ( Array.isArray( b ) ) {\r\n            pathB = b, $pathB = b.dotSafe ? b.join( '.' ) : undefined;\r\n        } else {\r\n            pathB = b.path, $pathB = b.$path;\r\n        }\r\n        let remainder = pathA.length - pathB.length;\r\n        if ( remainder > 0 ) {\r\n            [ pathA, pathB, $pathA, $pathB ] = [ pathB, pathA, $pathB, $pathA ];\r\n        }\r\n        if ( $pathA && $pathB ) {\r\n            return [ `${ $pathB }.`.startsWith( `${ $pathA }.` ), remainder, [] ];\r\n        }\r\n        let computes = [];\r\n        let getVal = element => ( typeof element === 'object' ? element.name : element );\r\n        let compareIdentifiers = ( a, b ) => {\r\n            if ( !a || !b ) return false;\r\n            let isComputeA = typeof a === 'object' && ( 'memoId' in a ),\r\n                isComputeB = typeof b === 'object' && ( 'memoId' in b );\r\n            if ( isComputeA || isComputeB ) {\r\n                computes.push( memo => {\r\n                    return ( isComputeA ? memo[ a.memoId ] : getVal( a ) ) === ( isComputeB ? memo[ b.memoId ] : getVal( b ) ) \r\n                } );\r\n                return true;\r\n            }\r\n            return getVal( a ) === getVal( b );\r\n        };\r\n        return [\r\n            pathA.reduce( ( prev, identifier, i ) => prev && compareIdentifiers( identifier, pathB[ i ] ), true ),\r\n            remainder,\r\n            computes,\r\n        ];\r\n    }\r\n\r\n    locate( contractUrl ) {\r\n        let ownLineage_ = this.graph.lineage + '/';\r\n        let contractUrl_ = contractUrl + '/';\r\n        if ( contractUrl_ === ownLineage_ ) return this;\r\n        if ( contractUrl_.startsWith( ownLineage_ ) ) {\r\n            let postLineage = contractUrl.slice( ownLineage_.length ).split( '/' );\r\n            let subContract = this.subContracts.get( parseInt( postLineage.shift() ) );\r\n            if ( postLineage.length) {\r\n                if ( subContract instanceof Map ) {\r\n                    return Array.from( subContract ).reduce( ( subContracts, [ key, _subContract ] ) => {\r\n                        return subContracts.concat( _subContract.locate( contractUrl ) );\r\n                    }, [] );\r\n                }\r\n                if ( subContract ) {\r\n                    return subContract.locate( contractUrl );\r\n                }\r\n            }\r\n            return subContract;\r\n        }\r\n        if ( this.ownerContract ) {\r\n            return this.ownerContract.locate( contractUrl );\r\n        }\r\n    }\r\n\r\n    compute( computes ) {\r\n        return !computes.some( compute => compute( this.contract.memo ) === false );\r\n    }\r\n\r\n    assert( condition ) {\r\n        if ( typeof condition === 'string' && condition.includes( ':' ) ) {\r\n            let [ contractUrl, _condition ] = condition.split( ':' );\r\n            return this.locate( contractUrl ).assert( _condition );\r\n        }\r\n        let conditionDef = this.graph.conditions[ condition ];\r\n        let memo = this.contract.memo;\r\n        if ( typeof conditionDef.parent !== 'undefined'  && !this.assert( conditionDef.parent ) ) return false;\r\n        if ( typeof conditionDef.switch !== 'undefined' ) {\r\n            return conditionDef.cases.some( _case => memo[ _case ] === memo[ conditionDef.switch ] );\r\n        }\r\n        if ( typeof conditionDef.whenNot !== 'undefined' ) {\r\n            return !memo[ conditionDef.whenNot ];\r\n        }\r\n        if ( typeof conditionDef.when !== 'undefined' ) {\r\n            return memo[ conditionDef.when ];\r\n        }\r\n        return true;\r\n    }\r\n\r\n    dispose() {\r\n        if ( this.params.isFunctionContract ) return;\r\n        this.subContracts.forEach( ( subContract, contractId ) => {\r\n            if ( subContract instanceof Map ) {\r\n                subContract.forEach( subContract => subContract.dispose() );\r\n                subContract.clear();\r\n            } else {\r\n                subContract.dispose();\r\n            }\r\n        } );\r\n        this.subContracts.clear();\r\n        delete this.ownerContract;\r\n        delete this.callee;\r\n        delete this.params;\r\n        delete this.contract.memo;\r\n        this.disposed = true;\r\n    }\r\n    \r\n    createFunction( createCallback, defaultThis = undefined ) {\r\n        let contract = createCallback();\r\n        // -------------\r\n        const execute = function( _contract, ...args ) {\r\n            let _returnValue = _contract.call( this === undefined ? defaultThis : this, ...args );\r\n            if ( _contract.params.isSubscriptFunction && _contract.params.apiVersion > 1 ) {\r\n                _returnValue = _await( _returnValue, __returnValue => [ __returnValue, _contract.thread.bind( _contract ), _contract ] );\r\n                // Replace global for next call\r\n                contract = createCallback( contract );\r\n            }\r\n            return _returnValue;\r\n        };\r\n        // -------------\r\n        const _function = ( contract instanceof Promise ) || ( contract.callee instanceof ( async function() {} ).constructor )\r\n            ? async function() { return _await( contract, _contract => execute.call( this, _contract, ...arguments ) ); } \r\n            : function() { return execute.call( this, contract, ...arguments ); };\r\n        // -------------\r\n        _await( contract, _contract => {\r\n            this.applyReflection( _function, _contract );\r\n        } );\r\n        // -------------\r\n        inspection( _function, 'properties', _await( contract, _contract => {\r\n            const graph = {\r\n                type: _contract.params.functionType || 'Program',\r\n                isSubscriptFunction: _contract.params.isSubscriptFunction,\r\n                sideEffects: _contract.graph.sideEffects || false,\r\n            };\r\n            if ( _contract.params.isSubscriptFunction ) {\r\n                graph.dependencies = [];\r\n                for ( const [ id, effect ] of Object.entries( _contract.graph.effects ) ) {\r\n                    graph.dependencies.push( ...effect.refs.map( ref => ref.path.map( s => s.name ) ) );\r\n                }\r\n            }\r\n            return graph;\r\n        } ) );\r\n        // -------------\r\n        return _function;\r\n    }\r\n\r\n    applyReflection( _function, contract ) {\r\n        // Hide implementation details on callee\r\n        Object.defineProperty( contract.callee, 'length', { configurable: true, value: contract.callee.length - 1 } );\r\n        const compiledSourceNeat = contract.callee.toString()//.replace( /\\(\\$[\\w]+\\,([\\s]*)?/, '(' );\r\n        Object.defineProperty( contract.callee, 'toString', { configurable: true, value: ( compiledSource = false ) => {\r\n            if ( !compiledSource && contract.graph.originalSource ) { return contract.graph.originalSource; }\r\n            return compiledSourceNeat;\r\n        } } );\r\n        // Hide implementation details on main\r\n        let properties = {\r\n            name: contract.callee.name,\r\n            length: contract.callee.length,\r\n            toString: contract.callee.toString,\r\n        };\r\n        if ( contract.params.isSubscriptFunction ) {\r\n            if ( !( contract.params.apiVersion > 1 ) ) {\r\n                properties = {\r\n                    ...properties,\r\n                    thread: contract.thread.bind( contract ),\r\n                    dispose: contract.dispose.bind( contract ),\r\n                    runtime: contract,\r\n                };\r\n            }\r\n        }\r\n        Object.keys( properties ).forEach( name => {\r\n            Object.defineProperty( _function, name, { configurable: true, value: properties[ name ] } );\r\n        } );\r\n    }\r\n\r\n}\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport { _await } from '../util.js';\r\nimport Contract from './Contract.js';\r\nimport inspection from './inspect.js';\r\n\r\nexport default class Runtime extends Contract {\r\n\r\n    static create( compilation, parameters = [], runtimeParams = {} ) {\r\n        const isAsync = runtimeParams.async || compilation.graph.hoistedAwaitKeyword;\r\n        const _Function = isAsync ? Object.getPrototypeOf( async function() {} ).constructor : Function;\r\n        const callee = runtimeParams.compileFunction \r\n            ? runtimeParams.compileFunction( compilation.source, [ compilation.identifier + '' ].concat( parameters ) )\r\n            : new _Function( compilation.identifier + '', ...parameters, compilation.source );\r\n        return new this( null, compilation.graph, callee, runtimeParams );\r\n    }\r\n\r\n    static createFunction( sourceName, compilation, parameters = [], runtimeParams = {}, defaultThis, originalSource = null ) {\r\n        runtimeParams = { ...runtimeParams, functionType: 'Constructor', };\r\n        if ( compilation instanceof Promise ) { runtimeParams = { ...runtimeParams, async: true, }; }\r\n        const createCallback = contract => {\r\n            // Subsequent calls avoid recompilation\r\n            if ( contract ) { return new this( null, contract.graph, contract.callee, runtimeParams ); }\r\n            // Supports lazy compilation. So, input compilation may be a Promise\r\n            return _await( compilation, _compilation => applyReflection( this.create( _compilation, parameters, runtimeParams ) ) );\r\n        };\r\n        const applyReflection = contract => { \r\n            if ( contract.graph.originalSource && !contract.graph.originalSourceModified ) {\r\n                const ownSource = `${ runtimeParams.async || contract.graph.hoistedAwaitKeyword ? 'async ' : '' }function ${ sourceName || 'anonymous' }`;\r\n                const originalSourceIndented = contract.graph.originalSource.split(/\\n/g).map( line => `    ${ line }` ).join( `\\n` );\r\n                contract.graph.originalSource = `${ ownSource }(${ parameters.join( ', ' ) }) {\\n${ originalSourceIndented }\\n}`;\r\n                contract.graph.originalSourceModified = true;\r\n            }\r\n            if ( sourceName ) { Object.defineProperty( contract.callee, 'name', { configurable: true, value: sourceName } ); }\r\n            return contract;\r\n        };\r\n        const _function = this.prototype.createFunction( createCallback, defaultThis );\r\n        inspection( _function, 'locations', _await( compilation, _compilation => ( {\r\n            locations: _compilation.locations,\r\n        } ) ) );\r\n        return _function;\r\n    }\r\n\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport { resolveParams } from './params.js';\r\nimport { normalizeTabs } from './util.js';\r\nimport Runtime from './runtime/Runtime.js';\r\nimport inspect from './runtime/inspect.js';\r\n\r\n/**\r\n * @SubscriptFunctionLite\r\n */\r\nexport default function SubscriptFunctionLite( ...args ) {\r\n    if ( typeof window !== 'object' ) throw new Error( `No window in context.` );\r\n    // --------------------\r\n    const params = resolveParams( typeof args[ args.length - 1 ] === 'object' ? args.pop() : {} );\r\n    const source = normalizeTabs( args.pop() || '' );\r\n    const parameters = args;\r\n    const createFunction = compilation => Runtime.createFunction( undefined, compilation, parameters, params.runtimeParams, this, source );\r\n    // --------------------\r\n    // SubscriptCompiler has been loaded sync?\r\n    if ( window.wq?.SubscriptCompiler && !params.runtimeParams.async ) {\r\n        const { parse, compile } = window.wq.SubscriptCompiler;\r\n        const ast = parse( source, params.parserParams );\r\n        return createFunction( compile( ast, params.compilerParams ) );\r\n    }\r\n    // Load and run SubscriptCompiler async - in the background?\r\n    if ( !window.wq?.SubscriptCompilerWorker ) {\r\n        const customUrl = document.querySelector( 'meta[name=\"subscript-compiler-url\"]' );\r\n        const compilerUrl = customUrl?.content || `https://unpkg.com/@webqit/subscript/dist/compiler.js`;\r\n        const workerScriptText = `\r\n        importScripts( '${ compilerUrl }' );\r\n        const { parse, compile } = self.wq.SubscriptCompiler;\r\n        self.onmessage = e => {\r\n            const { source, params } = e.data;\r\n            const ast = parse( source, params.parserParams );\r\n            const compilation = compile( ast, params.compilerParams );\r\n            compilation.identifier = compilation.identifier.toString();\r\n            e.ports[ 0 ]?.postMessage( compilation );\r\n        };`;\r\n        window.wq = window.wq || {};\r\n        window.wq.SubscriptCompilerWorker = new Worker( `data:text/javascript;base64,${ btoa( workerScriptText ) }` );\r\n    }\r\n    return createFunction( new Promise( res => {\r\n        let messageChannel = new MessageChannel;\r\n        wq.SubscriptCompilerWorker.postMessage( { source, params }, [ messageChannel.port2 ] );\r\n        messageChannel.port1.onmessage = e => res( e.data );\r\n    } ) );\r\n}\r\n\r\n/**\r\n * @inspect\r\n */\r\nObject.defineProperty( SubscriptFunctionLite, 'inspect', { value: inspect } );\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport wqDom from '@webqit/dom';\r\nimport SubscriptFunctionLite from '@webqit/subscript/src/SubscriptFunctionLite.js';\r\n\r\n/**\r\n * @init\r\n * \r\n * @param Object $params\r\n */\r\nexport default function init( $params = {} ) {\r\n\tconst window = this, dom = wqDom.call( window );\r\n    // -------\r\n    // params\r\n    const params = dom.meta( 'oohtml' ).copyWithDefaults( $params, {\r\n        selectors: { script: 'script[type=\"subscript\"]', },\r\n        retention: 'retain',\r\n    } );\r\n    // -------\r\n    // realtime?\r\n    realtime.call( this, params );\r\n    // -------\r\n}\r\n\r\n/**\r\n * Performs realtime capture of elements and builds their relationships.\r\n *\r\n * @param Object params\r\n *\r\n * @return Void\r\n */\r\nfunction realtime( params ) {\r\n\tconst window = this, { dom } = window.wq;\r\n    // ---\r\n    window.wq.transformCache = new Map;\r\n    window.wq.compileCache = [ new Map, new Map, ];\r\n    // ---\r\n    const handled = () => {};\r\n\tdom.Realtime.intercept( window.document, 'script[scoped],script[contract]', record => {\r\n        record.incomingNodes.forEach( script => {\r\n            // ---\r\n            if ( 'contract' in script ) return handled( script );\r\n            Object.defineProperty( script, 'contract', { value: script.hasAttribute( 'contract' ) } ); \r\n            if ( 'scoped' in script ) return handled( script );\r\n            Object.defineProperty( script, 'scoped', { value: script.hasAttribute( 'scoped' ) } ); \r\n            // ---\r\n            const thisContext = script.scoped ? record.target : ( script.type === 'module' ? undefined : window );\r\n            compile.call( this, script, thisContext, params );\r\n        } );\r\n\t}, { subtree: true, on: 'connected' } );\r\n    // ---\r\n    window.wq.exec = ( execHash ) => {\r\n        const exec = fromHash( execHash );\r\n        if ( !exec ) throw new Error( `Argument must be a valid exec hash.` );\r\n        const { script, compiledScript, thisContext } = exec;\r\n        if ( thisContext instanceof window.Element && script.scoped ) {\r\n            if ( !thisContext.scripts ) { Object.defineProperty( thisContext, 'scripts', { value: new Set } ); }\r\n            thisContext.scripts.add( script );\r\n        }\r\n        switch ( params.retention ) {\r\n            case 'dispose':\r\n                script.remove();\r\n                break;\r\n            case 'hidden':\r\n                script.textContent = `\"hidden\"`;\r\n                break;\r\n            default:\r\n                script.textContent = compiledScript.function.originalSource;\r\n        }\r\n        return execute.call( this, compiledScript, thisContext, script );\r\n    };\r\n}\r\n\r\n// ------------------\r\n// Script runner\r\nexport function execute( compiledScript, thisContext, script ) {\r\n    if ( !compiledScript.function ) throw new Error( `Input script must already be compiled!` );\r\n    // Execute...\r\n    const returnValue = compiledScript.function.call( thisContext );\r\n    if ( compiledScript.contract ) {\r\n        Object.defineProperty( script, 'sync', { value: ( ...args ) => _await( returnValue, ( [ , sync ] ) => sync( ...args ) ) } );\r\n    }\r\n    // Observe,,,\r\n    const window = this, { dom } = window.wq;\r\n    if ( !( thisContext instanceof window.EventTarget ) ) return returnValue;\r\n    let changeHandler;\r\n    if ( script.contract ) {\r\n        changeHandler = e => { script.sync(); };\r\n        thisContext.addEventListener( 'namespacechange', changeHandler );\r\n        thisContext.addEventListener( 'statechange', changeHandler );\r\n    }\r\n    dom.Realtime.intercept( window.document, thisContext, () => {\r\n        if ( script.contract ) {\r\n            thisContext.removeEventListener( 'namespacechange', changeHandler );\r\n            thisContext.removeEventListener( 'statechange', changeHandler );\r\n        }\r\n        thisContext.dispatchEvent( new window.CustomEvent( 'beforeremove' ) );\r\n        thisContext.scripts.delete( script );\r\n    }, { subtree: true, on: 'disconnected' } );\r\n    return script;\r\n}\r\n\r\n// ------------------\r\n// JAVASCRIPT::[SCOPED|CONTRACT]\r\nexport function compile( script, thisContext, params = {} ) {\r\n    const wq = this.wq, cache = wq.compileCache[ script.contract ? 0 : 1 ];\r\n    const sourceHash = toHash( script.textContent );\r\n    // Script instances are parsed only once\r\n    let source = script.textContent, compiledScript;\r\n    if ( !( compiledScript = cache.get( sourceHash ) ) ) {\r\n        // Are there \"import\" (and \"await\") statements? Then, we need to rewrite that\r\n        let imports = [], meta = {};\r\n        let targetKeywords = [];\r\n        if ( script.type === 'module' ) targetKeywords.push( 'import ' );\r\n        if ( script.type === 'module' && !script.contract ) targetKeywords.push( 'await ' );\r\n        if ( targetKeywords.length && ( new RegExp( targetKeywords.join( '|' ) ) ).test( source ) ) {\r\n            [ imports, source, meta ] = parse( source );\r\n            if ( imports.length ) {\r\n                source = `\\n\\t${ rewriteImportStmts( imports ).join( `\\n\\t` ) }\\n\\t${ source }\\n`;\r\n            }\r\n        }\r\n        // Let's obtain a material functions\r\n        let _Function;\r\n        if ( script.contract ) {\r\n            const parserParams = {\r\n                ...( params.parserParams || {} ),\r\n                allowReturnOutsideFunction: false,\r\n                allowAwaitOutsideFunction: script.type === 'module',\r\n                allowSuperOutsideMethod: false,\r\n            }\r\n            const runtimeParams = {\r\n                ...( params.runtimeParams || {} ),\r\n                async: script.type === 'module',\r\n                apiVersion: 2,\r\n            };\r\n            _Function = SubscriptFunctionLite( source, { ...params, parserParams, runtimeParams, } );\r\n        } else {\r\n            const isAsync = script.type === 'module'//meta.topLevelAwait || imports.length;\r\n            const _FunctionConstructor = isAsync ? Object.getPrototypeOf( async function() {} ).constructor : Function;\r\n            _Function = params.runtimeParams?.compileFunction \r\n                ? params.runtimeParams.compileFunction( source )\r\n                : new _FunctionConstructor( source );\r\n            Object.defineProperty( _Function, 'originalSource', { configurable: true, value: script.textContent } );\r\n        }\r\n        // Save material function to compile cache\r\n        compiledScript = Object.defineProperty( script.cloneNode(), 'function', { value: _Function } );\r\n        script.scoped && Object.defineProperty( compiledScript, 'scoped', Object.getOwnPropertyDescriptor( script, 'scoped') );\r\n        script.contract && Object.defineProperty( compiledScript, 'contract', Object.getOwnPropertyDescriptor( script, 'contract') );\r\n        cache.set( sourceHash, compiledScript );\r\n    }\r\n    const execHash = toHash( { script, compiledScript, thisContext } );\r\n    script.textContent = `wq.exec('${ execHash }');`;\r\n}\r\n\r\n// ------------------\r\n// Match import statements\r\n// and detect top-level await\r\nexport function parse( source ) {\r\n    const [ tokens, meta ] = tokenize( source, ( $tokens, event, char, meta, i, isLastChar ) => {\r\n        \r\n        if ( event === 'start-enclosure' && char === '{' && !meta.openAsync?.type && meta.openEnclosures.length === meta.openAsync?.scopeId ) {\r\n            meta.openAsync.type = 'block';\r\n        } else if ( event === 'end-enclosure' && char === '}' && meta.openAsync?.type === 'block' && meta.openEnclosures.length === meta.openAsync.scopeId ) {\r\n            meta.openAsync = null;\r\n        } else if ( event === 'start-quote' && !meta.openEnclosures.length && [ 'starting', 'from' ].includes( meta.openImport ) ) {\r\n            meta.openImport = 'url';\r\n        } else if ( event === 'end-quote' && meta.openImport === 'url' ) {\r\n            meta.openImport = 'closing';\r\n        } else if ( event === 'char' ) {\r\n\r\n            if ( meta.openImport === 'closing' && (\r\n                char === ';'/* explicit */ || ![ ' ', `\\n` ].includes( char )/* implicit */ || isLastChar\r\n            ) ) {\r\n                if ( char === ';' || isLastChar ) {\r\n                    $tokens[ 0 ] += char;\r\n                    $tokens.unshift( '' );\r\n                } else { $tokens.unshift( char ); }\r\n                meta.openImport = null;\r\n                return false;\r\n            }\r\n\r\n            let remainder = source.substring( i - 1 );\r\n\r\n            if ( !meta.openImport && /^[\\W]?import[ ]*[^\\(]/.test( remainder ) ) {\r\n                meta.openImport = 'starting';\r\n                $tokens.unshift( '' );\r\n                return 6;\r\n            }\r\n            if ( meta.openImport === 'starting' && /^[\\W]?from /.test( remainder ) ) {\r\n                meta.openImport = 'from';\r\n                return 4;\r\n            }\r\n            if ( !meta.openAsync ) {\r\n                if ( /^[\\W]?async /.test( remainder ) ) {\r\n                    meta.openAsync = { scopeId: meta.openEnclosures.length };\r\n                    return 5;\r\n                }\r\n                if ( /^[\\W]?await /.test( remainder ) ) {\r\n                    meta.topLevelAwait = true;\r\n                    return 5;\r\n                }\r\n            }\r\n            if ( meta.openAsync ) {\r\n                if ( !meta.openAsync.type && /.?\\=\\>[ ]*?\\{/.test( remainder ) ) {\r\n                    meta.openAsync.type = 'inline-arrow';\r\n                } else if ( meta.openAsync.type === 'inline-arrow' && [ `\\n`, ';' ].includes( char ) && meta.openEnclosures.length === meta.openAsync.scopeId ) {\r\n                    meta.openAsync = null;\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n    } );\r\n    // Hoist all import statements\r\n    let imports = [], body = '', _str;\r\n    for ( const str of tokens.reverse() ) {\r\n        if ( ( _str = str.trim() ).startsWith( 'import ' ) ) {\r\n            imports.push( str );\r\n        } else if ( _str ) { body += str; }\r\n    }\r\n\r\n    return [ imports, body, meta ];\r\n}\r\n\r\n// ------------------\r\n// Rewrite import statements\r\nexport function rewriteImportStmts( imports ) {\r\n    const importSpecs = [], importPromises = [];\r\n    imports.forEach( ( $import, i ) => {\r\n        $import = parseImportStmt( $import );\r\n        // Identify whole imports and individual imports\r\n        const [ wholeImport, individualImports ] = $import.items.reduce( ( [ whole, parts ], item ) => {\r\n            return item.id === '*' ? [ item.alias, parts ] : [ whole, parts.concat( item ) ];\r\n        }, [ null, [] ] );\r\n        if ( wholeImport ) {\r\n            // const main = await import(\"url\");\r\n            importSpecs.push( `const ${ wholeImport } = __$imports$__[${ i }];` );\r\n        }\r\n        if ( individualImports.length ) {\r\n            // const { aa: bb, cc } = await import(\"url\");\r\n            const individualImportsSpec = individualImports.map( item => `${ item.id }${ item.id !== item.alias ? `: ${ item.alias }` : '' }` ).join( ', ' );\r\n            importSpecs.push( `const { ${ individualImportsSpec } } = __$imports$__[${ i }];` );\r\n        }\r\n        importPromises.push( `import(\"${ $import.url }\")` );\r\n    } );\r\n    return [\r\n        `\\n\\tconst __$imports$__ = await Promise.all([\\n\\t\\t${ importPromises.join( `,\\n\\t\\t` ) }\\n\\t]);`,\r\n        importSpecs.join( `\\n\\t` ),\r\n    ];\r\n}\r\n\r\n// ------------------\r\n// Parse import statements\r\nexport function parseImportStmt( str ) {\r\n    const getUrl = str => {\r\n        let quo = /^[`'\"]/.exec( str );\r\n        return quo && str.substring( 1, str.lastIndexOf( quo[ 0 ] ) );\r\n    }\r\n    let $import = { items: [ { id: '' } ] }, _str = str.replace( 'import', '' ).trim();\r\n    if ( !( $import.url = getUrl( _str ) ) ) {\r\n        tokenize( _str, ( $tokens, event, char, meta, i, isLastChar ) => {\r\n            if ( [ 'start-quote', 'ongoing-quote', 'end-quote', 'char' ].includes( event ) ) {\r\n                if ( $import.url ) return;\r\n                if ( !meta.openQuote ) {\r\n                    let remainder = _str.substring( i );\r\n                    if ( char === ',' ) {\r\n                        $import.items.unshift( { id: '' } );\r\n                        return;\r\n                    }\r\n                    if ( remainder.startsWith( ' as ' ) ) {\r\n                        $import.items[ 0 ].alias = '';\r\n                        return 3;\r\n                    }\r\n                    if ( remainder.startsWith( ' from ' ) ) {\r\n                        $import.url = getUrl( remainder.replace( 'from', '' ).trim() );\r\n                        return remainder.length;\r\n                    }\r\n                }\r\n                if ( 'alias' in $import.items[ 0 ] ) {\r\n                    $import.items[ 0 ].alias += char;\r\n                } else {\r\n                    $import.items[ 0 ].id += char;\r\n                    if ( meta.openEnclosures.length ) {\r\n                        $import.items[ 0 ].enclosed = true;\r\n                    }\r\n                }\r\n            }\r\n        } );\r\n    }\r\n    $import.items = $import.items\r\n        .map( item => ( {\r\n            id: item.id && !item.alias && !item.enclosed ? 'default' : item.id.trim(),\r\n            alias: item.alias ? item.alias.trim() : item.id.trim(),\r\n        } ) )\r\n        .filter( item => item.id )\r\n        .reverse();\r\n    return $import;\r\n}\r\n\r\n// ------------------\r\n// Token JavaScript source\r\nexport function tokenize( source, _callback ) {\r\n    const lastI = source.length - 1;\r\n    return [ ...source ].reduce( ( [ $tokens, meta, skip ], char, i ) => {\r\n        \r\n        if ( skip ) {\r\n            $tokens[ 0 ] += char;\r\n            return [ $tokens, meta, --skip ];\r\n        }\r\n        let callbackReturn;\r\n\r\n        if ( meta.openQuote || meta.openComment ) {\r\n            if ( char === meta.openQuote ) {\r\n                meta.openQuote = null;\r\n                callbackReturn = _callback( $tokens, 'end-quote', char, meta, i, i === lastI );\r\n            } else if ( meta.openQuote ) {\r\n                callbackReturn = _callback( $tokens, 'ongoing-quote', char, meta, i, i === lastI );\r\n            } else if ( meta.openComment ) {\r\n                if ( ( meta.openComment === '//' && char === `\\n` ) || ( meta.openComment === '/*' && $tokens[ 0 ].substr( -1 ) === '*' && char === '/' ) ) {\r\n                    meta.openComment = null;\r\n                    callbackReturn = _callback( $tokens, 'end-comment', char, meta, i, i === lastI );\r\n                }\r\n            }\r\n            if ( callbackReturn !== false ) {\r\n                $tokens[ 0 ] += char;\r\n            }\r\n            return [ $tokens, meta, typeof callbackReturn === 'number' ? callbackReturn : skip ];\r\n        }\r\n\r\n        let enclosure;\r\n        if ( enclosure = [ '()', '{}', '[]' ].filter( pair => char === pair[ 0 ] )[ 0 ] ) {\r\n            callbackReturn = _callback( $tokens, 'start-enclosure', char, meta, i, i === lastI );\r\n            meta.openEnclosures.unshift( enclosure );\r\n        } else if ( meta.openEnclosures.length && char === meta.openEnclosures[ 0 ][ 1 ] ) {\r\n            meta.openEnclosures.shift();\r\n            callbackReturn = _callback( $tokens, 'end-enclosure', char, meta, i, i === lastI );\r\n        } else if ( [ '\"', \"'\", \"`\" ].includes( char ) ) {\r\n            callbackReturn = _callback( $tokens, 'start-quote', char, meta, i, i === lastI );\r\n            meta.openQuote = char;\r\n        } else if ( !meta.openComment && [ '/*', '//' ].includes( source.substr( i, 2 ) ) ) {\r\n            callbackReturn = _callback( $tokens, 'start-comment', char, meta, i, i === lastI );\r\n            meta.openComment = source.substr( i, 2 );\r\n        } else {\r\n            callbackReturn = _callback( $tokens, 'char', char, meta, i, i === lastI );\r\n        }\r\n\r\n        if ( callbackReturn !== false ) {\r\n            $tokens[ 0 ] += char;\r\n        }\r\n        return [ $tokens, meta, typeof callbackReturn === 'number' ? callbackReturn : skip ];\r\n\r\n    }, [ [ '' ], { openEnclosures: [], }, 0 ] );\r\n}\r\n\r\n// ------------------\r\n// Unique ID generator\r\nconst hashTable = new Map;\r\nconst uniqId = () => (0|Math.random()*9e6).toString(36);\r\nconst _await = ( value, callback ) => value instanceof Promise ? value.then( callback ) : callback( value );\r\n\r\n// ------------------\r\n// Hash of anything generator\r\nexport function toHash( val ) {\r\n    let hash;\r\n    if ( !( hash = hashTable.get( val ) ) ) {\r\n        hash = uniqId();\r\n        hashTable.set( val, hash );\r\n    }\r\n    return hash;\r\n}\r\n\r\n// ------------------\r\n// Value of any hash\r\nexport function fromHash( hash ) {\r\n    let val;\r\n    hashTable.forEach( ( _hash, _val ) => {\r\n        if ( _hash === hash ) val = _val;\r\n    } );\r\n    return val;\r\n}\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport Observer from '@webqit/observer';\r\nimport HTMLModules from './html-modules/index.js';\r\nimport HTMLImports from './html-imports/index.js';\r\nimport NamespacedHTML from './namespaced-html/index.js';\r\nimport StateAPI from './state-api/index.js';\r\nimport ScopedJS from './scoped-js/index.js';\r\n\r\n/**\r\n * @init\r\n */\r\nexport default function init( configs = {} ) {\r\n    if ( !this.wq ) { this.wq = {}; }\r\n    if ( this.wq.oohtml ) return;\r\n    this.wq.Observer = Observer;\r\n    // --------------\r\n    //HTMLModules.call( this, (configs.HTMLModules || {}));\r\n    //HTMLImports.call( this, (configs.HTMLImports || {}));\r\n    //NamespacedHTML.call(this, (configs.NamespacedHTML || {}));\r\n    //StateAPI.call(this, (configs.StateAPI || {}));\r\n    ScopedJS.call(this, (configs.ScopedJS || {}));\r\n    // --------------\r\n    this.wq.oohtml = {};\r\n}\r\n\r\n/**\r\n * @exports\r\n */\r\nexport {\r\n    Observer,\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport init from './index.js';\r\n\r\n/**\r\n * @init\r\n */\r\ninit.call(window);"],
  "mappings": "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",
  "names": []
}
