{
  "version": 3,
  "sources": ["../../observer/src/main.js", "../../observer/node_modules/@webqit/util/js/isObject.js", "../../observer/node_modules/@webqit/util/js/getType.js", "../../observer/node_modules/@webqit/util/js/internals.js", "../../observer/node_modules/@webqit/util/js/isArray.js", "../../observer/node_modules/@webqit/util/js/isTypeFunction.js", "../../observer/node_modules/@webqit/util/js/isClass.js", "../../observer/node_modules/@webqit/util/js/isNull.js", "../../observer/node_modules/@webqit/util/js/isUndefined.js", "../../observer/node_modules/@webqit/util/js/isTypeObject.js", "../../observer/node_modules/@webqit/util/js/isEmpty.js", "../../observer/node_modules/@webqit/util/js/isFunction.js", "../../observer/node_modules/@webqit/util/js/isString.js", "../../observer/node_modules/@webqit/util/js/isTypeArray.js", "../../observer/node_modules/@webqit/util/arr/from.js", "../../observer/src/core/Registration.js", "../../observer/src/core/ListenerRegistration.js", "../../observer/src/core/Registry.js", "../../observer/src/core/ListenerRegistry.js", "../../observer/src/core/TrapsRegistration.js", "../../observer/src/core/TrapsRegistry.js", "../../observer/src/core/Descriptor.js", "../../observer/src/actors.js", "../../observer/src/index.js", "../../dom/node_modules/@webqit/util/js/isObject.js", "../../dom/node_modules/@webqit/util/js/internals.js", "../../dom/node_modules/@webqit/util/js/isArray.js", "../../dom/node_modules/@webqit/util/js/isTypeFunction.js", "../../dom/node_modules/@webqit/util/js/isNull.js", "../../dom/node_modules/@webqit/util/js/isUndefined.js", "../../dom/node_modules/@webqit/util/js/isTypeObject.js", "../../dom/node_modules/@webqit/util/js/isEmpty.js", "../../dom/node_modules/@webqit/util/js/isFunction.js", "../../dom/node_modules/@webqit/util/js/isNumber.js", "../../dom/node_modules/@webqit/util/js/isNumeric.js", "../../dom/node_modules/@webqit/util/js/isString.js", "../../dom/node_modules/@webqit/util/js/isTypeArray.js", "../../dom/node_modules/@webqit/util/arr/pushUnique.js", "../../dom/node_modules/@webqit/util/obj/getPrototypeChain.js", "../../dom/node_modules/@webqit/util/obj/getAllPropertyNames.js", "../../dom/node_modules/@webqit/util/obj/mergeCallback.js", "../../dom/node_modules/@webqit/util/obj/merge.js", "../../dom/node_modules/@webqit/util/arr/from.js", "../../dom/node_modules/@webqit/util/obj/get.js", "../../dom/node_modules/@webqit/util/obj/set.js", "../../dom/src/_Reflow.js", "../../dom/src/realtime/Realtime.js", "../../dom/src/realtime/AttrRealtime.js", "../../dom/src/realtime/DOMRealtime.js", "../../dom/src/polyfills.js", "../../dom/src/index.js", "../../util/js/isArray.js", "../../util/arr/intersect.js", "../../util/js/internals.js", "../src/util.js", "../src/state-api/index.js", "../src/context-api/_ContextRequestEvent.js", "../src/context-api/HTMLContextManager.js", "../src/context-api/HTMLContext.js", "../src/context-api/index.js", "../src/html-modules/_HTMLImportsContext.js", "../src/html-modules/HTMLExportsManager.js", "../src/html-modules/index.js", "../src/html-imports/_HTMLImportElement.js", "../src/html-imports/index.js", "../src/namespaced-html/index.js", "../../subscript/src/params.js", "../../subscript/src/util.js", "../../subscript/src/runtime/inspect.js", "../../subscript/src/runtime/Contract.js", "../../subscript/src/runtime/Runtime.js", "../../subscript/src/SubscriptFunctionLite.js", "../src/scoped-js/index.js", "../src/index.js", "../src/targets.browser.js"],
  "sourcesContent": ["\r\n/**\r\n * @imports\r\n */\r\nimport { _internals, _isObject, _isTypeObject, _isFunction, _getType } from '@webqit/util/js/index.js';\r\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\r\nimport ListenerRegistry from './core/ListenerRegistry.js';\r\nimport TrapsRegistry from './core/TrapsRegistry.js';\r\nimport Descriptor from './core/Descriptor.js';\r\nimport { unproxy } from './actors.js';\r\n\r\n/* ---------------SPECIAL APIs--------------- */\r\n\r\n/**\r\n * Reduces a path array against handler.\r\n * \r\n * @param Array|Object\t    target\r\n * @param Array\t            path\r\n * @param Function\t        receiver\r\n * @param Function\t        final\r\n * @param Object\t        params\r\n * \r\n * @example deep( object, [ segement1, segement2 ], observe, ( value, flags ) => {}, params );\r\n *\r\n * @return Any\r\n */\r\nexport function deep( target, path, receiver, final = x => x, params = {} ) {\r\n    return ( function eat( target, path, _params ) {\r\n        const segment = path[ _params.level ];\r\n        // ---------------\r\n        if ( _params.level < path.length - 1 ) { _params = { ..._params, preflight: true }; }\r\n        else { _params = { ..._params, preflight: /*reset*/params.preflight }; }\r\n        // ---------------\r\n        return receiver( target, segment, ( result, ...args ) => {\r\n            // -----------\r\n            const paramsNext = ( flags = {} ) => ( { ..._params, ...flags, level: _params.level + 1, } );\r\n            const addTrail = desc => {\r\n                if ( !( desc instanceof Descriptor ) ) return;\r\n                desc.path = [ desc.key ];\r\n                if ( target instanceof Descriptor ) {\r\n                    desc.path = target.path.concat( desc.key );\r\n                    desc.context = target;\r\n                }\r\n            };\r\n            // -----------\r\n            if ( isPropsList( segment ) && Array.isArray( result ) ) {\r\n                // -----------\r\n                result.forEach( addTrail );\r\n                if ( _params.level === path.length - 1 || ( !result.length && _params.midwayResults ) ) return final( result, ...args );\r\n                return result.map( entry => eat( entry, path, paramsNext( ...args ) ) )\r\n                // -----------\r\n            }\r\n            // -----------\r\n            addTrail( result );\r\n            const $isTypeObject = _isTypeObject( resolveObj( result, false ) );\r\n            if ( _params.level === path.length - 1 || ( !$isTypeObject && _params.midwayResults ) ) return final( result, ...args );\r\n            return $isTypeObject && eat( result, path, paramsNext( ...args ) );\r\n            // -----------\r\n        }, _params );\r\n    } )( target, path.slice( 0 ), { ...params, level: 0 } );\r\n}\r\n\r\n/**\r\n * Adds an observer to a target's registry.\r\n *\r\n * @param Array|Object\t    target\r\n * @param String|Object\t    prop\r\n * @param Function\t        receiver\r\n * @param Object\t\t    params\r\n *\r\n * @return AbortController\r\n */\r\nexport function observe( target, prop, receiver, params = {} ) {\r\n    // ---------------\r\n    target = resolveObj( target );\r\n\tif ( _isFunction( arguments[ 1 ] ) ) {\r\n        [ , receiver, params = {} ] = arguments;\r\n        prop = Infinity;\r\n\t}\r\n\tif ( !_isFunction( receiver ) ) throw new Error( `Handler must be a function; \"${ _getType( receiver ) }\" given!` );\r\n    // ---------------\r\n    const emit = bind( target, prop, receiver, params );\r\n    if ( params.preflight ) {\r\n        params = { ...params, descripted: true };\r\n        delete params.live;\r\n        return get( target, prop, emit, params );\r\n    }\r\n    return emit();\r\n}\r\n\r\n/**\r\n * Adds an interceptor object to a target's registry.\r\n *\r\n * @param Array|Object\t    target\r\n * @param Object\t        traps\r\n * @param Object\t\t    params\r\n *\r\n * @return AbortRegistry\r\n */\r\nexport function intercept( target, traps, params = {} ) {\r\n    // ---------------\r\n    target = resolveObj( target );\r\n    if ( !_isObject( traps ) ) {\r\n        [ /*target*/, /*type*/, /*handler*/, params = {} ] = arguments;\r\n        traps = { [ arguments[ 1 ] ]: arguments[ 2 ] };\r\n    }\r\n    // ---------------\r\n    return TrapsRegistry.getInstance( target, true, params.namespace ).addRegistration( { traps, params } );\r\n}\r\n\r\n/* ---------------QUERY APIs--------------- */\r\n\r\n/**\r\n * Performs a \"getOwnPropertyDescriptor\" operation.\r\n *\r\n * @param Array|Object\t    target\r\n * @param String|Number\t    prop\r\n * @param Function\t        receiver\r\n * @param Object\t\t    params\r\n *\r\n * @return Any\r\n */\r\nexport function getOwnPropertyDescriptor( target, prop, receiver = x => x, params = {} ) {\r\n    return exec( target, 'getOwnPropertyDescriptor', { key: prop }, receiver, params );\r\n}\r\n\r\n/**\r\n * Performs a \"getOwnPropertyDescriptors\" operation.\r\n * @note this isn't part of the standard Reflect API.\r\n *\r\n * @param Array|Object\t    target\r\n * @param String|Number\t    prop\r\n * @param Function\t        receiver\r\n * @param Object\t\t    params\r\n *\r\n * @return Any\r\n */\r\nexport function getOwnPropertyDescriptors( target, prop, receiver = x => x, params = {} ) {\r\n    return exec( target, 'getOwnPropertyDescriptors', { key: prop }, receiver, params );\r\n}\r\n\r\n/**\r\n * Performs a \"getPrototypeOf\" operation.\r\n *\r\n * @param Array|Object\t    target\r\n * @param Function\t        receiver\r\n * @param Object\t\t    params\r\n *\r\n * @return Any\r\n */\r\nexport function getPrototypeOf( target, receiver = x => x, params = {} ) {\r\n    return exec( target, 'getPrototypeOf', {}, receiver, params );\r\n}\r\n\r\n/**\r\n * Performs a \"isExtensible\" operation.\r\n *\r\n * @param Array|Object\t    target\r\n * @param Function\t        receiver\r\n * @param Object\t\t    params\r\n *\r\n * @return Any\r\n */\r\nexport function isExtensible( target, receiver = x => x, params = {} ) {\r\n    return exec( target, 'isExtensible', {}, receiver, params );\r\n}\r\n\r\n/**\r\n * Performs a \"ownKeys\" operation.\r\n *\r\n * @param Array|Object\t    target\r\n * @param Function\t        receiver\r\n * @param Object\t\t    params\r\n *\r\n * @return Any\r\n */\r\nexport function ownKeys( target, receiver = x => x, params = {} ) {\r\n    return exec( target, 'ownKeys', {}, receiver, params );\r\n}\r\n\r\n/**\r\n * Performs an operation of the given \"type\".\r\n *\r\n * @param Array|Object\t    target\r\n * @param String|Number\t    prop\r\n * @param Function\t        receiver\r\n * @param Object\t\t    params\r\n *\r\n * @return Any\r\n */\r\nexport function has( target, prop, receiver = x => x, params = {} ) {\r\n    return exec( target, 'has', { key: prop }, receiver, params );\r\n}\r\n\r\n/**\r\n * Performs a get operation.\r\n *\r\n * @param Array|Object\t    target\r\n * @param String|Number\t    prop\r\n * @param Function\t        receiver\r\n * @param Object\t        params\r\n *\r\n * @return Any\r\n */\r\nexport function get( target, prop, receiver = x => x, params = {} ) {\r\n    // ---------------\r\n    let isLive;\r\n    target = resolveObj( target );\r\n    if ( _isObject( receiver ) ) { [ params, receiver ] = [ receiver, x => x ]; }\r\n    else if ( params.live ) { isLive = true; }\r\n    // ---------------\r\n    return resolveProps( target, prop, props => {\r\n        const related = [ ...props ];\r\n        return ( function next( results, _props, _done ) {\r\n            if ( !_props.length ) return _done( results );\r\n            const prop = _props.shift();\r\n            // ---------\r\n            function defaultGet( descriptor, value = undefined ) {\r\n                const _next = value => ( descriptor.value = value, next( results.concat( params.live || params.descripted ? descriptor : value ), _props, _done ) );\r\n                if ( arguments.length > 1 ) return _next( value );\r\n                const accessorizedProps = _internals( target, 'accessorizedProps', false );\r\n                const accessorization = accessorizedProps && accessorizedProps.get( descriptor.key );\r\n                if ( accessorization && accessorization.intact() ) {\r\n                    return _next( accessorization.getValue() );\r\n                }\r\n                return _next( Reflect.get( target, descriptor.key, ...( params.receiver ? [ params.receiver ] : [] ) ) );\r\n            }\r\n            // ---------\r\n            const descriptor = new Descriptor( target, {\r\n                type: 'get',\r\n                key: prop,\r\n                value: undefined,\r\n                related,\r\n            } );\r\n            const listenerRegistry = TrapsRegistry.getInstance( target, false, params.namespace );\r\n            if ( listenerRegistry ) {\r\n                return listenerRegistry.emit( descriptor, defaultGet );\r\n            }\r\n            return defaultGet( descriptor );\r\n        } )( [], props.slice( 0 ), results => {\r\n            const result_s = isPropsList( prop/*original*/ ) ? results : results[ 0 ];\r\n            if ( isLive ) {\r\n                const emit = bind( target, prop, receiver, params );\r\n                return emit( result_s );\r\n            }\r\n            return receiver( result_s );\r\n        } );\r\n    } );\r\n}\r\n\r\n/* ---------------MUTATION APIs--------------- */\r\n\r\n/**\r\n * Performs a set operation.\r\n * \r\n * @param Object\t        target\r\n * @param String|Number\t    prop\r\n * @param Any\t            value\r\n * @param Function\t        receiver\r\n * @param Object\t        params\r\n * @param Bool\t            def\r\n *\r\n * @return Any\r\n */\r\nexport function set( target, prop, value, receiver = x => x, params = {}, def = false ) {\r\n    // ---------------\r\n    target = resolveObj( target );\r\n    let entries = [ [ prop, value ] ];\r\n    if ( _isObject( prop ) ) {\r\n        [ /*target*/, /*hash*/, receiver = x => x, params = {}, def = false ] = arguments;\r\n        entries = Object.entries( prop );\r\n    }\r\n    if ( _isObject( receiver ) ) { [ def, params, receiver ] = [ typeof params === 'boolean' ? params : false, receiver, x => x ]; }\r\n    // ---------------\r\n    const related = entries.map( ( [ prop ] ) => prop );\r\n    return ( function next( descriptors, entries, _done ) {\r\n        if ( !entries.length ) return _done( descriptors );\r\n        const [ prop, value ] = entries.shift();\r\n        // ---------\r\n        function defaultSet( descriptor, status = undefined ) {\r\n            const _next = status => ( descriptor.status = status, next( descriptors.concat( descriptor ), entries, _done ) );\r\n            if ( arguments.length > 1 ) return _next( descriptor, status );\r\n            const accessorizedProps = _internals( target, 'accessorizedProps', false );\r\n            const accessorization = accessorizedProps && accessorizedProps.get( descriptor.key );\r\n            if ( descriptor.type === 'defineProperty' ) {\r\n                if ( accessorization && !accessorization.restore() ) _next( false );\r\n                Object.defineProperty( target, descriptor.key, descriptor.value );\r\n                return _next( true );\r\n            }\r\n            if ( accessorization && accessorization.intact() ) {\r\n                return _next( accessorization.setValue( descriptor.value ) );\r\n            }\r\n            return _next( Reflect.set( target, descriptor.key, descriptor.value ) );\r\n        }\r\n        // ---------\r\n        function exec( isUpdate, oldValue ) {\r\n            const descriptor = new Descriptor( target, {\r\n                type: def ? 'defineProperty' : 'set',\r\n                key: prop,\r\n                value,\r\n                isUpdate,\r\n                oldValue,\r\n                related: [ ...related ],\r\n                detail: params.detail,\r\n            } );\r\n            const listenerRegistry = TrapsRegistry.getInstance( target, false, params.namespace );\r\n            return listenerRegistry \r\n                ? listenerRegistry.emit( descriptor, defaultSet ) \r\n                : defaultSet( descriptor );\r\n        }\r\n        // ---------\r\n        return has( target, prop, isUpdate => {\r\n            if ( !isUpdate || params.oldValue !== true ) return exec( isUpdate );\r\n            return get( target, prop, oldValue => exec( isUpdate, oldValue ), params );\r\n        }, params );\r\n        // ---------\r\n    } )( [], entries.slice( 0 ), descriptors => {\r\n        const listenerRegistry = ListenerRegistry.getInstance( target, false, params.namespace );\r\n        if ( listenerRegistry ) listenerRegistry.emit( descriptors );\r\n        return receiver(\r\n            isPropsList( prop/*original*/ ) ? descriptors.map( opr => opr.status ) : descriptors[ 0 ].status\r\n        );\r\n    } );\r\n}\r\n\r\n/**\r\n * Performs a defineProperty operation.\r\n * \r\n * @param Object\t        target\r\n * @param String|Number\t    prop\r\n * @param Object\t        descriptor\r\n * @param Function\t        receiver\r\n * @param Object\t        params\r\n *\r\n * @return Any\r\n */\r\nexport function defineProperty( target, prop, descriptor, receiver = x => x, params = {} ) {\r\n    return set( target, prop, descriptor, receiver, params, true/*def*/ );\r\n}\r\n\r\n/**\r\n * Performs a defineProperties operation.\r\n * @note this isn't part of the standard Reflect API.\r\n * \r\n * @param Object\t        target\r\n * @param Object\t        descriptors\r\n * @param Function\t        receiver\r\n * @param Object\t        params\r\n *\r\n * @return Any\r\n */\r\nexport function defineProperties( target, descriptors, receiver = x => x, params = {} ) {\r\n    return set( target, descriptors, receiver, params, true/*def*/ );\r\n}\r\n\r\n/**\r\n * Performs a delete operation.\r\n * \r\n * @param Object\t        target\r\n * @param String|Number\t    prop\r\n * @param Function\t        receiver\r\n * @param Object\t        params\r\n *\r\n * @return Any\r\n */\r\nexport function deleteProperty( target, prop, receiver = x => x, params = {} ) {\r\n    // ---------------\r\n    target = resolveObj( target );\r\n    if ( _isObject( receiver ) ) { [ params, receiver ] = [ receiver, x => x ]; }\r\n    // ---------------\r\n    const props = _arrFrom( prop ), related = [ ...props ];\r\n    return ( function next( descriptors, props, _done ) {\r\n        if ( !props.length ) return _done( descriptors );\r\n        const prop = props.shift();\r\n        // ---------\r\n        function defaultDel( descriptor, status = undefined ) {\r\n            const _next = status => ( descriptor.status = status, next( descriptors.concat( descriptor ), props, _done ) );\r\n            if ( arguments.length > 1 ) return _next( descriptor, status );\r\n            const accessorizedProps = _internals( target, 'accessorizedProps', false );\r\n            const accessorization = accessorizedProps && accessorizedProps.get( descriptor.key );\r\n            if ( accessorization && !accessorization.restore() ) _next( false );\r\n            return _next( Reflect.deleteProperty( target, descriptor.key ) );\r\n        }\r\n        // ---------\r\n        function exec( oldValue ) {\r\n            const descriptor = new Descriptor( target, {\r\n                type: 'deleteProperty',\r\n                key: prop,\r\n                oldValue,\r\n                related: [ ...related ],\r\n                detail: params.detail,\r\n            } );\r\n            const listenerRegistry = TrapsRegistry.getInstance( target, false, params.namespace );\r\n            return listenerRegistry \r\n                ? listenerRegistry.emit( descriptor, defaultDel ) \r\n                : defaultDel( descriptor );\r\n        }\r\n        // ---------\r\n        if ( params.oldValue === false ) return exec();\r\n        return get( target, prop, exec, params );\r\n        // ---------\r\n    } )( [], props.slice( 0 ), descriptors => {\r\n        const listenerRegistry = ListenerRegistry.getInstance( target, false, params.namespace );\r\n        if ( listenerRegistry ) listenerRegistry.emit( descriptors );\r\n        return receiver(\r\n            isPropsList( prop/*original*/ ) ? descriptors.map( opr => opr.status ) : descriptors[ 0 ].status\r\n        );\r\n    } );\r\n}\r\n\r\n/* ---------------EFFECT APIs--------------- */\r\n\r\n/**\r\n * Performs a \"construct\" operation.\r\n *\r\n * @param Array|Object\t    target\r\n * @param Array\t\t\t    argumentsList\r\n * @param Object\t\t    newTarget\r\n * @param Function\t        receiver\r\n * @param Object\t\t    params\r\n *\r\n * @return Any\r\n */\r\nexport function construct( target, argumentsList, newTarget = null, receiver = x => x, params = {} ) {\r\n    return exec( target, 'construct', arguments.length > 2 ? { argumentsList, newTarget } : { argumentsList }, receiver, params );\r\n}\r\n\r\n/**\r\n * Performs an \"apply\" operation.\r\n *\r\n * @param Array|Object\t    target\r\n * @param Any\t            thisArgument\r\n * @param Array\t            argumentsList\r\n * @param Function\t        receiver\r\n * @param Object\t\t    params\r\n *\r\n * @return Any\r\n */\r\nexport function apply( target, thisArgument, argumentsList, receiver = x => x, params = {} ) {\r\n    return exec( target, 'apply', { thisArgument, argumentsList }, receiver, params );\r\n}\r\n\r\n/**\r\n * Performs a \"setPrototypeOf\" operation.\r\n *\r\n * @param Array|Object\t    target\r\n * @param Anyr\t            proto\r\n * @param Function\t        receiver\r\n * @param Object\t\t    params\r\n *\r\n * @return Any\r\n */\r\nexport function setPrototypeOf( target, proto, receiver = x => x, params = {} ) {\r\n    return exec( target, 'setPrototypeOf', { proto }, receiver, params );\r\n}\r\n\r\n/**\r\n * Performs a \"preventExtension\" operation.\r\n *\r\n * @param Array|Object\t    target\r\n * @param Function\t        receiver\r\n * @param Object\t\t    params\r\n *\r\n * @return Any\r\n */\r\nexport function preventExtensions( target, receiver = x => x, params = {} ) {\r\n    return exec( target, 'preventExtensions', {}, receiver, params );\r\n}\r\n\r\n/* ---------------HELPER APIs--------------- */\r\n\r\n/**\r\n * Adds an observer to a target's registry.\r\n *\r\n * @param Array|Object\t    target\r\n * @param String|Object\t    prop\r\n * @param Function\t        receiver\r\n * @param Object\t\t    params\r\n *\r\n * @return Function: AbortController\r\n */\r\nfunction bind( target, prop, receiver, params = {} ) {\r\n    let controller;\r\n    if ( !params.signal ) {\r\n        controller = new AbortController;\r\n        params = { ...params, signal: controller.signal };\r\n    }\r\n    const listenerRegistry = ListenerRegistry.getInstance( target, true, params.namespace );\r\n    return function emit( descriptor_s, prevRegistration = null ) {\r\n        prevRegistration?.remove();\r\n        const registrationNext = listenerRegistry.addRegistration( prop, emit, params );\r\n        const flags = { signal: registrationNext.signal, };\r\n        if ( arguments.length ) {\r\n            receiver( descriptor_s, flags );\r\n        }\r\n        return controller;\r\n    };\r\n}\r\n\r\n/**\r\n * Performs an operation of the given \"type\".\r\n *\r\n * @param Array|Object\t    target\r\n * @param String\t\t    type\r\n * @param Object\t\t    payload\r\n * @param Function\t        receiver\r\n * @param Object\t\t    params\r\n *\r\n * @return Any\r\n */\r\nfunction exec( target, type, payload = {}, receiver = x => x, params = {} ) {\r\n    // ---------\r\n    target = resolveObj( target );\r\n    if ( _isObject( receiver ) ) { [ params, receiver ] = [ receiver, x => x ]; }    \r\n    // ---------\r\n    function defaultExec( descriptor, result ) {\r\n        if ( arguments.length > 1 ) return receiver( result );\r\n        return receiver( Reflect[ type ]( target, ...Object.values( payload ) ) );\r\n    }\r\n    // ---------\r\n    const descriptor = new Descriptor( target, { type, ...payload } );\r\n    const listenerRegistry = TrapsRegistry.getInstance( target, false, params.namespace );\r\n    if ( listenerRegistry ) {\r\n        return listenerRegistry.emit( descriptor, defaultExec );\r\n    }\r\n    return defaultExec( descriptor );\r\n}\r\n\r\n// Asks if prop is a multi-result field\r\nfunction isPropsList( prop ) {\r\n    return prop === Infinity || Array.isArray( prop );\r\n}\r\n\r\n// Resolves obj down to it's self\r\nfunction resolveObj( obj, assert = true ) {\r\n\tif ( ( !obj || !_isTypeObject( obj ) ) && assert ) throw new Error( `Object must be of type object or array! \"${ _getType( obj ) }\" given.` );\r\n    if ( obj instanceof Descriptor ) {\r\n        obj = obj.value;\r\n    }\r\n\treturn obj && unproxy( obj );\r\n}\r\n\r\n// Resolves prop down to actual keys\r\nfunction resolveProps( obj, prop, receiver ) {\r\n    if ( prop === Infinity )  return ownKeys( obj, receiver );\r\n    return receiver( _arrFrom( prop ) );\r\n}\r\n", "\n/**\n * Tells if val is pure object.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn !Array.isArray(val) && typeof val === 'object' && val;\n};\n", "\n/**\n * Returns the val's type.\n *\n * @param string \tval\n *\n * @return string\n */\nexport default function(val) {\n\treturn typeof val;\n};\n", "\n/**\n * Creates and/or returns an \"internals\" object for the given object.\n * \n * @param Any obj\n * @param String namespace\n * \n * @return Object\n */\nexport default function internals(obj, ...namespaces) {\n    if (!globalThis.WebQitInternalsRegistry) {\n        globalThis.WebQitInternalsRegistry = new Map;\n    }\n    var itnls = globalThis.WebQitInternalsRegistry.get(obj);\n    if (!itnls) {\n        itnls = new Map;\n        if (namespaces[0] === false) {\n            // FALSE means: Return orphan Map if not exists\n            return itnls;\n        }\n        globalThis.WebQitInternalsRegistry.set(obj, itnls);\n    }\n    var _ns, _itnls;\n    while ((_ns = namespaces.shift())) {\n        if ((_itnls = itnls) && !(itnls = itnls.get(_ns))) {\n            itnls = new Map;\n            if (namespaces[0] === false) {\n                // FALSE means: Return orphan Map if not exists\n                return itnls;\n            }\n            _itnls.set(_ns, itnls);\n        }\n    }\n    return itnls;\n}", "\n/**\n * Tells if val is of type \"array\".\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn Array.isArray(val);\n};\n", "\n/**\n * Tells if val is of type \"function\".\n * This holds true for both regular functions and classes.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn typeof val === 'function';\n};\n", "\n/**\n * @imports\n */\nimport _isTypeFunction from './isTypeFunction.js';\n\n/**\n * Tells if val is of type \"class\".\n *\n * @param object \t\tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isTypeFunction(val) && /^class\\s?/.test(Function.prototype.toString.call(val));\n};\n", "\n/**\n * Tells if val is undefined or is null.\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn val === null || val === '';\n};\n", "\n/**\n * Tells if val is undefined or is of type \"undefined\".\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn arguments.length && (val === undefined || typeof val === 'undefined');\n};\n", "\n/**\n * @imports\n */\nimport _isTypeFunction from './isTypeFunction.js';\n\n/**\n * Tells if val is of type \"object\".\n * This holds true for anything object, including built-ins.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn Array.isArray(val) || (typeof val === 'object' && val) || _isTypeFunction(val);\n};\n", "\n/**\n * @imports\n */\nimport _isNull from './isNull.js';\nimport _isUndefined from './isUndefined.js';\nimport _isTypeObject from './isTypeObject.js';\n\n/**\n * Tells if val is empty in its own type.\n * This holds true for NULLs, UNDEFINED, FALSE, 0,\n * objects without keys, empty arrays.\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isNull(val) || _isUndefined(val) || val === false || val === 0 \n\t\t|| (_isTypeObject(val) && !Object.keys(val).length);\n};\n", "\n/**\n * @imports\n */\nimport _isTypeFunction from './isTypeFunction.js';\n\n/**\n * Tells if val is of type \"function\".\n *\n * @param object \t\tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isTypeFunction(val) || (val && {}.toString.call(val) === '[object function]');\n};\n", "\n/**\n * Tells if val is of type \"string\".\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn val instanceof String || (typeof val === 'string' && val !== null);\n};\n", "\n/**\n * @imports\n */\nimport _isString from './isString.js';\nimport _isUndefined from './isUndefined.js';\n\n/**\n * Tells if val is \"array-like\".\n * This holds true for anything that has a length property.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn !_isString(val) && !_isUndefined(val.length);\n};\n", "\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\nimport _isTypeArray from '../js/isTypeArray.js';\nimport _isEmpty from '../js/isEmpty.js';\nimport _isObject from '../js/isObject.js';\n\n/**\n * Casts an array-like object to an array.\n *\n * @param mixed \tval\n * @param bool\t \tcastObject\n *\n * @return array\n */\nexport default function(val, castObject = true) {\n\tif (_isArray(val)) {\n\t\treturn val;\n\t};\n\tif (!castObject && _isObject(val)) {\n\t\treturn [val];\n\t};\n\tif (val !== false && val !== 0 && _isEmpty(val)) {\n\t\treturn [];\n\t};\n\tif (_isTypeArray(val)) {\n\t\treturn Array.prototype.slice.call(val);\n\t};\n\tif (_isObject(val)) {\n\t\treturn Object.values(val);\n\t};\n\treturn [val];\n};\n", "\r\n/**\r\n * ---------------------------\r\n * The Registration class\r\n * ---------------------------\r\n */\r\n\r\nexport default class Registration {\r\n\t\r\n\t/**\r\n\t * Initializes the instance.\r\n\t *\r\n\t * @param Registry\t\t\tregistry\r\n\t * @param object\t\t\tdfn\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tconstructor( registry, dfn ) {\r\n\t\tthis.registry = registry;\r\n\t\tObject.assign( this, { ...dfn, target: registry.target } );\r\n\t\tif ( this.params.signal ) {\r\n\t\t\tthis.params.signal.addEventListener( 'abort', () => this.remove() );\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Sets a \"disconnected\" flag on the Registration.\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tremove() {\r\n\t\tthis.removed = true;\r\n\t\treturn this.registry.removeRegistration( this );\r\n\t}\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\r\nimport Registration from './Registration.js';\r\n\r\n/**\r\n * ---------------------------\r\n * The ListenerRegistration class\r\n * ---------------------------\r\n */\r\n\r\nexport default class ListenerRegistration extends Registration {\r\n\t\r\n\t/**\r\n\t * @constructor\r\n\t */\r\n\tconstructor() {\r\n\t\tsuper( ...arguments );\r\n\t\tObject.defineProperty( this, 'abortController', { value: new AbortController } );\r\n\t\tObject.defineProperty( this, 'signal', { value: this.abortController.signal } );\r\n\t}\r\n\r\n\t/**\r\n\t * De-registers the instance.\r\n\t * \r\n\t * @return Void\r\n\t */\r\n\tremove() {\r\n\t\tthis.abortController.abort();\r\n\t\tsuper.remove();\r\n\t}\r\n\r\n\t/**\r\n\t * Calls the observer's handler function\r\n\t * on matching with the event's fields.\r\n\t *\r\n\t * @param Array\t\t\t \t\tevents\r\n\t *\r\n\t * @return Any\r\n\t */\r\n\tfire( events ) {\r\n\t\tlet matches = events, filter = this.filter;\r\n\t\tif ( filter !== Infinity && ( filter = _arrFrom( filter ) ) ) {\r\n\t\t\tmatches = events.filter( event => filter.includes( event.key ) );\r\n\t\t}\r\n\t\tif ( matches.length ) {\r\n\t\t\treturn this.filter === Infinity || Array.isArray( this.filter )\r\n\t\t\t\t? this.handler( matches, this )\r\n\t\t\t\t: this.handler( matches[ 0 ], this );\r\n\t\t}\r\n\t}\r\n}\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport { _isTypeObject, _getType, _internals } from '@webqit/util/js/index.js';\r\nimport { _from as _arrFrom, _intersect, _equals as _arrEquals } from '@webqit/util/arr/index.js';\r\n\r\n/**\r\n * ---------------------------\r\n * The Registry class\r\n * ---------------------------\r\n */\r\n\r\nexport default class Registry {\r\n\t\r\n\t/**\r\n\t * Initializes the instance.\r\n\t *\r\n\t * @param object\ttarget\r\n\t * \r\n\t * @return void\r\n\t */\r\n\tconstructor( target ) {\r\n\t\tthis.target = target;\r\n\t\tthis.entries = [];\r\n\t}\r\n\t\r\n\t/**\r\n\t * Adds an Registration instance\r\n\t * with optional tags.\r\n\t *\r\n\t * @param Registration\t\tregistration\r\n\t *\r\n\t * @return Registration\r\n\t */\r\n\taddRegistration( registration ) {\r\n\t\tthis.entries.push( registration );\r\n\t\treturn registration;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Removes registrations by reference.\r\n\t *\r\n\t * @param Registration\t\tregistration\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tremoveRegistration( registration ) {\r\n\t\tthis.entries = this.entries.filter( _entry => _entry !== registration );\r\n\t}\r\n\t\t\r\n\t/**\r\n\t * Returns a observer-specific object embedded on an element.\r\n\t *\r\n\t * @param string\t\ttype\r\n\t * @param array|object\ttarget\r\n\t * @param bool      \tcreateIfNotExists\r\n\t * @param string      \tnamespace\r\n\t *\r\n\t * @return Registry\r\n\t */\r\n\tstatic _getInstance( type, target, createIfNotExists = true, namespace = this.__namespace ) {\r\n\t\tif ( !_isTypeObject( target ) ) throw new Error( `Subject must be of type object; \"${ _getType( target ) }\" given!` );\r\n\t\tlet ImplementationClass = this;\r\n\t\tif ( namespace && globalThis.WebQitObserverNamespaceRegistry.has( type + '-' + namespace ) ) {\r\n\t\t\tImplementationClass = globalThis.WebQitObserverNamespaceRegistry.get( type + '-' + namespace );\r\n\t\t\ttype += '-' + namespace\r\n\t\t}\r\n\t\tif ( !_internals( target, 'observerApi' ).has( type ) && createIfNotExists ) {\r\n\t\t\t_internals( target, 'observerApi' ).set( type, new ImplementationClass( target ) );\r\n\t\t}\r\n\t\treturn _internals( target, 'observerApi' ).get( type );\r\n\t}\r\n\r\n\t/**\r\n\t * Extend a Fireable Class with a namespace.\r\n\t *\r\n\t * @param string\t\tnamespace\r\n\t * @param class      \tImplementationClass\r\n\t *\r\n\t * @return void|class\r\n\t */\r\n\tstatic _namespace( type, namespace, ImplementationClass = null ) {\r\n\t\ttype += '-' + namespace;\r\n\t\tif ( arguments.length === 2 ) return globalThis.WebQitObserverNamespaceRegistry.get( type );\r\n\t\tif ( !( ImplementationClass.prototype instanceof this ) ) {\r\n\t\t\tthrow new Error( `The implementation of the namespace ${ this.name }.${ namespace } must be a subclass of ${ this.name }.` );\r\n\t\t}\r\n\t\tglobalThis.WebQitObserverNamespaceRegistry.set( type, ImplementationClass );\r\n\t\tImplementationClass.__namespace = namespace;\r\n\t}\r\n}\r\n\r\nif ( !globalThis.WebQitObserverNamespaceRegistry ) {\r\n\tglobalThis.WebQitObserverNamespaceRegistry = new Map;\r\n}\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport ListenerRegistration from './ListenerRegistration.js';\r\nimport Registry from './Registry.js';\r\n\r\n/**\r\n * ---------------------------\r\n * The ListenerRegistry class\r\n * ---------------------------\r\n */\r\n\r\nexport default class ListenerRegistry extends Registry {\r\n\r\n\tstatic getInstance( target, createIfNotExists = true, namespace = null ) {\r\n\t\treturn super._getInstance( 'listeners', ...arguments );\r\n\t}\r\n\r\n\tstatic namespace( namespace, ImplementationClass = null ) {\r\n\t\treturn super._namespace( 'listeners', ...arguments );\r\n\t}\r\n\t\r\n\t/**\r\n\t * @inheritdoc\r\n\t */\r\n\taddRegistration( filter, handler, params ) {\r\n\t\treturn super.addRegistration( new ListenerRegistration( this, { filter, handler, params } ) );\r\n\t}\r\n\t\r\n\t/**\r\n\t * Fires all observers with the given evt (change).\r\n\t *\r\n\t * @param Arrayn events\r\n\t *\r\n\t * @return Void\r\n\t */\r\n\temit( events ) {\r\n\t\tthis.entries.forEach( listener => listener.fire( events ) );\r\n\t}\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport Registration from './Registration.js';\r\n\r\n/**\r\n * ---------------------------\r\n * The TrapsRegistration class\r\n * ---------------------------\r\n */\r\n\r\nexport default class TrapsRegistration extends Registration {\r\n\t\r\n\t/**\r\n\t * Calls the observer's handler function\r\n\t * on matching with the descriptor's fields.\r\n\t *\r\n\t * @param Descriptor\t\t\t \tdescriptor\r\n\t * @param function\t\t\t\t\tnext\r\n\t * @param mixed\t\t\t\t\t \trecieved\r\n\t *\r\n\t * @return void\r\n\t */\r\n\texec( descriptor, next, recieved ) {\r\n\t\tif ( this.running || !this.traps[ descriptor.type ] ) {\r\n\t\t\treturn next( ...Array.prototype.slice.call( arguments, 2 ) );\r\n\t\t}\r\n\t\tthis.running = true;\r\n\t\treturn this.traps[ descriptor.type ]( descriptor, recieved, ( ...args ) => {\r\n\t\t\tthis.running = false;\r\n\t\t\treturn next( ...args );\r\n\t\t} );\r\n\t}\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport TrapsRegistration from './TrapsRegistration.js';\r\nimport Registry from './Registry.js';\r\n\r\n/**\r\n * ---------------------------\r\n * The TrapsRegistry class\r\n * ---------------------------\r\n */\r\n\r\nexport default class TrapsRegistry extends Registry {\r\n\r\n\tstatic getInstance( target, createIfNotExists = true, namespace = null ) {\r\n\t\treturn super._getInstance( 'traps', ...arguments );\r\n\t}\r\n\r\n\tstatic namespace( namespace, ImplementationClass = null ) {\r\n\t\treturn super._namespace( 'traps', ...arguments );\r\n\t}\r\n\t\r\n\t/**\r\n\t * @inheritdoc\r\n\t */\r\n\taddRegistration( dfn ) {\r\n\t\treturn super.addRegistration( new TrapsRegistration( this, dfn ) );\r\n\t}\r\n\r\n\t/**\r\n\t * Fires all interceptors with the given action.\r\n\t *\r\n\t * @param Descriptor\t\tdescriptor\r\n\t * @param function\t\t\tdefaultHandler\r\n\t *\r\n\t * @return mixed\r\n\t */\r\n\temit( descriptor, defaultHandler = null ) {\r\n\t\tconst $this = this;\r\n\t\treturn ( function next( index, ..._args ) {\r\n\t\t\tconst registration = $this.entries[ index ];\r\n\t\t\tif ( registration ) {\r\n\t\t\t\treturn registration.exec( descriptor, ( ...args ) => {\r\n\t\t\t\t\treturn next( index + 1, ...args );\r\n\t\t\t\t}/*next*/, ..._args );\r\n\t\t\t}\r\n\t\t\treturn defaultHandler ? defaultHandler( descriptor, ..._args ) : _args[ 0 ];\r\n\t\t} )( 0 );\r\n\t}\r\n}", "\r\n/**\r\n * ---------------------------\r\n * The Descriptor class\r\n * ---------------------------\r\n */\r\n\r\nexport default class Descriptor {\r\n\t\r\n\t/**\r\n\t * Initializes the instance.\r\n\t *\r\n\t * @param array|object\ttarget\r\n\t * @param object\t\tdfn\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tconstructor( target, dfn ) {\r\n\t\tthis.target = target;\r\n\t\tif ( !( dfn.type ) ) throw new Error( 'Descriptor type must be given in definition!' );\r\n\t\tObject.assign( this, dfn );\r\n\t}\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\r\nimport { _isClass, _isFunction, _isTypeObject, _getType, _internals } from '@webqit/util/js/index.js';\r\nimport { set, deleteProperty, has, get, ownKeys, defineProperty, getOwnPropertyDescriptor } from \"./main.js\";\r\nimport { apply, construct, getPrototypeOf, setPrototypeOf, isExtensible, preventExtensions } from \"./main.js\";\r\n\r\n/* ---------------ACCESSORIZE METHODS--------------- */\r\n\r\n/**\r\n * Accessorizes props.\r\n *\r\n * @param Array|Object\ttarget\r\n * @param String|Array\tprops\r\n * @param Object\t\tparams\r\n *\r\n * @return Array\r\n */\r\nexport function accessorize( target, props, params = {} ) {\r\n    target = resolveTarget( target );\r\n    const accessorizedProps = _internals( target, 'accessorizedProps' );\r\n    // ---------\r\n    function getDescriptorDeep( prop ) {\r\n        let descriptor, proto = target;\r\n        while ( !descriptor && ( proto = Object.getPrototypeOf( proto ) ) ) {\r\n            descriptor = Object.getOwnPropertyDescriptor( proto, prop );\r\n        }\r\n        return descriptor \r\n            ? { proto, descriptor } \r\n            : { descriptor: { value: undefined } };\r\n    }\r\n    // ---------\r\n    function accessorizeProp( prop ) {\r\n        if ( accessorizedProps.has( prop ) ) return true;\r\n        // ------------------\r\n        // Current Descriptor Record\r\n        const currentDescriptorRecord = getDescriptorDeep( prop );\r\n        currentDescriptorRecord.getValue = function() {\r\n            return 'get' in this.descriptor ? this.descriptor.get() : this.descriptor.value;\r\n        };\r\n        currentDescriptorRecord.setValue = function( value ) {\r\n            return 'set' in this.descriptor ? this.descriptor.set( value ) : ( this.descriptor.value = value )\r\n        };\r\n        currentDescriptorRecord.intact = function() {\r\n            const currentDescriptor = Object.getOwnPropertyDescriptor( target, prop );\r\n            return currentDescriptor.get === accessorization.get \r\n                && currentDescriptor.set === accessorization.set\r\n                && accessorizedProps.get( prop ) === this;\r\n        };\r\n        currentDescriptorRecord.restore = function() {\r\n            if ( !this.intact() ) return false;\r\n            if ( this.proto !== target ) { delete target[ prop ]; }\r\n            else { Object.defineProperty( target, prop, this.descriptor ); }\r\n            accessorizedProps.delete( prop );\r\n            return true;\r\n        };\r\n        accessorizedProps.set( prop, currentDescriptorRecord );\r\n        // ------------------\r\n        // enumerable, configurable\r\n        const { enumerable = true, configurable = true } = currentDescriptorRecord.descriptor;\r\n        const accessorization = { enumerable, configurable };\r\n        // set, get\r\n        if ( [ 'value', 'set' ].some( x => x in currentDescriptorRecord.descriptor ) ) {\r\n            accessorization.set = function ( value ) { return set( this, prop, value, params ); };\r\n        }\r\n        if ( [ 'value', 'get' ].some( x => x in currentDescriptorRecord.descriptor ) ) {\r\n            accessorization.get = function () { return get( this, prop, params ); };\r\n        }\r\n        try {\r\n            Object.defineProperty( target, prop, accessorization );\r\n            return true;\r\n        } catch( e ) {\r\n            accessorizedProps.delete( prop );\r\n            return false;\r\n        }\r\n    }\r\n    const _props = Array.isArray( props ) ? props : (\r\n        props === undefined ? Object.keys( target ) : [ props ]\r\n    );\r\n    const statuses = _props.map( accessorizeProp );\r\n    return props === undefined || Array.isArray( props ) \r\n        ? statuses \r\n        : statuses[ 0 ];\r\n}\r\n\r\n/**\r\n * Unaccessorizes previously accessorized props.\r\n *\r\n * @param Array|Object\ttarget\r\n * @param String|Array\tprops\r\n * @param Object\t\tparams\r\n *\r\n * @return Array\r\n */\r\nexport function unaccessorize( target, props, params = {} ) {\r\n    target = resolveTarget( target );\r\n    const accessorizedProps = _internals( target, 'accessorizedProps' );\r\n    function unaccessorizeProp( prop ) {\r\n        if ( !accessorizedProps.has( prop ) ) return true;\r\n        return accessorizedProps.get( prop ).restore();\r\n    }\r\n    const _props = Array.isArray( props ) ? props : (\r\n        props === undefined ? Object.keys( target ) : [ props ]\r\n    );\r\n    const statuses = _props.map( unaccessorizeProp );\r\n    return props === undefined || Array.isArray( props ) \r\n        ? statuses \r\n        : statuses[ 0 ];\r\n}\r\n\r\n/* ---------------PROXY METHODS--------------- */\r\n\r\n/**\r\n * Returns an object as a proxy and binds all instance methods\r\n * to the proxy instead of the object itself.\r\n *\r\n * @param Array|Object\t\ttarget\r\n * @param Object\t\t    params\r\n *\r\n * @return Proxy\r\n */\r\nexport function proxy( target, params = {} ) {\r\n    target = resolveTarget( target );\r\n    const proxy = new Proxy( target, {\r\n        apply:  ( target, thisArgument, argumentsList ) => apply( target, thisArgument, argumentsList, params ),\r\n        construct:  ( target, argumentsList, newTarget = null ) => construct( target, argumentsList, newTarget, params ),\r\n        defineProperty:  ( target, propertyKey, attributes ) => defineProperty( target, propertyKey, attributes, params ),\r\n        deleteProperty: ( target, propertyKey ) => deleteProperty( target, propertyKey, params ),\r\n        get: ( target, propertyKey, receiver = null ) => {\r\n            const val = get( target, propertyKey, { ...params, receiver } );\r\n            if ( params.proxyAutoBinding !== false && _isFunction( val ) && !_isClass( val )) {\r\n                return val.bind( proxy );\r\n            }\r\n            return val;\r\n        },\r\n        getOwnPropertyDescriptor: ( target, propertyKey ) => getOwnPropertyDescriptor( target, propertyKey, params ),\r\n        getPrototypeOf: target => getPrototypeOf( target, params ),\r\n        has: ( target, propertyKey ) => has( target, propertyKey, params ),\r\n        isExtensible: target => isExtensible( target, params ),\r\n        ownKeys: target => ownKeys( target, params ),\r\n        preventExtensions: target => preventExtensions( target, params ),\r\n        set: ( target, propertyKey, value, receiver = null ) => set( target, propertyKey, value, { ...params, receiver } ),\r\n        setPrototypeOf: ( target, prototype ) => setPrototypeOf( target, prototype, params ),\r\n    });\r\n    _internals( proxy ).set( proxy, target );\r\n\treturn proxy;\r\n}\r\n\r\n/**\r\n * Returns the original object earlier proxied by proxy().\r\n *\r\n * @param Proxy|Any\t\ttarget\r\n *\r\n * @return Any\r\n */\r\nexport function unproxy( target ) {\r\n    // Proxy targets are mapped to their own instances internally\r\n    return _internals( target, false ).get( target ) || target;\r\n}\r\n\r\n/* ---------------HELPERS--------------- */\r\n\r\n/** \r\n * Ensures target object is an object or array.\r\n *\r\n * @param Array|Object\ttarget\r\n *\r\n * @return Array|Object\r\n */\r\nfunction resolveTarget( target ) {\r\n\tif ( !target || !_isTypeObject( target ) ) throw new Error('Target must be of type object!');\r\n\treturn unproxy( target );\r\n}\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport * as main from './main.js';\r\nimport * as actors from './actors.js';\r\n\r\nconst Observer = { ...main, ...actors };\r\n\r\nexport default Observer;", "\n/**\n * Tells if val is pure object.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn !Array.isArray(val) && typeof val === 'object' && val;\n};\n", "\n/**\n * Creates and/or returns an \"internals\" object for the given object.\n * \n * @param Any obj\n * @param String namespace\n * \n * @return Object\n */\nexport default function internals(obj, ...namespaces) {\n    if (!globalThis.WebQitInternalsRegistry) {\n        globalThis.WebQitInternalsRegistry = new Map;\n    }\n    var itnls = globalThis.WebQitInternalsRegistry.get(obj);\n    if (!itnls) {\n        itnls = new Map;\n        if (namespaces[0] === false) {\n            // FALSE means: Return orphan Map if not exists\n            return itnls;\n        }\n        globalThis.WebQitInternalsRegistry.set(obj, itnls);\n    }\n    var _ns, _itnls;\n    while ((_ns = namespaces.shift())) {\n        if ((_itnls = itnls) && !(itnls = itnls.get(_ns))) {\n            itnls = new Map;\n            if (namespaces[0] === false) {\n                // FALSE means: Return orphan Map if not exists\n                return itnls;\n            }\n            _itnls.set(_ns, itnls);\n        }\n    }\n    return itnls;\n}", "\n/**\n * Tells if val is of type \"array\".\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn Array.isArray(val);\n};\n", "\n/**\n * Tells if val is of type \"function\".\n * This holds true for both regular functions and classes.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn typeof val === 'function';\n};\n", "\n/**\n * Tells if val is undefined or is null.\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn val === null || val === '';\n};\n", "\n/**\n * Tells if val is undefined or is of type \"undefined\".\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn arguments.length && (val === undefined || typeof val === 'undefined');\n};\n", "\n/**\n * @imports\n */\nimport _isTypeFunction from './isTypeFunction.js';\n\n/**\n * Tells if val is of type \"object\".\n * This holds true for anything object, including built-ins.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn Array.isArray(val) || (typeof val === 'object' && val) || _isTypeFunction(val);\n};\n", "\n/**\n * @imports\n */\nimport _isNull from './isNull.js';\nimport _isUndefined from './isUndefined.js';\nimport _isTypeObject from './isTypeObject.js';\n\n/**\n * Tells if val is empty in its own type.\n * This holds true for NULLs, UNDEFINED, FALSE, 0,\n * objects without keys, empty arrays.\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isNull(val) || _isUndefined(val) || val === false || val === 0 \n\t\t|| (_isTypeObject(val) && !Object.keys(val).length);\n};\n", "\n/**\n * @imports\n */\nimport _isTypeFunction from './isTypeFunction.js';\n\n/**\n * Tells if val is of type \"function\".\n *\n * @param object \t\tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isTypeFunction(val) || (val && {}.toString.call(val) === '[object function]');\n};\n", "\n/**\n * Tells if val is of type \"number\".\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn val instanceof Number || (typeof val === 'number');\n};\n", "\n/**\n * @imports\n */\nimport _isNumber from './isNumber.js';\n/**\n * Tells if val is of type \"string\" or a numeric string.\n * This holds true for both numbers and numeric strings.\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn _isNumber(val) || (val !== true && val !== false && val !== null && val !== '' && !isNaN(val * 1));\n};\n", "\n/**\n * Tells if val is of type \"string\".\n *\n * @param string \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn val instanceof String || (typeof val === 'string' && val !== null);\n};\n", "\n/**\n * @imports\n */\nimport _isString from './isString.js';\nimport _isUndefined from './isUndefined.js';\n\n/**\n * Tells if val is \"array-like\".\n * This holds true for anything that has a length property.\n *\n * @param object\t \tval\n *\n * @return bool\n */\nexport default function(val) {\n\treturn !_isString(val) && !_isUndefined(val.length);\n};\n", "\n/**\n * Adds an item if not already exist.\n *\n * @param array \tarr\n * @param array\t \t...itms\n *\n * @return array\n */\nexport default function(arr, ...items) {\n\titems.forEach(itm => {\n\t\tif (arr.indexOf(itm) < 0) {\n\t\t\tarr.push(itm);\n\t\t}\n\t});\n\treturn arr;\n};\n", "\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\n\n/**\n * Returns the prototype chain.\n *\n * @param object \t\tobj\n * @param object\t \tuntil\n *\n * @return bool\n */\nexport default function(obj, until) {\n\tuntil = until || Object.prototype;\n\tuntil = until && !_isArray(until) ? [until] : until;\n\t// We get the chain of inheritance\n\tvar prototypalChain = [];\n\tvar obj = obj;\n\twhile((obj && (!until || until.indexOf(obj) < 0) && obj.name !== 'default')) {\n\t\tprototypalChain.push(obj);\n\t\tobj = obj ? Object.getPrototypeOf(obj) : null;\n\t}\n\treturn prototypalChain;\n};\n", "\n/**\n * @imports\n */\nimport _pushUnique from '../arr/pushUnique.js';\nimport _getPrototypeChain from './getPrototypeChain.js';\n\n/**\n * Eagerly retrieves object members all down the prototype chain.\n *\n * @param object\t \tobj\n * @param object\t \tuntil\n *\n * @return array\n */\nexport default function(obj, until) {\n\tvar keysAll = [];\n\t_getPrototypeChain(obj, until).forEach(obj => {\n\t\t_pushUnique(keysAll, ...Object.getOwnPropertyNames(obj));\n\t});\n\treturn keysAll;\n};\n", "\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\nimport _isFunction from '../js/isFunction.js';\nimport _isObject from '../js/isObject.js';\nimport _isTypeObject from '../js/isTypeObject.js';\nimport _isNumeric from '../js/isNumeric.js';\nimport _getAllPropertyNames from './getAllPropertyNames.js';\n\n/**\n  * Merges values from subsequent arrays/objects first array/object;\n  * optionally recursive\n  *\n  * @param array ...objs\n  *\n  * @return void\n  */\nexport default function mergeCallback(objs, callback, deepProps = false, isReplace = false, withSymbols = false) {\n\tvar depth = 0;\n\tvar obj1 = objs.shift();\n\tif (_isNumeric(obj1) || obj1 === true || obj1 === false) {\n\t\tdepth = obj1;\n\t\tobj1 = objs.shift();\n\t}\n\tif (!objs.length) {\n\t\tthrow new Error('_merge() requires two or more array/objects.');\n\t}\n\tobjs.forEach((obj2, i) => {\n\t\tif (!_isTypeObject(obj2) && !_isFunction(obj2)) {\n\t\t\treturn;\n\t\t}\n\t\t(deepProps ? _getAllPropertyNames(obj2) : Object.keys(obj2)).forEach(key => {\n\t\t\tif (!callback(key, obj1, obj2, i)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar valAtObj1 = obj1[key];\n\t\t\tvar valAtObj2 = obj2[key];\n\t\t\tif (((_isArray(valAtObj1) && _isArray(valAtObj2)) || (_isObject(valAtObj1) && _isObject(valAtObj2))) \n\t\t\t&& (depth === true || depth > 0)) {\n\t\t\t\t// RECURSE...\n\t\t\t\tobj1[key] = _isArray(valAtObj1) && _isArray(valAtObj2) ? [] : {};\n\t\t\t\tmergeCallback([_isNumeric(depth) ? depth - 1 : depth, obj1[key], valAtObj1, valAtObj2], callback, deepProps, isReplace, withSymbols);\n\t\t\t} else {\n\t\t\t\tif (_isArray(obj1) && _isArray(obj2)) {\n\t\t\t\t\tif (isReplace) {\n\t\t\t\t\t\tobj1[key] = valAtObj2;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tobj1.push(valAtObj2);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// In case we're setting a read-only property\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (withSymbols) {\n\t\t\t\t\t\t\tObject.defineProperty(obj1, key, Object.getOwnPropertyDescriptor(obj2, key));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tobj1[key] = obj2[key];\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\treturn obj1;\n};\n", "\n/**\n * @imports\n */\nimport _mergeCallback from './mergeCallback.js';\n\n/**\n  * Merges values from subsequent arrays/objects first array/object;\n  * optionally recursive\n  *\n  * @param array ...objs\n  *\n  * @return void\n  */\nexport default function(...objs) {\n\treturn _mergeCallback(objs, (k, obj1, obj2) => {\n\t\treturn true;\n\t}, false/*deepProps*/, false/*isReplace*/, false/*withSymbols*/);\n};\n", "\n/**\n * @imports\n */\nimport _isArray from '../js/isArray.js';\nimport _isTypeArray from '../js/isTypeArray.js';\nimport _isEmpty from '../js/isEmpty.js';\nimport _isObject from '../js/isObject.js';\n\n/**\n * Casts an array-like object to an array.\n *\n * @param mixed \tval\n * @param bool\t \tcastObject\n *\n * @return array\n */\nexport default function(val, castObject = true) {\n\tif (_isArray(val)) {\n\t\treturn val;\n\t};\n\tif (!castObject && _isObject(val)) {\n\t\treturn [val];\n\t};\n\tif (val !== false && val !== 0 && _isEmpty(val)) {\n\t\treturn [];\n\t};\n\tif (_isTypeArray(val)) {\n\t\treturn Array.prototype.slice.call(val);\n\t};\n\tif (_isObject(val)) {\n\t\treturn Object.values(val);\n\t};\n\treturn [val];\n};\n", "\n/**\n * @imports\n */\nimport _isTypeObject from '../js/isTypeObject.js';\nimport _isUndefined from '../js/isUndefined.js';\nimport _isNull from '../js/isNull.js';\nimport _arrFrom from '../arr/from.js';\n\n/**\n * Retrieves the value at the given path.\n *\n * A return value of undefined is ambiguous, and can mean either that the\n * path does not exist, or that the path actually exists but with a value of undefined. If it is required to\n * know whether the path actually exists, pass an object as a third argument.\n * This object will have an \"exists\" key set to true/false.\n *\n * @param object \t\t\t\tctxt\n * @param array \t\t\t\tpath\n * @param object \t\t\t\ttrap\n * @param object \t\t\t\treciever\n *\n * @return mixed\n */\nexport default function(ctxt, path, trap = {}, reciever = {}) {\n\tpath = _arrFrom(path).slice();\n\tvar _ctxt = ctxt;\n\twhile(!_isUndefined(_ctxt) && !_isNull(_ctxt) && path.length) {\n\t\tvar _key = path.shift();\n\t\tif (!(trap.get ? trap.get(_ctxt, _key) : (_isTypeObject(_ctxt) ? _key in _ctxt : _ctxt[_key]))) {\n\t\t\treciever.exists = false;\n\t\t\treturn;\n\t\t}\n\t\t_ctxt = trap.get ? trap.get(_ctxt, _key) : _ctxt[_key];\n\t}\n\treciever.exists = true;\n\treturn _ctxt;\n};\n", "\n/**\n * @imports\n */\nimport _isTypeObject from '../js/isTypeObject.js';\nimport _isFunction from '../js/isFunction.js';\nimport _isNumeric from '../js/isNumeric.js';\nimport _isArray from '../js/isArray.js';\nimport _arrFrom from '../arr/from.js';\nimport _get from './get.js';\n\n/**\n * Sets a value to the given path.\n *\n * @param object \t\t\t\tobj\n * @param array \t\t\t\tpath\n * @param mixed \t\t\t\tval\n * @param object|function \t\tbuildTree\n * @param object \t\t\t\ttrap\n *\n * @return bool\n */\nexport default function(obj, path, val, buildTree = {}, trap = {}) {\n\tconst _set = (target, key, val) => {\n\t\tif (trap.set) {\n\t\t\treturn trap.set(target, key, val);\n\t\t} else {\n\t\t\tif (_isNumeric(path[i]) && _isArray(target)) {\n\t\t\t\ttarget.push(val);\n\t\t\t} else {\n\t\t\t\ttarget[key] = val;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t};\n\tpath = _arrFrom(path);\n\tvar target = obj;\n\tfor(var i = 0; i < path.length; i ++) {\n\t\tif (i < path.length - 1) {\n\t\t\tif (!target || (!_isTypeObject(target) && !_isFunction(target))) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar branch = _get(target, path[i], trap);\n\t\t\tif (!_isTypeObject(branch)) {\n\t\t\t\tif (trap.buildTree === false) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tbranch = _isFunction(trap.buildTree) ? trap.buildTree(i) : (_isNumeric(path[i + 1]) ? [] : {});\n\t\t\t\tvar branchSuccess = _set(target, path[i], branch);\n\t\t\t\tif (!branchSuccess) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttarget = branch;\n\t\t} else {\n\t\t\treturn _set(target, path[i], val);\n\t\t}\n\t}\n};\n", "\r\n/**\r\n * ---------------------------\r\n * Binds callbacks to requestAnimationFrame()\r\n * to create a central \"read/write\" phases for Ctxt access.\r\n * ---------------------------\r\n */\r\n\t\t\t\r\nexport default window => class Reflow {\r\n\r\n\t/**\r\n\t * Starts the loop.\r\n\t *\r\n\t * @return this\r\n\t */\r\n\tconstructor( asyncDOM = true ) {\r\n\t\tObject.defineProperty( this, 'window', { value: window } );\r\n\t\tObject.defineProperty( this, 'readCallbacks', { value: new Set } );\r\n\t\tObject.defineProperty( this, 'writeCallbacks', { value: new Set } );\r\n\t\tthis.async = asyncDOM;\r\n\t\tif ( this.window.requestAnimationFrame ) {\r\n\t\t\tthis._run();\r\n\t\t} else {\r\n\t\t\tthis.async = false;\r\n\t\t}\r\n\t}\r\n\r\n\t_run() {\r\n\t\tthis.window.requestAnimationFrame( () => {\r\n\t\t\tthis.readCallbacks.forEach( callback => {\r\n\t\t\t\tif ( !callback() ) {\r\n\t\t\t\t\tthis.readCallbacks.delete( callback );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t\tthis.writeCallbacks.forEach( callback => {\r\n\t\t\t\tif ( !callback() ) {\r\n\t\t\t\t\tthis.writeCallbacks.delete( callback );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t\tthis._run();\r\n\t\t} );\r\n\t}\r\n\t\r\n\t/**\r\n\t * Binds a callback to the \"read\" phase.\r\n\t *\r\n\t * @param function \tcallback\r\n\t * @param bool\t\twithPromise\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tonread( callback, withPromise = false ) {\r\n\t\tif ( withPromise ) {\r\n\t\t\treturn new Promise( ( resolve, reject ) => {\r\n\t\t\t\tif ( this.async === false ) {\r\n\t\t\t\t\tcallback( resolve, reject );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.readCallbacks.add( () => {\r\n\t\t\t\t\t\tcallback( resolve, reject );\r\n\t\t\t\t\t} );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t}\r\n\t\tif ( this.async === false ) {\r\n\t\t\tcallback();\r\n\t\t} else {\r\n\t\t\tthis.readCallbacks.add( callback );\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Binds a callback to the \"write\" phase.\r\n\t *\r\n\t * @param function \tcallback\r\n\t * @param bool\t\twithPromise\r\n\t *\r\n\t * @return void\r\n\t */\r\n\tonwrite( callback, withPromise = false ) {\r\n\t\tif ( withPromise ) {\r\n\t\t\treturn new Promise( ( resolve, reject ) => {\r\n\t\t\t\tif ( this.async === false ) {\r\n\t\t\t\t\tcallback( resolve, reject );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.writeCallbacks.add( () => {\r\n\t\t\t\t\t\tcallback( resolve, reject );\r\n\t\t\t\t\t} );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t}\r\n\t\tif ( this.async === false ) {\r\n\t\t\tcallback();\r\n\t\t} else {\r\n\t\t\tthis.writeCallbacks.add( callback );\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * A special construct for Ctxt manipulations that span\r\n\t * one or more read/write cycles.\r\n\t *\r\n\t * @param function \tread\r\n\t * @param function \twrite\r\n\t * @param mixed\t\tprevTransaction\r\n\t *\r\n\t * @return void|mixed\r\n\t */\r\n\tcycle( onread, onwrite, prevTransaction ) {\r\n\t\tthis.onread( () => {\r\n\t\t\t// Record initial values\r\n\t\t\tconst readReturn = onread( prevTransaction );\r\n\t\t\t// Call erite, the transation\r\n\t\t\tconst callWrite = ( readReturn ) => {\r\n\t\t\t\tif ( readReturn === undefined ) return;\r\n\t\t\t\tthis.onwrite( () => {\r\n\t\t\t\t\tconst writeReturn = onwrite( readReturn, prevTransaction );\r\n\t\t\t\t\t// Repeat transaction\r\n\t\t\t\t\tconst repeatTransaction = ( writeReturn ) => {\r\n\t\t\t\t\t\tif ( writeReturn === undefined ) return;\r\n\t\t\t\t\t\tthis.cycle( onread, onwrite, writeReturn );\r\n\t\t\t\t\t};\r\n\t\t\t\t\t// ---------------------------------------\r\n\t\t\t\t\t// If \"write\" returns a promise, we wait until it is resolved\r\n\t\t\t\t\t// ---------------------------------------\r\n\t\t\t\t\tif ( writeReturn instanceof Promise ) {\r\n\t\t\t\t\t\twriteReturn.then( repeatTransaction );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\trepeatTransaction( writeReturn );\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\t\t\t};\r\n\t\t\t// ---------------------------------------\r\n\t\t\t// If \"read\" returns a promise, we wait until it is resolved\r\n\t\t\t// ---------------------------------------\r\n\t\t\tif ( readReturn instanceof Promise ) {\r\n\t\t\t\treadReturn.then( callWrite );\r\n\t\t\t} else {\r\n\t\t\t\tcallWrite( readReturn );\r\n\t\t\t}\r\n\t\t} );\r\n\t}\r\n\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport { _isFunction, _isObject, _internals } from '@webqit/util/js/index.js';\r\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\r\n\r\n/**\r\n *\r\n * @class Realtime\r\n */\r\nexport default class Realtime {\r\n\r\n\t/**\r\n\t * @constructor\r\n\t *\r\n\t * @param document|Element\tcontext\r\n\t */\r\n\tconstructor( context, namespace, window ) {\r\n\t\tthis.context = context;\r\n\t\tthis.namespace = namespace;\r\n\t\tthis.window = context.defaultView || context.ownerDocument?.defaultView || window;\r\n\t\tthis.document = this.window.document;\r\n\t\tthis.wq = this.window.wq;\r\n\t\tObject.defineProperty( this, '#', { value: {} } );\r\n\t}\r\n\r\n\t/**\r\n\t * Resolves arguments\r\n\t * \r\n\t * @param Array \t\t\targs \r\n\t * \r\n\t * @returns Array\r\n\t */\r\n\tresolveArgs( args ) {\r\n\t\tif ( _isFunction( args[ 0 ] ) ) { args = [ [], ...args ]; }\r\n\t\telse if ( _isObject( args[ 0 ] ) && args.length === 1 ) {\r\n\t\t\targs = [ [], undefined, args[ 0 ] ];\r\n\t\t} else if ( _isObject( args[ 1 ] ) && args.length === 2 ) {\r\n\t\t\targs = [ _arrFrom( args[ 0 ], false/*castObject*/ ), undefined, args[ 1 ] ];\r\n\t\t} else { args[ 0 ] = _arrFrom( args[ 0 ], false/*castObject*/ ); }\r\n\t\treturn args;\r\n\t}\r\n\r\n\t/**\r\n\t * @registry\r\n\t *\r\n\t * @param Array\t\t\t\t...args\r\n\t * \r\n\t * @returns Map\r\n\t */\r\n\tregistry( ...args ) {\r\n\t\treturn _internals( this.window, 'dom.realtime', this.namespace, ...args );\r\n\t}\r\n\t\t\r\n\t/**\r\n\t * @createSignalGenerator\r\n\t * \r\n\t * @param Object \t\t\tmo \r\n\t * \r\n\t * @returns Object\r\n\t */\r\n\tcreateSignalGenerator() {\r\n\t\treturn {\r\n\t\t\tgenerate() {\r\n\t\t\t\t// Abort previous\r\n\t\t\t\tthis.lastController?.abort();\r\n\t\t\t\tthis.lastController = new AbortController;\r\n\t\t\t\tconst flags = { signal: this.lastController.signal };\r\n\t\t\t\treturn flags;\r\n\t\t\t},\r\n\t\t\tdisconnect() { this.lastController?.abort(); }\r\n\t\t}\r\n\t}\r\n\t\t\r\n\t/**\r\n\t * Loops through registration objects whose contexts match the event context.\r\n\t * \r\n\t * @param String \t\tinterceptionTiming\r\n\t * @param Object|Array \trecord_s\r\n\t * @param Function \t\tcallback \r\n\t * \r\n\t * @returns void\r\n\t */\r\n\tforEachMatchingContext( interceptionTiming, record_s, callback ) {\r\n\t\tconst { window } = this, records = Array.isArray( record_s ) ? record_s : [ record_s ];\r\n\t\tlet dispatchBatch = new Set;\r\n\t\tfor ( const [ depth, registries ] of this.registry( interceptionTiming ) ) {\r\n\t\t\tfor ( const [ context, registry ] of registries ) {\r\n\t\t\t\t// Ensure event target is/within context\r\n\t\t\t\tlet matches = records.filter( record => {\r\n\t\t\t\t\tif ( !context.contains( record.target ) ) return false;\r\n\t\t\t\t\treturn depth === 'subtree' || record.target === context;\r\n\t\t\t\t} );\r\n\t\t\t\tif ( !matches.length ) continue;\r\n\t\t\t\t// Records will be dispatched in their original form\r\n\t\t\t\tif ( !Array.isArray( record_s ) ) { matches = matches[ 0 ]; }\r\n\t\t\t\tfor ( const registration of registry ) {\r\n\t\t\t\t\tdispatchBatch.add( [ registration, matches, context ] );\r\n\t\t\t\t\t//callback.call( this, registration, matches, context );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Saving everything to dispatchBatch ensures that recursive modifications\r\n\t\t// to both this.registry( interceptionTiming ), registries, and registry aren't pciked up\r\n\t\tfor ( const [ registration, record_s, context ] of dispatchBatch ) {\r\n\t\t\tcallback.call( this, registration, record_s, context );\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @disconnectables\r\n\t * \r\n\t * @param AbortSignal \t\tsignal\r\n\t * @param Array \t\t\t...objects \r\n\t * \r\n\t * @returns Object\r\n\t */\r\n\tdisconnectables( signal, ...objects ) {\r\n\t\tconst disconnectable = { disconnect() {\r\n\t\t\tobjects.forEach( d => (\r\n\t\t\t\td && _isFunction( d.disconnect ) && d.disconnect() \r\n\t\t\t\t|| _isFunction( d ) && d() \r\n\t\t\t\t|| _isObject( d ) && ( d.disconnected = true )\r\n\t\t\t) );\r\n\t\t} };\r\n\t\tif ( signal ) signal.addEventListener( 'abort', () => disconnectable.disconnect() );\r\n\t\treturn disconnectable;\r\n\t}\r\n}\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport Realtime from './Realtime.js';\r\n\r\n/**\r\n *\r\n * @class AttrRealtime\r\n */\r\nexport default class AttrRealtime extends Realtime {\r\n\r\n\t/**\r\n\t * @constructor\r\n\t */\r\n\tconstructor( context, ...args ) {\r\n\t\tsuper( context, 'attr', ...args );\r\n\t}\r\n\t\r\n\t/**\r\n\t * Runs a query.\r\n\t *\r\n\t * @param array|string\t\t\t\tfilter\r\n\t * @param function\t\t\t\t\tcallback\r\n\t * @param object\t\t\t\t\tparams\r\n\t *\r\n\t * @return Disconnectable|Void\r\n\t */\r\n\tget( filter, callback = undefined, params = {} ) {\r\n\t\tconst originalFilterIsString = typeof filter === 'string';\r\n\t\t[ filter = [], callback = undefined, params = {} ] = this.resolveArgs( arguments );\r\n\t\tconst { context } = this;\r\n\t\t// -------------\r\n\t\tconst records = attrIntersection( context, filter );\r\n\t\tconst record_s = originalFilterIsString ? records[ 0 ] : records;\r\n\t\tif ( !callback ) return record_s;\r\n\t\tconst signalGenerator = callback && params.lifecycleSignals && this.createSignalGenerator();\r\n\t\tconst flags = signalGenerator?.generate() || {};\r\n\t\tcallback( record_s, flags, context );\r\n\t\t// -------------\r\n\t\tif ( params.live ) {\r\n\t\t\tif ( signalGenerator ) { params = { ...params, signalGenerator }; }\r\n\t\t\tconst disconnectable_live = this.observe( originalFilterIsString ? filter[ 0 ] : filter, callback, { newValue: true, ...params } );\r\n\t\t\treturn this.disconnectables( params.signal, disconnectable_live );\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Mutation Observer\r\n\t * \r\n\t * @param array|string\t\t\t\tfilter\r\n\t * @param function\t\t\t\t\tcallback\r\n\t * @param object\t\t\t\t\tparams\r\n\t * \r\n\t * @returns Disconnectable\r\n\t */\r\n\tobserve( filter, callback, params = {} ) {\r\n\t\tconst originalFilterIsString = typeof filter === 'string';\r\n\t\t[ filter = [], callback, params = {} ] = this.resolveArgs( arguments );\r\n\t\t// ------------------------\r\n\t\tif ( [ 'sync', 'intercept' ].includes( params.timing ) ) return this.observeSync( originalFilterIsString ? filter[ 0 ] : filter, callback, params );\r\n\t\tif ( params.timing && params.timing !== 'async' ) throw new Error( `Timing option \"${ params.timing }\" invalid.` );\r\n\t\t// ------------------------\r\n\t\tconst { context, window, wq } = this;\r\n\t\t// ------------------\r\n\t\tif ( params.eventDetails && !wq.attrInterceptionHooks?.intercepting ) {\r\n\t\t\tattrInterception.call( window, 'intercept', () => {} );\r\n\t\t}\r\n\t\t// -------------\r\n\t\tconst disconnectable = new window.MutationObserver( records => {\r\n\t\t\trecords = dedup( records ).map( rcd => withAttrEventDetails.call( window, rcd ) );\r\n\t\t\tdispatch.call( window, registration, records, context );\r\n\t\t} );\r\n\t\t// ------------------\r\n\t\tconst $params = { attributes: true, attributeOldValue: params.oldValue, subtree: params.subtree };\r\n\t\tif ( filter.length ) { $params.attributeFilter = filter; }\r\n\t\tdisconnectable.observe( context, $params );\r\n\t\t// -------------\r\n\t\tconst signalGenerator = params.signalGenerator || params.lifecycleSignals && this.createSignalGenerator();\r\n\t\tconst registration = { context, filter, callback, params, atomics: new Map, originalFilterIsString, signalGenerator, disconnectable };\r\n\t\t// -------------\r\n\t\treturn this.disconnectables( params.signal, disconnectable, signalGenerator );\r\n\t}\r\n\t\r\n\t/**\r\n\t * Mutation Interceptor\r\n\t * \r\n\t * @param array|string\t\t\t\tfilter\r\n\t * @param function\t\t\t\t\tcallback\r\n\t * @param object\t\t\t\t\tparams\r\n\t * \r\n\t * @returns Disconnectable\r\n\t */\r\n\tobserveSync( filter, callback, params = {} ) {\r\n\t\tconst originalFilterIsString = typeof filter === 'string';\r\n\t\t[ filter, callback, params = {} ] = this.resolveArgs( arguments );\r\n\t\tconst { context, window } = this;\r\n\t\t// -------------\r\n\t\tif ( params.timing && ![ 'sync', 'intercept' ].includes( params.timing ) ) throw new Error( `Timing option \"${ params.timing }\" invalid.` );\r\n\t\tconst interceptionTiming = params.timing === 'intercept' ? 'intercept' : 'sync';\r\n\t\tconst intersectionDepth = params.subtree ? 'subtree' : 'children';\r\n\t\tif ( !this.registry( interceptionTiming ).size ) {\r\n\t\t\t// One handler per intercept/sync registry\r\n\t\t\tattrInterception.call( window, interceptionTiming, records => {\r\n\t\t\t\tthis.forEachMatchingContext( interceptionTiming, records, dispatch );\r\n\t\t\t} );\r\n\t\t}\r\n\t\t// -------------\r\n\t\tconst disconnectable = { disconnect() {\r\n\t\t\tregistry.delete( registration );\r\n\t\t\tif ( !registry.size ) { registries.delete( context ); }\r\n\t\t} };\r\n\t\tconst signalGenerator = params.signalGenerator || params.lifecycleSignals && this.createSignalGenerator();\r\n\t\tconst registration = { context, filter, callback, params, atomics: new Map, originalFilterIsString, signalGenerator, disconnectable };\r\n\t\t// -------------\r\n\t\tconst registries = this.registry( interceptionTiming, intersectionDepth );\r\n\t\tif ( !registries.has( context ) ) { registries.set( context, new Set ); }\r\n\t\tconst registry = registries.get( context );\r\n\t\tregistry.add( registration );\r\n\t\t// -------------\r\n\t\treturn this.disconnectables( params.signal, disconnectable, signalGenerator );\r\n\t}\r\n}\r\n\r\n/**\r\n * Deduplicates records.\r\n * \r\n * @param Array \t\t\trecords\r\n * \r\n * @returns Array\r\n */\r\nfunction dedup( records ) {\r\n\treturn records.reduce( ( rcds, rcd, i ) => {\r\n\t\tif ( rcds[ i - 1 ]?.attributeName === rcd.attributeName ) return rcds;\r\n\t\treturn rcds.concat( rcd );\r\n\t}, [] );\r\n}\r\n\r\n/**\r\n * Dispatches a mutation record if it matches the observed.\r\n * \r\n * @param Object \t\t\tregistration\r\n * @param Array \t\t\trecords\r\n * \r\n * @returns Void\r\n */\r\nfunction dispatch( registration, records ) {\r\n\tconst { context, filter, callback, params, atomics, originalFilterIsString, signalGenerator } = registration;\r\n\tif ( params.atomic && !atomics.size ) {\r\n\t\trecords = attrIntersection( context, filter, records );\r\n\t}\r\n\t// Should we care about old / new values being present?\r\n\tif ( !( params.newValue === null && params.oldValue === null ) ) {\r\n\t\trecords = records.map( rcd => {\r\n\t\t\tlet exclusion;\r\n\t\t\tif ( !params.oldValue && ( 'oldValue' in rcd ) ) {\r\n\t\t\t\t( { oldValue: exclusion, ...rcd } = rcd );\r\n\t\t\t}\r\n\t\t\tif ( !params.newValue && ( 'value' in rcd ) ) {\r\n\t\t\t\t( { value: exclusion, ...rcd } = rcd );\r\n\t\t\t} else if ( params.newValue && typeof rcd.value === 'undefined' ) {\r\n\t\t\t\trcd = {  ...rcd, value: rcd.target.getAttribute( rcd.name ) };\r\n\t\t\t}\r\n\t\t\treturn rcd;\r\n\t\t} );\r\n\t}\r\n\tif ( params.atomic ) {\r\n\t\trecords.forEach( record => atomics.set( record.name, record ) );\r\n\t\trecords = Array.from( atomics.entries() ).map( ( [ , value ] ) => value );\r\n\t}\r\n\tconst record_s = originalFilterIsString ? records[ 0 ] : records;\r\n\tconst flags = signalGenerator?.generate() || {};\r\n\tcallback( record_s, flags, context );\r\n}\r\n\r\n/**\r\n * Helper to determining which records to deliver.\r\n * \r\n * @param Object \t\t\tcontext\r\n * @param Array \t\t\tfilter\r\n * @param Array \t\t\trecords\r\n * \r\n * @returns Array\r\n */\r\nfunction attrIntersection( context, filter, records = [] ) {\r\n\tconst _type = { event: null, type: 'attribute' };\r\n\tif ( filter.length ) {\r\n\t\treturn filter.map( attrName => {\r\n\t\t\treturn records.find( r => r.name === attrName ) || { target: context, name: attrName, value: context.getAttribute( attrName ), ..._type };\r\n\t\t} );\r\n\t}\r\n\tconst attrs = Array.from( context.attributes );\r\n\treturn attrs.map( attr => {\r\n\t\treturn records.find( r => r.name === attr.nodeName ) || { target: context, name: attr.nodeName, value: attr.nodeValue, ..._type };\r\n\t} );\r\n}\r\n\r\n/**\r\n * Determines the event for an attr mutation record.\r\n * \r\n * @param MutationRecord \t{ target, attributeName }\r\n * \r\n * @returns Object\r\n */\r\nfunction withAttrEventDetails( { target, attributeName, value, oldValue } ) {\r\n\tconst window = this, registry = window.wq.attrInterceptionRecords?.get( target ) || {};\r\n\tconst event = registry[ attributeName ] || 'mutation';\r\n\tconst record = { target, name: attributeName, value, oldValue, type: 'observation', event };\r\n\treturn record;\r\n}\r\n\r\n/**\r\n * Attributes intersection engine.\r\n * \r\n * @param String \t\t\ttiming \r\n * @param Function \t\t\tcallback \r\n * \r\n * @returns \r\n */\r\nfunction attrInterception( timing, callback ) {\r\n\tconst window = this;\r\n\tconst { wq, document, Element } = window;\r\n\tif ( !wq.attrInterceptionHooks ) { wq.attrInterceptionHooks = new Map; }\r\n\tif ( !wq.attrInterceptionHooks.has( timing ) ) { wq.attrInterceptionHooks.set( timing, new Set ); }\r\n\twq.attrInterceptionHooks.get( timing ).add( callback );\r\n\tconst rm = () => wq.attrInterceptionHooks.get( timing ).delete( callback );\r\n\tif ( wq.attrInterceptionHooks?.intercepting ) return rm;\r\n\tconsole.warn( `Attr mutation APIs are now being intercepted.` );\r\n\twq.attrInterceptionHooks.intercepting = true;\r\n\twq.attrInterceptionRecords = new Map;\r\n\r\n\t// Interception hooks\r\n\tconst attrIntercept = ( record, defaultAction ) => {\r\n\t\tif ( !wq.attrInterceptionRecords.has( record.target ) ) { wq.attrInterceptionRecords.set( record.target, {} ); }\r\n\t\tconst registry = wq.attrInterceptionRecords.get( record.target );\r\n\t\t// ------------------\r\n\t\tclearTimeout( registry[ record.name ]?.timeout ); // Clear any previous that's still active\r\n\t\tregistry[ record.name ] = record.event; // Main: set event details... and next to timeout details\r\n\t\tconst timeout = setTimeout( () => { delete registry[ record.name ]; }, 0 );\r\n\t\tObject.defineProperty( record.event, 'timeout', { value: timeout, configurable: true } );\r\n\t\t// ------------------\r\n\t\twq.attrInterceptionHooks.get( 'intercept' )?.forEach( callback => callback( [ record ] ) );\r\n\t\tconst returnValue = defaultAction();\r\n\t\twq.attrInterceptionHooks.get( 'sync' )?.forEach( callback => callback( [ record ] ) );\r\n\t\treturn returnValue;\r\n\t};\r\n\r\n\t// Interception observer WILL need to know non-API-based mutations\r\n\tconst mo = new window.MutationObserver( records => {\r\n\t\trecords = dedup( records ).map( rcd => withAttrEventDetails.call( window, rcd ) ).filter( ( rcd, i ) => {\r\n\t\t\treturn !Array.isArray( rcd.event );\r\n\t\t} );\r\n\t\tif ( !records.length ) return;\r\n\t\twq.attrInterceptionHooks.get( 'intercept' )?.forEach( callback => callback( records ) );\r\n\t\twq.attrInterceptionHooks.get( 'sync' )?.forEach( callback => callback( records ) );\r\n\t} );\r\n\tmo.observe( document, { attributes: true, subtree: true, attributeOldValue: true } );\r\n\r\n\t// Intercept DOM attr mutation methods\r\n\tconst originalApis = Object.create( null );\r\n\t[ 'setAttribute', 'removeAttribute', 'toggleAttribute', ].forEach( apiName => {\r\n\t\toriginalApis[ apiName ] = Element.prototype[ apiName ];\r\n\t\tElement.prototype[ apiName ] = function( ...args ) {\r\n\t\t\tlet value, oldValue = this.getAttribute( args[ 0 ] );\r\n\t\t\tif ( [ 'setAttribute', 'toggleAttribute' ].includes( apiName ) ) { value = args[ 1 ]; }\r\n\t\t\tif ( apiName === 'toggleAttribute' && value === undefined ) {\r\n\t\t\t\tvalue = oldValue === null ? true : false;\r\n\t\t\t}\r\n\t\t\tconst record = { target: this, name: args[ 0 ], value, oldValue, type: 'interception', event: [ this, apiName ] };\r\n\t\t\tconst exec = () => originalApis[ apiName ].call( this, ...args );\r\n\t\t\treturn attrIntercept( record, exec );\r\n\t\t}\r\n\t} );\r\n\r\n\treturn rm;\r\n}\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport { _isObject } from '@webqit/util/js/index.js';\r\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\r\nimport AttrRealtime from './AttrRealtime.js';\r\nimport Realtime from './Realtime.js';\r\n\r\n/**\r\n *\r\n * @class DOMRealtime\r\n */\r\nexport default class DOMRealtime extends Realtime {\r\n\r\n\t/**\r\n\t * @constructor\r\n\t */\r\n\tconstructor( context, ...args ) {\r\n\t\tsuper( context, 'tree', ...args );\r\n\t}\r\n\r\n\t/**\r\n\t * Alias for ( new AttrRealtime() ).all( ... )\r\n\t */\r\n\tattr( filter, callback = undefined, params = {} ) {\r\n\t\tconst { context, window } = this;\r\n\t\treturn ( new AttrRealtime( context, window ) ).get( ...arguments );\r\n\t}\r\n\r\n\t/**\r\n\t * Runs a query.\r\n\t *\r\n\t * @param array|Element|string\t\tselectors\r\n\t * @param function\t\t\t\t\tcallback\r\n\t * @param object\t\t\t\t\tparams\r\n\t *\r\n\t * @return Disconnectable|Void\r\n\t */\r\n\tquery( selectors, callback = undefined, params = {} ) {\r\n\t\t[ selectors, callback = undefined, params = {} ] = this.resolveArgs( arguments );\r\n\t\tconst { context } = this;\r\n\t\t// ------------------\r\n\t\tconst records = new Map, getRecord = target => {\r\n\t\t\tif ( !records.has( target ) ) { records.set( target, { target, entrants: [], exits: [], type: 'query', event: null } ); }\r\n\t\t\treturn records.get( target );\r\n\t\t};\r\n\t\t// ------------------\r\n\t\tif ( !params.generation || params.generation === 'entrants' ) {\r\n\t\t\tif ( !selectors.length ) {\r\n\t\t\t\t//if ( params.subtree ) throw new Error( `The subtree option requires a selector to work.` );\r\n\t\t\t\t[ ...context.children ].forEach( node => getRecord( context ).entrants.push( node ) );\r\n\t\t\t} else if ( selectors.every( selector => typeof selector === 'string' ) && ( selectors = selectors.join( ',' ) ) ) {\r\n\t\t\t\tconst matches = params.subtree\r\n\t\t\t\t\t? context.querySelectorAll( selectors )\r\n\t\t\t\t\t: [ ...context.children ].filter( node => node.matches( selectors ) );\r\n\t\t\t\tmatches.forEach( node => getRecord( node.parentNode || context ).entrants.push( node ) );\r\n\t\t\t}\r\n\t\t}\r\n\t\t// ------------------\r\n\t\tif ( !callback ) return records;\r\n\t\tconst disconnectable = { disconnected: false };\r\n\t\tconst signalGenerator = callback && params.lifecycleSignals && this.createSignalGenerator();\r\n\t\tfor ( const [ , record ] of records ) {\r\n\t\t\tif ( disconnectable.disconnected ) break;\r\n\t\t\tconst flags = signalGenerator?.generate() || {};\r\n\t\t\tcallback( record, flags, context );\r\n\t\t}\r\n\t\t// ------------------\r\n\t\tif ( params.live ) {\r\n\t\t\tif ( signalGenerator ) { params = { ...params, signalGenerator }; }\r\n\t\t\tconst disconnectable_live = this.observe( selectors, callback, params );\r\n\t\t\treturn this.disconnectables( params.signal, disconnectable, disconnectable_live );\r\n\t\t}\r\n\t\treturn this.disconnectables( params.signal, disconnectable, signalGenerator );\r\n\t}\r\n\r\n\t/**\r\n\t * Alias for query( ..., { subtree: false } )\r\n\t */\r\n\tchildren( selectors, callback = undefined, params = {} ) {\r\n\t\t[ selectors, callback = undefined, params = {} ] = this.resolveArgs( arguments );\r\n\t\treturn this.query( selectors, callback, { ...params, subtree: false } );\r\n\t}\r\n\r\n\t/**\r\n\t * Alias for query( ..., { subtree: true } )\r\n\t */\r\n\tsubtree( selectors, callback = undefined, params = {} ) {\r\n\t\t[ selectors, callback = undefined, params = {} ] = this.resolveArgs( arguments );\r\n\t\treturn this.query( selectors, callback, { ...params, subtree: true } );\r\n\t}\r\n\r\n\t/**\r\n\t * Mutation Observer\r\n\t * \r\n\t * @param array|Element|string\t\tselectors\r\n\t * @param function\t\t\t\t\tcallback\r\n\t * @param object\t\t\t\t\tparams\r\n\t * \r\n\t * @returns Disconnectable\r\n\t */\r\n\tobserve( selectors, callback, params = {} ) {\r\n\t\t[ selectors, callback, params = {} ] = this.resolveArgs( arguments );\r\n\t\t// ------------------------\r\n\t\tif ( [ 'sync', 'intercept' ].includes( params.timing ) ) return this.observeSync( selectors, callback, params );\r\n\t\tif ( params.timing && params.timing !== 'async' ) throw new Error( `Timing option \"${ params.timing }\" invalid.` );\r\n\t\t// ------------------------\r\n\t\tconst { context, window, wq, document } = this;\r\n\t\t// ------------------\r\n\t\tif ( params.eventDetails ) { wq.domInterceptionRecordsAlwaysOn = true; }\r\n\t\tif ( ( document.readyState === 'loading' || wq.domInterceptionRecordsAlwaysOn ) && !wq.domInterceptionHooks?.intercepting ) {\r\n\t\t\tdomInterception.call( window, 'sync', () => {} );\r\n\t\t}\r\n\t\t// -------------\r\n\t\tconst disconnectable = new window.MutationObserver( records => records.forEach( record => {\r\n\t\t\tdispatch.call( window, registration, withEventDetails.call( window, record ), context );\r\n\t\t} ) );\r\n\t\tdisconnectable.observe( context, { childList: true, subtree: params.subtree, } );\r\n\t\tconst signalGenerator = params.signalGenerator || params.lifecycleSignals && this.createSignalGenerator();\r\n\t\tconst registration = { context, selectors, callback, params, signalGenerator, disconnectable };\r\n\t\t// -------------\r\n\t\tif ( params.staticSensitivity ) {\r\n\t\t\tconst disconnectable_attr = staticSensitivity.call( window, registration );\r\n\t\t\treturn this.disconnectables( params.signal, disconnectable, signalGenerator, disconnectable_attr );\r\n\t\t}\r\n\t\treturn this.disconnectables( params.signal, disconnectable, signalGenerator );\r\n\t}\r\n\t\r\n\t/**\r\n\t * Mutation Interceptor\r\n\t * \r\n\t * @param array|Element|string\t\tselectors\r\n\t * @param function\t\t\t\t\tcallback\r\n\t * @param object\t\t\t\t\tparams\r\n\t * \r\n\t * @returns Disconnectable\r\n\t */\r\n\tobserveSync( selectors, callback, params = {} ) {\r\n\t\t[ selectors, callback, params = {} ] = this.resolveArgs( arguments );\r\n\t\tconst { context, window } = this;\r\n\t\t// -------------\r\n\t\tif ( params.timing && ![ 'sync', 'intercept' ].includes( params.timing ) ) throw new Error( `Timing option \"${ params.timing }\" invalid.` );\r\n\t\tconst interceptionTiming = params.timing === 'intercept' ? 'intercept' : 'sync';\r\n\t\tconst intersectionDepth = params.subtree ? 'subtree' : 'children';\r\n\t\tif ( !this.registry( interceptionTiming ).size ) {\r\n\t\t\t// One handler per intercept/sync registry\r\n\t\t\tdomInterception.call( window, interceptionTiming, record => {\r\n\t\t\t\tthis.forEachMatchingContext( interceptionTiming, record, dispatch );\r\n\t\t\t} );\r\n\t\t}\r\n\t\t// -------------\r\n\t\tconst disconnectable = { disconnect() {\r\n\t\t\tregistry.delete( registration );\r\n\t\t\tif ( !registry.size ) { registries.delete( context ); }\r\n\t\t} };\r\n\t\tconst signalGenerator = params.signalGenerator || params.lifecycleSignals && this.createSignalGenerator();\r\n\t\tconst registration = { context, selectors, callback, params, signalGenerator, disconnectable };\r\n\t\t// -------------\r\n\t\tconst registries = this.registry( interceptionTiming, intersectionDepth );\r\n\t\tif ( !registries.has( context ) ) { registries.set( context, new Set ); }\r\n\t\tconst registry = registries.get( context );\r\n\t\tregistry.add( registration );\r\n\t\t// -------------\r\n\t\tif ( params.staticSensitivity ) {\r\n\t\t\tconst disconnectable_attr = staticSensitivity.call( window, registration );\r\n\t\t\treturn this.disconnectables( params.signal, disconnectable, signalGenerator, disconnectable_attr );\r\n\t\t}\r\n\t\treturn this.disconnectables( params.signal, disconnectable, signalGenerator );\r\n\t}\r\n}\r\n\r\n/**\r\n * Sensitivty for attribute changes for attribute selectors.\r\n * \r\n * @param object registration\r\n * \r\n * @returns Disconnectable\r\n */\r\nfunction staticSensitivity( registration ) {\r\n\tconst window = this;\r\n\tconst { context, selectors, callback, params, signalGenerator } = registration;\r\n\tconst parse = selector => [ ...selector.matchAll(/\\[([^\\=\\]]+)(\\=[^\\]]+)?\\]/g) ].map( x => x[ 1 ] );\r\n\tif ( !( registration.$attrs = selectors.filter( s => typeof s === 'string' && s.includes( '[' ) ).reduce( ( attrs, selector ) => attrs.concat( parse( selector ) ), [] ) ).length ) return;\r\n\t// ---------\r\n\tconst entrants = new Set, exits = new Set;\r\n\tentrants.push = val => ( exits.delete( val ), entrants.add( val ) );\r\n\texits.push = val => ( entrants.delete( val ), exits.add( val ) );\r\n\tregistration.$deliveryCache = { entrants, exits };\r\n\t// ---------\r\n\treturn ( new AttrRealtime( context, window ) ).observe( registration.$attrs, _records => {\r\n\t\tconst records = new Map, getRecord = target => {\r\n\t\t\tif ( !records.has( target ) ) { records.set( target, { target, entrants: [], exits: [], type: 'static', event: null } ); }\r\n\t\t\treturn records.get( target );\r\n\t\t};\r\n\t\t// ---------\r\n\t\tconst matchesCache = new WeakMap;\r\n\t\tconst matches = node => {\r\n\t\t\tif ( !matchesCache.has( node ) ) { matchesCache.set( node, selectors.some( selector => node.matches( selector ) ) ); }\r\n\t\t\treturn matchesCache.get( node );\r\n\t\t};\r\n\t\t// ---------\r\n\t\tfor ( const _record of _records ) {\r\n\t\t\t[ 'entrants', 'exits' ].forEach( generation => {\r\n\t\t\t\tif ( params.generation && generation !== params.generation ) return;\r\n\t\t\t\tif ( registration.$deliveryCache[ generation ].has( _record.target ) || ( generation === 'entrants' ? !matches( _record.target ) : matches( _record.target ) ) ) return;\r\n\t\t\t\tregistration.$deliveryCache[ generation ].push( _record.target );\r\n\t\t\t\tgetRecord( _record.target )[ generation ].push( _record.target );\r\n\t\t\t\tgetRecord( _record.target ).event = _record.event;\r\n\t\t\t} );\r\n\t\t}\r\n\t\t// ---------\r\n\t\tfor ( const [ , record ] of records ) {\r\n\t\t\tconst flags = signalGenerator?.generate() || {};\r\n\t\t\tcallback( record, flags, context );\r\n\t\t}\r\n\t}, { subtree: params.subtree, timing: params.timing, eventDetails: params.eventDetails } );\r\n}\r\n\r\n/**\r\n * Dispatches a mutation record if it matches the observed.\r\n * \r\n * @param Object \t\t\tregistration \r\n * @param Object \t\t\trecord \r\n * \r\n * @returns Void\r\n */\r\nfunction dispatch( registration, _record ) {\r\n\tconst { context, selectors, callback, params, signalGenerator, $deliveryCache } = registration;\r\n\t// ---------\r\n\tconst record = { ..._record, entrants: [], exits: [] };\r\n\t[ 'entrants', 'exits' ].forEach( generation => {\r\n\t\tif ( params.generation && generation !== params.generation ) return;\r\n\t\tif ( selectors.length ) {\r\n\t\t\trecord[ generation ] = nodesIntersection( selectors, _record[ generation ], _record.event !== 'parse' );\r\n\t\t} else {\r\n\t\t\trecord[ generation ] = [ ..._record[ generation ] ];\r\n\t\t}\r\n\t\tif ( !$deliveryCache ) return;\r\n\t\tfor ( const node of record[ generation ] ) {\r\n\t\t\t$deliveryCache[ generation ].push( node );\r\n\t\t}\r\n\t} );\r\n\t// ---------\r\n\tif ( !record.entrants.length && !record.exits.length ) return;\r\n\tconst flags = signalGenerator?.generate() || {};\r\n\tcallback( record, flags, context );\r\n}\r\n\r\n/**\r\n * Aggregates instances of els in sources\r\n * \r\n * @param Array \t\t\ttargets \r\n * @param Array \t\t\tsources \r\n * @param Bool \t\t\t\tdeepIntersect \r\n * \r\n * @returns \r\n */\r\nfunction nodesIntersection( targets, sources, deepIntersect ) {\r\n\tsources = Array.isArray( sources ) ? sources : [ ...sources ];\r\n\tconst match = ( sources, target ) => {\r\n\t\t// Filter out text nodes\r\n\t\tsources = sources.filter( source => source.matches );\r\n\t\tif ( typeof target === 'string' ) {\r\n\t\t\t// Is directly mutated...\r\n\t\t\tlet matches = sources.filter( source => source.matches( target ) );\r\n\t\t\t// Is contextly mutated...\r\n\t\t\tif ( deepIntersect ) {\r\n\t\t\t\tmatches = sources.reduce( ( collection, source ) => {\r\n\t\t\t\t\treturn [ ...collection, ...source.querySelectorAll( target ) ];\r\n\t\t\t\t}, matches );\r\n\t\t\t}\r\n\t\t\tif ( matches.length ) return matches;\r\n\t\t} else {\r\n\t\t\t// Is directly mutated...\r\n\t\t\tif ( sources.includes( target ) || (\r\n\t\t\t\tdeepIntersect && sources.some( source => source.contains( target ) )\r\n\t\t\t) ) { return [ target ]; }\r\n\t\t}\r\n\t};\r\n\t// Search can be expensive...\r\n\t// Multiple listeners searching the same thing in the same list?\r\n\tif ( !sources.$$searchCache ) { sources.$$searchCache = new Map; }\r\n\treturn targets.reduce( ( matches, target ) => {\r\n\t\tlet _matches;\r\n\t\tif ( sources.$$searchCache.has( target ) ) {\r\n\t\t\t_matches = sources.$$searchCache.get( target );\r\n\t\t} else {\r\n\t\t\t_matches = match( sources, target ) || [];\r\n\t\t\tif ( _isObject( target ) ) {\r\n\t\t\t\tsources.$$searchCache.set( target, _matches );\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn matches.concat( _matches );\r\n\t}, [] );\r\n}\r\n\r\n/**\r\n * Determines the event for a mutation record\r\n * \r\n * @param MutationRecord \t{ target, entrants, exits }\r\n * \r\n * @returns Object\r\n */\r\nfunction withEventDetails( { target, addedNodes, removedNodes } ) {\r\n\tlet window = this, event;\r\n\tevent = _arrFrom( addedNodes ).reduce( ( prev, node ) => prev || window.wq.domInterceptionRecords?.get( node ), null );\r\n\tevent = _arrFrom( removedNodes ).reduce( ( prev, node ) => prev || window.wq.domInterceptionRecords?.get( node ), event );\r\n\tevent = event || window.document.readyState === 'loading' && 'parse' || 'mutation';\r\n\treturn { target, entrants: addedNodes, exits: removedNodes, type: 'observation', event };\r\n}\r\n\r\n/**\r\n * DOM intersection engine.\r\n * \r\n * @param String \t\t\ttiming \r\n * @param Function \t\t\tcallback \r\n * \r\n * @returns \r\n */\r\nfunction domInterception( timing, callback ) {\r\n\tconst window = this;\r\n\tconst { wq, document, Node, Element, HTMLElement, HTMLTemplateElement, DocumentFragment } = window;\r\n\tif ( !wq.domInterceptionHooks ) { wq.domInterceptionHooks = new Map; }\r\n\tif ( !wq.domInterceptionHooks.has( timing ) ) { wq.domInterceptionHooks.set( timing, new Set ); }\r\n\twq.domInterceptionHooks.get( timing ).add( callback );\r\n\tconst rm = () => wq.domInterceptionHooks.get( timing ).delete( callback );\r\n\tif ( wq.domInterceptionHooks?.intercepting ) return rm;\r\n\tconsole.warn( `DOM mutation APIs are now being intercepted.` );\r\n\twq.domInterceptionHooks.intercepting = true;\r\n\twq.domInterceptionRecords = new Map;\r\n\r\n\t// Interception hooks\r\n\tconst shouldObserve = () => true//document.readyState === 'loading' || wq.domInterceptionRecordsAlwaysOn;\r\n\tconst intercept = ( record, defaultAction ) => {\r\n\t\tif ( shouldObserve() ) {\r\n\t\t\trecord.entrants.concat( record.exits ).forEach( node => {\r\n\t\t\t\tclearTimeout( wq.domInterceptionRecords.get( node )?.timeout ); // Clear any previous that's still active\r\n\t\t\t\twq.domInterceptionRecords.set( node, record.event ); // Main: set event details... and next to timeout details\r\n\t\t\t\tconst timeout = setTimeout( () => { wq.domInterceptionRecords.delete( node ); }, 0 );\r\n\t\t\t\tObject.defineProperty( record.event, 'timeout', { value: timeout, configurable: true } );\r\n\t\t\t} );\r\n\t\t} else { wq.domInterceptionRecords.clear(); }\r\n\t\twq.domInterceptionHooks.get( 'intercept' )?.forEach( callback => callback( record ) );\r\n\t\tconst returnValue = defaultAction();\r\n\t\twq.domInterceptionHooks.get( 'sync' )?.forEach( callback => callback( record ) );\r\n\t\treturn returnValue;\r\n\t};\r\n\r\n\t// Interception observer WILL need to know non-API-based mutations\r\n\tif ( shouldObserve() ) {\r\n\t\tconst mo = new window.MutationObserver( records => records.forEach( record => {\r\n\t\t\tif ( Array.isArray( ( record = withEventDetails.call( window, record ) ).event ) ) return;\r\n\t\t\twq.domInterceptionHooks.get( 'intercept' )?.forEach( callback => callback( record ) );\r\n\t\t\twq.domInterceptionHooks.get( 'sync' )?.forEach( callback => callback( record ) );\r\n\t\t} ) );\r\n\t\tmo.observe( document, { childList: true, subtree: true, } );\r\n\t\tdocument.addEventListener( 'readystatechange', () => !shouldObserve() && mo.disconnect() );\r\n\t}\r\n\r\n\t// Intercept DOM mutation methods\r\n\tconst originalApis = Object.create( null );\r\n\t[ 'insertBefore'/*Node*/, 'insertAdjacentElement', 'insertAdjacentHTML', 'setHTML',\r\n\t\t'replaceChildren', 'replaceWith', 'remove', 'replaceChild'/*Node*/, 'removeChild'/*Node*/, \r\n\t\t'before', 'after', 'append', 'prepend', 'appendChild'/*Node*/, \r\n\t].forEach( apiName => {\r\n\t\t// We'll be sure to monkey the correct interface\r\n\t\tconst Interface = [ 'insertBefore', 'replaceChild', 'removeChild', 'appendChild' ].includes( apiName ) ? Node : Element;\r\n\t\toriginalApis[ apiName ] = Interface.prototype[ apiName ];\r\n\t\t// In case newer methods like setHTML() are not supported\r\n\t\tif ( !originalApis[ apiName ] ) return;\r\n\t\t// Monkey now...\r\n\t\tInterface.prototype[ apiName ] = function( ...args ) {\r\n\t\t\t// Instance of Node interface? Abort!\r\n\t\t\tconst exec = () => originalApis[ apiName ].call( this, ...args );\r\n\t\t\tif ( !( this instanceof Element || this instanceof DocumentFragment ) ) return exec();\r\n\t\t\t// --------------\r\n\t\t\t// Obtain exits and entrants\r\n\t\t\tlet exits = [], entrants = [], target = this;\r\n\t\t\tif ( [ 'insertBefore' ].includes( apiName ) ) {\r\n\t\t\t\tentrants = [ args[ 0 ] ];\r\n\t\t\t} else if ( [ 'insertAdjacentElement', 'insertAdjacentHTML' ].includes( apiName ) ) {\r\n\t\t\t\tentrants = [ args[ 1 ] ];\r\n\t\t\t\tif ( [ 'beforebegin', 'afterend' ].includes( args[ 0 ] ) ) {\r\n\t\t\t\t\ttarget = this.parentNode;\r\n\t\t\t\t}\r\n\t\t\t} else if ( [ 'setHTML', 'replaceChildren' ].includes( apiName ) ) {\r\n\t\t\t\texits = [ ...this.childNodes ];\r\n\t\t\t\tentrants = apiName === 'replaceChildren' ? [ ...args ] : [ args[ 0 ] ];\r\n\t\t\t} else if ( [ 'replaceWith', 'remove' ].includes( apiName ) ) {\r\n\t\t\t\texits = [ this ];\r\n\t\t\t\tentrants = apiName === 'replaceWith' ? [ ...args ] : [];\r\n\t\t\t\ttarget = this.parentNode;\r\n\t\t\t} else if ( [ 'replaceChild' ].includes( apiName ) ) {\r\n\t\t\t\texits = [ args[ 1 ] ];\r\n\t\t\t\tentrants = [ args[ 0 ] ];\r\n\t\t\t} else if ( [ 'removeChild' ].includes( apiName ) ) {\r\n\t\t\t\texits = [ ...args ];\r\n\t\t\t} else {\r\n\t\t\t\t// 'before', 'after', 'append', 'prepend', 'appendChild'\r\n\t\t\t\tentrants = [ ...args ];\r\n\t\t\t\tif ( [ 'before', 'after' ].includes( apiName ) ) {\r\n\t\t\t\t\ttarget = this.parentNode;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// --------------\r\n\t\t\t// Parse HTML to entrants\r\n\t\t\tlet apiNameFinal = apiName;\r\n\t\t\tif ( [ 'insertAdjacentHTML', 'setHTML' ].includes( apiName ) ) {\r\n\t\t\t\tlet tempNodeName = this.nodeName;\r\n\t\t\t\tif ( apiName === 'insertAdjacentHTML' && [ 'beforebegin', 'afterend' ].includes( args[ 0 ] ) ) {\r\n\t\t\t\t\t// We can't handle this... and this is going to throw afterall\r\n\t\t\t\t\tif ( !this.parentNode ) return originalApis[ apiName ].call( this, ...args );\r\n\t\t\t\t\ttempNodeName = this.parentNode.nodeName;\r\n\t\t\t\t}\r\n\t\t\t\tconst temp = document.createElement( tempNodeName );\r\n\t\t\t\toriginalApis.setHTML.call( temp, entrants[ 0 ], apiName === 'setHTML' ? args[ 1 ] : {} );\r\n\t\t\t\tentrants = [ ...temp.childNodes ];\r\n\t\t\t\t// --------------  \r\n\t\t\t\tif ( apiName === 'insertAdjacentHTML' ) {\r\n\t\t\t\t\tapiNameFinal = 'insertAdjacentElement';\r\n\t\t\t\t\targs[ 1 ] = new DocumentFragment;\r\n\t\t\t\t\targs[ 1 ].______isTemp = true;\r\n\t\t\t\t\targs[ 1 ].append( ...temp.childNodes );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tapiNameFinal = 'replaceChildren';\r\n\t\t\t\t\targs = [ ...temp.childNodes ];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// --------------\r\n\t\t\tconst record = { target, entrants, exits, type: 'interception', event: [ this, apiName ] };\r\n\t\t\treturn intercept( record, () => {\r\n\t\t\t\treturn originalApis[ apiNameFinal ].call( this, ...args );\r\n\t\t\t} );\r\n\t\t}\r\n\t} );\r\n\r\n\t// Intercept DOM mutation properties\r\n\t[ 'outerHTML', 'outerText'/*HTMLElement*/, 'innerHTML', \r\n\t\t'innerText'/*HTMLElement*/,'textContent'/*Node*/, 'nodeValue'/*Node*/\r\n\t].forEach( apiName => {\r\n\t\t// We'll be sure to monkey the correct interface\r\n\t\tconst Interface = [ 'textContent', 'nodeValue' ].includes( apiName ) ? Node : (\r\n\t\t\t[ 'outerText', 'innerText' ].includes( apiName ) ? HTMLElement : Element\r\n\t\t);\r\n\t\toriginalApis[ apiName ] = Object.getOwnPropertyDescriptor( Interface.prototype, apiName );\r\n\t\tObject.defineProperty( Interface.prototype, apiName, { ...originalApis[ apiName ], set: function( value ) {\r\n\t\t\tlet exec = () => originalApis[ apiName ].set.call( this, value );\r\n\t\t\t// Instance of Node interface? Abort!\r\n\t\t\tif ( !( this instanceof Element ) ) return exec();\r\n\t\t\t// --------------\r\n\t\t\t// Obtain exits and entrants\r\n\t\t\tlet exits = [], entrants = [], target = this;\r\n\t\t\tif ( [ 'outerHTML', 'outerText' ].includes( apiName ) ) {\r\n\t\t\t\texits = [ this ];\r\n\t\t\t\ttarget = this.parentNode;\r\n\t\t\t} else {\r\n\t\t\t\t// 'innerHTML', 'innerText', 'textContent', 'nodeValue'\r\n\t\t\t\texits = /*this instanceof HTMLTemplateElement \r\n\t\t\t\t\t? [ ...this.content.childNodes ]\r\n\t\t\t\t\t: */[ ...this.childNodes ];\r\n\t\t\t}\r\n\t\t\t// --------------\r\n\t\t\t// Parse HTML to nodes\r\n\t\t\tif ( [ 'outerHTML', 'innerHTML' ].includes( apiName ) ) {\r\n\t\t\t\tlet tempNodeName = this.nodeName;\r\n\t\t\t\tif ( apiName === 'outerHTML' ) {\r\n\t\t\t\t\t// We can't handle this... and this is going to throw afterall\r\n\t\t\t\t\tif ( !this.parentNode ) return exec();\r\n\t\t\t\t\ttempNodeName = this.parentNode.nodeName;\r\n\t\t\t\t}\r\n\t\t\t\tconst temp = document.createElement( tempNodeName === 'TEMPLATE' ? 'div' : tempNodeName );\r\n\t\t\t\toriginalApis[ apiName ].set.call( temp, value );\r\n\t\t\t\tentrants = /*[ ...temp.childNodes ];*/this instanceof HTMLTemplateElement ? [] : [ ...temp.childNodes ];\r\n\t\t\t\t// -------------- \r\n\t\t\t\tif ( apiName === 'outerHTML' ) {\r\n\t\t\t\t\tvalue = new DocumentFragment;\r\n\t\t\t\t\tvalue.______isTemp = true;\r\n\t\t\t\t\tvalue.append( ...temp.childNodes );\r\n\t\t\t\t\texec = () => originalApis.replaceWith.call( this, value );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif ( this instanceof HTMLTemplateElement ) {\r\n\t\t\t\t\t\texec = () => this.content.replaceChildren( ...temp.childNodes );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\texec = () => originalApis.replaceChildren.call( this, ...temp.childNodes );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// -------------- \r\n\t\t\tconst record = { target, entrants, exits, type: 'interception', event: [ this, apiName ] };\r\n\t\t\treturn intercept( record, exec );\r\n\t\t} } );\r\n\t} );\r\n\r\n\t// Intercept document mutation methods\r\n\t[ 'append', 'prepend', 'replaceChildren' ].forEach( apiName => {\r\n\t\t[ document, DocumentFragment.prototype ].forEach( target => {\r\n\t\t\tconst originalApi = target[ apiName ];\r\n\t\t\ttarget[ apiName ] = function( ...args ) {\r\n\t\t\t\tif ( this.______isTemp ) return originalApi.call( this, ...args );\r\n\t\t\t\tconst exits = apiName === 'replaceChildren' ? [ ...this.childNodes ] : [];\r\n\t\t\t\tconst record = {\r\n\t\t\t\t\ttarget: this,\r\n\t\t\t\t\tentrants: args,\r\n\t\t\t\t\texits,\r\n\t\t\t\t\ttype: 'interception', \r\n\t\t\t\t\tevent: [ this, apiName ]\r\n\t\t\t\t};\r\n\t\t\t\treturn intercept( record, () => {\r\n\t\t\t\t\treturn originalApi.call( this, ...args );\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\t\t} );\r\n\t} );\r\n\r\n\treturn rm;\r\n}\r\n", "\r\n/**\r\n * Applies all supported polyfills\r\n */\r\nexport default function() {\r\n    CSS_escape.call( this );\r\n    Node_isConnected.call( this );\r\n    Element_matches.call( this );\r\n}\r\n\r\n/**\r\n * Polyfills the window.CSS object.\r\n *  \r\n * @return void\r\n */\r\nexport function CSS_escape() {\r\n    const window = this;\r\n    if ( !window.CSS ) { window.CSS = {} }\r\n    if ( !window.CSS.escape ) {\r\n        /**\r\n         * Polyfills the window.CSS.escape() function.\r\n         *  \r\n         * @param string str \r\n         * \r\n         * @return string\r\n         */\r\n        window.CSS.escape = str => str.replace( /([\\:@\\~\\$\\&])/g, '\\\\$1' );\r\n    }\r\n}\r\n\r\n/**\r\n * Polyfills the Node.prototype.isConnected property\r\n * \r\n * @see MDN\r\n  *  \r\n * @return bool\r\n*/\r\nexport function Node_isConnected() {\r\n    const window = this;\r\n    if ( !( 'isConnected' in window.Node.prototype ) ) {\r\n        Object.defineProperty( window.Node.prototype, 'isConnected', { get: function() {\r\n            return !this.ownerDocument || !(\r\n                this.ownerDocument.compareDocumentPosition( this )\r\n                & this.DOCUMENT_POSITION_DISCONNECTED);\r\n        } } );\r\n    }\r\n}\r\n\r\n/**\r\n * Polyfills the Element.prototype.matches() method\r\n * \r\n * @see MDN\r\n  *  \r\n * @return void\r\n*/\r\nexport function Element_matches() {\r\n    const window = this;\r\n    if ( !window.Element.prototype.matches ) {\r\n        window.Element.prototype.matches = \r\n        window.Element.prototype.matchesSelector || \r\n        window.Element.prototype.mozMatchesSelector ||\r\n        window.Element.prototype.msMatchesSelector || \r\n        window.Element.prototype.oMatchesSelector || \r\n        window.Element.prototype.webkitMatchesSelector ||\r\n        function( s ) {\r\n            var matches = ( this.document || this.ownerDocument ).querySelectorAll( s ),\r\n                i = matches.length;\r\n            while ( --i >= 0 && matches.item( i ) !== this ) {}\r\n            return i > -1;            \r\n        }\r\n    }\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport { _isNumeric } from '@webqit/util/js/index.js';\r\nimport { _set, _get, _merge } from '@webqit/util/obj/index.js';\r\nimport _Reflow from './_Reflow.js';\r\nimport DOMRealtime from './realtime/DOMRealtime.js';\r\nimport AttrRealtime from './realtime/AttrRealtime.js';\r\nimport polyfill from './polyfills.js';\r\n\r\nexport default function() {\r\n    const window = this;\r\n    if ( !window.wq ) window.wq = {};\r\n    if ( window.wq.dom ) return window.wq.dom;\r\n    window.wq.dom = {};\r\n    polyfill.call( window );\r\n    // ------\r\n    const Reflow = _Reflow( window );\r\n    window.wq.dom.Reflow = new Reflow;\r\n    // ------\r\n    window.wq.dom.DOMRealtime = DOMRealtime;\r\n    window.wq.dom.AttrRealtime = AttrRealtime;\r\n    window.wq.dom.realtime = ( context, namespace = 'tree' ) => {\r\n        if ( namespace === 'tree' ) return new DOMRealtime( context, window );\r\n        if ( namespace === 'attr' ) return new AttrRealtime( context, window );\r\n    };\r\n    // ------\r\n    window.wq.dom.ready = ready.bind( window );\r\n    window.wq.dom.meta = meta.bind( window );\r\n    // ------\r\n    return window.wq.dom;\r\n}\r\n\r\n\r\n/**\r\n * DOM-ready listeners.\r\n * \r\n * @param Function\t    \t\tcallback\r\n * \r\n * @return void\r\n */\r\nfunction ready( callback ) {\r\n\tconst window = this;\r\n\tif ( window.document.readyState === 'complete' ) {\r\n\t\tcallback( window );\r\n\t} else {\r\n\t\tif ( !window.document.domReadyCallbacks ) {\r\n\t\t\twindow.document.domReadyCallbacks = [];\r\n\t\t\twindow.document.addEventListener( 'DOMContentLoaded', () => {\r\n\t\t\t\twindow.document.domReadyCallbacks.splice( 0 ).forEach( cb => cb( window ) );\r\n\t\t\t}, false );\r\n\t\t}\r\n\t\twindow.document.domReadyCallbacks.push( callback );\r\n\t}\r\n}\r\n\r\n/**\r\n * A wq's meta tag props reader.\r\n *  \r\n * @param String name\r\n * @param Bool\t readWrite\r\n * \r\n * @return Object\r\n */\r\nfunction meta( name, readWrite = false ) {\r\n    const window = this;\r\n    const metaInstance = { content: {} };\r\n    // Initialize reader\r\n    if ( !(metaInstance.el = window.document.querySelector( `meta[name=\"${ name }\"]` ) ) && readWrite ) {\r\n        metaInstance.el = window.document.createElement( 'meta' );\r\n        metaInstance.el.setAttribute( 'name', name );\r\n        window.document.head.append( metaInstance.el );\r\n    }\r\n    if ( metaInstance.el ) {\r\n        metaInstance.content = ( metaInstance.el.getAttribute( 'content' ) || '' ).split( ';' ).filter( v => v ).reduce( ( _metaVars, directive ) => {\r\n            const directiveSplit = directive.split( '=' ).map( d => d.trim() );\r\n            _set( _metaVars, directiveSplit[ 0 ].split( '.' ), directiveSplit[ 1 ] === 'true' \r\n                ? true : (directiveSplit[ 1 ] === 'false' ? false : (\r\n                    _isNumeric( directiveSplit[ 1 ] ) ? parseInt( directiveSplit[ 1 ] ) : directiveSplit[ 1 ]\r\n                ) )\r\n            );\r\n            return _metaVars;\r\n        }, {} );\r\n    }\r\n    // Read prop...\r\n    metaInstance.get = function( prop ) { return JSON.parse( JSON.stringify( _get( this.content, prop.split( '.' ) ) ) ); }\r\n    // Copy...\r\n    metaInstance.copy = function() {\r\n\t\treturn JSON.parse( JSON.stringify( this.content ) );\r\n    };\r\n\t// Copy with defaults...\r\n    metaInstance.copyWithDefaults = function( ...defaults ) {\r\n\t\tif ( defaults.length ) return _merge( true, {}, ...defaults.reverse().concat( this.content ) );\r\n\t\treturn this.copy();\r\n    };\r\n    return metaInstance;\r\n}", "\r\n/**\r\n * Tells if val is of type \"array\".\r\n *\r\n * @param object\t \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn Array.isArray(val);\r\n};\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport _isArray from '../js/isArray.js';\r\n\r\n/**\r\n * Returns the intersection of two arrays;\r\n * optionally using a custom matching function.\r\n *\r\n * @param array \tarr\r\n * @param array\t \tarr2\r\n * @param function \tcallback\r\n *\r\n * @return array\r\n */\r\nexport default function(arr, arr2, callback = null) {\r\n\treturn !_isArray(arr2) ? [] : arr.filter(val1 => callback \r\n\t\t? arr2.filter(val2 => callback(val1, val2)).length \r\n\t\t: arr2.indexOf(val1) !== -1\r\n\t);\r\n};\r\n", "/**\r\n * @imports\r\n */\r\nimport _intersect from '../arr/intersect.js';\r\n\r\n/**\r\n * Creates and/or returns an \"internals\" object for the given object.\r\n * \r\n * @param Any obj\r\n * @param String namespace\r\n * \r\n * @return Object\r\n */\r\nexport default function internals(obj, ...namespaces) {\r\n    if (!globalThis.WebQitInternalsRegistry) {\r\n        globalThis.WebQitInternalsRegistry = new ObservableMap;\r\n    }\r\n    var itnls = globalThis.WebQitInternalsRegistry.get(obj);\r\n    if (!itnls) {\r\n        itnls = new ObservableMap;\r\n        globalThis.WebQitInternalsRegistry.set(obj, itnls);\r\n    }\r\n    var _ns, _itnls;\r\n    while ((_ns = namespaces.shift())) {\r\n        if ((_itnls = itnls) && !(itnls = itnls.get(_ns))) {\r\n            itnls = new ObservableMap;\r\n            _itnls.set(_ns, itnls);\r\n        }\r\n    }\r\n    return itnls;\r\n}\r\n\r\nclass ObservableMap extends Map {\r\n    constructor( ...args ) {\r\n        super( ...args );\r\n        this.observers = new Set;\r\n    }\r\n    set( key, value ) {\r\n        let returnValue = super.set( key, value );\r\n        this.fire( 'set', key, value, key );\r\n        return returnValue;\r\n    }\r\n    delete( key ) {\r\n        let returnValue = super.delete( key );\r\n        this.fire( 'delete', key );\r\n        return returnValue;\r\n    }\r\n    has( key ) {\r\n        this.fire( 'has', key );\r\n        return super.has( key );\r\n    }\r\n    get( key ) {\r\n        this.fire( 'get', key );\r\n        return super.get( key );\r\n    }\r\n    keyNames() { return Array.from( super.keys() ); }\r\n    observe( type, key, callback ) {\r\n        const entry = { type, key, callback };\r\n        this.observers.add( entry );\r\n        return () => this.observers.delete( entry );\r\n    }\r\n    unobserve( type, key, callback ) {\r\n        if ( Array.isArray( type ) || Array.isArray( key ) ) {\r\n            throw new Error( `The \"type\" and \"key\" arguments can only be strings.` );\r\n        }\r\n        for ( let entry of this.observers ) {\r\n            if ( !( _intersection( [ type, '*' ], entry.type ) && _intersection( [ key, '*' ], entry.key ) && entry.callback === callback ) ) continue;\r\n            this.observers.delete( entry );\r\n        }\r\n    }\r\n    fire( type, key, ...args ) {\r\n        // IMPORTANT: Array.from() must be used so that new additions to this.observers\r\n        // during the loop aren't picked up!\r\n        for ( let entry of this.observers ) {\r\n            if ( !( _intersection( [ type, '*' ], entry.type ) && _intersection( [ key, '*' ], entry.key ) ) ) continue;\r\n            entry.callback( ...args );\r\n        }\r\n    }\r\n}\r\n\r\nconst _intersection = ( a, b ) => {\r\n    if ( Array.isArray( b ) ) return _intersect( a, b ).length;\r\n    return a.includes( b );\r\n}\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport { _internals } from '@webqit/util/js/index.js';\r\n\r\nexport const _ = ( node, ...args ) => _internals( node, 'oohtml', ...args );\r\n\r\nexport  const _compare = ( a, b, depth = 1, objectSizing = false ) => {\r\n    if ( depth && typeof a === 'object' && a && typeof b === 'object' && b && ( !objectSizing || Object.keys( a ).length === Object.keys( b ).length ) ) {\r\n        for ( let key in a ) {\r\n            if ( !_compare( a[ key ], b[ key ], depth - 1, objectSizing ) ) return false;\r\n        }\r\n        return true;\r\n    }\r\n    if ( Array.isArray( a ) && Array.isArray( b ) && a.length === b.length ) {\r\n        return ( b = b.slice( 0 ).sort() ) && a.slice( 0 ).sort().every( ( valueA, i ) => valueA === b[ i ] );\r\n    }\r\n    return a === b;\r\n};", "\r\n/**\r\n * @imports\r\n */\r\nimport wqDom from '@webqit/dom';\r\nimport Observer from '@webqit/observer';\r\nimport { _ } from '../util.js';\r\n\r\n/**\r\n * @init\r\n * \r\n * @param Object $params\r\n */\r\nexport default function init( $params = {} ) {\r\n\tconst window = this, dom = wqDom.call( window );\r\n    const params = dom.meta( 'oohtml' ).copyWithDefaults( $params, {\r\n        api: { state: 'state', },\r\n    } );\r\n    exposeAPIs.call( this, params );\r\n}\r\n\r\n/**\r\n * @Exports\r\n * \r\n * The internal state object\r\n * within elements and the document object.\r\n */\r\nfunction getStateObject( node ) {\r\n\tif ( !_( node ).has( 'state' ) ) {\r\n\t\tconst stateObj = Object.create( null );\r\n\t\t_( node ).set( 'state', stateObj );\r\n\t}\r\n\treturn _( node ).get( 'state' );\r\n}\r\n\r\n/**\r\n * Exposes State with native APIs.\r\n *\r\n * @param Object params\r\n *\r\n * @return Void\r\n */\r\nfunction exposeAPIs( params ) {\r\n\tconst window = this;\r\n    // Assertions\r\n    if ( params.api.state in window.document ) { throw new Error( `document already has a \"${ params.api.state }\" property!` ); }\r\n    if ( params.api.state in window.Element.prototype ) { throw new Error( `The \"Element\" class already has a \"${ params.api.state }\" property!` ); }\r\n    // Definitions\r\n    Object.defineProperty( window.document, params.api.state, { get: function() {\r\n        return Observer.proxy( getStateObject( window.document ) );\r\n    } });\r\n    Object.defineProperty( window.Element.prototype, params.api.state, { get: function() {\r\n        return Observer.proxy( getStateObject( this ) );\r\n    } } );\r\n}", "\r\nexport default function() {\r\n    const window = this;\r\n    return class ContextRequestEvent extends window.Event {\r\n\r\n        /**\r\n         * @constructor\r\n         */\r\n        constructor( request, callback, { type = 'contextrequest', ...params } = {} ) {\r\n            super( type, params );\r\n            Object.defineProperty( this, 'request', { get: () => request } );\r\n            Object.defineProperty( this, 'callback', { get: () => callback } );\r\n        }\r\n\r\n        /**\r\n         * @respondWith\r\n         */\r\n        respondWith( response, ...rest ) {\r\n            if ( this.request.diff ) {\r\n                if ( 'previousValue' in this && this.previousValue === response ) return;\r\n                this.previousValue = response;\r\n            }\r\n            return this.callback( response, ...rest );\r\n        }\r\n    };\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport _ContextRequestEvent from './_ContextRequestEvent.js';\r\nimport { _ } from '../util.js';\r\n\r\nexport default class HTMLContextManager {\r\n\r\n    /**\r\n     * @instance\r\n     */\r\n    static instance( host ) {\r\n        return _( host ).get( 'contextsmanager::instance' ) || new this( host );;\r\n    }\r\n\r\n    /**\r\n     * @constructor\r\n     */\r\n    constructor( host ) {\r\n        _( host ).get( `contextsmanager::instance` )?.dispose();\r\n        _( host ).set( `contextsmanager::instance`, this );\r\n        const priv = { host, contexts: new Set };\r\n        Object.defineProperty( this, '#', { get: () => priv } );\r\n        const ContextRequestEvent = _ContextRequestEvent.call( host.ownerDocument?.defaultView || host.defaultView );\r\n        Object.defineProperty( this, 'ContextRequestEvent', { get: () => ContextRequestEvent } );\r\n        this[ Symbol.iterator ] = function*() {\r\n            const it = priv.contexts[ Symbol.iterator ]();\r\n            yield it.next().value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @length()\r\n     */\r\n    get length() {\r\n        this[ '#' ].contexts.size;\r\n    }\r\n\r\n    /**\r\n     * @find()\r\n     */\r\n    find( callback ) {\r\n        return [ ...this[ '#' ].contexts ].find( callback );\r\n    }\r\n\r\n    /**\r\n     * @attach()\r\n     */\r\n    attach( context ) {\r\n        this[ '#' ].contexts.add( context );\r\n        context.initialize( this[ '#' ].host );\r\n    }\r\n\r\n    /**\r\n     * @detach()\r\n     */\r\n    detach( context ) {\r\n        context.dispose( this[ '#' ].host );\r\n        this[ '#' ].contexts.delete( context );\r\n    }\r\n\r\n    /**\r\n     * @ask()\r\n     */\r\n    ask( request, callback, params = {} ) {\r\n        return this[ '#' ].host.dispatchEvent(\r\n            new this.ContextRequestEvent( request, callback, { bubbles: true, ...params } )\r\n        );\r\n    }\r\n\r\n    /**\r\n     * @dispose()\r\n     */\r\n    dispose() {}\r\n\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport { _compare } from '../util.js';\r\nimport HTMLContextManager from './HTMLContextManager.js';\r\n\r\nexport default class HTMLContext {\r\n\r\n    /**\r\n     * @params\r\n     */\r\n    static get params() {\r\n        return {};\r\n    }\r\n\r\n    /**\r\n     * @attachTo\r\n     */\r\n    static attachTo( host, Id, multiple = false ) {\r\n        let instance, contextMgr = HTMLContextManager.instance( host );\r\n        if ( !multiple && ( instance = contextMgr.find( cx => this.matchRequest( cx.id, Id, true ) ) ) ) return instance;\r\n        return contextMgr.attach( new this( Id ) );\r\n    }\r\n\r\n    /**\r\n     * @detachFrom\r\n     */\r\n    static detachFrom( host, Id, multiple = false ) {\r\n        let instance, contextMgr = HTMLContextManager.instance( host );\r\n        for ( instance of contextMgr[ '#' ].contexts ) {\r\n            if ( !this.matchRequest( instance.id, Id, true ) || ( typeof multiple === 'function' && !multiple( instance ) ) ) continue;\r\n            contextMgr.detach( instance );\r\n            if ( typeof multiple !== 'function' && !multiple ) return instance;\r\n        }\r\n    }\r\n \r\n    /**\r\n     * @createId\r\n     */\r\n    static createId( host, fields = {} ) {\r\n        const id = { type: 'HTMLModules', ...fields };\r\n        if ( id.name ) return id;\r\n        if ( host.getAttribute && !( id.name = ( host.getAttribute( this.params.context.attr.contextname ) || '' ).trim() ) ) {\r\n            delete id.name;\r\n        } else if ( !host.ownerDocument ) {\r\n            id.name = 'root';\r\n        }\r\n        return id;\r\n    }\r\n \r\n    /**\r\n     * @createRequest\r\n     */\r\n    static createRequest( fields = {} ) {\r\n        return { ...fields };\r\n    }\r\n\r\n    /**\r\n     * @matchesRequest\r\n     */\r\n    static matchRequest( id, request, strict = false ) {\r\n        if ( strict ) return _compare( id, request, 1, true );\r\n        return request.type === id.type && !request.name || request.name === id.name;\r\n    }\r\n\r\n    /**\r\n     * @constructor\r\n     */\r\n    constructor( id ) {\r\n        Object.defineProperty( this, 'id', { get: () => id } );\r\n        Object.defineProperty( this, 'subscriptions', { value: new Set } );\r\n    }\r\n\r\n    /**\r\n     * @length()\r\n     */\r\n    get length() {\r\n        this.subscriptions.size;\r\n    }\r\n\r\n    /**\r\n     * @handle()\r\n     */\r\n    handle( event ) {}\r\n\r\n    /**\r\n     * @subscribe()\r\n     */\r\n    subscribe( event ) {\r\n        this.subscriptions.add( event );\r\n        if ( !event.request.signal ) return;\r\n        event.request.signal.addEventListener( 'abort', () => {\r\n            this.unsubscribe( event );\r\n        } );\r\n    }\r\n\r\n    /**\r\n     * @unsubscribe()\r\n     */\r\n    unsubscribe( event ) {\r\n        this.subscriptions.delete( event );\r\n        event.request.controller?.abort();\r\n    }\r\n\r\n    /**\r\n     * @handleEvent()\r\n     */\r\n    handleEvent( event ) {\r\n        if ( this.disposed || ( event.target === this.host && !event.request?.selfScoped )\r\n        || !event.request || typeof event.callback !== 'function' || !this.constructor.matchRequest( this.id, event.request ) ) return;\r\n        event.stopPropagation();\r\n        if ( event.type === 'contextclaim' ) {\r\n            const claims = new Set;\r\n            this.subscriptions.forEach( subscriptionEvent => {\r\n                if ( !event.target.contains( subscriptionEvent.request.selfScoped ? subscriptionEvent.target : subscriptionEvent.target.parentNode ) \r\n                || !this.constructor.matchRequest( event.request/*provider ID*/, subscriptionEvent.request/*request ID*/ ) ) return;\r\n                this.subscriptions.delete( subscriptionEvent );\r\n                claims.add( subscriptionEvent );\r\n            } );\r\n            event.respondWith( claims );\r\n        } else if ( event.type === 'contextrequest' ) {\r\n            if ( event.request.live ) { this.subscribe( event ); }\r\n            this.handle( event );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @initialize()\r\n     */\r\n    initialize( host ) {\r\n        this.host = host;\r\n        this.disposed = false;\r\n        host.addEventListener( 'contextrequest', this );\r\n        host.addEventListener( 'contextclaim', this );\r\n        HTMLContextManager.instance( host ).ask( this.id, claims => claims.forEach( subscriptionEvent => {\r\n            this.subscribe( subscriptionEvent );\r\n            this.handle( subscriptionEvent );\r\n        } ), { type: 'contextclaim' } );\r\n        return this;\r\n    }\r\n     \r\n    /**\r\n     * @dispose()\r\n     */\r\n    dispose( host ) {\r\n        this.disposed = true;\r\n        host.removeEventListener( 'contextrequest', this );\r\n        host.removeEventListener( 'contextclaim', this );\r\n        this.subscriptions.forEach( subscriptionEvent => {\r\n            this.unsubscribe( subscriptionEvent );\r\n            const { target, request, callback, params } = subscriptionEvent;\r\n            HTMLContextManager.instance( target ).ask( request, callback, params );\r\n        } );\r\n        return this;\r\n    }\r\n\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport wqDom from '@webqit/dom';\r\nimport HTMLContextManager from './HTMLContextManager.js';\r\nimport HTMLContext from './HTMLContext.js';\r\n\r\n/**\r\n * Initializes HTML Modules.\r\n * \r\n * @param $params  Object\r\n *\r\n * @return Void\r\n */\r\nexport default function init( $params = { }) {\r\n    const window = this, dom = wqDom.call( window );\r\n    // -------\r\n    const params = dom.meta( 'oohtml' ).copyWithDefaults( $params, {\r\n        api: { context: 'context', },\r\n    } );\r\n    // -------\r\n    exposeModulesObjects.call( this, params );\r\n}\r\n\r\n/**\r\n * Exposes HTML Modules with native APIs.\r\n *\r\n * @param Object                    params\r\n *\r\n * @return Void\r\n */\r\nfunction exposeModulesObjects( params ) {\r\n    const window = this;\r\n    // Assertions\r\n    if ( params.api.context in window.document ) { throw new Error( `document already has a \"${ params.api.context }\" property!` ); }\r\n    if ( params.api.context in window.HTMLElement.prototype ) { throw new Error( `The \"HTMLElement\" class already has a \"${ params.api.context }\" property!` ); }\r\n    // Definitions\r\n    Object.defineProperty( window.document, params.api.context, { get: function() {\r\n        return HTMLContextManager.instance( window.document );\r\n    } } );\r\n    Object.defineProperty( window.HTMLElement.prototype, params.api.context, { get: function() {\r\n        return HTMLContextManager.instance( this );\r\n    } } );\r\n}\r\n\r\n/**\r\n * @exports\r\n */\r\nexport {\r\n    HTMLContextManager,\r\n    HTMLContext,\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport Observer from '@webqit/observer';\r\nimport { HTMLContextManager, HTMLContext } from '../context-api/index.js';\r\nimport { getModulesObject } from './index.js';\r\nimport { _ } from '../util.js';\r\n\r\nexport default class _HTMLImportsContext extends HTMLContext {\r\n \r\n    /**\r\n     * @createRequest\r\n     */\r\n    static createRequest( fields = {} ) {\r\n        const request = { type: 'HTMLModules', ...fields };\r\n        if ( !request.name && request.detail?.startsWith( '/' ) ) { request.name = 'root'; }\r\n        else if ( request.detail?.startsWith( '@' ) ) {\r\n            const [ contextName, detail ] = request.detail.split( ':' ).map( s => s.trim() );\r\n            request.name = contextName.slice( 1 );\r\n            request.detail = detail;\r\n        }\r\n        return request;\r\n    }\r\n\r\n    /**\r\n     * @modules\r\n     */\r\n    get modules() {\r\n        return getModulesObject( this.host );\r\n    }\r\n\r\n    /**\r\n     * @handle()\r\n     */\r\n    handle( event ) {\r\n        // Any existing event.request.controller? Abort!\r\n        event.request.controller?.abort();\r\n\r\n        // Parse and translate detail\r\n        if ( ( event.request.detail || '' ).trim() === '/' ) return event.respondWith( this.modules );\r\n        const $params = this.constructor.params;\r\n        let path = ( event.request.detail || '' ).split( /\\/|(?<=\\w)(?=\\W)/g ).map( x => x.trim() ).filter( x => x );\r\n        if ( path.length ) { path = path.join( `/${ $params.template.api.modules }/` )?.split( '/' ) || []; }\r\n        // No detail?\r\n        if ( !path.length ) return event.respondWith();\r\n\r\n        // We'll now fulfill request\r\n        const params = { live: event.request.live, descripted: true, midwayResults: true };\r\n        // Find a way to resolve request against two sources\r\n        event.request.controller = Observer.deep( this.modules, path, Observer.get, ( result, { signal } = {} ) => {\r\n            if ( !result.value && this.host.isConnected === false ) return; // Subtree is being disposed\r\n            if ( result.value || !this.altModules ) return event.respondWith( result.value );\r\n            // This superModules binding is automatically aborted by the injected control.signal; see below\r\n            return Observer.deep( this.altModules, path, Observer.get, result => {\r\n                return event.respondWith( result.value );\r\n            }, { signal, ...params } );\r\n        }, params );\r\n    }\r\n\r\n    /**\r\n     * @startRealtime()\r\n     */\r\n    realtimeSources( host ) {\r\n        this.host = host;\r\n        // ----------------\r\n        const update = () => {\r\n            for ( const subscriptionEvent of this.subscriptions ) {\r\n                this.handle( subscriptionEvent );\r\n            }\r\n        };\r\n        // ----------------\r\n        const $params = this.constructor.params;\r\n        if ( !this.host.matches || !$params.context.attr.importscontext ) return;\r\n        // Any existing this.refdSourceController? Abort!\r\n        this.refdSourceController?.disconnect();\r\n        const dom = this.host.ownerDocument.defaultView.wq.dom;\r\n        this.refdSourceController = dom.realtime( this.host ).attr( $params.context.attr.importscontext, ( record, { signal } ) => {\r\n            // No importscontext attr set. But we're still watching\r\n            if ( !record.value ) {\r\n                this.altModules = undefined;\r\n                return update();\r\n            }\r\n            // This superModules contextrequest is automatically aborted by the injected signal below\r\n            const request = this.constructor.createRequest( { detail: record.value.trim(), live: true, signal } );\r\n            HTMLContextManager.instance( this.host ).ask( request, response => {\r\n                this.altModules = !( response && Object.getPrototypeOf( response ) ) ? response : getModulesObject( response );\r\n                update();\r\n            } );\r\n        }, { live: true, timing: 'sync', lifecycleSignals: true } );\r\n    }\r\n\r\n    /**\r\n     * @initialize()\r\n     */\r\n    initialize( host ) {\r\n        // If host has importscontext attr, compute that\r\n        this.realtimeSources( host );\r\n        // Now, listen for contextrequest and contextclaim events\r\n        // And process own claim\r\n        return super.initialize( host );\r\n    }\r\n    \r\n    /**\r\n     * @dispose()\r\n     */\r\n    dispose( host ) {\r\n        // Stop listening for sources\r\n        this.refdSourceController?.disconnect();\r\n        // Now, stop listening for contextrequest and contextclaim events\r\n        // And relinquish own subscribers to owner context\r\n        return super.dispose( host );\r\n    }\r\n}\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport Observer from '@webqit/observer';\r\nimport { getModulesObject } from './index.js';\r\nimport { _ } from '../util.js';\r\n\r\nexport default class HTMLExportsManager {\r\n\r\n    /**\r\n     * @instance\r\n     */\r\n    static instance( host, params ) {\r\n        return _( host ).get( 'exportsmanager::instance' ) || new this( host, params );;\r\n    }\r\n\r\n    /**\r\n     * @constructor\r\n     */\r\n    constructor( host, params, parent = null, level = 0 ) {\r\n        _( host ).get( `exportsmanager::instance` )?.dispose();\r\n        _( host ).set( `exportsmanager::instance`, this );\r\n        this.host = host;\r\n        this.params = params;\r\n        this.parent = parent;\r\n        this.level = level;\r\n        this.modules = getModulesObject( this.host );\r\n        this.exportId = ( this.host.getAttribute( this.params.template.attr.exportid ) || '' ).trim();\r\n        this.validateExportId( this.exportId );\r\n        const dom = params.window.wq.dom;\r\n        // ----------\r\n        this.realtimeA = dom.realtime( this.host.content ).children( record => {\r\n            this.export( record.entrants, true );\r\n            this.export( record.exits, false );\r\n        }, { live: true, timing: 'sync' } );\r\n        // ----------\r\n        this.realtimeB = dom.realtime( this.host ).attr( [ 'src', 'loading' ], ( ...args ) => this.evaluateLoading( ...args ), {\r\n            live: true,\r\n            atomic: true,\r\n            timing: 'sync',\r\n            lifecycleSignals: true\r\n        } );\r\n        // ----------\r\n        this.realtimeC = this.evalInheritance();\r\n        // ----------\r\n    }\r\n\r\n    /**\r\n     * Validates export ID.\r\n     * \r\n     * @param String     exportId\r\n     *\r\n     * @returns Void\r\n     */\r\n    validateExportId( exportId ) {\r\n        if ( [ '@', '#', ':' ].some( token => exportId.includes( token ) ) ) {\r\n            throw new Error( `The export ID \"${ exportId }\" contains an invalid character.` );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Maps module contents as exports.\r\n     * \r\n     * @param Array     entries\r\n     * @param Bool      isConnected\r\n     *\r\n     * @returns Void\r\n     */\r\n    export( entries, isConnected ) {\r\n        const fragmentsExports = new Map;\r\n        entries.forEach( entry => {\r\n            if ( entry.nodeType !== 1 ) return;\r\n            if ( entry.matches( this.params.templateSelector ) ) {\r\n                if ( isConnected ) {\r\n                    const moduleExport = new HTMLExportsManager( entry, this.params, this.host, this.level + 1 );\r\n                    if ( moduleExport.exportId ) { Observer.set( this.modules, moduleExport.exportId, entry ); }\r\n                } else {\r\n                    const moduleExport = HTMLModulesGraph.instance( entry, this.params );\r\n                    if ( moduleExport.exportId ) { Observer.deleteProperty( this.modules, moduleExport.exportId ); }\r\n                    moduleExport.dispose();\r\n                }\r\n            } else {\r\n                const exportId = ( entry.getAttribute( this.params.export.attr.exportid ) || '' ).trim() || 'default';\r\n                this.validateExportId( exportId );\r\n                if ( !fragmentsExports.has( exportId ) ) { fragmentsExports.set( exportId, [] ); }\r\n                fragmentsExports.get( exportId ).push( entry );\r\n            }\r\n        } );\r\n        // ----------------\r\n        fragmentsExports.forEach( ( fragments, exportId ) => {\r\n            let existingFragments = Observer.get( this.modules, `#${ exportId }` );\r\n            if ( isConnected ) {\r\n                existingFragments = new Set( ( existingFragments ? [ ...existingFragments ] : [] ).concat( fragments ) );\r\n            } else if ( existingFragments ) {\r\n                fragments.forEach( el => existingFragments.delete( el ) );\r\n            }\r\n            if ( !isConnected && !existingFragments.size ) { Observer.deleteProperty( this.modules, `#${ exportId }` ); }\r\n            else { Observer.set( this.modules, `#${ exportId }`, existingFragments ) }\r\n        } );\r\n    }\r\n\r\n    /**\r\n     * Evaluates remote content loading.\r\n     *\r\n     * @param AbortSignal   signal\r\n     * \r\n     * @returns Void\r\n     */\r\n    evaluateLoading( [ record1, record2 ], { signal } ) {\r\n        const src = ( record1.value || '' ).trim();\r\n        if ( !src ) return;\r\n        const loading = ( record2.value || '' ).trim();\r\n        if ( loading === 'lazy' ) {\r\n            const interception = Observer.intercept( this.modules, 'get', async ( descriptor, recieved, next ) => {\r\n                await this.load( src, true );\r\n                interception.remove();\r\n                return next();\r\n            }, { signal } );\r\n        } else { this.load( src ); }\r\n    }\r\n    \r\n    /**\r\n     * Fetches a module's \"src\".\r\n     *\r\n     * @param String src\r\n     *\r\n     * @return Promise\r\n     */\r\n    load( src ) {\r\n        const window = this.params.window;\r\n        if ( this.host.content.children.length ) return;\r\n        // Ongoing request?\r\n        if ( this.fetchInFlight?.src === src ) return this.fetchInFlight.request;\r\n        this.fetchInFlight?.controller.abort();\r\n        // The promise\r\n        const controller = new AbortController();\r\n        const fire = ( type, detail ) => this.host.dispatchEvent( new window.CustomEvent( type, { detail } ) );\r\n        const request = window.fetch( src, { signal: controller.signal } ).then( response => {\r\n            return response.ok ? response.text() : Promise.reject( response.statusText );\r\n        }).then( content => {\r\n            this.host.innerHTML = content.trim(); // IMPORTANT: .trim()\r\n            fire( 'load' );\r\n            return this.host;\r\n        } ).catch( e => {\r\n            console.error( `Error fetching the bundle at \"${ src }\": ${ e.message }` );\r\n            this.fetchInFlight = null;\r\n            fire( 'loaderror' );\r\n            return this.host;\r\n        } );\r\n        this.fetchInFlight = { src, request, controller };\r\n        return request;\r\n    }\r\n\r\n    /**\r\n     * Evaluates module inheritance.\r\n     *\r\n     * @returns Void|AbortController\r\n     */\r\n    evalInheritance( ) {\r\n        let inheritedIds;\r\n        if ( this.parent && ( inheritedIds = ( this.host.getAttribute( this.params.template.attr.inherits ) || '' ).trim() ) \r\n        && ( inheritedIds = inheritedIds.split( ' ' ).map( id => id.trim() ) ).length ) {\r\n            const parentExportsObj = getModulesObject( this.parent );\r\n            return Observer.get( parentExportsObj, inheritedIds, records => {\r\n                records.forEach( record => {\r\n                    if ( [ 'get'/*initial get*/, 'set', 'defineProperty' ].includes( record.type ) ) {\r\n                        Observer[ record.type.replace( 'get', 'set' ) ]( this.modules, record.key, record.value );\r\n                    } else if ( record.type === 'deleteProperty' ) {\r\n                        Observer.deleteProperty( this.modules, record.key );\r\n                    }\r\n                } );\r\n            }, { live: true } );\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Disposes the instance and its processes.\r\n     *\r\n     * @returns Void\r\n     */\r\n    dispose() {\r\n        this.realtimeA.disconnect();\r\n        this.realtimeB.disconnect();\r\n        this.realtimeC?.abort();\r\n        Object.entries( this.modules ).forEach( ( [ key, entry ] ) => {\r\n            if ( key.startsWith( '#' ) ) return;\r\n            HTMLExportsManager.instance( entry ).dispose();\r\n        } );\r\n    }\r\n}\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport wqDom from '@webqit/dom';\r\nimport Observer from '@webqit/observer';\r\nimport _HTMLImportsContext from './_HTMLImportsContext.js';\r\nimport HTMLExportsManager from './HTMLExportsManager.js';\r\nimport { _ } from '../util.js';\r\n\r\n/**\r\n * Initializes HTML Modules.\r\n * \r\n * @param Object        $params \r\n *\r\n * @return Void\r\n */\r\nexport default function init( $params = {} ) {\r\n    const window = this, dom = wqDom.call( window );\r\n    // -------\r\n    const params = dom.meta( 'oohtml' ).copyWithDefaults( $params, {\r\n        template: { attr: { exportid: 'exportid', inherits: 'inherits' }, api: { modules: 'modules', exportid: 'exportid' }, },\r\n        context: { attr: { importscontext: 'importscontext', contextname: 'contextname' }, api: { modules: 'modules' }, },\r\n        export: { attr: { exportid: 'exportid' }, },\r\n        staticsensitivity: true,\r\n    } );\r\n    params.window = window;\r\n    params.templateSelector = `template[${ window.CSS.escape( params.template.attr.exportid ) }]`;\r\n    params.ownerContextSelector = [ params.context.attr.contextname, params.context.attr.importscontext ].map( a => `[${ window.CSS.escape( a ) }]` ).join( ',' );\r\n    params.HTMLImportsContext = class extends _HTMLImportsContext {\r\n        static get params() { return params; }\r\n    }\r\n    // -------\r\n    exposeModulesObjects.call( this, params );\r\n    realtime.call( this, params );\r\n}\r\n\r\n/**\r\n * Returns the \"exports\" object associated with the given node.\r\n *\r\n * @param Element       node\r\n * @param Bool          autoCreate\r\n *\r\n * @return Object\r\n */\r\nexport function getModulesObject( node, autoCreate = true ) {\r\n\tif ( !_( node ).has( 'modules' ) && autoCreate ) {\r\n\t\tconst modulesObj = Object.create( null );\r\n\t\tObserver.intercept( modulesObj, 'set', ( event, receiver, next ) => {\r\n\t\t\tif ( !event.key.startsWith( '#' ) || event.value instanceof Set ) return next();\r\n            if ( !Array.isArray( event.value ) ) { event.value = [ event.value ]; }\r\n            event.value = new Set( event.value );\r\n\t\t\treturn next();\r\n\t\t} );\r\n\t\t_( node ).set( 'modules', modulesObj );\r\n\t}\r\n\treturn _( node ).get( 'modules' );\r\n}\r\n\r\n/**\r\n * Exposes HTML Modules with native APIs.\r\n *\r\n * @param Object        params\r\n *\r\n * @return Void\r\n */\r\nfunction exposeModulesObjects( params ) {\r\n    const window = this;\r\n    // Assertions\r\n    if ( params.context.api.modules in window.document ) { throw new Error( `document already has a \"${ params.context.api.modules }\" property!` ); }\r\n    if ( params.template.api.modules in window.HTMLElement.prototype ) { throw new Error( `The \"HTMLElement\" class already has a \"${ params.template.api.modules }\" property!` ); }\r\n    if ( params.template.api.exportid in window.HTMLTemplateElement.prototype ) { throw new Error( `The \"HTMLTemplateElement\" class already has a \"${ params.template.api.exportid }\" property!` ); }\r\n    // Definitions\r\n    Object.defineProperty( window.document, params.context.api.modules, { get: function() {\r\n        return getModulesObject( window.document );\r\n    } } );\r\n    Object.defineProperty( window.HTMLElement.prototype, params.template.api.modules, { get: function() {\r\n        return getModulesObject( this );\r\n    } } );\r\n    Object.defineProperty( window.HTMLTemplateElement.prototype, params.template.api.exportid, { get: function() {\r\n        return this.isConnected ? HTMLExportsManager.instance( this, params ).exportId : this.getAttribute( params.template.attr.exportid );\r\n    } } );\r\n}\r\n\r\n/**\r\n * Performs realtime capture of elements and builds their contents graph.\r\n *\r\n * @param Object\t    params\r\n *\r\n * @return Void\r\n */\r\nfunction realtime( params ) {\r\n    const window = this, { dom } = window.wq;\r\n    // ------------\r\n    const attachImportsContext = host => {\r\n        const contextId = params.HTMLImportsContext.createId( host );\r\n        params.HTMLImportsContext.attachTo( host, contextId );\r\n    };\r\n    const detachImportsContext = ( host, force ) => {\r\n        const contextId = params.HTMLImportsContext.createId( host );\r\n        params.HTMLImportsContext.detachFrom( host, contextId, cx => {\r\n            return force || host.matches && !host.matches( params.ownerContextSelector ) && !Object.keys( cx.modules ).length;\r\n        } );\r\n    };\r\n    // ------------\r\n    dom.realtime( window.document ).observe( [ params.templateSelector, params.ownerContextSelector ], record => {\r\n        record.entrants.forEach( entry => {\r\n            if ( entry.matches( params.templateSelector ) ) {\r\n                Object.defineProperty( entry, 'scoped', { value: entry.hasAttribute( 'scoped' ) } ); \r\n                const moduleExport = new HTMLExportsManager( entry, params );\r\n                moduleExport.ownerContext = entry.scoped ? record.target : window.document;\r\n                const ownerContextModulesObj = getModulesObject( moduleExport.ownerContext );\r\n                if ( moduleExport.exportId ) { Observer.set( ownerContextModulesObj, moduleExport.exportId, entry ); }\r\n                // The ownerContext's modulesObj - ownerContextModulesObj - has to be populated\r\n                // Before attaching a context instance to it, to give the just created context something to use for\r\n                // fullfiling reclaimed requests.\r\n                attachImportsContext( moduleExport.ownerContext );\r\n            } else {\r\n                attachImportsContext( entry );\r\n            }\r\n        } );\r\n        record.exits.forEach( entry => {\r\n            if ( entry.matches( params.templateSelector ) ) {\r\n                const moduleExport = HTMLExportsManager.instance( entry, params );\r\n                const ownerContextModulesObj = getModulesObject( moduleExport.ownerContext );\r\n                if ( moduleExport.exportId ) { Observer.deleteProperty( ownerContextModulesObj, moduleExport.exportId ); }\r\n                detachImportsContext( moduleExport.ownerContext );\r\n            } else {\r\n                detachImportsContext( entry, true );\r\n            }\r\n        } );\r\n    }, { subtree: true, timing: 'sync', staticSensitivity: params.staticsensitivity } );\r\n}\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport { HTMLContextManager } from '../context-api/index.js';\r\nimport _HTMLImportsContext from '../html-modules/_HTMLImportsContext.js';\r\nimport { _ } from '../util.js';\r\n\r\n/**\r\n * Creates the HTMLImportElement class.\r\n * \r\n * @param Object params \r\n * \r\n * @return HTMLImportElement\r\n */\r\nexport default function( params ) {\r\n    const window = this, { dom } = window.wq;\r\n    const BaseExportElement = params.import.tagName.includes( '-' )\r\n        ? ( params.HTMLImportBaseElement || window.HTMLElement )\r\n        : class {};\r\n    return class HTMLImportElement extends BaseExportElement {\r\n        \r\n        /**\r\n         * @instance\r\n         * \r\n         * @param HTMLElement node\r\n         * \r\n         * @returns \r\n         */\r\n        static instance( node ) {\r\n            if ( params.import.tagName.includes( '-' ) && ( node instanceof this ) )  return node;\r\n            return _( node ).get( 'import::instance' ) || new this( node );;\r\n        }\r\n\r\n        /**\r\n         * @constructor\r\n         */\r\n        constructor( ...args ) {\r\n            super();\r\n            // --------\r\n            const el = args[ 0 ] || this;\r\n            _( el ).set( 'import::instance', this );\r\n            Object.defineProperty( this, 'el', { get: () => el, configurable: false } );\r\n\r\n            const priv = {};\r\n            Object.defineProperty( this, '#', { get: () => priv, configurable: false } );\r\n            priv.slottedElements = new Set;\r\n\r\n            priv.setAnchorNode = anchorNode => {\r\n                priv.anchorNode = anchorNode;\r\n                _( anchorNode ).set( 'anchoredNode@imports', this.el );\r\n            };\r\n\r\n            priv.importRequest = ( callback, signal = null ) => {\r\n                const detail = priv.moduleRef && !priv.moduleRef.includes( '#' ) ? `${ priv.moduleRef }#default` : priv.moduleRef;\r\n                const request = _HTMLImportsContext.createRequest( { detail, live: signal && true, signal, selfScoped: true } );\r\n                HTMLContextManager.instance( this.el.isConnected ? this.el.parentNode : priv.anchorNode.parentNode ).ask( request, response => {\r\n                    callback( ( response instanceof Set ? new Set( response ) : response ) || [] );\r\n                } );\r\n            };\r\n\r\n            priv.hydrate = ( anchorNode, slottedElements ) => {\r\n                // ----------------\r\n                priv.moduleRef = ( this.el.getAttribute( params.import.attr.moduleref ) || '' ).trim();\r\n                priv.setAnchorNode( anchorNode );\r\n                priv.autoRestore( () => {\r\n                    slottedElements.forEach( slottedElement => {\r\n                        priv.slottedElements.add( slottedElement );\r\n                        _( slottedElement ).set( 'slot@imports', this.el );\r\n                    } );\r\n                } );\r\n                // ----------------\r\n                priv.hydrationImportRequest = new AbortController;\r\n                priv.importRequest( modules => {\r\n                    if ( priv.originalsRemapped ) { return this.fill( modules ); }\r\n                    const identifiersMap = [ ...modules ].map( module => ( { el: module, exportId: module.getAttribute( params.export.attr.exportid ) || 'default', tagName: module.tagName, } ) );\r\n                    slottedElements.forEach( slottedElement => {\r\n                        const tagName = slottedElement.tagName, exportId = slottedElement.getAttribute( params.export.attr.exportid ) || 'default';\r\n                        const originalsMatch = identifiersMap.filter( moduleIdentifiers => tagName === moduleIdentifiers.tagName && exportId === moduleIdentifiers.exportId );\r\n                        if ( originalsMatch.length !== 1 ) return;\r\n                        _( slottedElement ).set( 'original@imports', originalsMatch[ 0 ].el );\r\n                    } );\r\n                    priv.originalsRemapped = true;\r\n                }, priv.hydrationImportRequest.signal );\r\n            };\r\n\r\n            priv.autoRestore = ( callback = null ) => {\r\n                priv.autoRestoreRealtime?.disconnect();\r\n                if ( callback ) callback();\r\n                if ( !priv.slottedElements.size ) {\r\n                    priv.anchorNode.replaceWith( this.el );\r\n                    return;\r\n                }\r\n                const autoRestoreRealtime = dom.realtime( window.document ).observe( [ ...priv.slottedElements ], record => {\r\n                    record.exits.forEach( outgoingNode => {\r\n                        _( outgoingNode ).delete( 'slot@imports' );\r\n                        priv.slottedElements.delete( outgoingNode );\r\n                    } );\r\n                    if ( !priv.slottedElements.size ) {\r\n                        autoRestoreRealtime.disconnect();\r\n                        // At this point, ignore if this is a removal involving the whole parent node\r\n                        if ( !record.target.isConnected ) return;\r\n                        priv.anchorNode.replaceWith( this.el );\r\n                    }\r\n                }, { subtree: true, timing: 'sync', generation: 'exits' } );\r\n                priv.autoRestoreRealtime = autoRestoreRealtime;\r\n            };\r\n\r\n            priv.connectedCallback = () => {\r\n                // In case this is DOM node relocation or induced reinsertion into the DOM\r\n                if ( priv.slottedElements.size ) throw new Error( `Illegal reinsertion into the DOM; import slot is not empty!` );\r\n                // Totally initialize this instance?\r\n                if ( !priv.anchorNode ) { priv.setAnchorNode( this.createAnchorNode() ); }\r\n                if ( priv.moduleRefRealtime ) return;\r\n                priv.moduleRefRealtime = dom.realtime( this.el ).attr( params.import.attr.moduleref, ( record, { signal } ) => {\r\n                    priv.moduleRef = record.value;\r\n                    ;\r\n                    // Below, we ignore first restore from hydration\r\n                    priv.importRequest( modules => !priv.hydrationImportRequest && this.fill( modules ), signal );\r\n                }, { live: true, timing: 'sync', lifecycleSignals: true } );\r\n                // Must come after\r\n                priv.hydrationImportRequest?.abort();\r\n                priv.hydrationImportRequest = null;\r\n            };\r\n\r\n            priv.disconnectedCallback = () => {\r\n                priv.hydrationImportRequest?.abort();\r\n                priv.hydrationImportRequest = null;\r\n                if ( priv.anchorNode.isConnected ) return;\r\n                priv.moduleRefRealtime?.disconnect();\r\n                priv.moduleRefRealtime = null;\r\n            };\r\n        }\r\n\r\n        /**\r\n         * Creates the slot's anchor node.\r\n         *\r\n         * @return Element\r\n         */\r\n        createAnchorNode() {\r\n            if ( !params.isomorphic ) { return window.document.createTextNode( '' ) }\r\n            return window.document.createComment( this.el.outerHTML );\r\n        }\r\n\r\n        /**\r\n         * Fills the slot with slottableElements\r\n         *\r\n         * @param Iterable  slottableElements\r\n         *\r\n         * @return void\r\n         */\r\n        fill( slottableElements ) {\r\n            if ( Array.isArray( slottableElements ) ) { slottableElements = new Set( slottableElements ) }\r\n            this[ '#' ].autoRestore( () => {              \r\n                this[ '#' ].slottedElements.forEach( slottedElement => {\r\n                    const slottedElementOriginal = _( slottedElement ).get( 'original@imports' );\r\n                    // If still available in source, simply leave unchanged\r\n                    // otherwise remove it from slot... to reflect this change\r\n                    if ( slottableElements.has( slottedElementOriginal ) ) {\r\n                        slottableElements.delete( slottedElementOriginal );\r\n                    } else {\r\n                        this[ '#' ].slottedElements.delete( slottedElement );\r\n                        // This removal will not be caught\r\n                        slottedElement.remove();\r\n                    }\r\n                } );\r\n                // Make sure anchor node is what's in place...\r\n                // not the import element itslef - but all only when we have slottableElements.size\r\n                if ( this.el.isConnected && slottableElements.size ) {\r\n                    this.el.replaceWith( this[ '#' ].anchorNode );\r\n                }\r\n                // Insert slottables now\r\n                slottableElements.forEach( slottableElement => {\r\n                    // Clone each slottable element and give it a reference to its original\r\n                    const slottableElementClone = slottableElement.cloneNode( true );\r\n                    // The folllowing references must be set before adding to DODM\r\n                    if ( !slottableElementClone.hasAttribute( params.export.attr.exportid ) ) {\r\n                        slottableElementClone.toggleAttribute( params.export.attr.exportid, true );\r\n                    }\r\n                    _( slottableElementClone ).set( 'original@imports', slottableElement );\r\n                    _( slottableElementClone ).set( 'slot@imports', this.el );\r\n                    this[ '#' ].slottedElements.add( slottableElementClone );\r\n                    this[ '#' ].anchorNode.before( slottableElementClone );\r\n                } );\r\n            } );\r\n        }\r\n\r\n        /**\r\n         * Empty slot.\r\n         *\r\n         * @return void\r\n         */\r\n        empty() { this[ '#' ].slottedElements.forEach( slottedElement => slottedElement.remove() ); }\r\n\r\n        /**\r\n         * Returns the slot's anchorNode.\r\n         *\r\n         * @return array\r\n         */\r\n        get anchorNode() { return this[ '#' ].anchorNode; }\r\n\r\n        /**\r\n         * Returns the slot's module reference, if any.\r\n         *\r\n         * @return string\r\n         */\r\n        get moduleRef() { return this[ '#' ].moduleRef; }\r\n\r\n        /**\r\n         * Returns the slot's slotted elements.\r\n         *\r\n         * @return array\r\n         */\r\n        get slottedElements() { return this[ '#' ].slottedElements; }\r\n    }\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport wqDom from '@webqit/dom';\r\nimport _HTMLImportElement from './_HTMLImportElement.js';\r\nimport { _ } from '../util.js';\r\n\r\n/**\r\n * Initializes HTML Modules.\r\n * \r\n * @param $params  Object\r\n *\r\n * @return Void\r\n */\r\nexport default function init( $params = { }) {\r\n    const window = this, dom = wqDom.call( window );\r\n    // -------\r\n    const params = dom.meta( 'oohtml' ).copyWithDefaults( $params, {\r\n        import: { tagName: 'import', attr: { moduleref: 'module' }, },\r\n        export: { attr: { exportid: 'exportid' }, },\r\n        isomorphic: true,\r\n    } );\r\n    params.slottedElementsSelector = `[${ window.CSS.escape( params.export.attr.exportid ) }]`;\r\n    params.HTMLImportElement = _HTMLImportElement.call( this, params );\r\n    // -------\r\n    dom.ready( () => hydration.call( this, params ) );\r\n    realtime.call( this, params );\r\n}\r\n\r\n/**\r\n * Performs realtime capture of elements and their attributes\r\n * and their module query results; then resolves the respective import elements.\r\n *\r\n * @param Object params\r\n *\r\n * @return Void\r\n */\r\nfunction realtime( params ) {\r\n    const window = this, { dom } = window.wq;\r\n    dom.realtime( window.document ).observe( params.import.tagName, record => {\r\n        record.entrants.forEach( node => handleRealtime( node, true, record ) );\r\n        record.exits.forEach( node => handleRealtime( node, false, record ) );\r\n    }, { subtree: true, timing: 'sync' } );\r\n    function handleRealtime( entry, connectedState, record ) {\r\n        const elInstance = params.HTMLImportElement.instance( entry );\r\n        if ( connectedState ) { elInstance[ '#' ].connectedCallback(); }\r\n        else { elInstance[ '#' ].disconnectedCallback(); }\r\n    }\r\n}\r\n\r\n/**\r\n * Performs hydration for server-slotted elements.\r\n *\r\n * @param Object params\r\n *\r\n * @return Void\r\n */\r\nfunction hydration( params ) {\r\n    const window = this;\r\n    function scan( context ) {\r\n        const slottedElements = new Set;\r\n        context.childNodes.forEach( node => {\r\n            if ( node.nodeType === 1/** ELEMENT_NODE */ ) {\r\n                if ( !node.matches( params.slottedElementsSelector ) ) return;\r\n                if ( _( node ).get( 'slot@imports' ) ) return;\r\n                slottedElements.add( node );\r\n            } else if ( node.nodeType === 8/** COMMENT_NODE */ ) {\r\n                const nodeValue = node.nodeValue.trim();\r\n                if ( !nodeValue.startsWith( '<' + params.import.tagName ) ) return;\r\n                if ( !nodeValue.endsWith( '</' + params.import.tagName + '>' ) ) return;\r\n                const reviver = window.document.createElement( 'div' );\r\n                reviver.innerHTML = nodeValue;\r\n                const importEl = reviver.firstChild;\r\n                if ( !importEl.matches( params.import.tagName ) ) return;\r\n                params.HTMLImportElement.instance( importEl )[ '#' ].hydrate(\r\n                    node/* the comment node */, slottedElements\r\n                );\r\n                slottedElements.clear();\r\n            }\r\n        } );\r\n    }\r\n    Array.from( window.document.querySelectorAll( params.slottedElementsSelector ) ).forEach( slottedElement => {\r\n        // hydration() might be running AFTER certain <slots> have resolved\r\n        // and slottedElement might be a just-resolved node\r\n        if ( _( slottedElement ).get( 'slot@imports' ) ) return;\r\n        if ( _( slottedElement.parentNode ).get( 'alreadyscanned@imports' ) ) return;\r\n        scan( slottedElement.parentNode );\r\n        // Scanning is once for every parent\r\n        _( slottedElement.parentNode ).set( 'alreadyscanned@imports', true );\r\n    } );\r\n}\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport Observer from '@webqit/observer';\r\nimport wqDom from '@webqit/dom';\r\nimport { _ } from '../util.js';\r\n\r\n/**\r\n * @init\r\n * \r\n * @param Object $params\r\n */\r\nexport default function init( $params = {} ) {\r\n\tconst window = this, dom = wqDom.call( window );\r\n    // -------\r\n    const params = dom.meta( 'oohtml' ).copyWithDefaults( $params, {\r\n\t\tattr: { namespace: 'namespace',  id: 'data-id', },\r\n        api: { namespace: 'namespace', },\r\n\t\tstaticsensitivity: true,\r\n\t\teagermode: true,\r\n    } );\r\n\tparams.idSelector = `[${ window.CSS.escape( params.attr.id ) }]`;\r\n\tparams.namespaceSelector = `[${ window.CSS.escape( params.attr.namespace ) }]`;\r\n    // -------\r\n    exposeNamespaceObjects.call( this, params );\r\n    realtime.call( this, params );\r\n}\r\n\r\n/**\r\n * Exposes Namespaced HTML with native APIs.\r\n *\r\n * @param Object params\r\n *\r\n * @return Void\r\n */\r\nfunction exposeNamespaceObjects( params ) {\r\n\tconst window = this;\r\n    // Assertions\r\n    if ( params.api.namespace in window.document ) { throw new Error( `document already has a \"${ params.api.namespace }\" property!` ); }\r\n    if ( params.api.namespace in window.Element.prototype ) { throw new Error( `The \"Element\" class already has a \"${ params.api.namespace }\" property!` ); }\r\n    // Definitions\r\n    Object.defineProperty( window.document, params.api.namespace, { get: function() {\r\n        return Observer.proxy( getNamespaceObject.call( window, window.document, params ) );\r\n    } });\r\n    Object.defineProperty( window.Element.prototype, params.api.namespace, { get: function() {\r\n        return Observer.proxy( getNamespaceObject.call( window, this, params ) );\r\n    } } );\r\n}\r\n\r\n/**\r\n * Returns the \"namespace\" object associated with the given node.\r\n *\r\n * @param Element node\r\n *\r\n * @return Object\r\n */\r\nfunction getNamespaceObject( node, params ) {\r\n\tconst window = this;\r\n\tif ( !_( node ).has( 'namespace' ) ) {\r\n\t\tconst namespaceObj = Object.create( null );\r\n\t\tObserver.intercept( namespaceObj, 'get', ( event, receiver, next ) => {\r\n\t\t\tif ( Observer.has( namespaceObj, event.key ) || !params.eagermode ) return next();\r\n\t\t\tconst selector = `[${ window.CSS.escape( params.attr.id ) }=\"${ event.key }\"]`;\r\n\t\t\tconst resultNode = Array.from( node.querySelectorAll( selector ) ).filter( idNode => {\r\n\t\t\t\tconst ownerRoot = idNode.parentNode.closest( params.namespaceSelector );\r\n\t\t\t\tif ( node === window.document ) {\r\n\t\t\t\t\t// Only IDs without a scope actually belong to the document scope\r\n\t\t\t\t\treturn !ownerRoot;\r\n\t\t\t\t}\r\n\t\t\t\treturn ownerRoot === node;\r\n\t\t\t} )[ 0 ];\r\n\t\t\tif ( resultNode ) Observer.set( namespaceObj, event.key, resultNode );\r\n\t\t\treturn next();\r\n\t\t} );\r\n\t\t_( node ).set( 'namespace', namespaceObj );\r\n\t}\r\n\treturn _( node ).get( 'namespace' );\r\n}\r\n\r\n/**\r\n * Performs realtime capture of elements and builds their relationships.\r\n *\r\n * @param Object params\r\n *\r\n * @return Void\r\n */\r\nfunction realtime( params ) {\r\n\tconst window = this, { dom } = window.wq;\r\n\t// ----------------\r\n\tconst handle = ( target, entry, incoming ) => {\r\n\t\tconst identifier = entry.getAttribute( params.attr.id );\r\n\t\tconst ownerRoot = target.closest( params.namespaceSelector ) || _( entry ).get( 'ownerNamespace' ) || window.document;\r\n\t\tconst namespaceObj = getNamespaceObject.call( window, ownerRoot, params );\r\n\t\tif ( incoming ) {\r\n\t\t\tif ( Observer.get( namespaceObj, identifier ) !== entry ) {\r\n\t\t\t\t_( entry ).set( 'ownerNamespace', ownerRoot );\r\n\t\t\t\tObserver.set( namespaceObj, identifier, entry );\r\n\t\t\t}\r\n\t\t} else if ( Observer.get( namespaceObj, identifier ) === entry ) {\r\n\t\t\t_( entry ).delete( 'ownerNamespace' );\r\n\t\t\tObserver.deleteProperty( namespaceObj, identifier );\r\n\t\t}\r\n\t};\r\n\tdom.realtime( window.document ).observe( params.idSelector, record => {\r\n        record.entrants.forEach( entry => handle( record.target, entry, true ) );\r\n        record.exits.forEach( entry => handle( record.target, entry, false ) );\r\n\t}, { subtree: true, timing: 'sync', staticSensitivity: params.staticsensitivity } );\r\n\t// ----------------\r\n\tif ( params.staticsensitivity ) {\r\n\t\tdom.realtime( window.document, 'attr' ).observe( params.namespaceSelector, record => {\r\n\t\t\tconst ownerRoot = record.target.parentNode?.closest( params.namespaceSelector ) || _( record.target ).get( 'ownerNamespace' ) || window.document;\r\n\t\t\tconst ownerRootNamespaceObj = getNamespaceObject.call( window, ownerRoot, params );\r\n\t\t\tconst namespaceObj = getNamespaceObject.call( window, record.target, params );\r\n\t\t\tif ( record.target.matches( params.namespaceSelector ) ) {\r\n\t\t\t\tfor ( const [ key, entry ] of Object.entries( ownerRootNamespaceObj ) ) {\r\n\t\t\t\t\tif ( !record.target.contains( entry.parentNode ) ) continue;\r\n\t\t\t\t\tObserver.deleteProperty( ownerRootNamespaceObj, key );\r\n\t\t\t\t\tObserver.set( namespaceObj, key, entry );\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfor ( const [ key, entry ] of Object.entries( namespaceObj ) ) {\r\n\t\t\t\t\tObserver.deleteProperty( namespaceObj, key );\r\n\t\t\t\t\tObserver.set( ownerRootNamespaceObj, key, entry );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, { subtree: true, timing: 'sync' } );\r\n\t}\r\n\t// ----------------\r\n}\r\n", "\r\n/**\r\n * @exports\r\n */\r\nexport function resolveParams( extensions = {} ) {\r\n    const params = {\r\n        runtimeParams: { ...runtimeParams, ...( extensions.runtimeParams || {} ) },\r\n        compilerParams: { ...compilerParams, ...( extensions.compilerParams || {} ) },\r\n        parserParams: { ...parserParams, ...( extensions.parserParams || {} ) },\r\n    };\r\n    if ( extensions.devMode ) { /* shortcut for devMode configs */ }\r\n    return params;\r\n}\r\nexport const parserParams = {\r\n    ecmaVersion: '2020',\r\n    allowReturnOutsideFunction: true,\r\n    allowAwaitOutsideFunction: true,\r\n    allowSuperOutsideMethod: true,\r\n    preserveParens: false,\r\n    locations: false,\r\n};\r\nexport const compilerParams = {\r\n    globalsNoObserve: [ 'globalThis', 'arguments', 'console', ],\r\n    originalSource: true,\r\n    globalsOnlyPaths: false,\r\n    locations: true,\r\n    compact: 2,\r\n};\r\nexport const runtimeParams = {\r\n    apiVersion: 1,\r\n};\r\n", "\r\n/**\r\n * @normalizeTabs\r\n */\r\nexport  function normalizeTabs( rawSource, isFunc = false ) {\r\n    let rawSourceSplit = rawSource.split(/\\n/g);\r\n    if ( rawSourceSplit.length > 1 ) {\r\n        while ( !rawSourceSplit[ 0 ].trim().length ) rawSourceSplit.shift();\r\n        let possibleBodyIndentLevel = rawSourceSplit[ isFunc ? 1 : 0 ].split(/[^\\s]/)[ 0 ].length;\r\n        if ( possibleBodyIndentLevel ) {\r\n            return rawSourceSplit.map( ( line, i ) => {\r\n                let possibleIndent = line.substring( 0, possibleBodyIndentLevel );\r\n                if ( !possibleIndent.trim().length ) {\r\n                    return line.substring( possibleBodyIndentLevel );\r\n                }\r\n                // Last line?\r\n                if ( possibleIndent.trim() === '}' && i === rawSourceSplit.length - 1 ) {\r\n                    return '}';\r\n                }\r\n                return line;\r\n            } ).join( \"\\n\" );\r\n        }\r\n    }\r\n    return rawSource;\r\n}\r\n\r\nexport const _await = ( maybePromise, callback ) => (\r\n    maybePromise instanceof Promise ? maybePromise.then( callback ) : callback( maybePromise )\r\n);\r\n\r\nexport  const _compare = ( a, b ) => {\r\n    if ( typeof a === 'object' && a && typeof b === 'object' && b ) return _deepEql( a, b );\r\n    if ( Array.isArray( a ) && Array.isArray( b ) && a.length === b.length ) return a.every( valueA => b.some( valueB => _compare( valueA, valueB ) ) );\r\n    return a === b;\r\n};\r\n\r\nexport  const _deepEql = function( a, b ) {\r\n    for ( let key in a ) {\r\n        if ( !_compare( a[ key ], b[ key ] ) ) return false;\r\n    }\r\n    return true;\r\n};\r\n\r\n// ------------------\r\n// Obsolete\r\n// ------------------\r\n\r\n/**\r\n * @SubscriptFunctionClone\r\n */\r\nexport function SubscriptFunctionClone( _function, defaultThis = null, params = {} ) {\r\n    if ( typeof _function !== 'function' ) {\r\n        throw new Error( `Expected argument 1 to be of type 'function' but got ${ typeof _function }.` );\r\n    }\r\n    if ( !_function.name ) {\r\n        throw new Error(`Function must have a name.`);\r\n    }\r\n    params = resolveParams( params );\r\n    const rawSource = normalizeTabs( _function.toString(), true );\r\n    let source = rawSource, isAsync;\r\n    if ( rawSource.startsWith( 'async ' ) ) {\r\n        params.runtimeParams.async = true;\r\n        source = source.substring( 6 );\r\n        isAsync = true;\r\n    }\r\n    if ( !source.startsWith( 'function ' ) && !source.startsWith( 'function(' ) ) {\r\n        if ( source.trim().startsWith( '[' ) ) {\r\n            let computedName, roughSPlit = source.split(/\\](?:[\\s]+)?\\(/g).filter( str => str );\r\n            [ computedName, source ] = roughSPlit.reduce( ( prev, str, i ) => {\r\n                if ( Array.isArray( prev ) ) return prev;\r\n                str = `${ prev }${ str || '' }]`;\r\n                try {\r\n                    parse( str );\r\n                    return [ str, `${ _function.name }(${ roughSPlit.slice( i + 1 ).join( '] (' ) }`]\r\n                } catch( e ) { return `${ str } (`; }\r\n            }, '' );\r\n        }\r\n        source = 'function ' + source;\r\n    }\r\n    const ast = parse( source, params.parserParams ).body[ 0 ];\r\n    let bodyStart = ast.body.start + 1/* the opening brace */;\r\n    if ( source.substr( bodyStart, 1 ) === \"\\n\" ) {\r\n        bodyStart += 1;\r\n    }\r\n    const originalSource = source.substring( bodyStart, ast.body.end - 1 );\r\n    const compilation = compile( { type: 'Program', body: ast.body.body }, { ...params.compilerParams, locStart: - bodyStart } );\r\n    const parameters = ast.params.map( paramExpr => serialize( paramExpr ) );\r\n    return Runtime.createFunction( _function.name, compilation, parameters, params.runtimeParams, defaultThis, originalSource );\r\n}\r\n\r\n/**\r\n * @SubscriptClass\r\n */\r\nexport const SubscriptClass = Class => class extends ( Class || class {} ) {\r\n\r\n    constructor() {\r\n        super();\r\n        const _static = this.constructor;\r\n        _static.subscriptMethods.forEach( methodName => {\r\n            if ( !this[ methodName ] ) {\r\n                throw new Error( `${ methodName } is not a method.` );\r\n            }\r\n            if ( methodName === 'constructor' ) {\r\n                throw new Error( `Class constructors cannot be subscript methods.` );\r\n            }\r\n            this[ methodName ] = _static.implementMethod( this[ methodName ], this );\r\n        } );\r\n    }\r\n    \r\n    static implementMethod( method, thisBinding = null ) {\r\n        return SubscriptFunctionClone( method, thisBinding, {\r\n            compilerParams: this.compilerParams,\r\n            runtimeParams: this.runtimeParams,\r\n        } );\r\n    }\r\n\r\n    static get subscriptMethods() {\r\n        return [];\r\n    }\r\n\r\n    static get runtimeParams() {\r\n        return {};\r\n    }\r\n\r\n    static get compilerParams() {\r\n        return {};\r\n    }\r\n\r\n}", "\r\n/**\r\n * @exports\r\n */\r\nconst store = new Map;\r\nexport default function( _function, property, value = undefined ) {\r\n    let insp = store.get( _function );\r\n    if ( arguments.length > 2 ) {\r\n        if ( !insp ) {\r\n            insp = new Map;\r\n            store.set( _function, insp );\r\n        }\r\n        insp.set( property, value );\r\n        return;\r\n    }\r\n    return insp && insp.get( property );\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport { _await } from '../util.js';\r\nimport inspection from './inspect.js';\r\n\r\nexport default class Contract {\r\n\r\n    constructor( ownerContract, graph, callee, params = {}, $thread = null, exits = null ) {\r\n        this.ownerContract = ownerContract;\r\n        this.graph = graph;\r\n        this.callee = callee;\r\n        this.params = !ownerContract ? { ...params, isSubscriptFunction: true } : params;\r\n        this.exits = exits || new Map;\r\n        this.$thread = $thread || { entries: new Map, sequence: [], ownerContract: this };\r\n        this.subContracts = new Map;\r\n        this.observers = [];\r\n        this.contract = function( contractId, arg1, arg2 = null, arg3 = null ) {\r\n            if ( !this.graph.subContracts[ contractId ] ) {\r\n                throw new Error( `[${ this.graph.type }:${ this.graph.lineage }]: Graph not found for child contract ${ contractId }.` );\r\n            }\r\n\r\n            let subGraph = this.graph.subContracts[ contractId ];\r\n            let subParams = {\r\n                ...this.params,\r\n                isIterationContract: arguments.length === 3,\r\n                iterationId: arguments.length === 3 && arg1,\r\n                isFunctionContract: arguments.length === 4,\r\n                functionType: arguments.length === 4 && arg1,\r\n                isSubscriptFunction: arguments.length === 4 && arg2,\r\n                functionScope: ( this.params.isFunctionContract && this.graph.lineage ) || this.params.functionScope,\r\n            };\r\n\r\n            if ( subParams.isIterationContract ) {\r\n                // This is an iteration contract\r\n                let callee = arg2;\r\n                // Create iteration\r\n                let iterationInstanceContract = new Contract( this, subGraph, callee, subParams, this.$thread, this.exits );\r\n                // Add iteration\r\n                let iterations = this.subContracts.get( contractId );\r\n                if ( !iterations ) {\r\n                    iterations = new Map;\r\n                    this.subContracts.set( contractId, iterations );\r\n                }\r\n                // Dispose all existing\r\n                if ( iterations.has( subParams.iterationId ) ) {\r\n                    iterations.get( subParams.iterationId ).dispose();\r\n                }\r\n                iterations.set( subParams.iterationId, iterationInstanceContract );\r\n                return iterationInstanceContract.call();\r\n            }\r\n\r\n            let callee, subContract, returnValue;\r\n            // Dispose existing\r\n            if ( this.subContracts.has( contractId ) ) {\r\n                this.subContracts.get( contractId ).dispose();\r\n            }\r\n\r\n            if ( subParams.isFunctionContract ) {\r\n                // Function contracts\r\n                callee = arg3;\r\n                const createCallback = () => new Contract( this, subGraph, callee, subParams );\r\n                if ( subParams.functionType !== 'FunctionDeclaration' ) {\r\n                    returnValue = this.createFunction( createCallback );\r\n                } else {\r\n                    let subContract = createCallback();\r\n                    if ( subParams.apiVersion > 1 ) {\r\n                        returnValue = function( ...args ) {\r\n                            let _returnValue = subContract.call( this, ...args );\r\n                            _returnValue = _await( _returnValue, __returnValue => [ _returnValue, subContract.thread.bind( subContract ), subContract ] );\r\n                            subContract = createCallback();\r\n                            return _returnValue;\r\n                        }\r\n                        returnValue.target = subContract;\r\n                    } else {\r\n                        returnValue = subContract;\r\n                    }\r\n                }\r\n            } else {\r\n                // Regular contracts\r\n                callee = arg1, subContract = new Contract( this, subGraph, callee, subParams, this.$thread, this.exits );\r\n                this.subContracts.set( contractId, subContract );\r\n                returnValue = subContract.call();\r\n            }\r\n\r\n            return returnValue;\r\n        }.bind( this );\r\n        // ---------------------------\r\n        this.contract.memo = Object.create( null );\r\n        if ( this.ownerContract && ![ 'FunctionDeclaration', 'FunctionExpression' ].includes( this.graph.type ) ) {\r\n            this.contract.args = this.ownerContract.contract.args;\r\n        }\r\n        // ---------------------------\r\n        this.contract.exiting = function( keyword, arg ) {\r\n            if ( !arguments.length ) return this.exits.size;\r\n            let exitMatch = this.exits.get( keyword ) === arg;\r\n            if ( exitMatch ) this.exits.clear();\r\n            return exitMatch;\r\n        }.bind( this );\r\n        // ---------------------------\r\n        this.contract.exit = function( keyword, arg ) {\r\n            this.exits.set( keyword, arg );\r\n        }.bind( this );\r\n        // ---------------------------\r\n        this.contract.functions = new Map;\r\n        this.contract.functions.declaration = ( functionDeclaration, callTarget ) => {\r\n            this.contract.functions.set( functionDeclaration, callTarget );\r\n            this.applyReflection( functionDeclaration, typeof callTarget === 'function' ? callTarget.target : callTarget );\r\n        }\r\n    }\r\n\r\n    fire( contractUrl, event, refs ) {\r\n        if ( !this.ownerContract ) return;\r\n        const ret = this.ownerContract.fire( contractUrl, event, refs );\r\n        this.observers.forEach( observer => {\r\n            if ( observer.contractUrl !== contractUrl ) return;\r\n            observer.callback( event, refs );\r\n        } );\r\n        return ret;\r\n    }\r\n\r\n    observe( contractUrl, callback ) {\r\n        if ( !this.params.isFunctionContract ) return;\r\n        this.observers.push( { contractUrl, callback } );\r\n    }\r\n\r\n    call( $this, ...$arguments ) {\r\n        if ( this.disposed ) {\r\n            throw new Error( `[${ this.graph.type }:${ this.graph.lineage }]: Instance not runable after having been disposed.` );\r\n        }\r\n        if ( !this.ownerContract ) {\r\n            this.contract.args = $arguments;\r\n            Object.defineProperty( this.contract.args, Symbol.toStringTag, { value: 'Arguments' } );\r\n        }\r\n        let returnValue = this.callee.call( $this, this.contract, ...$arguments );\r\n        if ( this.graph.$sideEffects ) {\r\n            for ( let referenceId in this.graph.effects ) {\r\n                for ( let effectRef of this.graph.effects[ referenceId ].refs ) {\r\n                    // Build side effects\r\n                    this.buildThread( [], effectRef, [], 0, true );\r\n                }\r\n            }\r\n        }\r\n        return _await( returnValue, () => {\r\n            if ( !this.ownerContract || this.params.isFunctionContract ) {\r\n                let exitReturnValue = this.exits.get( 'return' );\r\n                this.exits.clear();\r\n                if ( exitReturnValue !== undefined ) return exitReturnValue;\r\n            }\r\n            return returnValue;\r\n        } );\r\n    }\r\n\r\n    iterate( keys = [] ) {\r\n        if ( this.disposed ) return false;\r\n        if ( ![ 'ForOfStatement', 'ForInStatement' ].includes( this.graph.type ) || this.subContracts.size !== 1 ) {\r\n            throw new Error( `Contract ${ this.graph.lineage } is not an iterator.` );\r\n        }\r\n        let [ [ /* iterationContractId */, iterationInstances ] ] = this.subContracts;\r\n        let prev\r\n        if ( !keys.length || ( keys.includes( 'length' ) && this.graph.type === 'ForOfStatement' ) ) {\r\n            for ( let [ /* iterationId */, iterationInstance ] of iterationInstances ) {\r\n                prev = _await( prev, () => iterationInstance.call() );\r\n            }\r\n        } else {\r\n            for ( let key of keys ) {\r\n                let instance = iterationInstances.get( key ) || iterationInstances.get( parseInt( key ) );\r\n                if ( !instance ) continue;\r\n                prev = _await( prev, () => instance.call() );\r\n            }\r\n        }\r\n        return prev;\r\n    }\r\n\r\n    thread( ...eventRefs ) {\r\n        if ( this.disposed ) return false;\r\n        this.$thread.active = true;\r\n        for ( let referenceId in this.graph.effects ) {\r\n            for ( let effectRef of this.graph.effects[ referenceId ].refs ) {\r\n                for ( let eventRef of eventRefs ) {\r\n                    let [ isMatch, remainder, computes ] = this.matchRefs( eventRef, effectRef );\r\n                    if ( !isMatch ) continue;\r\n                    this.buildThread( eventRef, effectRef, computes, remainder );\r\n                }\r\n            }\r\n        }\r\n        return this.runThread();\r\n    }\r\n\r\n    runThread() {\r\n        let execute = ( entry, refs ) => {\r\n            if ( [ 'ForOfStatement', 'ForInStatement' ].includes( entry.graph.type ) \r\n            && refs.every( ref => ref.executionPlan.isIterationContractTarget ) ) {\r\n                let targets = refs.map( ref => ref.executionPlan.iterationTarget );\r\n                this.fire( entry.graph.lineage, 'iterating', refs );\r\n                return entry.iterate( targets );\r\n            }\r\n            this.fire( entry.graph.lineage, 'executing', refs );\r\n            return entry.call();\r\n        };\r\n        let prev, entry, refs;\r\n        while ( \r\n            ( entry = this.$thread.sequence.shift() ) \r\n            && ( refs = [ ...this.$thread.entries.get( entry ) ] ) \r\n            && this.$thread.entries.delete( entry ) // Important: to allow re-entry on susequent threads\r\n        ) {\r\n            prev = _await( prev, () => {\r\n                if ( entry.disposed || !entry.filterRefs( refs ).length ) return;\r\n                this.$thread.current = entry;\r\n                let maybePromise = execute( entry, refs );\r\n                _await( maybePromise, () => {\r\n                    for ( let ref of refs ) {\r\n                        [].concat( ref.executionPlan.assigneeRef || ref.executionPlan.assigneeRefs || [] ).forEach( assigneeRef => {\r\n                            entry.buildThread( [], assigneeRef, [], 0 );\r\n                        } );\r\n                    }\r\n                } );\r\n                return maybePromise;\r\n            } );\r\n        }\r\n        return _await( prev, () => {\r\n            let _ret = this.exits.get( 'return' );\r\n            this.exits.clear();\r\n            this.$thread.current = null;\r\n            this.$thread.active = false;\r\n            return _ret;\r\n        } );\r\n    }\r\n\r\n    buildThread( eventRef, effectRef, computes, remainder = 0, isSideEffect = false ) {\r\n        let shouldMatchEventRef = remainder > 0;\r\n        if ( this.ownerContract ) {\r\n            // IMPORTANT: effectRef at global level are not supposed to be checked for computes and condition\r\n            if ( !this.compute( computes ) ) return;\r\n            if ( effectRef.condition !== undefined && !this.assert( effectRef.condition ) ) return;\r\n        } else if ( !shouldMatchEventRef ) {\r\n            shouldMatchEventRef = computes.length || effectRef.condition !== undefined;\r\n        }\r\n        let subscriptionsObject = isSideEffect ? effectRef.$subscriptions : effectRef.subscriptions;\r\n        // First we assert the conditions for the effectRef before moving on\r\n        Object.keys( subscriptionsObject ).forEach( fullReferenceUrl => {\r\n            let [ contractUrl, referenceId ] = fullReferenceUrl.split( ':' );\r\n            let selectRefs = _subscriberInstance => {\r\n                if ( !_subscriberInstance ) return;\r\n                _subscriberInstance.selectRefs( referenceId, subscriptionsObject[ fullReferenceUrl ], shouldMatchEventRef ? eventRef : null );\r\n            }\r\n            // We find the subscriber instance\r\n            let subscriberInstance = this.locate( contractUrl );\r\n            if ( Array.isArray( subscriberInstance ) ) {\r\n                subscriberInstance.forEach( selectRefs );\r\n            } else {\r\n                selectRefs( subscriberInstance );\r\n            }\r\n        } );\r\n    }\r\n\r\n    selectRefs( referenceId, refIds, eventRef = null ) {\r\n        // We'll select refs from within the following reference\r\n        let $thread = this.$thread;\r\n        let reference = this.graph.signals[ referenceId ];\r\n        // -----------------------------------------\r\n        let compare = ( a, b ) => a.graph.lineage.localeCompare( b.graph.lineage, undefined, { numeric: true } );\r\n        let selectRef = ( ref, computes = [], executionPlan = {} ) => {\r\n            // If this addition is by the side effect of a function, \"this\" can sometimes be higher in scope\r\n            if ( !$thread.active ) return;\r\n            if ( $thread.current && compare( this, $thread.current ) < 0 ) return;\r\n            let refs = $thread.entries.get( this );\r\n            if ( !refs ) {\r\n                refs = new Set;\r\n                $thread.entries.set( this, refs );\r\n                $thread.sequence.push( this );\r\n                $thread.sequence.sort( compare );\r\n            }\r\n            refs.add( { ...ref, computes, executionPlan } );\r\n            if ( !executionPlan.assigneeRef && [ 'VariableDeclaration', 'AssignmentExpression' ].includes( this.graph.type ) ) {\r\n                executionPlan.assigneeRefs = [];\r\n                for ( let referenceId in this.graph.effects ) {\r\n                    executionPlan.assigneeRefs.push( ...this.graph.effects[ referenceId ].refs )\r\n                }\r\n            }\r\n        };\r\n        // -----------------------------------------\r\n        for ( let refId of refIds ) {\r\n            // The ref within reference\r\n            let ref = reference.refs[ refId ];\r\n            // First we assert the conditions for the ref before moving on\r\n            if ( !eventRef ) {\r\n                // AffectedRef matched event ref... So we select ALL refs within reference\r\n                selectRef( ref );\r\n                continue;\r\n            }\r\n            // We match ref to decide whether or how to select it\r\n            let [ isMatch_b, remainder_b, computes_b ] = this.matchRefs( eventRef, ref );\r\n            if ( !isMatch_b ) continue;\r\n            if ( remainder_b <= 0 ) {\r\n                // SubscriberRef matches event ref\r\n                selectRef( ref, computes_b );\r\n                continue;\r\n            }\r\n            let eventRef_balance = eventRef.slice( -remainder_b );\r\n            let assigneeReference = 'assignee' in reference ? this.graph.effects[ reference.assignee ] : null;\r\n            if ( assigneeReference ) {\r\n                assigneeReference.refs.forEach( assigneeRef => {\r\n                    if ( assigneeRef.depth.length ) {\r\n                        let [ isMatch_c, remainder_c, computes_c ] = this.matchRefs( eventRef_balance, assigneeRef.depth );\r\n                        let computes_d = computes_b.concat( computes_c );\r\n                        if ( isMatch_c && remainder_c > 0 ) {\r\n                            // We move on passively to effects on the assignee\r\n                            let newEventRef = assigneeRef.path.concat( eventRef_balance.slice( -remainder_c ) );\r\n                            this.buildThread( newEventRef, assigneeRef, computes_d, remainder_c );\r\n                        } else if ( isMatch_c ) {\r\n                            // Match is successful on the destructuring side... so we select\r\n                            selectRef( ref, computes_d, { assigneeRef } );\r\n                        }\r\n                    } else {\r\n                        // We move on passively to effects on the assignee\r\n                        let newEventRef = assigneeRef.path.concat( eventRef_balance );\r\n                        this.buildThread( newEventRef, assigneeRef, computes_b, remainder_b );\r\n                    }\r\n                } );\r\n                continue;\r\n            }\r\n            if ( remainder_b === 1 && this.graph.type === 'ForOfStatement' ) {\r\n                // An iteration item was changed or the length property of the list was changed\r\n                selectRef( ref, computes_b, { isIterationContractTarget: true, iterationTarget: eventRef_balance[ 0 ] } );\r\n                continue;\r\n            }\r\n            if ( remainder_b === 1 && this.graph.type === 'ForInStatement' ) {\r\n                // An iteration property was changed\r\n                selectRef( ref, computes_b, { isIterationContractTarget: true, iterationTarget: eventRef_balance[ 0 ] } );\r\n                continue;\r\n            }\r\n        }\r\n    }\r\n\r\n    filterRefs( refs ) {\r\n        return refs.filter( ref => {\r\n            if ( !this.compute( ref.computes ) ) return;\r\n            if ( ref.condition !== undefined && !this.assert( ref.condition ) ) return;\r\n            return true;\r\n        } );\r\n    }\r\n\r\n    matchRefs( a, b ) {\r\n        let pathA, $pathA, pathB, $pathB;\r\n        if ( Array.isArray( a ) ) {\r\n            pathA = a, $pathA = a.dotSafe ? a.join( '.' ) : undefined;\r\n        } else {\r\n            pathA = a.path, $pathA = a.$path;\r\n        }\r\n        if ( Array.isArray( b ) ) {\r\n            pathB = b, $pathB = b.dotSafe ? b.join( '.' ) : undefined;\r\n        } else {\r\n            pathB = b.path, $pathB = b.$path;\r\n        }\r\n        let remainder = pathA.length - pathB.length;\r\n        if ( remainder > 0 ) {\r\n            [ pathA, pathB, $pathA, $pathB ] = [ pathB, pathA, $pathB, $pathA ];\r\n        }\r\n        if ( $pathA && $pathB ) {\r\n            return [ `${ $pathB }.`.startsWith( `${ $pathA }.` ), remainder, [] ];\r\n        }\r\n        let computes = [];\r\n        let getVal = element => ( typeof element === 'object' ? element.name : element );\r\n        let compareIdentifiers = ( a, b ) => {\r\n            if ( !a || !b ) return false;\r\n            let isComputeA = typeof a === 'object' && ( 'memoId' in a ),\r\n                isComputeB = typeof b === 'object' && ( 'memoId' in b );\r\n            if ( isComputeA || isComputeB ) {\r\n                computes.push( memo => {\r\n                    return ( isComputeA ? memo[ a.memoId ] : getVal( a ) ) === ( isComputeB ? memo[ b.memoId ] : getVal( b ) ) \r\n                } );\r\n                return true;\r\n            }\r\n            return getVal( a ) === getVal( b );\r\n        };\r\n        return [\r\n            pathA.reduce( ( prev, identifier, i ) => prev && compareIdentifiers( identifier, pathB[ i ] ), true ),\r\n            remainder,\r\n            computes,\r\n        ];\r\n    }\r\n\r\n    locate( contractUrl ) {\r\n        let ownLineage_ = this.graph.lineage + '/';\r\n        let contractUrl_ = contractUrl + '/';\r\n        if ( contractUrl_ === ownLineage_ ) return this;\r\n        if ( contractUrl_.startsWith( ownLineage_ ) ) {\r\n            let postLineage = contractUrl.slice( ownLineage_.length ).split( '/' );\r\n            let subContract = this.subContracts.get( parseInt( postLineage.shift() ) );\r\n            if ( postLineage.length) {\r\n                if ( subContract instanceof Map ) {\r\n                    return Array.from( subContract ).reduce( ( subContracts, [ key, _subContract ] ) => {\r\n                        return subContracts.concat( _subContract.locate( contractUrl ) );\r\n                    }, [] );\r\n                }\r\n                if ( subContract ) {\r\n                    return subContract.locate( contractUrl );\r\n                }\r\n            }\r\n            return subContract;\r\n        }\r\n        if ( this.ownerContract ) {\r\n            return this.ownerContract.locate( contractUrl );\r\n        }\r\n    }\r\n\r\n    compute( computes ) {\r\n        return !computes.some( compute => compute( this.contract.memo ) === false );\r\n    }\r\n\r\n    assert( condition ) {\r\n        if ( typeof condition === 'string' && condition.includes( ':' ) ) {\r\n            let [ contractUrl, _condition ] = condition.split( ':' );\r\n            return this.locate( contractUrl ).assert( _condition );\r\n        }\r\n        let conditionDef = this.graph.conditions[ condition ];\r\n        let memo = this.contract.memo;\r\n        if ( typeof conditionDef.parent !== 'undefined'  && !this.assert( conditionDef.parent ) ) return false;\r\n        if ( typeof conditionDef.switch !== 'undefined' ) {\r\n            return conditionDef.cases.some( _case => memo[ _case ] === memo[ conditionDef.switch ] );\r\n        }\r\n        if ( typeof conditionDef.whenNot !== 'undefined' ) {\r\n            return !memo[ conditionDef.whenNot ];\r\n        }\r\n        if ( typeof conditionDef.when !== 'undefined' ) {\r\n            return memo[ conditionDef.when ];\r\n        }\r\n        return true;\r\n    }\r\n\r\n    dispose() {\r\n        if ( this.params.isFunctionContract ) return;\r\n        this.subContracts.forEach( ( subContract, contractId ) => {\r\n            if ( subContract instanceof Map ) {\r\n                subContract.forEach( subContract => subContract.dispose() );\r\n                subContract.clear();\r\n            } else {\r\n                subContract.dispose();\r\n            }\r\n        } );\r\n        this.subContracts.clear();\r\n        delete this.ownerContract;\r\n        delete this.callee;\r\n        delete this.params;\r\n        delete this.contract.memo;\r\n        this.disposed = true;\r\n    }\r\n    \r\n    createFunction( createCallback, defaultThis = undefined ) {\r\n        let contract = createCallback();\r\n        // -------------\r\n        const execute = function( _contract, ...args ) {\r\n            let _returnValue = _contract.call( this === undefined ? defaultThis : this, ...args );\r\n            if ( _contract.params.isSubscriptFunction && _contract.params.apiVersion > 1 ) {\r\n                _returnValue = _await( _returnValue, __returnValue => [ __returnValue, _contract.thread.bind( _contract ), _contract ] );\r\n                // Replace global for next call\r\n                contract = createCallback( contract );\r\n            }\r\n            return _returnValue;\r\n        };\r\n        // -------------\r\n        const _function = ( contract instanceof Promise ) || ( contract.callee instanceof ( async function() {} ).constructor )\r\n            ? async function() { return _await( contract, _contract => execute.call( this, _contract, ...arguments ) ); } \r\n            : function() { return execute.call( this, contract, ...arguments ); };\r\n        // -------------\r\n        _await( contract, _contract => {\r\n            this.applyReflection( _function, _contract );\r\n        } );\r\n        // -------------\r\n        inspection( _function, 'properties', _await( contract, _contract => {\r\n            const graph = {\r\n                type: _contract.params.functionType || 'Program',\r\n                apiVersion: _contract.params.apiVersion || 1,\r\n                isSubscriptFunction: _contract.params.isSubscriptFunction,\r\n                sideEffects: _contract.graph.sideEffects || false,\r\n            };\r\n            if ( _contract.params.isSubscriptFunction ) {\r\n                graph.dependencies = [];\r\n                for ( const [ id, effect ] of Object.entries( _contract.graph.effects ) ) {\r\n                    graph.dependencies.push( ...effect.refs.map( ref => ref.path.map( s => !( 'name' in s ) ? Infinity : s.name ) ) );\r\n                }\r\n            }\r\n            return graph;\r\n        } ) );\r\n        // -------------\r\n        return _function;\r\n    }\r\n\r\n    applyReflection( _function, contract ) {\r\n        // Hide implementation details on callee\r\n        Object.defineProperty( contract.callee, 'length', { configurable: true, value: contract.callee.length - 1 } );\r\n        const compiledSourceNeat = contract.callee.toString()//.replace( /\\(\\$[\\w]+\\,([\\s]*)?/, '(' );\r\n        Object.defineProperty( contract.callee, 'toString', { configurable: true, value: ( compiledSource = false ) => {\r\n            if ( !compiledSource && contract.graph.originalSource ) { return contract.graph.originalSource; }\r\n            return compiledSourceNeat;\r\n        } } );\r\n        // Hide implementation details on main\r\n        let properties = {\r\n            name: contract.callee.name,\r\n            length: contract.callee.length,\r\n            toString: contract.callee.toString,\r\n        };\r\n        if ( contract.params.isSubscriptFunction ) {\r\n            if ( !( contract.params.apiVersion > 1 ) ) {\r\n                properties = {\r\n                    ...properties,\r\n                    thread: contract.thread.bind( contract ),\r\n                    dispose: contract.dispose.bind( contract ),\r\n                    runtime: contract,\r\n                };\r\n            }\r\n        }\r\n        Object.keys( properties ).forEach( name => {\r\n            Object.defineProperty( _function, name, { configurable: true, value: properties[ name ] } );\r\n        } );\r\n    }\r\n\r\n}\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport { _await } from '../util.js';\r\nimport Contract from './Contract.js';\r\nimport inspection from './inspect.js';\r\n\r\nexport default class Runtime extends Contract {\r\n\r\n    static create( compilation, parameters = [], runtimeParams = {} ) {\r\n        const isAsync = runtimeParams.async || compilation.graph.hoistedAwaitKeyword;\r\n        const _Function = isAsync ? Object.getPrototypeOf( async function() {} ).constructor : Function;\r\n        const callee = runtimeParams.compileFunction \r\n            ? runtimeParams.compileFunction( compilation.source, [ compilation.identifier + '' ].concat( parameters ) )\r\n            : new _Function( compilation.identifier + '', ...parameters, compilation.source );\r\n        return new this( null, compilation.graph, callee, runtimeParams );\r\n    }\r\n\r\n    static createFunction( sourceName, compilation, parameters = [], runtimeParams = {}, defaultThis, originalSource = null ) {\r\n        runtimeParams = { ...runtimeParams, functionType: 'Constructor', };\r\n        if ( compilation instanceof Promise ) { runtimeParams = { ...runtimeParams, async: true, }; }\r\n        const createCallback = contract => {\r\n            // Subsequent calls avoid recompilation\r\n            if ( contract ) { return new this( null, contract.graph, contract.callee, runtimeParams ); }\r\n            // Supports lazy compilation. So, input compilation may be a Promise\r\n            return _await( compilation, _compilation => applyReflection( this.create( _compilation, parameters, runtimeParams ) ) );\r\n        };\r\n        const applyReflection = contract => { \r\n            if ( contract.graph.originalSource && !contract.graph.originalSourceModified ) {\r\n                const ownSource = `${ runtimeParams.async || contract.graph.hoistedAwaitKeyword ? 'async ' : '' }function ${ sourceName || 'anonymous' }`;\r\n                const originalSourceIndented = contract.graph.originalSource.split(/\\n/g).map( line => `    ${ line }` ).join( `\\n` );\r\n                contract.graph.originalSource = `${ ownSource }(${ parameters.join( ', ' ) }) {\\n${ originalSourceIndented }\\n}`;\r\n                contract.graph.originalSourceModified = true;\r\n            }\r\n            if ( sourceName ) { Object.defineProperty( contract.callee, 'name', { configurable: true, value: sourceName } ); }\r\n            return contract;\r\n        };\r\n        const _function = this.prototype.createFunction( createCallback, defaultThis );\r\n        inspection( _function, 'locations', _await( compilation, _compilation => ( {\r\n            locations: _compilation.locations,\r\n        } ) ) );\r\n        return _function;\r\n    }\r\n\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport { resolveParams } from './params.js';\r\nimport { normalizeTabs } from './util.js';\r\nimport Runtime from './runtime/Runtime.js';\r\nimport inspect from './runtime/inspect.js';\r\n\r\n/**\r\n * @SubscriptFunctionLite\r\n */\r\nexport default function SubscriptFunctionLite( ...args ) {\r\n    if ( typeof window !== 'object' ) throw new Error( `No window in context.` );\r\n    // --------------------\r\n    const params = resolveParams( typeof args[ args.length - 1 ] === 'object' ? args.pop() : {} );\r\n    const source = normalizeTabs( args.pop() || '' );\r\n    const parameters = args;\r\n    const createFunction = compilation => Runtime.createFunction( undefined, compilation, parameters, params.runtimeParams, this, source );\r\n    // --------------------\r\n    // SubscriptCompiler has been loaded sync?\r\n    if ( window.wq?.SubscriptCompiler && !params.runtimeParams.async ) {\r\n        const { parse, compile } = window.wq.SubscriptCompiler;\r\n        const ast = parse( source, params.parserParams );\r\n        return createFunction( compile( ast, params.compilerParams ) );\r\n    }\r\n    // Load and run SubscriptCompiler async - in the background?\r\n    if ( !window.wq?.SubscriptCompilerWorker ) {\r\n        const customUrl = document.querySelector( 'meta[name=\"subscript-compiler-url\"]' );\r\n        const compilerUrl = customUrl?.content || `https://unpkg.com/@webqit/subscript/dist/compiler.js`;\r\n        const workerScriptText = `\r\n        importScripts( '${ compilerUrl }' );\r\n        const { parse, compile } = self.wq.SubscriptCompiler;\r\n        self.onmessage = e => {\r\n            const { source, params } = e.data;\r\n            const ast = parse( source, params.parserParams );\r\n            const compilation = compile( ast, params.compilerParams );\r\n            compilation.identifier = compilation.identifier.toString();\r\n            e.ports[ 0 ]?.postMessage( compilation );\r\n        };`;\r\n        window.wq = window.wq || {};\r\n        window.wq.SubscriptCompilerWorker = new Worker( `data:text/javascript;base64,${ btoa( workerScriptText ) }` );\r\n    }\r\n    return createFunction( new Promise( res => {\r\n        let messageChannel = new MessageChannel;\r\n        wq.SubscriptCompilerWorker.postMessage( { source, params }, [ messageChannel.port2 ] );\r\n        messageChannel.port1.onmessage = e => res( e.data );\r\n    } ) );\r\n}\r\n\r\n/**\r\n * @inspect\r\n */\r\nObject.defineProperty( SubscriptFunctionLite, 'inspect', { value: inspect } );\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport SubscriptFunctionLite from '@webqit/subscript/src/SubscriptFunctionLite.js';\r\nimport wqDom from '@webqit/dom';\r\n\r\n/**\r\n * @init\r\n * \r\n * @param Object $params\r\n */\r\nexport default function init( $params = {} ) {\r\n\tconst window = this, dom = wqDom.call( window );\r\n    // -------\r\n    const params = dom.meta( 'oohtml' ).copyWithDefaults( $params, {\r\n        retention: 'retain',\r\n        mimeType: '',\r\n    } );\r\n\tparams.scriptSelector = ( Array.isArray( params.mimeType ) ? params.mimeType : [ params.mimeType ] ).reduce( ( selector, mm ) => {\r\n        const qualifier = mm ? `[type=${ window.CSS.escape( mm ) }]` : '';\r\n        return selector.concat( `script${ qualifier }[scoped],script${ qualifier }[contract]` );\r\n    }, [] ).join( ',' );\r\n    // -------\r\n    realtime.call( this, params );\r\n}\r\n\r\n/**\r\n * Performs realtime capture of elements and builds their relationships.\r\n *\r\n * @param Object params\r\n *\r\n * @return Void\r\n */\r\nfunction realtime( params ) {\r\n\tconst window = this, { dom } = window.wq;\r\n    // ---\r\n    window.wq.transformCache = new Map;\r\n    window.wq.compileCache = [ new Map, new Map, ];\r\n    // ---\r\n    const handled = () => {};\r\n\tdom.realtime( window.document ).observe( params.scriptSelector, record => {\r\n        record.entrants.forEach( script => {\r\n            if ( 'contract' in script ) return handled( script );\r\n            Object.defineProperty( script, 'contract', { value: script.hasAttribute( 'contract' ) } ); \r\n            if ( 'scoped' in script ) return handled( script );\r\n            Object.defineProperty( script, 'scoped', { value: script.hasAttribute( 'scoped' ) } ); \r\n            // ---\r\n            const thisContext = script.scoped ? record.target : ( script.type === 'module' ? undefined : window );\r\n            compile.call( this, script, thisContext, params );\r\n        } );\r\n\t}, { subtree: true, timing: 'intercept', generation: 'entrants' } );\r\n    // ---\r\n    window.wq.exec = ( execHash ) => {\r\n        const exec = fromHash( execHash );\r\n        if ( !exec ) throw new Error( `Argument must be a valid exec hash.` );\r\n        const { script, compiledScript, thisContext } = exec;\r\n        if ( thisContext instanceof window.Element && script.scoped ) {\r\n            if ( !thisContext.scripts ) { Object.defineProperty( thisContext, 'scripts', { value: new Set } ); }\r\n            thisContext.scripts.add( script );\r\n        }\r\n        switch ( params.retention ) {\r\n            case 'dispose':\r\n                script.remove();\r\n                break;\r\n            case 'hidden':\r\n                script.textContent = `\"hidden\"`;\r\n                break;\r\n            default:\r\n                script.textContent = compiledScript.function.originalSource;\r\n        }\r\n        return execute.call( this, compiledScript, thisContext, script );\r\n    };\r\n}\r\n\r\n// ------------------\r\n// Script runner\r\nexport function execute( compiledScript, thisContext, script ) {\r\n    if ( !compiledScript.function ) throw new Error( `Input script must already be compiled!` );\r\n    // Execute...\r\n    const returnValue = compiledScript.function.call( thisContext );\r\n    if ( compiledScript.contract ) {\r\n        Object.defineProperty( script, 'rerender', { value: ( ...args ) => _await( returnValue, ( [ , rerender ] ) => rerender( ...args ) ) } );\r\n    }\r\n    // Observe,,,\r\n    const window = this, { dom } = window.wq;\r\n    if ( !( thisContext instanceof window.EventTarget ) ) return returnValue;\r\n    let changeHandler;\r\n    if ( script.contract ) {\r\n        changeHandler = e => { script.rerender( ( e.detail || { paths: [] } ).paths ); };\r\n        thisContext.addEventListener( 'namespacechange', changeHandler );\r\n        thisContext.addEventListener( 'statechange', changeHandler );\r\n    }\r\n    dom.realtime( window.document ).observe( thisContext, () => {\r\n        if ( script.contract ) {\r\n            thisContext.removeEventListener( 'namespacechange', changeHandler );\r\n            thisContext.removeEventListener( 'statechange', changeHandler );\r\n        }\r\n        thisContext.dispatchEvent( new window.CustomEvent( 'remove' ) );\r\n        thisContext.scripts.delete( script );\r\n    }, { subtree: true, timing: 'sync', generation: 'exits' } );\r\n    return script;\r\n}\r\n\r\n// ------------------\r\n// JAVASCRIPT::[SCOPED|CONTRACT]\r\nexport function compile( script, thisContext, params = {} ) {\r\n    const wq = this.wq, cache = wq.compileCache[ script.contract ? 0 : 1 ];\r\n    const sourceHash = toHash( script.textContent );\r\n    // Script instances are parsed only once\r\n    let source = script.textContent, compiledScript;\r\n    if ( !( compiledScript = cache.get( sourceHash ) ) ) {\r\n        // Are there \"import\" (and \"await\") statements? Then, we need to rewrite that\r\n        let imports = [], meta = {};\r\n        let targetKeywords = [];\r\n        if ( script.type === 'module' ) targetKeywords.push( 'import ' );\r\n        if ( script.type === 'module' && !script.contract ) targetKeywords.push( 'await ' );\r\n        if ( targetKeywords.length && ( new RegExp( targetKeywords.join( '|' ) ) ).test( source ) ) {\r\n            [ imports, source, meta ] = parse( source );\r\n            if ( imports.length ) {\r\n                source = `\\n\\t${ rewriteImportStmts( imports ).join( `\\n\\t` ) }\\n\\t${ source }\\n`;\r\n            }\r\n        }\r\n        // Let's obtain a material functions\r\n        let _Function;\r\n        if ( script.contract ) {\r\n            const parserParams = {\r\n                ...( params.parserParams || {} ),\r\n                allowReturnOutsideFunction: false,\r\n                allowAwaitOutsideFunction: script.type === 'module',\r\n                allowSuperOutsideMethod: false,\r\n            }\r\n            const runtimeParams = {\r\n                ...( params.runtimeParams || {} ),\r\n                async: script.type === 'module',\r\n                apiVersion: 2,\r\n            };\r\n            _Function = SubscriptFunctionLite( source, { ...params, parserParams, runtimeParams, } );\r\n        } else {\r\n            const isAsync = script.type === 'module'//meta.topLevelAwait || imports.length;\r\n            const _FunctionConstructor = isAsync ? Object.getPrototypeOf( async function() {} ).constructor : Function;\r\n            _Function = params.runtimeParams?.compileFunction \r\n                ? params.runtimeParams.compileFunction( source )\r\n                : new _FunctionConstructor( source );\r\n            Object.defineProperty( _Function, 'originalSource', { configurable: true, value: script.textContent } );\r\n        }\r\n        // Save material function to compile cache\r\n        compiledScript = Object.defineProperty( script.cloneNode(), 'function', { value: _Function } );\r\n        script.scoped && Object.defineProperty( compiledScript, 'scoped', Object.getOwnPropertyDescriptor( script, 'scoped') );\r\n        script.contract && Object.defineProperty( compiledScript, 'contract', Object.getOwnPropertyDescriptor( script, 'contract') );\r\n        cache.set( sourceHash, compiledScript );\r\n    }\r\n    const execHash = toHash( { script, compiledScript, thisContext } );\r\n    script.textContent = `wq.exec('${ execHash }');`;\r\n}\r\n\r\n// ------------------\r\n// Match import statements\r\n// and detect top-level await\r\nexport function parse( source ) {\r\n    const [ tokens, meta ] = tokenize( source, ( $tokens, event, char, meta, i, isLastChar ) => {\r\n        \r\n        if ( event === 'start-enclosure' && char === '{' && !meta.openAsync?.type && meta.openEnclosures.length === meta.openAsync?.scopeId ) {\r\n            meta.openAsync.type = 'block';\r\n        } else if ( event === 'end-enclosure' && char === '}' && meta.openAsync?.type === 'block' && meta.openEnclosures.length === meta.openAsync.scopeId ) {\r\n            meta.openAsync = null;\r\n        } else if ( event === 'start-quote' && !meta.openEnclosures.length && [ 'starting', 'from' ].includes( meta.openImport ) ) {\r\n            meta.openImport = 'url';\r\n        } else if ( event === 'end-quote' && meta.openImport === 'url' ) {\r\n            meta.openImport = 'closing';\r\n        } else if ( event === 'char' ) {\r\n\r\n            if ( meta.openImport === 'closing' && (\r\n                char === ';'/* explicit */ || ![ ' ', `\\n` ].includes( char )/* implicit */ || isLastChar\r\n            ) ) {\r\n                if ( char === ';' || isLastChar ) {\r\n                    $tokens[ 0 ] += char;\r\n                    $tokens.unshift( '' );\r\n                } else { $tokens.unshift( char ); }\r\n                meta.openImport = null;\r\n                return false;\r\n            }\r\n\r\n            let remainder = source.substring( i - 1 );\r\n\r\n            if ( !meta.openImport && /^[\\W]?import[ ]*[^\\(]/.test( remainder ) ) {\r\n                meta.openImport = 'starting';\r\n                $tokens.unshift( '' );\r\n                return 6;\r\n            }\r\n            if ( meta.openImport === 'starting' && /^[\\W]?from /.test( remainder ) ) {\r\n                meta.openImport = 'from';\r\n                return 4;\r\n            }\r\n            if ( !meta.openAsync ) {\r\n                if ( /^[\\W]?async /.test( remainder ) ) {\r\n                    meta.openAsync = { scopeId: meta.openEnclosures.length };\r\n                    return 5;\r\n                }\r\n                if ( /^[\\W]?await /.test( remainder ) ) {\r\n                    meta.topLevelAwait = true;\r\n                    return 5;\r\n                }\r\n            }\r\n            if ( meta.openAsync ) {\r\n                if ( !meta.openAsync.type && /.?\\=\\>[ ]*?\\{/.test( remainder ) ) {\r\n                    meta.openAsync.type = 'inline-arrow';\r\n                } else if ( meta.openAsync.type === 'inline-arrow' && [ `\\n`, ';' ].includes( char ) && meta.openEnclosures.length === meta.openAsync.scopeId ) {\r\n                    meta.openAsync = null;\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n    } );\r\n    // Hoist all import statements\r\n    let imports = [], body = '', _str;\r\n    for ( const str of tokens.reverse() ) {\r\n        if ( ( _str = str.trim() ).startsWith( 'import ' ) ) {\r\n            imports.push( str );\r\n        } else if ( _str ) { body += str; }\r\n    }\r\n\r\n    return [ imports, body, meta ];\r\n}\r\n\r\n// ------------------\r\n// Rewrite import statements\r\nexport function rewriteImportStmts( imports ) {\r\n    const importSpecs = [], importPromises = [];\r\n    imports.forEach( ( $import, i ) => {\r\n        $import = parseImportStmt( $import );\r\n        // Identify whole imports and individual imports\r\n        const [ wholeImport, individualImports ] = $import.items.reduce( ( [ whole, parts ], item ) => {\r\n            return item.id === '*' ? [ item.alias, parts ] : [ whole, parts.concat( item ) ];\r\n        }, [ null, [] ] );\r\n        if ( wholeImport ) {\r\n            // const main = await import(\"url\");\r\n            importSpecs.push( `const ${ wholeImport } = __$imports$__[${ i }];` );\r\n        }\r\n        if ( individualImports.length ) {\r\n            // const { aa: bb, cc } = await import(\"url\");\r\n            const individualImportsSpec = individualImports.map( item => `${ item.id }${ item.id !== item.alias ? `: ${ item.alias }` : '' }` ).join( ', ' );\r\n            importSpecs.push( `const { ${ individualImportsSpec } } = __$imports$__[${ i }];` );\r\n        }\r\n        importPromises.push( `import(\"${ $import.url }\")` );\r\n    } );\r\n    return [\r\n        `\\n\\tconst __$imports$__ = await Promise.all([\\n\\t\\t${ importPromises.join( `,\\n\\t\\t` ) }\\n\\t]);`,\r\n        importSpecs.join( `\\n\\t` ),\r\n    ];\r\n}\r\n\r\n// ------------------\r\n// Parse import statements\r\nexport function parseImportStmt( str ) {\r\n    const getUrl = str => {\r\n        let quo = /^[`'\"]/.exec( str );\r\n        return quo && str.substring( 1, str.lastIndexOf( quo[ 0 ] ) );\r\n    }\r\n    let $import = { items: [ { id: '' } ] }, _str = str.replace( 'import', '' ).trim();\r\n    if ( !( $import.url = getUrl( _str ) ) ) {\r\n        tokenize( _str, ( $tokens, event, char, meta, i, isLastChar ) => {\r\n            if ( [ 'start-quote', 'ongoing-quote', 'end-quote', 'char' ].includes( event ) ) {\r\n                if ( $import.url ) return;\r\n                if ( !meta.openQuote ) {\r\n                    let remainder = _str.substring( i );\r\n                    if ( char === ',' ) {\r\n                        $import.items.unshift( { id: '' } );\r\n                        return;\r\n                    }\r\n                    if ( remainder.startsWith( ' as ' ) ) {\r\n                        $import.items[ 0 ].alias = '';\r\n                        return 3;\r\n                    }\r\n                    if ( remainder.startsWith( ' from ' ) ) {\r\n                        $import.url = getUrl( remainder.replace( 'from', '' ).trim() );\r\n                        return remainder.length;\r\n                    }\r\n                }\r\n                if ( 'alias' in $import.items[ 0 ] ) {\r\n                    $import.items[ 0 ].alias += char;\r\n                } else {\r\n                    $import.items[ 0 ].id += char;\r\n                    if ( meta.openEnclosures.length ) {\r\n                        $import.items[ 0 ].enclosed = true;\r\n                    }\r\n                }\r\n            }\r\n        } );\r\n    }\r\n    $import.items = $import.items\r\n        .map( item => ( {\r\n            id: item.id && !item.alias && !item.enclosed ? 'default' : item.id.trim(),\r\n            alias: item.alias ? item.alias.trim() : item.id.trim(),\r\n        } ) )\r\n        .filter( item => item.id )\r\n        .reverse();\r\n    return $import;\r\n}\r\n\r\n// ------------------\r\n// Token JavaScript source\r\nexport function tokenize( source, _callback ) {\r\n    const lastI = source.length - 1;\r\n    return [ ...source ].reduce( ( [ $tokens, meta, skip ], char, i ) => {\r\n        \r\n        if ( skip ) {\r\n            $tokens[ 0 ] += char;\r\n            return [ $tokens, meta, --skip ];\r\n        }\r\n        let callbackReturn;\r\n\r\n        if ( meta.openQuote || meta.openComment ) {\r\n            if ( char === meta.openQuote ) {\r\n                meta.openQuote = null;\r\n                callbackReturn = _callback( $tokens, 'end-quote', char, meta, i, i === lastI );\r\n            } else if ( meta.openQuote ) {\r\n                callbackReturn = _callback( $tokens, 'ongoing-quote', char, meta, i, i === lastI );\r\n            } else if ( meta.openComment ) {\r\n                if ( ( meta.openComment === '//' && char === `\\n` ) || ( meta.openComment === '/*' && $tokens[ 0 ].substr( -1 ) === '*' && char === '/' ) ) {\r\n                    meta.openComment = null;\r\n                    callbackReturn = _callback( $tokens, 'end-comment', char, meta, i, i === lastI );\r\n                }\r\n            }\r\n            if ( callbackReturn !== false ) {\r\n                $tokens[ 0 ] += char;\r\n            }\r\n            return [ $tokens, meta, typeof callbackReturn === 'number' ? callbackReturn : skip ];\r\n        }\r\n\r\n        let enclosure;\r\n        if ( enclosure = [ '()', '{}', '[]' ].filter( pair => char === pair[ 0 ] )[ 0 ] ) {\r\n            callbackReturn = _callback( $tokens, 'start-enclosure', char, meta, i, i === lastI );\r\n            meta.openEnclosures.unshift( enclosure );\r\n        } else if ( meta.openEnclosures.length && char === meta.openEnclosures[ 0 ][ 1 ] ) {\r\n            meta.openEnclosures.shift();\r\n            callbackReturn = _callback( $tokens, 'end-enclosure', char, meta, i, i === lastI );\r\n        } else if ( [ '\"', \"'\", \"`\" ].includes( char ) ) {\r\n            callbackReturn = _callback( $tokens, 'start-quote', char, meta, i, i === lastI );\r\n            meta.openQuote = char;\r\n        } else if ( !meta.openComment && [ '/*', '//' ].includes( source.substr( i, 2 ) ) ) {\r\n            callbackReturn = _callback( $tokens, 'start-comment', char, meta, i, i === lastI );\r\n            meta.openComment = source.substr( i, 2 );\r\n        } else {\r\n            callbackReturn = _callback( $tokens, 'char', char, meta, i, i === lastI );\r\n        }\r\n\r\n        if ( callbackReturn !== false ) {\r\n            $tokens[ 0 ] += char;\r\n        }\r\n        return [ $tokens, meta, typeof callbackReturn === 'number' ? callbackReturn : skip ];\r\n\r\n    }, [ [ '' ], { openEnclosures: [], }, 0 ] );\r\n}\r\n\r\n// ------------------\r\n// Unique ID generator\r\nconst hashTable = new Map;\r\nconst uniqId = () => (0|Math.random()*9e6).toString(36);\r\nconst _await = ( value, callback ) => value instanceof Promise ? value.then( callback ) : callback( value );\r\n\r\n// ------------------\r\n// Hash of anything generator\r\nexport function toHash( val ) {\r\n    let hash;\r\n    if ( !( hash = hashTable.get( val ) ) ) {\r\n        hash = uniqId();\r\n        hashTable.set( val, hash );\r\n    }\r\n    return hash;\r\n}\r\n\r\n// ------------------\r\n// Value of any hash\r\nexport function fromHash( hash ) {\r\n    let val;\r\n    hashTable.forEach( ( _hash, _val ) => {\r\n        if ( _hash === hash ) val = _val;\r\n    } );\r\n    return val;\r\n}\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport Observer from '@webqit/observer';\r\nimport StateAPI from './state-api/index.js';\r\nimport ContextAPI from './context-api/index.js';\r\nimport HTMLModules from './html-modules/index.js';\r\nimport HTMLImports from './html-imports/index.js';\r\nimport NamespacedHTML from './namespaced-html/index.js';\r\nimport ScopedJS from './scoped-js/index.js';\r\n\r\n/**\r\n * @init\r\n */\r\nexport default function init( configs = {} ) {\r\n    if ( !this.wq ) { this.wq = {}; }\r\n    if ( this.wq.oohtml ) return;\r\n    this.wq.Observer = Observer;\r\n    // --------------\r\n    StateAPI.call(this, ( configs.StateAPI || {} ) );\r\n    ContextAPI.call( this, ( configs.ContextAPI || {} ) );\r\n    HTMLModules.call( this, ( configs.HTMLModules || {} ) );\r\n    HTMLImports.call( this, ( configs.HTMLImports || {} ) );\r\n    NamespacedHTML.call(this, ( configs.NamespacedHTML || {} ) );\r\n    ScopedJS.call( this, ( configs.ScopedJS || {} ) );\r\n    // --------------\r\n    this.wq.oohtml = {};\r\n}\r\n\r\n/**\r\n * @exports\r\n */\r\nexport { Observer }", "\r\n/**\r\n * @imports\r\n */\r\nimport init from './index.js';\r\n\r\n/**\r\n * @init\r\n */\r\ninit.call(window);"],
  "mappings": "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",
  "names": []
}
