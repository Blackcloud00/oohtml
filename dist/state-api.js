(()=>{var Ct=Object.defineProperty;var Ye=(e,t)=>{for(var n in t)Ct(e,n,{get:t[n],enumerable:!0})};function w(e){return!Array.isArray(e)&&typeof e=="object"&&e}function ce(e,...t){globalThis.WebQitInternalsRegistry||(globalThis.WebQitInternalsRegistry=new Map);var n=globalThis.WebQitInternalsRegistry.get(e);if(!n){if(n=new Map,t[0]===!1)return n;globalThis.WebQitInternalsRegistry.set(e,n)}for(var r,o;r=t.shift();)if((o=n)&&!(n=n.get(r))){if(n=new Map,t[0]===!1)return n;o.set(r,n)}return n}function _(e){return Array.isArray(e)}function Y(e){return typeof e=="function"}function te(e){return e===null||e===""}function R(e){return arguments.length&&(e===void 0||typeof e>"u")}function T(e){return Array.isArray(e)||typeof e=="object"&&e||Y(e)}function we(e){return te(e)||R(e)||e===!1||e===0||T(e)&&!Object.keys(e).length}function b(e){return Y(e)||e&&{}.toString.call(e)==="[object function]"}function re(e){return e instanceof Number||typeof e=="number"}function C(e){return re(e)||e!==!0&&e!==!1&&e!==null&&e!==""&&!isNaN(e*1)}function le(e){return e instanceof String||typeof e=="string"&&e!==null}function be(e){return!le(e)&&!R(e.length)}function me(e,...t){return t.forEach(n=>{e.indexOf(n)<0&&e.push(n)}),e}function ve(r,t){t=t||Object.prototype,t=t&&!_(t)?[t]:t;for(var n=[],r=r;r&&(!t||t.indexOf(r)<0)&&r.name!=="default";)n.push(r),r=r?Object.getPrototypeOf(r):null;return n}function Ae(e,t){var n=[];return ve(e,t).forEach(r=>{me(n,...Object.getOwnPropertyNames(r))}),n}function F(e,t,n=!1,r=!1,o=!1){var i=0,f=e.shift();if((C(f)||f===!0||f===!1)&&(i=f,f=e.shift()),!e.length)throw new Error("_merge() requires two or more array/objects.");return e.forEach((l,u)=>{!T(l)&&!b(l)||(n?Ae(l):Object.keys(l)).forEach(c=>{if(!!t(c,f,l,u)){var s=f[c],m=l[c];if((_(s)&&_(m)||w(s)&&w(m))&&(i===!0||i>0))f[c]=_(s)&&_(m)?[]:{},F([C(i)?i-1:i,f[c],s,m],t,n,r,o);else if(_(f)&&_(l))r?f[c]=m:f.push(m);else try{o?Object.defineProperty(f,c,Object.getOwnPropertyDescriptor(l,c)):f[c]=l[c]}catch{}}})}),f}function ne(...e){return F(e,(t,n,r)=>!0,!1,!1,!1)}function E(e,t=!0){return _(e)?e:!t&&w(e)?[e]:e!==!1&&e!==0&&we(e)?[]:be(e)?Array.prototype.slice.call(e):w(e)?Object.values(e):[e]}function W(e,t,n={},r={}){t=E(t).slice();for(var o=e;!R(o)&&!te(o)&&t.length;){var i=t.shift();if(!(n.get?n.get(o,i):T(o)?i in o:o[i])){r.exists=!1;return}o=n.get?n.get(o,i):o[i]}return r.exists=!0,o}function Ee(e,t,n,r={},o={}){let i=(s,m,h)=>o.set?o.set(s,m,h):(C(t[l])&&_(s)?s.push(h):s[m]=h,!0);t=E(t);for(var f=e,l=0;l<t.length;l++)if(l<t.length-1){if(!f||!T(f)&&!b(f))return!1;var u=W(f,t[l],o);if(!T(u)){if(o.buildTree===!1)return!1;u=b(o.buildTree)?o.buildTree(l):C(t[l+1])?[]:{};var c=i(f,t[l],u);if(!c)return!1}f=u}else return i(f,t[l],n)}var rt=e=>class{constructor(n=!0){Object.defineProperty(this,"window",{value:e}),Object.defineProperty(this,"readCallbacks",{value:new Set}),Object.defineProperty(this,"writeCallbacks",{value:new Set}),this.async=n,this.window.requestAnimationFrame?this._run():this.async=!1}_run(){this.window.requestAnimationFrame(()=>{this.readCallbacks.forEach(n=>{n()||this.readCallbacks.delete(n)}),this.writeCallbacks.forEach(n=>{n()||this.writeCallbacks.delete(n)}),this._run()})}onread(n,r=!1){if(r)return new Promise((o,i)=>{this.async===!1?n(o,i):this.readCallbacks.add(()=>{n(o,i)})});this.async===!1?n():this.readCallbacks.add(n)}onwrite(n,r=!1){if(r)return new Promise((o,i)=>{this.async===!1?n(o,i):this.writeCallbacks.add(()=>{n(o,i)})});this.async===!1?n():this.writeCallbacks.add(n)}cycle(n,r,o){this.onread(()=>{let i=n(o),f=l=>{l!==void 0&&this.onwrite(()=>{let u=r(l,o),c=s=>{s!==void 0&&this.cycle(n,r,s)};u instanceof Promise?u.then(c):c(u)})};i instanceof Promise?i.then(f):f(i)})}};var B=class{constructor(t,n,r){this.context=t,this.namespace=n,this.window=t.defaultView||t.ownerDocument?.defaultView||r,this.document=this.window.document,this.wq=this.window.wq,Object.defineProperty(this,"#",{value:{}})}resolveArgs(t){return b(t[0])?t=[[],...t]:w(t[0])&&t.length===1?t=[[],void 0,t[0]]:w(t[1])&&t.length===2?t=[E(t[0],!1),void 0,t[1]]:t[0]=E(t[0],!1),t}registry(...t){return ce(this.window,"dom.realtime",this.namespace,...t)}createSignalGenerator(){return{generate(){return this.lastController?.abort(),this.lastController=new AbortController,{signal:this.lastController.signal}},disconnect(){this.lastController?.abort()}}}forEachMatchingContext(t,n,r){let{window:o}=this,i=Array.isArray(n)?n:[n],f=new Set;for(let[l,u]of this.registry(t))for(let[c,s]of u){let m=i.filter(h=>c.contains(h.target)?l==="subtree"||h.target===c:!1);if(!!m.length){Array.isArray(n)||(m=m[0]);for(let h of s)f.add([h,m,c])}}for(let[l,u,c]of f)r.call(this,l,u,c)}disconnectables(t,...n){let r={disconnect(){n.forEach(o=>o&&b(o.disconnect)&&o.disconnect()||b(o)&&o()||w(o)&&(o.disconnected=!0))}};return t&&t.addEventListener("abort",()=>r.disconnect()),r}};var q=class extends B{constructor(t,...n){super(t,"attr",...n)}get(t,n=void 0,r={}){let o=typeof t=="string";[t=[],n=void 0,r={}]=this.resolveArgs(arguments);let{context:i}=this,f=ut(i,t),l=o?f[0]:f;if(!n)return l;let u=n&&r.lifecycleSignals&&this.createSignalGenerator(),c=u?.generate()||{};if(n(l,c,i),r.live){u&&(r={...r,signalGenerator:u});let s=this.observe(o?t[0]:t,n,{newValue:!0,...r});return this.disconnectables(r.signal,s)}}observe(t,n,r={}){let o=typeof t=="string";if([t=[],n,r={}]=this.resolveArgs(arguments),["sync","intercept"].includes(r.timing))return this.observeSync(o?t[0]:t,n,r);if(r.timing&&r.timing!=="async")throw new Error(`Timing option "${r.timing}" invalid.`);let{context:i,window:f,wq:l}=this;r.eventDetails&&!l.attrInterceptionHooks?.intercepting&&ft.call(f,"intercept",()=>{});let u=new f.MutationObserver(h=>{h=st(h).map(g=>ct.call(f,g)),it.call(f,m,h,i)}),c={attributes:!0,attributeOldValue:r.oldValue,subtree:r.subtree};t.length&&(c.attributeFilter=t),u.observe(i,c);let s=r.signalGenerator||r.lifecycleSignals&&this.createSignalGenerator(),m={context:i,filter:t,callback:n,params:r,atomics:new Map,originalFilterIsString:o,signalGenerator:s,disconnectable:u};return this.disconnectables(r.signal,u,s)}observeSync(t,n,r={}){let o=typeof t=="string";[t,n,r={}]=this.resolveArgs(arguments);let{context:i,window:f}=this;if(r.timing&&!["sync","intercept"].includes(r.timing))throw new Error(`Timing option "${r.timing}" invalid.`);let l=r.timing==="intercept"?"intercept":"sync",u=r.subtree?"subtree":"children";this.registry(l).size||ft.call(f,l,a=>{this.forEachMatchingContext(l,a,it)});let c={disconnect(){g.delete(m),g.size||h.delete(i)}},s=r.signalGenerator||r.lifecycleSignals&&this.createSignalGenerator(),m={context:i,filter:t,callback:n,params:r,atomics:new Map,originalFilterIsString:o,signalGenerator:s,disconnectable:c},h=this.registry(l,u);h.has(i)||h.set(i,new Set);let g=h.get(i);return g.add(m),this.disconnectables(r.signal,c,s)}};function st(e){return e.reduce((t,n,r)=>t[r-1]?.attributeName===n.attributeName?t:t.concat(n),[])}function it(e,t){let{context:n,filter:r,callback:o,params:i,atomics:f,originalFilterIsString:l,signalGenerator:u}=e;i.atomic&&!f.size&&(t=ut(n,r,t)),i.newValue===null&&i.oldValue===null||(t=t.map(m=>{let h;return!i.oldValue&&"oldValue"in m&&({oldValue:h,...m}=m),!i.newValue&&"value"in m?{value:h,...m}=m:i.newValue&&typeof m.value>"u"&&(m={...m,value:m.target.getAttribute(m.name)}),m})),i.atomic&&(t.forEach(m=>f.set(m.name,m)),t=Array.from(f.entries()).map(([,m])=>m));let c=l?t[0]:t,s=u?.generate()||{};o(c,s,n)}function ut(e,t,n=[]){let r={event:null,type:"attribute"};return t.length?t.map(i=>n.find(f=>f.name===i)||{target:e,name:i,value:e.getAttribute(i),...r}):Array.from(e.attributes).map(i=>n.find(f=>f.name===i.nodeName)||{target:e,name:i.nodeName,value:i.nodeValue,...r})}function ct({target:e,attributeName:t,value:n,oldValue:r}){let f=(this.wq.attrInterceptionRecords?.get(e)||{})[t]||"mutation";return{target:e,name:t,value:n,oldValue:r,type:"observation",event:f}}function ft(e,t){let n=this,{wq:r,document:o,Element:i}=n;r.attrInterceptionHooks||(r.attrInterceptionHooks=new Map),r.attrInterceptionHooks.has(e)||r.attrInterceptionHooks.set(e,new Set),r.attrInterceptionHooks.get(e).add(t);let f=()=>r.attrInterceptionHooks.get(e).delete(t);if(r.attrInterceptionHooks?.intercepting)return f;console.warn("Attr mutation APIs are now being intercepted."),r.attrInterceptionHooks.intercepting=!0,r.attrInterceptionRecords=new Map;let l=(s,m)=>{r.attrInterceptionRecords.has(s.target)||r.attrInterceptionRecords.set(s.target,{});let h=r.attrInterceptionRecords.get(s.target);clearTimeout(h[s.name]?.timeout),h[s.name]=s.event;let g=setTimeout(()=>{delete h[s.name]},0);Object.defineProperty(s.event,"timeout",{value:g,configurable:!0}),r.attrInterceptionHooks.get("intercept")?.forEach(d=>d([s]));let a=m();return r.attrInterceptionHooks.get("sync")?.forEach(d=>d([s])),a};new n.MutationObserver(s=>{s=st(s).map(m=>ct.call(n,m)).filter((m,h)=>!Array.isArray(m.event)),s.length&&(r.attrInterceptionHooks.get("intercept")?.forEach(m=>m(s)),r.attrInterceptionHooks.get("sync")?.forEach(m=>m(s)))}).observe(o,{attributes:!0,subtree:!0,attributeOldValue:!0});let c=Object.create(null);return["setAttribute","removeAttribute","toggleAttribute"].forEach(s=>{c[s]=i.prototype[s],i.prototype[s]=function(...m){let h,g=this.getAttribute(m[0]);["setAttribute","toggleAttribute"].includes(s)&&(h=m[1]),s==="toggleAttribute"&&h===void 0&&(h=g===null);let a={target:this,name:m[0],value:h,oldValue:g,type:"interception",event:[this,s]};return l(a,()=>c[s].call(this,...m))}}),f}var Z=class extends B{constructor(t,...n){super(t,"tree",...n)}attr(t,n=void 0,r={}){let{context:o,window:i}=this;return new q(o,i).get(...arguments)}query(t,n=void 0,r={}){[t,n=void 0,r={}]=this.resolveArgs(arguments);let{context:o}=this,i=new Map,f=c=>(i.has(c)||i.set(c,{target:c,entrants:[],exits:[],type:"query",event:null}),i.get(c));if((!r.generation||r.generation==="entrants")&&(t.length?t.every(c=>typeof c=="string")&&(t=t.join(","))&&(r.subtree?o.querySelectorAll(t):[...o.children].filter(s=>s.matches(t))).forEach(s=>f(s.parentNode||o).entrants.push(s)):[...o.children].forEach(c=>f(o).entrants.push(c))),!n)return i;let l={disconnected:!1},u=n&&r.lifecycleSignals&&this.createSignalGenerator();for(let[,c]of i){if(l.disconnected)break;let s=u?.generate()||{};n(c,s,o)}if(r.live){u&&(r={...r,signalGenerator:u});let c=this.observe(t,n,r);return this.disconnectables(r.signal,l,c)}return this.disconnectables(r.signal,l,u)}children(t,n=void 0,r={}){return[t,n=void 0,r={}]=this.resolveArgs(arguments),this.query(t,n,{...r,subtree:!1})}subtree(t,n=void 0,r={}){return[t,n=void 0,r={}]=this.resolveArgs(arguments),this.query(t,n,{...r,subtree:!0})}observe(t,n,r={}){if([t,n,r={}]=this.resolveArgs(arguments),["sync","intercept"].includes(r.timing))return this.observeSync(t,n,r);if(r.timing&&r.timing!=="async")throw new Error(`Timing option "${r.timing}" invalid.`);let{context:o,window:i,wq:f,document:l}=this;r.eventDetails&&(f.domInterceptionRecordsAlwaysOn=!0),(l.readyState==="loading"||f.domInterceptionRecordsAlwaysOn)&&!f.domInterceptionHooks?.intercepting&&at.call(i,"sync",()=>{});let u=new i.MutationObserver(m=>m.forEach(h=>{mt.call(i,s,pt.call(i,h),o)}));u.observe(o,{childList:!0,subtree:r.subtree});let c=r.signalGenerator||r.lifecycleSignals&&this.createSignalGenerator(),s={context:o,selectors:t,callback:n,params:r,signalGenerator:c,disconnectable:u};if(r.staticSensitivity){let m=lt.call(i,s);return this.disconnectables(r.signal,u,c,m)}return this.disconnectables(r.signal,u,c)}observeSync(t,n,r={}){[t,n,r={}]=this.resolveArgs(arguments);let{context:o,window:i}=this;if(r.timing&&!["sync","intercept"].includes(r.timing))throw new Error(`Timing option "${r.timing}" invalid.`);let f=r.timing==="intercept"?"intercept":"sync",l=r.subtree?"subtree":"children";this.registry(f).size||at.call(i,f,g=>{this.forEachMatchingContext(f,g,mt)});let u={disconnect(){h.delete(s),h.size||m.delete(o)}},c=r.signalGenerator||r.lifecycleSignals&&this.createSignalGenerator(),s={context:o,selectors:t,callback:n,params:r,signalGenerator:c,disconnectable:u},m=this.registry(f,l);m.has(o)||m.set(o,new Set);let h=m.get(o);if(h.add(s),r.staticSensitivity){let g=lt.call(i,s);return this.disconnectables(r.signal,u,c,g)}return this.disconnectables(r.signal,u,c)}};function lt(e){let t=this,{context:n,selectors:r,callback:o,params:i,signalGenerator:f}=e,l=s=>[...s.matchAll(/\[([^\=\]]+)(\=[^\]]+)?\]/g)].map(m=>m[1]);if(!(e.$attrs=r.filter(s=>typeof s=="string"&&s.includes("[")).reduce((s,m)=>s.concat(l(m)),[])).length)return;let u=new Set,c=new Set;return u.push=s=>(c.delete(s),u.add(s)),c.push=s=>(u.delete(s),c.add(s)),e.$deliveryCache={entrants:u,exits:c},new q(n,t).observe(e.$attrs,s=>{let m=new Map,h=d=>(m.has(d)||m.set(d,{target:d,entrants:[],exits:[],type:"static",event:null}),m.get(d)),g=new WeakMap,a=d=>(g.has(d)||g.set(d,r.some(p=>d.matches(p))),g.get(d));for(let d of s)["entrants","exits"].forEach(p=>{i.generation&&p!==i.generation||e.$deliveryCache[p].has(d.target)||(p==="entrants"?!a(d.target):a(d.target))||(e.$deliveryCache[p].push(d.target),h(d.target)[p].push(d.target),h(d.target).event=d.event)});for(let[,d]of m){let p=f?.generate()||{};o(d,p,n)}},{subtree:i.subtree,timing:i.timing,eventDetails:i.eventDetails})}function mt(e,t){let{context:n,selectors:r,callback:o,params:i,signalGenerator:f,$deliveryCache:l}=e,u={...t,entrants:[],exits:[]};if(["entrants","exits"].forEach(s=>{if(!(i.generation&&s!==i.generation)&&(r.length?u[s]=Vt(r,t[s],t.event!=="parse"):u[s]=[...t[s]],!!l))for(let m of u[s])l[s].push(m)}),!u.entrants.length&&!u.exits.length)return;let c=f?.generate()||{};o(u,c,n)}function Vt(e,t,n){t=Array.isArray(t)?t:[...t];let r=(o,i)=>{if(o=o.filter(f=>f.matches),typeof i=="string"){let f=o.filter(l=>l.matches(i));if(n&&(f=o.reduce((l,u)=>[...l,...u.querySelectorAll(i)],f)),f.length)return f}else if(o.includes(i)||n&&o.some(f=>f.contains(i)))return[i]};return t.$$searchCache||(t.$$searchCache=new Map),e.reduce((o,i)=>{let f;return t.$$searchCache.has(i)?f=t.$$searchCache.get(i):(f=r(t,i)||[],w(i)&&t.$$searchCache.set(i,f)),o.concat(f)},[])}function pt({target:e,addedNodes:t,removedNodes:n}){let r=this,o;return o=E(t).reduce((i,f)=>i||r.wq.domInterceptionRecords?.get(f),null),o=E(n).reduce((i,f)=>i||r.wq.domInterceptionRecords?.get(f),o),o=o||r.document.readyState==="loading"&&"parse"||"mutation",{target:e,entrants:t,exits:n,type:"observation",event:o}}function at(e,t){let n=this,{wq:r,document:o,Node:i,Element:f,HTMLElement:l,HTMLTemplateElement:u,DocumentFragment:c}=n;r.domInterceptionHooks||(r.domInterceptionHooks=new Map),r.domInterceptionHooks.has(e)||r.domInterceptionHooks.set(e,new Set),r.domInterceptionHooks.get(e).add(t);let s=()=>r.domInterceptionHooks.get(e).delete(t);if(r.domInterceptionHooks?.intercepting)return s;console.warn("DOM mutation APIs are now being intercepted."),r.domInterceptionHooks.intercepting=!0,r.domInterceptionRecords=new Map;let m=()=>!0,h=(a,d)=>{m()?a.entrants.concat(a.exits).forEach(y=>{clearTimeout(r.domInterceptionRecords.get(y)?.timeout),r.domInterceptionRecords.set(y,a.event);let x=setTimeout(()=>{r.domInterceptionRecords.delete(y)},0);Object.defineProperty(a.event,"timeout",{value:x,configurable:!0})}):r.domInterceptionRecords.clear(),r.domInterceptionHooks.get("intercept")?.forEach(y=>y(a));let p=d();return r.domInterceptionHooks.get("sync")?.forEach(y=>y(a)),p};if(m()){let a=new n.MutationObserver(d=>d.forEach(p=>{Array.isArray((p=pt.call(n,p)).event)||(r.domInterceptionHooks.get("intercept")?.forEach(y=>y(p)),r.domInterceptionHooks.get("sync")?.forEach(y=>y(p)))}));a.observe(o,{childList:!0,subtree:!0}),o.addEventListener("readystatechange",()=>!m()&&a.disconnect())}let g=Object.create(null);return["insertBefore","insertAdjacentElement","insertAdjacentHTML","setHTML","replaceChildren","replaceWith","remove","replaceChild","removeChild","before","after","append","prepend","appendChild"].forEach(a=>{let d=["insertBefore","replaceChild","removeChild","appendChild"].includes(a)?i:f;g[a]=d.prototype[a],g[a]&&(d.prototype[a]=function(...p){let y=()=>g[a].call(this,...p);if(!(this instanceof f||this instanceof c))return y();let x=[],O=[],v=this;["insertBefore"].includes(a)?O=[p[0]]:["insertAdjacentElement","insertAdjacentHTML"].includes(a)?(O=[p[1]],["beforebegin","afterend"].includes(p[0])&&(v=this.parentNode)):["setHTML","replaceChildren"].includes(a)?(x=[...this.childNodes],O=a==="replaceChildren"?[...p]:[p[0]]):["replaceWith","remove"].includes(a)?(x=[this],O=a==="replaceWith"?[...p]:[],v=this.parentNode):["replaceChild"].includes(a)?(x=[p[1]],O=[p[0]]):["removeChild"].includes(a)?x=[...p]:(O=[...p],["before","after"].includes(a)&&(v=this.parentNode));let X=a;if(["insertAdjacentHTML","setHTML"].includes(a)){let H=this.nodeName;if(a==="insertAdjacentHTML"&&["beforebegin","afterend"].includes(p[0])){if(!this.parentNode)return g[a].call(this,...p);H=this.parentNode.nodeName}let ue=o.createElement(H);g.setHTML.call(ue,O[0],a==="setHTML"?p[1]:{}),O=[...ue.childNodes],a==="insertAdjacentHTML"?(X="insertAdjacentElement",p[1]=new c,p[1].______isTemp=!0,p[1].append(...ue.childNodes)):(X="replaceChildren",p=[...ue.childNodes])}return h({target:v,entrants:O,exits:x,type:"interception",event:[this,a]},()=>g[X].call(this,...p))})}),["outerHTML","outerText","innerHTML","innerText","textContent","nodeValue"].forEach(a=>{let d=["textContent","nodeValue"].includes(a)?i:["outerText","innerText"].includes(a)?l:f;g[a]=Object.getOwnPropertyDescriptor(d.prototype,a),Object.defineProperty(d.prototype,a,{...g[a],set:function(p){let y=()=>g[a].set.call(this,p);if(!(this instanceof f))return y();let x=[],O=[],v=this;if(["outerHTML","outerText"].includes(a)?(x=[this],v=this.parentNode):x=[...this.childNodes],["outerHTML","innerHTML"].includes(a)){let se=this.nodeName;if(a==="outerHTML"){if(!this.parentNode)return y();se=this.parentNode.nodeName}let H=o.createElement(se==="TEMPLATE"?"div":se);g[a].set.call(H,p),O=this instanceof u?[]:[...H.childNodes],a==="outerHTML"?(p=new c,p.______isTemp=!0,p.append(...H.childNodes),y=()=>g.replaceWith.call(this,p)):this instanceof u?y=()=>this.content.replaceChildren(...H.childNodes):y=()=>g.replaceChildren.call(this,...H.childNodes)}return h({target:v,entrants:O,exits:x,type:"interception",event:[this,a]},y)}})}),["append","prepend","replaceChildren"].forEach(a=>{[o,c.prototype].forEach(d=>{let p=d[a];d[a]=function(...y){if(this.______isTemp)return p.call(this,...y);let x=a==="replaceChildren"?[...this.childNodes]:[];return h({target:this,entrants:y,exits:x,type:"interception",event:[this,a]},()=>p.call(this,...y))}})}),s}function dt(){zt.call(this),Ut.call(this),Gt.call(this)}function zt(){let e=this;e.CSS||(e.CSS={}),e.CSS.escape||(e.CSS.escape=t=>t.replace(/([\:@\~\$\&])/g,"\\$1"))}function Ut(){let e=this;"isConnected"in e.Node.prototype||Object.defineProperty(e.Node.prototype,"isConnected",{get:function(){return!this.ownerDocument||!(this.ownerDocument.compareDocumentPosition(this)&this.DOCUMENT_POSITION_DISCONNECTED)}})}function Gt(){let e=this;e.Element.prototype.matches||(e.Element.prototype.matches=e.Element.prototype.matchesSelector||e.Element.prototype.mozMatchesSelector||e.Element.prototype.msMatchesSelector||e.Element.prototype.oMatchesSelector||e.Element.prototype.webkitMatchesSelector||function(t){for(var n=(this.document||this.ownerDocument).querySelectorAll(t),r=n.length;--r>=0&&n.item(r)!==this;);return r>-1})}function ht(){let e=this;if(e.wq||(e.wq={}),e.wq.dom)return e.wq.dom;e.wq.dom={},dt.call(e);let t=rt(e);return e.wq.dom.Reflow=new t,e.wq.dom.DOMRealtime=Z,e.wq.dom.AttrRealtime=q,e.wq.dom.realtime=(n,r="tree")=>{if(r==="tree")return new Z(n,e);if(r==="attr")return new q(n,e)},e.wq.dom.ready=Qt.bind(e),e.wq.dom.meta=kt.bind(e),e.wq.dom}function Qt(e){let t=this;t.document.readyState==="complete"?e(t):(t.document.domReadyCallbacks||(t.document.domReadyCallbacks=[],t.document.addEventListener("DOMContentLoaded",()=>{t.document.domReadyCallbacks.splice(0).forEach(n=>n(t))},!1)),t.document.domReadyCallbacks.push(e))}function kt(e,t=!1){let n=this,r={content:{}};return!(r.el=n.document.querySelector(`meta[name="${e}"]`))&&t&&(r.el=n.document.createElement("meta"),r.el.setAttribute("name",e),n.document.head.append(r.el)),r.el&&(r.content=(r.el.getAttribute("content")||"").split(";").filter(o=>o).reduce((o,i)=>{let f=i.split("=").map(l=>l.trim());return Ee(o,f[0].split("."),f[1]==="true"?!0:f[1]==="false"?!1:C(f[1])?parseInt(f[1]):f[1]),o},{})),r.get=function(o){return JSON.parse(JSON.stringify(W(this.content,o.split("."))))},r.copy=function(){return JSON.parse(JSON.stringify(this.content))},r.copyWithDefaults=function(...o){return o.length?ne(!0,{},...o.reverse().concat(this.content)):this.copy()},r}var Ue={};Ye(Ue,{apply:()=>$e,construct:()=>Be,deep:()=>ar,defineProperties:()=>gr,defineProperty:()=>De,deleteProperty:()=>We,get:()=>Q,getOwnPropertyDescriptor:()=>qe,getOwnPropertyDescriptors:()=>hr,getPrototypeOf:()=>Le,has:()=>ge,intercept:()=>dr,isExtensible:()=>He,observe:()=>pr,ownKeys:()=>he,preventExtensions:()=>ze,set:()=>ee,setPrototypeOf:()=>Ve});function A(e){return!Array.isArray(e)&&typeof e=="object"&&e}function K(e){return typeof e}function P(e,...t){globalThis.WebQitInternalsRegistry||(globalThis.WebQitInternalsRegistry=new Map);var n=globalThis.WebQitInternalsRegistry.get(e);if(!n){if(n=new Map,t[0]===!1)return n;globalThis.WebQitInternalsRegistry.set(e,n)}for(var r,o;r=t.shift();)if((o=n)&&!(n=n.get(r))){if(n=new Map,t[0]===!1)return n;o.set(r,n)}return n}function I(e){return Array.isArray(e)}function $(e){return typeof e=="function"}function Ce(e){return $(e)&&/^class\s?/.test(Function.prototype.toString.call(e))}function Se(e){return e===null||e===""}function V(e){return arguments.length&&(e===void 0||typeof e>"u")}function S(e){return Array.isArray(e)||typeof e=="object"&&e||$(e)}function Ie(e){return Se(e)||V(e)||e===!1||e===0||S(e)&&!Object.keys(e).length}function j(e){return $(e)||e&&{}.toString.call(e)==="[object function]"}function pe(e){return e instanceof String||typeof e=="string"&&e!==null}function je(e){return!pe(e)&&!V(e.length)}function D(e,t=!0){return I(e)?e:!t&&A(e)?[e]:e!==!1&&e!==0&&Ie(e)?[]:je(e)?Array.prototype.slice.call(e):A(e)?Object.values(e):[e]}var z=class{constructor(t,n){this.registry=t,Object.assign(this,{...n,target:t.target}),this.params.signal&&this.params.signal.addEventListener("abort",()=>this.remove())}remove(){return this.removed=!0,this.registry.removeRegistration(this)}};var oe=class extends z{constructor(){super(...arguments),Object.defineProperty(this,"abortController",{value:new AbortController}),Object.defineProperty(this,"signal",{value:this.abortController.signal})}remove(){this.abortController.abort(),super.remove()}fire(t){let n=t,r=this.filter;if(r!==1/0&&(r=D(r))&&(n=t.filter(o=>r.includes(o.key))),n.length)return this.filter===1/0||Array.isArray(this.filter)?this.handler(n,this):this.handler(n[0],this)}};var U=class{constructor(t){this.target=t,this.entries=[]}addRegistration(t){return this.entries.push(t),t}removeRegistration(t){this.entries=this.entries.filter(n=>n!==t)}static _getInstance(t,n,r=!0,o=this.__namespace){if(!S(n))throw new Error(`Subject must be of type object; "${K(n)}" given!`);let i=this;return o&&globalThis.WebQitObserverNamespaceRegistry.has(t+"-"+o)&&(i=globalThis.WebQitObserverNamespaceRegistry.get(t+"-"+o),t+="-"+o),!P(n,"observerApi").has(t)&&r&&P(n,"observerApi").set(t,new i(n)),P(n,"observerApi").get(t)}static _namespace(t,n,r=null){if(t+="-"+n,arguments.length===2)return globalThis.WebQitObserverNamespaceRegistry.get(t);if(!(r.prototype instanceof this))throw new Error(`The implementation of the namespace ${this.name}.${n} must be a subclass of ${this.name}.`);globalThis.WebQitObserverNamespaceRegistry.set(t,r),r.__namespace=n}};globalThis.WebQitObserverNamespaceRegistry||(globalThis.WebQitObserverNamespaceRegistry=new Map);var G=class extends U{static getInstance(t,n=!0,r=null){return super._getInstance("listeners",...arguments)}static namespace(t,n=null){return super._namespace("listeners",...arguments)}addRegistration(t,n,r){return super.addRegistration(new oe(this,{filter:t,handler:n,params:r}))}emit(t){this.entries.forEach(n=>n.fire(t))}};var ie=class extends z{exec(t,n,r){return this.running||!this.traps[t.type]?n(...Array.prototype.slice.call(arguments,2)):(this.running=!0,this.traps[t.type](t,r,(...o)=>(this.running=!1,n(...o))))}};var L=class extends U{static getInstance(t,n=!0,r=null){return super._getInstance("traps",...arguments)}static namespace(t,n=null){return super._namespace("traps",...arguments)}addRegistration(t){return super.addRegistration(new ie(this,t))}emit(t,n=null){let r=this;return function o(i,...f){let l=r.entries[i];return l?l.exec(t,(...u)=>o(i+1,...u),...f):n?n(t,...f):f[0]}(0)}};var M=class{constructor(t,n){if(this.target=t,!n.type)throw new Error("Descriptor type must be given in definition!");Object.assign(this,n)}};var Re={};Ye(Re,{accessorize:()=>cr,proxy:()=>mr,unaccessorize:()=>lr,unproxy:()=>de});function cr(e,t,n={}){e=Ne(e);let r=P(e,"accessorizedProps");function o(u){let c,s=e;for(;!c&&(s=Object.getPrototypeOf(s));)c=Object.getOwnPropertyDescriptor(s,u);return c?{proto:s,descriptor:c}:{descriptor:{value:void 0}}}function i(u){if(r.has(u))return!0;let c=o(u);c.getValue=function(){return"get"in this.descriptor?this.descriptor.get():this.descriptor.value},c.setValue=function(g){return"set"in this.descriptor?this.descriptor.set(g):this.descriptor.value=g},c.intact=function(){let g=Object.getOwnPropertyDescriptor(e,u);return g.get===h.get&&g.set===h.set&&r.get(u)===this},c.restore=function(){return this.intact()?(this.proto!==e?delete e[u]:Object.defineProperty(e,u,this.descriptor),r.delete(u),!0):!1},r.set(u,c);let{enumerable:s=!0,configurable:m=!0}=c.descriptor,h={enumerable:s,configurable:m};["value","set"].some(g=>g in c.descriptor)&&(h.set=function(g){return ee(this,u,g,n)}),["value","get"].some(g=>g in c.descriptor)&&(h.get=function(){return Q(this,u,n)});try{return Object.defineProperty(e,u,h),!0}catch{return r.delete(u),!1}}let l=(Array.isArray(t)?t:t===void 0?Object.keys(e):[t]).map(i);return t===void 0||Array.isArray(t)?l:l[0]}function lr(e,t,n={}){e=Ne(e);let r=P(e,"accessorizedProps");function o(l){return r.has(l)?r.get(l).restore():!0}let f=(Array.isArray(t)?t:t===void 0?Object.keys(e):[t]).map(o);return t===void 0||Array.isArray(t)?f:f[0]}function mr(e,t={}){e=Ne(e);let n=new Proxy(e,{apply:(r,o,i)=>$e(r,o,i,t),construct:(r,o,i=null)=>Be(r,o,i,t),defineProperty:(r,o,i)=>De(r,o,i,t),deleteProperty:(r,o)=>We(r,o,t),get:(r,o,i=null)=>{let f=Q(r,o,{...t,receiver:i});return t.proxyAutoBinding!==!1&&j(f)&&!Ce(f)?f.bind(n):f},getOwnPropertyDescriptor:(r,o)=>qe(r,o,t),getPrototypeOf:r=>Le(r,t),has:(r,o)=>ge(r,o,t),isExtensible:r=>He(r,t),ownKeys:r=>he(r,t),preventExtensions:r=>ze(r,t),set:(r,o,i,f=null)=>ee(r,o,i,{...t,receiver:f}),setPrototypeOf:(r,o)=>Ve(r,o,t)});return P(n).set(n,e),n}function de(e){return P(e,!1).get(e)||e}function Ne(e){if(!e||!S(e))throw new Error("Target must be of type object!");return de(e)}function ar(e,t,n,r=i=>i,o={}){return function i(f,l,u){let c=l[u.level];return u.level<l.length-1?u={...u,preflight:!0}:u={...u,preflight:o.preflight},n(f,c,(s,...m)=>{let h=(d={})=>({...u,...d,level:u.level+1}),g=d=>{d instanceof M&&(d.path=[d.key],f instanceof M&&(d.path=f.path.concat(d.key),d.context=f))};if(ye(c)&&Array.isArray(s))return s.forEach(g),u.level===l.length-1||!s.length&&u.midwayResults?r(s,...m):s.map(d=>i(d,l,h(...m)));g(s);let a=S(k(s,!1));return u.level===l.length-1||!a&&u.midwayResults?r(s,...m):a&&i(s,l,h(...m))},u)}(e,t.slice(0),{...o,level:0})}function pr(e,t,n,r={}){if(e=k(e),j(arguments[1])&&([,n,r={}]=arguments,t=1/0),!j(n))throw new Error(`Handler must be a function; "${K(n)}" given!`);let o=wt(e,t,n,r);return r.preflight?(r={...r,descripted:!0},delete r.live,Q(e,t,o,r)):o()}function dr(e,t,n={}){return e=k(e),A(t)||([,,,n={}]=arguments,t={[arguments[1]]:arguments[2]}),L.getInstance(e,!0,n.namespace).addRegistration({traps:t,params:n})}function qe(e,t,n=o=>o,r={}){return N(e,"getOwnPropertyDescriptor",{key:t},n,r)}function hr(e,t,n=o=>o,r={}){return N(e,"getOwnPropertyDescriptors",{key:t},n,r)}function Le(e,t=r=>r,n={}){return N(e,"getPrototypeOf",{},t,n)}function He(e,t=r=>r,n={}){return N(e,"isExtensible",{},t,n)}function he(e,t=r=>r,n={}){return N(e,"ownKeys",{},t,n)}function ge(e,t,n=o=>o,r={}){return N(e,"has",{key:t},n,r)}function Q(e,t,n=o=>o,r={}){let o;return e=k(e),A(n)?[r,n]=[n,i=>i]:r.live&&(o=!0),yr(e,t,i=>{let f=[...i];return function l(u,c,s){if(!c.length)return s(u);let m=c.shift();function h(d,p=void 0){let y=v=>(d.value=v,l(u.concat(r.live||r.descripted?d:v),c,s));if(arguments.length>1)return y(p);let x=P(e,"accessorizedProps",!1),O=x&&x.get(d.key);return O&&O.intact()?y(O.getValue()):y(Reflect.get(e,d.key,...r.receiver?[r.receiver]:[]))}let g=new M(e,{type:"get",key:m,value:void 0,related:f}),a=L.getInstance(e,!1,r.namespace);return a?a.emit(g,h):h(g)}([],i.slice(0),l=>{let u=ye(t)?l:l[0];return o?wt(e,t,n,r)(u):n(u)})})}function ee(e,t,n,r=f=>f,o={},i=!1){e=k(e);let f=[[t,n]];A(t)&&([,,r=u=>u,o={},i=!1]=arguments,f=Object.entries(t)),A(r)&&([i,o,r]=[typeof o=="boolean"?o:!1,r,u=>u]);let l=f.map(([u])=>u);return function u(c,s,m){if(!s.length)return m(c);let[h,g]=s.shift();function a(p,y=void 0){let x=X=>(p.status=X,u(c.concat(p),s,m));if(arguments.length>1)return x(p,y);let O=P(e,"accessorizedProps",!1),v=O&&O.get(p.key);return p.type==="defineProperty"?(v&&!v.restore()&&x(!1),Object.defineProperty(e,p.key,p.value),x(!0)):v&&v.intact()?x(v.setValue(p.value)):x(Reflect.set(e,p.key,p.value))}function d(p,y){let x=new M(e,{type:i?"defineProperty":"set",key:h,value:g,isUpdate:p,oldValue:y,related:[...l],detail:o.detail}),O=L.getInstance(e,!1,o.namespace);return O?O.emit(x,a):a(x)}return ge(e,h,p=>!p||o.oldValue!==!0?d(p):Q(e,h,y=>d(p,y),o),o)}([],f.slice(0),u=>{let c=G.getInstance(e,!1,o.namespace);return c&&c.emit(u),r(ye(t)?u.map(s=>s.status):u[0].status)})}function De(e,t,n,r=i=>i,o={}){return ee(e,t,n,r,o,!0)}function gr(e,t,n=o=>o,r={}){return ee(e,t,n,r,!0)}function We(e,t,n=o=>o,r={}){e=k(e),A(n)&&([r,n]=[n,f=>f]);let o=D(t),i=[...o];return function f(l,u,c){if(!u.length)return c(l);let s=u.shift();function m(g,a=void 0){let d=x=>(g.status=x,f(l.concat(g),u,c));if(arguments.length>1)return d(g,a);let p=P(e,"accessorizedProps",!1),y=p&&p.get(g.key);return y&&!y.restore()&&d(!1),d(Reflect.deleteProperty(e,g.key))}function h(g){let a=new M(e,{type:"deleteProperty",key:s,oldValue:g,related:[...i],detail:r.detail}),d=L.getInstance(e,!1,r.namespace);return d?d.emit(a,m):m(a)}return r.oldValue===!1?h():Q(e,s,h,r)}([],o.slice(0),f=>{let l=G.getInstance(e,!1,r.namespace);return l&&l.emit(f),n(ye(t)?f.map(u=>u.status):f[0].status)})}function Be(e,t,n=null,r=i=>i,o={}){return N(e,"construct",arguments.length>2?{argumentsList:t,newTarget:n}:{argumentsList:t},r,o)}function $e(e,t,n,r=i=>i,o={}){return N(e,"apply",{thisArgument:t,argumentsList:n},r,o)}function Ve(e,t,n=o=>o,r={}){return N(e,"setPrototypeOf",{proto:t},n,r)}function ze(e,t=r=>r,n={}){return N(e,"preventExtensions",{},t,n)}function wt(e,t,n,r={}){let o;r.signal||(o=new AbortController,r={...r,signal:o.signal});let i=G.getInstance(e,!0,r.namespace);return function f(l,u=null){u?.remove();let s={signal:i.addRegistration(t,f,r).signal};return arguments.length&&n(l,s),o}}function N(e,t,n={},r=i=>i,o={}){e=k(e),A(r)&&([o,r]=[r,u=>u]);function i(u,c){return arguments.length>1?r(c):r(Reflect[t](e,...Object.values(n)))}let f=new M(e,{type:t,...n}),l=L.getInstance(e,!1,o.namespace);return l?l.emit(f,i):i(f)}function ye(e){return e===1/0||Array.isArray(e)}function k(e,t=!0){if((!e||!S(e))&&t)throw new Error(`Object must be of type object or array! "${K(e)}" given.`);return e instanceof M&&(e=e.value),e&&de(e)}function yr(e,t,n){return t===1/0?he(e,n):n(D(t))}var _r={...Ue,...Re},Ge=_r;function J(e){return Array.isArray(e)}function vt(e,t,n=null){return J(t)?e.filter(r=>n?t.filter(o=>n(r,o)).length:t.indexOf(r)!==-1):[]}function xe(e,...t){globalThis.WebQitInternalsRegistry||(globalThis.WebQitInternalsRegistry=new fe);var n=globalThis.WebQitInternalsRegistry.get(e);n||(n=new fe,globalThis.WebQitInternalsRegistry.set(e,n));for(var r,o;r=t.shift();)(o=n)&&!(n=n.get(r))&&(n=new fe,o.set(r,n));return n}var fe=class extends Map{constructor(...t){super(...t),this.observers=new Set}set(t,n){let r=super.set(t,n);return this.fire("set",t,n,t),r}delete(t){let n=super.delete(t);return this.fire("delete",t),n}has(t){return this.fire("has",t),super.has(t)}get(t){return this.fire("get",t),super.get(t)}keyNames(){return Array.from(super.keys())}observe(t,n,r){let o={type:t,key:n,callback:r};return this.observers.add(o),()=>this.observers.delete(o)}unobserve(t,n,r){if(Array.isArray(t)||Array.isArray(n))throw new Error('The "type" and "key" arguments can only be strings.');for(let o of this.observers)!(_e([t,"*"],o.type)&&_e([n,"*"],o.key)&&o.callback===r)||this.observers.delete(o)}fire(t,n,...r){for(let o of this.observers)!(_e([t,"*"],o.type)&&_e([n,"*"],o.key))||o.callback(...r)}},_e=(e,t)=>Array.isArray(t)?vt(e,t).length:e.includes(t);var Oe=(e,...t)=>xe(e,"oohtml",...t);function Xe(e={}){let t=this,r=ht.call(t).meta("oohtml").copyWithDefaults(e,{api:{state:"state"}});vr.call(this,r)}function Pt(e){if(!Oe(e).has("state")){let t=Object.create(null);Oe(e).set("state",t)}return Oe(e).get("state")}function vr(e){let t=this;if(e.api.state in t.document)throw new Error(`document already has a "${e.api.state}" property!`);if(e.api.state in t.Element.prototype)throw new Error(`The "Element" class already has a "${e.api.state}" property!`);Object.defineProperty(t.document,e.api.state,{get:function(){return Ge.proxy(Pt(t.document))}}),Object.defineProperty(t.Element.prototype,e.api.state,{get:function(){return Ge.proxy(Pt(this))}})}Xe.call(window);})();
//# sourceMappingURL=state-api.js.map
