<!DOCTYPE html>
<html>
    <head>
        <meta name="subscript-compiler-url" content="http://127.0.0.1:5500/subscript/dist/compiler.js" />
        <script src="http://127.0.0.1:5500/oohtml/dist/main.js"></script>
        <script>
            window.extVar = 'External variable.';
        </script>
    </head>
    <body>

        <div id="diiiiv">
            DIV
            <script scoped contract>
                alert( 'Execution context: ' + this.tagName );
                alert( extVar );
                this.addEventListener( 'beforeremove', e => {
                    alert('removing...');
                } );
                setTimeout( () => {
                    this.remove();
                }, 10000 );
            </script>
        </div>

        <div id="diiiiv2">
            DIV
            <script scoped contract>
                alert( 'Execution context: ' + this.tagName );
                alert( extVar );
                this.addEventListener( 'beforeremove', e => {
                    alert('removing...');
                } );
                setTimeout( () => {
                    this.remove();
                }, 10000 );
            </script>
        </div>

        <script>
            const diiiiv = document.querySelector( '#diiiiv' );
            setTimeout( () => {
                extVar = 'External variable updated!';
                diiiiv.scripts.forEach( script => {
                    script.sync( [ 'extVar' ] );
                } );
            }, 5000 );
        </script>
        
    </body>
</html>